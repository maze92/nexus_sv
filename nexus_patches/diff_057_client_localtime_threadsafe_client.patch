diff --git a/src-client/Client/EterPythonLib/PythonGraphicModule.cpp b/src-client/Client/EterPythonLib/PythonGraphicModule.cpp
--- a/src-client/Client/EterPythonLib/PythonGraphicModule.cpp
+++ b/src-client/Client/EterPythonLib/PythonGraphicModule.cpp
@@ -821,7 +821,11 @@
 	time_t ct;
 
 	ct = time(0);
-	tmNow = localtime(&ct);
+	struct tm tmNowBuf;
+			if (localtime_s(&tmNowBuf, &ct) != 0)
+				tmNow = NULL;
+			else
+				tmNow = &tmNowBuf;
 
 	char szPath[MAX_PATH + 256];
 	snprintf(szPath, sizeof(szPath), "%s%02d%02d_%02d%02d%02d.jpg",
@@ -843,7 +847,11 @@
 	time_t ct;
 
 	ct = time(0);
-	tmNow = localtime(&ct);
+	struct tm tmNowBuf;
+			if (localtime_s(&tmNowBuf, &ct) != 0)
+				tmNow = NULL;
+			else
+				tmNow = &tmNowBuf;
 
 	char szPath[MAX_PATH + 256];
 	SHGetSpecialFolderPath(NULL, szPath, CSIDL_PERSONAL, TRUE);
diff --git a/src-client/Client/GameLib/Property.cpp b/src-client/Client/GameLib/Property.cpp
--- a/src-client/Client/GameLib/Property.cpp
+++ b/src-client/Client/GameLib/Property.cpp
@@ -129,7 +129,7 @@
 void GetTimeString(char* str, time_t ct)
 {
 	struct tm tm;
-	tm = *localtime(&ct);
+	localtime_s(&tm, &ct);
 
 	_snprintf(str, 15, "%04d%02d%02d%02d%02d%02d",
 		tm.tm_year + 1900,
diff --git a/src-client/Client/EterBase/Debug.cpp b/src-client/Client/EterBase/Debug.cpp
--- a/src-client/Client/EterBase/Debug.cpp
+++ b/src-client/Client/EterBase/Debug.cpp
@@ -37,7 +37,7 @@
 			return;
 
 		time_t ct = time(0);
-		struct tm ctm = *localtime(&ct);
+		struct tm ctm; localtime_s(&ctm, &ct);
 
 		fprintf(m_fp, "%02d%02d %02d:%02d:%05d :: %s",
 			ctm.tm_mon + 1,
@@ -224,7 +224,7 @@
 	szBuf[len + 1] = '\0';
 
 	time_t ct = time(0);
-	struct tm ctm = *localtime(&ct);
+	struct tm ctm; localtime_s(&ctm, &ct);
 
 	//fprintf(stderr, "%02d%02d %02d:%02d:%05d :: %s",
 	fprintf(stderr, "%02d%02d :: %s",
@@ -259,7 +259,7 @@
 	va_end(args);
 
 	time_t ct = time(0);
-	struct tm ctm = *localtime(&ct);
+	struct tm ctm; localtime_s(&ctm, &ct);
 
 	fprintf(stderr, "%02d%02d %02d:%02d:%05d :: %s",
 		ctm.tm_mon + 1,
@@ -325,7 +325,9 @@
 	gs_timestamp = std::chrono::duration_cast<std::chrono::seconds>(now.time_since_epoch()).count();
 
 	std::time_t cur_time = std::chrono::system_clock::to_time_t(now);
-	struct tm* time_info = std::localtime(&cur_time);
+	static thread_local struct tm time_info_buf;
+	localtime_s(&time_info_buf, &cur_time);
+	struct tm* time_info = &time_info_buf;
 
 	char szFileName[MAX_PATH];
 	std::strftime(szFileName, sizeof(szFileName), "%Y%m%d", time_info);
diff --git a/src-client/Client/UserInterface/PythonApplicationModule.cpp b/src-client/Client/UserInterface/PythonApplicationModule.cpp
--- a/src-client/Client/UserInterface/PythonApplicationModule.cpp
+++ b/src-client/Client/UserInterface/PythonApplicationModule.cpp
@@ -1237,7 +1237,9 @@
 {
 	time_t t = time(nullptr);
 	char szBuffer[100];
-	if (strftime(szBuffer, sizeof(szBuffer), "%Y.%m.%d  %T", localtime(&t)))
+	struct tm tm_buf;
+	localtime_s(&tm_buf, &t);
+	if (strftime(szBuffer, sizeof(szBuffer), "%Y.%m.%d  %T", &tm_buf))
 		return Py_BuildValue("s", szBuffer);
 
 	return Py_BuildValue("s", "");
@@ -1251,7 +1253,9 @@
 	//std::locale::global(std::locale(szCodePage));
 	time_t t = time(nullptr);
 	char szBuffer[100];
-	if (strftime(szBuffer, sizeof(szBuffer), "%Z", localtime(&t)))
+	struct tm tm_buf2;
+	localtime_s(&tm_buf2, &t);
+	if (strftime(szBuffer, sizeof(szBuffer), "%Z", &tm_buf2))
 		return Py_BuildValue("s", szBuffer);
 
 	return Py_BuildValue("s", "");
@@ -1264,7 +1268,8 @@
 		return Py_BuildException();
 
 	const time_t time = static_cast<time_t>(dwTime);
-	struct tm* t = localtime(&time);
+	struct tm t_buf; localtime_s(&t_buf, &time);
+	struct tm* t = &t_buf;
 	if (!t)
 		return Py_BuildNone();
 
@@ -1285,7 +1290,8 @@
 		return Py_BuildException();
 
 	const time_t time = static_cast<time_t>(dwTime);
-	struct tm* t = localtime(&time);
+	struct tm t_buf; localtime_s(&t_buf, &time);
+	struct tm* t = &t_buf;
 	if (!t)
 		return Py_BuildValue("s", "ERROR");
 
