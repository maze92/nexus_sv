--- Nexus OS/server/metin2/Source/Server/game/src/exchange.h
+++ Nexus OS/server/metin2/Source/Server/game/src/exchange.h
@@ -51,6 +51,7 @@
 	TItemPos m_aItemPos[EXCHANGE_ITEM_MAX_NUM];
 	LPITEM m_apItems[EXCHANGE_ITEM_MAX_NUM];
 	BYTE m_abItemDisplayPos[EXCHANGE_ITEM_MAX_NUM];
+	bool m_abLocked[EXCHANGE_ITEM_MAX_NUM];
 
 	bool m_bAccept;
 	long m_lGold;
--- Nexus OS/server/metin2/Source/Server/game/src/exchange.cpp
+++ Nexus OS/server/metin2/Source/Server/game/src/exchange.cpp
@@ -207,6 +207,7 @@
 		m_apItems[i] = NULL;
 		m_aItemPos[i] = NPOS;
 		m_abItemDisplayPos[i] = 0;
+		m_abLocked[i] = false;
 	}
 
 	m_lGold = 0;
@@ -684,6 +685,12 @@
 		}
 #endif
 
+		if (m_abLocked[i])
+		{
+			item->Lock(false);
+			m_abLocked[i] = false;
+		}
+
 		item->RemoveFromCharacter();
 #if defined(__DRAGON_SOUL_SYSTEM__)
 		if (item->IsDragonSoul())
@@ -763,6 +770,31 @@
 
 	m_bAccept = bAccept;
 
+	// Lock exchange items immediately on accept to prevent race/exploit (move/drop while accepting)
+	for (int i = 0; i < EXCHANGE_ITEM_MAX_NUM; ++i)
+	{
+		LPITEM item = m_apItems[i];
+		if (!item)
+			continue;
+
+		if (m_bAccept)
+		{
+			if (!m_abLocked[i])
+			{
+				item->Lock(true);
+				m_abLocked[i] = true;
+			}
+		}
+		else
+		{
+			if (m_abLocked[i])
+			{
+				item->Lock(false);
+				m_abLocked[i] = false;
+			}
+		}
+	}
+
 	// 둘 다 동의 했으므로 교환 성립
 	if (m_bAccept && GetCompany()->m_bAccept)
 	{
@@ -868,7 +900,14 @@
 	for (int i = 0; i < EXCHANGE_ITEM_MAX_NUM; ++i)
 	{
 		if (m_apItems[i])
+		{
+			if (m_abLocked[i])
+			{
+				m_apItems[i]->Lock(false);
+				m_abLocked[i] = false;
+			}
 			m_apItems[i]->SetExchanging(false);
+		}
 	}
 
 	if (GetCompany())
