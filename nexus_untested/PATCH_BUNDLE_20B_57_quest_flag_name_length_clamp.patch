--- server/metin2/Source/Server/game/src/questlua_pc.cpp
+++ server/metin2/Source/Server/game/src/questlua_pc.cpp
@@ -1452,6 +1452,11 @@
 		else
 		{
 			const char* sz = lua_tostring(L, 1);
+			if (sz && strlen(sz) > 20)
+			{
+				sys_err("QUEST setqf: flag name too long (len %zu): %s", strlen(sz), sz);
+				return 0;
+			}
 			CQuestManager& q = CQuestManager::Instance();
 			PC* pPC = q.GetCurrentPC();
 			pPC->SetFlag(sz, int(rint(lua_tonumber(L, 2))));
@@ -1484,6 +1489,11 @@
 		}
 
 		const char* sz = lua_tostring(L, 1);
+		if (sz && strlen(sz) > 20)
+		{
+			sys_err("QUEST delqf: flag name too long (len %zu): %s", strlen(sz), sz);
+			return 0;
+		}
 		PC* pPC = CQuestManager::instance().GetCurrentPC();
 		pPC->DeleteFlag(pPC->GetCurrentQuestName() + "." + sz);
 		return 0;
