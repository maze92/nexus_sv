--- a/game/src/char_item.cpp
+++ b/game/src/char_item.cpp
@@ -11175,6 +11188,19 @@
 
 	}
 
+#if defined(__COSTUME_SYSTEM__)
+	// Harden: never allow equipping costume visuals that violate gender restrictions (prevents client crashes via invalid race/sex models)
+	if (itemTable && itemTable->IsCostume())
+	{
+		if ((IS_SET(item->GetAntiFlag(), ITEM_ANTIFLAG_MALE) && SEX_MALE == GET_SEX(this)) ||
+			(IS_SET(item->GetAntiFlag(), ITEM_ANTIFLAG_FEMALE) && SEX_FEMALE == GET_SEX(this)))
+		{
+			ChatPacket(CHAT_TYPE_INFO, LC_STRING("\xbc\xba\xba\xb0\xc0\xcc \xb8\xc2\xc1\xf6\be\xca\be\xc6 \xc0\xcc \xbe\xc6\xc0\xcc\xc5\xdb\xc0\xbb \xbb\xe7\xbf\xeb\xc7\xd2 \xbc\xf6 \be\xf8\bd\xc0\xb4\xcf\xb4\xd9."));
+			return false;
+		}
+	}
+#endif
+
 	for (int i = 0; i < ITEM_LIMIT_MAX_NUM; ++i)
 	{
 		long limit = itemTable->aLimits[i].lValue;
