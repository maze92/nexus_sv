--- a/server/home/metin2/Source/Server/game/src/lzo_manager.h
+++ b/server/home/metin2/Source/Server/game/src/lzo_manager.h
@@ -6,6 +6,7 @@
 class LZOManager : public singleton<LZOManager>
 {
 public:
+	static const lzo_uint MAX_DECOMPRESSED = 16 * 1024 * 1024; // 16MB hard cap
 	LZOManager();
 	virtual ~LZOManager();
 

--- a/server/home/metin2/Source/Server/game/src/lzo_manager.cpp
+++ b/server/home/metin2/Source/Server/game/src/lzo_manager.cpp
@@ -31,6 +31,10 @@
 
 bool LZOManager::Decompress(const BYTE* src, size_t srcsize, BYTE* dest, lzo_uint* puiDestSize)
 {
+	if (!src || !dest || !puiDestSize)
+		return false;
+	if (*puiDestSize > MAX_DECOMPRESSED)
+		return false;
 	int ret = lzo1x_decompress_safe(src, srcsize, dest, puiDestSize, GetWorkMemory());
 
 	if (ret != LZO_E_OK)
