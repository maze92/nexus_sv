How to

Client\Source\EterLib\MSWindow.cpp:

// Find and erase

void CMSWindow::GetWindowRect(RECT* prc)
{
    ::GetWindowRect(m_hWnd, prc);
}

// Add new helper functions

static bool GetVisualWindowRect(HWND hwnd, RECT& outRect)
{
    if (!::GetWindowRect(hwnd, &outRect))
        return false;

    using DwmGetWindowAttributeFn = HRESULT(WINAPI*)(HWND, DWORD, PVOID, DWORD);
    constexpr DWORD ExtendedFrameBounds = 9;

    static HMODULE s_dwm = ::LoadLibraryA("dwmapi.dll");
    if (!s_dwm)
        return true;

    static auto s_getAttr =
        reinterpret_cast<DwmGetWindowAttributeFn>(
            ::GetProcAddress(s_dwm, "DwmGetWindowAttribute"));

    if (!s_getAttr)
        return true;

    RECT visual{};
    if (SUCCEEDED(s_getAttr(hwnd, ExtendedFrameBounds, &visual, sizeof(visual))))
    {
        outRect = visual;
    }

    return true;
}

static POINT GetCenteredPosition(const RECT& visualRect, const RECT& workArea, const RECT& windowRect)
{
    const int width = visualRect.right - visualRect.left;
    const int height = visualRect.bottom - visualRect.top;

    const int dx = visualRect.left - windowRect.left;
    const int dy = visualRect.top - windowRect.top;

    POINT pt{};
    pt.x = workArea.left + ((workArea.right - workArea.left) - width) / 2 - dx;
    pt.y = workArea.top + ((workArea.bottom - workArea.top) - height) / 2 - dy;
    return pt;
}

// change function void CMSWindow::SetCenterPosition()

void CMSWindow::SetCenterPosition()
{
    RECT window{};
    RECT visual{};
    RECT workArea{};

    if (!::GetWindowRect(m_hWnd, &window))
        return;

    visual = window;
    GetVisualWindowRect(m_hWnd, visual);

    ::SystemParametersInfo(SPI_GETWORKAREA, 0, &workArea, 0);

    const POINT pos = GetCenteredPosition(visual, workArea, window);
    SetPosition(pos.x, pos.y);
}
Client\Source\EterLib\MSWindow.h:

// Find and erase

        void GetWindowRect(RECT* prc);
Client\Source\UserInterface\PythonApplication.cpp:

// Find and erase

    bool bAnotherWindow = false;

    if (FindWindow(NULL, c_szName))
    {
        bAnotherWindow = true;
    }

// Find @@ bool CPythonApplication::Create(PyObject * poSelf, const char* c_szName, int wid

        AdjustSize(m_pySystem.GetWidth(), m_pySystem.GetHeight());

// Add this underneath

        CMSWindow::SetCenterPosition();

// Find and erase @@ bool CPythonApplication::Create(PyObject * poSelf, const char* c_szName, int wid


            if (bAnotherWindow)
            {
                RECT rc;

                GetClientRect(&rc);

                int windowWidth = rc.right - rc.left;
                int windowHeight = (rc.bottom - rc.top);

                CMSApplication::SetPosition(GetScreenWidth() - windowWidth, GetScreenHeight() - 60 - windowHeight);
            }
 

Client\Source\UserInterface\UserInterface.cpp:

// Add to the top of the file

#include <shellscalingapi.h>
#pragma comment(lib, "Shcore.lib")

// Find
int APIENTRY WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow)
{

// Add this
    SetProcessDpiAwarenessContext(DPI_AWARENESS_CONTEXT_PER_MONITOR_AWARE_V2);
