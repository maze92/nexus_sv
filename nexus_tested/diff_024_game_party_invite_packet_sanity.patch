--- a/server/metin2/Source/Server/game/src/input_main.cpp
+++ b/server/metin2/Source/Server/game/src/input_main.cpp
@@ -2702,6 +2702,12 @@
 		return;
 	}
 
+	if (m_iBufferLeft < (int)sizeof(TPacketCGPartyInvite))
+	{
+		sys_err("PARTY_INVITE: malformed packet (len=%d < %u)", m_iBufferLeft, (unsigned)sizeof(TPacketCGPartyInvite));
+		return;
+	}
+
 	TPacketCGPartyInvite* p = (TPacketCGPartyInvite*)c_pData;
 
 	LPCHARACTER pInvitee = CHARACTER_MANAGER::instance().Find(p->vid);
@@ -2741,6 +2747,12 @@
 		return;
 	}
 
+	if (m_iBufferLeft < (int)sizeof(TPacketCGPartyInviteAnswer))
+	{
+		sys_err("PARTY_INVITE_ANSWER: malformed packet (len=%d < %u)", m_iBufferLeft, (unsigned)sizeof(TPacketCGPartyInviteAnswer));
+		return;
+	}
+
 	TPacketCGPartyInviteAnswer* p = (TPacketCGPartyInviteAnswer*)c_pData;
 
 	LPCHARACTER pInviter = CHARACTER_MANAGER::instance().Find(p->leader_vid);
