--- server/metin2/Source/Server/game/src/DragonSoul.cpp
+++ server/metin2/Source/Server/game/src/DragonSoul.cpp
@@ -737,6 +737,20 @@
 				SendRefineResultPacket(ch, DS_SUB_HEADER_REFINE_FAIL_INVALID_MATERIAL, TItemPos(pItem->GetWindow(), pItem->GetCell()));

 				return false;

 			}

+			// Hardening: DS refine must only accept items from the dragon soul inventory.

+			if (pItem->GetWindow() != DRAGON_SOUL_INVENTORY)

+			{

+				ch->ChatPacket(CHAT_TYPE_INFO, LC_STRING("  ʿ ᰡ ƴմϴ."));

+				SendRefineResultPacket(ch, DS_SUB_HEADER_REFINE_FAIL_INVALID_MATERIAL, TItemPos(pItem->GetWindow(), pItem->GetCell()));

+				return false;

+			}

+			// Hardening: DS refine must only accept items from the dragon soul inventory.

+			if (pItem->GetWindow() != DRAGON_SOUL_INVENTORY)

+			{

+				ch->ChatPacket(CHAT_TYPE_INFO, LC_STRING("ܰ  ʿ ᰡ ƴմϴ."));

+				SendRefineResultPacket(ch, DS_SUB_HEADER_REFINE_FAIL_INVALID_MATERIAL, TItemPos(pItem->GetWindow(), pItem->GetCell()));

+				return false;

+			}

 			set_items.insert(pItem);

 		}

 	}

@@ -921,6 +935,12 @@
 				SendRefineResultPacket(ch, DS_SUB_HEADER_REFINE_FAIL_TOO_MUCH_MATERIAL, TItemPos(pItem->GetWindow(), pItem->GetCell()));

 				return false;

 			}

+			if (pItem->GetWindow() != DRAGON_SOUL_INVENTORY)

+			{

+				ch->ChatPacket(CHAT_TYPE_INFO, LC_STRING("ȭ ʿ ᰡ ƴմϴ."));

+				SendRefineResultPacket(ch, DS_SUB_HEADER_REFINE_FAIL_INVALID_MATERIAL, TItemPos(pItem->GetWindow(), pItem->GetCell()));

+				return false;

+			}

 			pDragonSoul = pItem;

 		}

 		else if (IsDragonSoulRefineMaterial(pItem))

@@ -1092,6 +1112,12 @@
 			if (lpDragonSoul != nullptr)

 			{

 				SendRefineResultPacket(lpCh, DS_SUB_HEADER_REFINE_FAIL_TOO_MUCH_MATERIAL, TItemPos(lpItem->GetWindow(), lpItem->GetCell()));

+				return false;

+			}

+			if (lpItem->GetWindow() != DRAGON_SOUL_INVENTORY)

+			{

+				lpCh->ChatPacket(CHAT_TYPE_INFO, LC_STRING("ȭ ʿ ᰡ ƴմϴ."));

+				SendRefineResultPacket(lpCh, DS_SUB_HEADER_REFINE_FAIL_INVALID_MATERIAL, TItemPos(lpItem->GetWindow(), lpItem->GetCell()));

 				return false;

 			}

 			lpDragonSoul = lpItem;

@@ -1417,4 +1443,4 @@
 	if (m_pTable)

 		delete m_pTable;

 }

-#endif

+#endif

