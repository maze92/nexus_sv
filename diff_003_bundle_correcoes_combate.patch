--- a/server/metin2/Source/Server/game/src/auth_brazil.cpp
+++ b/server/metin2/Source/Server/game/src/auth_brazil.cpp
@@ -37,7 +37,9 @@
 	int offset = 0;

 	for (int i = 0; i < 16; ++i)

 	{

-		offset += sprintf(s_buffer + offset, "%02x", digest[i]);

+		if (offset + 2 >= (int)sizeof(s_buffer))

+			break;

+		offset += snprintf(s_buffer + offset, sizeof(s_buffer) - offset, "%02x", digest[i]);

 	}

 	return s_buffer;

 }

@@ -131,7 +133,7 @@
 			return AUTH_BRAZIL_SERVER_ERR;

 		}

 

-		// ÀÀ´ä¹ÞÀº °æ¿ì¿¡¸¸ query count¸¦ ´Ã¸°´Ù.

+		//  쿡 query count ø.

 		auth_brazil_inc_query_count();

 

 		return FN_parse_reply(reply);


--- a/server/metin2/Source/Server/game/src/battle.cpp
+++ b/server/metin2/Source/Server/game/src/battle.cpp
@@ -45,6 +45,11 @@
 	const int iDistance = DISTANCE_APPROX(ch->GetX() - victim->GetX(), ch->GetY() - victim->GetY());

 	float fHitRange = 300 + static_cast<int>(victim->GetMonsterHitRange());

 

+	// [Security] Prevent click-through attacks across floors/ceilings (DT/Cata).

+	const long lZDist = ch->GetZ() - victim->GetZ();

+	if (lZDist > 1000 || lZDist < -1000)

+		return false;

+

 	if (iDistance > fHitRange)

 		return false;

 

@@ -76,7 +81,7 @@
 	}

 

 	// RECALL_DELAY

-	// Â÷ÈÄ ÀüÅõ·Î ÀÎÇØ ±ÍÈ¯ºÎ µô·¹ÀÌ°¡ Ãë¼Ò µÇ¾î¾ß ÇÒ °æ¿ì ÁÖ¼® ÇØÁ¦

+	//    ȯ ̰  Ǿ   ּ 

 	/*

 	if (ch->m_pk_RecallEvent)

 	{

@@ -91,11 +96,15 @@
 

 bool battle_is_attackable(LPCHARACTER ch, LPCHARACTER victim)

 {

-	// »ó´ë¹æÀÌ Á×¾úÀ¸¸é Áß´ÜÇÑ´Ù.

+	// [Security Fix] Ghost attack: observer/spectator cannot attack or be attacked.

+	if (!ch || ch->IsDead() || ch->IsObserverMode())

+		return false;

+

+	//  ׾ ߴѴ.

 	if (victim->IsDead() || victim->IsObserverMode())

 		return false;

 

-	// ¾ÈÀüÁö´ë¸é Áß´Ü

+	//  ߴ

 	{

 		SECTREE* sectree = NULL;

 

@@ -108,7 +117,7 @@
 			return false;

 	}

 

-	// ³»°¡ Á×¾úÀ¸¸é Áß´ÜÇÑ´Ù.

+	//  ׾ ߴѴ.

 	if (ch->IsStun() || ch->IsDead() || ch->IsObserverMode())

 		return false;

 

@@ -177,7 +186,7 @@
 	if (test_server && ch->IsPC())

 		sys_log(0, "battle_melee_attack : [%s] attack to [%s]", ch->GetName(), victim->GetName());

 

-	// °Å¸® Ã¼Å©

+	// Ÿ üũ

 	int distance = DISTANCE_APPROX(ch->GetX() - victim->GetX(), ch->GetY() - victim->GetY());

 

 	if (!victim->IsBuilding())

@@ -186,12 +195,12 @@
 

 		if (false == ch->IsPC())

 		{

-			// ¸ó½ºÅÍÀÇ °æ¿ì ¸ó½ºÅÍ °ø°Ý °Å¸®¸¦ »ç¿ë

+			//     Ÿ 

 			max = (int)(ch->GetMobAttackRange() * 1.15f);

 		}

 		else

 		{

-			// PCÀÏ °æ¿ì »ó´ë°¡ melee ¸÷ÀÏ °æ¿ì ¸÷ÀÇ °ø°Ý °Å¸®°¡ ÃÖ´ë °ø°Ý °Å¸®

+			// PC  밡 melee     Ÿ ִ  Ÿ

 			if (false == victim->IsPC() && BATTLE_TYPE_MELEE == victim->GetMobBattleType())

 				max = MAX(max, (int)(victim->GetMobAttackRange() * 1.15f));

 		}

@@ -206,10 +215,10 @@
 	}

 

 	if (timed_event_cancel(ch))

-		ch->ChatPacket(CHAT_TYPE_INFO, LC_STRING("ÀüÅõ°¡ ½ÃÀÛ µÇ¾î Ãë¼Ò µÇ¾ú½À´Ï´Ù."));

+		ch->ChatPacket(CHAT_TYPE_INFO, LC_STRING("  Ǿ  Ǿϴ."));

 

 	if (timed_event_cancel(victim))

-		victim->ChatPacket(CHAT_TYPE_INFO, LC_STRING("ÀüÅõ°¡ ½ÃÀÛ µÇ¾î Ãë¼Ò µÇ¾ú½À´Ï´Ù."));

+		victim->ChatPacket(CHAT_TYPE_INFO, LC_STRING("  Ǿ  Ǿϴ."));

 

 	ch->SetPosition(POS_FIGHTING);

 	ch->SetVictim(victim);

@@ -222,7 +231,7 @@
 	return (ret);

 }

 

-// ½ÇÁ¦ GET_BATTLE_VICTIMÀ» NULL·Î ¸¸µé°í ÀÌº¥Æ®¸¦ Äµ½½ ½ÃÅ²´Ù.

+//  GET_BATTLE_VICTIM NULL  ̺Ʈ ĵ Ų.

 void battle_end_ex(LPCHARACTER ch)

 {

 	if (ch->IsPosition(POS_FIGHTING))

@@ -251,12 +260,18 @@
 

 int CalcMagicDamageWithValue(int iDam, LPCHARACTER pkAttacker, LPCHARACTER pkVictim)

 {

+	if (!pkAttacker || !pkVictim)

+		return 0;

+

 	return CalcBattleDamage(iDam, pkAttacker->GetLevel(), pkVictim->GetLevel());

 }

 

 int CalcMagicDamage(LPCHARACTER pkAttacker, LPCHARACTER pkVictim)

 {

 	int iDam = 0;

+

+	if (!pkAttacker || !pkVictim)

+		return 0;

 

 	if (pkAttacker->IsNPC())

 	{

@@ -273,10 +288,13 @@
 

 float CalcAttackRating(LPCHARACTER pkAttacker, LPCHARACTER pkVictim, bool bIgnoreTargetRating)

 {

+	if (!pkAttacker || !pkVictim)

+		return 0.0f;

+

 	int iARSrc;

 	int iERSrc;

 

-	if (LC_IsYMIR()) // Ãµ¸¶

+	if (LC_IsYMIR()) // õ

 	{

 		iARSrc = MIN(gPlayerMaxLevelStats, pkAttacker->GetPolymorphPoint(POINT_DX));

 		iERSrc = MIN(gPlayerMaxLevelStats, pkVictim->GetPolymorphPoint(POINT_DX));

@@ -287,7 +305,7 @@
 		int attacker_lv = pkAttacker->GetLevel();

 

 		int victim_dx = pkVictim->GetPolymorphPoint(POINT_DX);

-		int victim_lv = pkAttacker->GetLevel();

+		int victim_lv = pkVictim->GetLevel();

 

 		iARSrc = MIN(gPlayerMaxLevelStats, (attacker_dx * 4 + attacker_lv * 2) / 6);

 		iERSrc = MIN(gPlayerMaxLevelStats, (victim_dx * 4 + victim_lv * 2) / 6);

@@ -329,11 +347,14 @@
 

 int CalcAttBonus(LPCHARACTER pkAttacker, LPCHARACTER pkVictim, int iAtk)

 {

-	// PvP¿¡´Â Àû¿ëÇÏÁö¾ÊÀ½

+	if (!pkAttacker || !pkVictim)

+		return iAtk;

+

+	// PvP\xbf\xa1\xb4\xc2 \xc0\xfb\xbf\xeb\xc7\xcf\xc1\xf6\xbe\xca\xc0\xbd

 	if (!pkVictim->IsPC())

 		iAtk += pkAttacker->GetMarriageBonus(UNIQUE_ITEM_MARRIAGE_ATTACK_BONUS);

 

-	// PvP¿¡´Â Àû¿ëÇÏÁö¾ÊÀ½

+	// PvP 

 	if (!pkAttacker->IsPC())

 	{

 		int iReduceDamagePct = pkVictim->GetMarriageBonus(UNIQUE_ITEM_MARRIAGE_TRANSFER_DAMAGE);

@@ -586,6 +607,9 @@
 

 int CalcMeleeDamage(LPCHARACTER pkAttacker, LPCHARACTER pkVictim, bool bIgnoreDefense, bool bIgnoreTargetRating)

 {

+	if (!pkAttacker || !pkVictim)

+		return 0;

+

 	LPITEM pWeapon = pkAttacker->GetWear(WEAR_WEAPON);

 	bool bPolymorphed = pkAttacker->IsPolymorphed();

 

@@ -769,8 +793,16 @@
 	if (!pkArrow)

 		return 0;

 

-	// Å¸°ÝÄ¡ °è»êºÎ

+	// Ÿġ 

 	int iDist = (int)(DISTANCE_SQRT(pkAttacker->GetX() - pkVictim->GetX(), pkAttacker->GetY() - pkVictim->GetY()));

+

+	// [Security Fix] Bow-Morph ghost range: when polymorphed, do not allow weapon range to override mob range.

+	if (pkAttacker->IsPolymorphed())

+	{

+		const int iMaxPolyRange = (int)(pkAttacker->GetMobAttackRange() * 1.15f);

+		if (iDist > iMaxPolyRange)

+			return 0;

+	}

 	//int iGap = (iDist / 100) - 5 - pkBow->GetValue(5) - pkAttacker->GetPoint(POINT_BOW_DISTANCE);

 	int iGap = (iDist / 100) - 5 - pkAttacker->GetPoint(POINT_BOW_DISTANCE);

 	int iPercent = 100 - (iGap * 5);

@@ -836,7 +868,7 @@
 

 void NormalAttackAffect(LPCHARACTER pkAttacker, LPCHARACTER pkVictim)

 {

-	// µ¶ °ø°ÝÀº Æ¯ÀÌÇÏ¹Ç·Î Æ¯¼ö Ã³¸®

+	//   ƯϹǷ Ư ó

 	if (pkAttacker->GetPoint(POINT_POISON_PCT) && !pkVictim->IsAffectFlag(AFF_POISON))

 	{

 #if defined(__CONQUEROR_LEVEL__)

@@ -877,13 +909,17 @@
 

 int battle_hit(LPCHARACTER pkAttacker, LPCHARACTER pkVictim, int& iRetDam)

 {

+	iRetDam = 0;

+	if (!pkAttacker || !pkVictim)

+		return (BATTLE_DAMAGE);

+

 	int iDam = CalcMeleeDamage(pkAttacker, pkVictim);

 	if (iDam <= 0)

 		return (BATTLE_DAMAGE);

 

 	NormalAttackAffect(pkAttacker, pkVictim);

 

-	// µ¥¹ÌÁö °è»ê

+	//  

 	//iDam = iDam * (100 - pkVictim->GetPoint(POINT_RESIST)) / 100;

 	LPITEM pkWeapon = pkAttacker->GetWear(WEAR_WEAPON);

 

@@ -921,7 +957,7 @@
 			{

 #if defined(__ELEMENT_SYSTEM__)

 				if (pkVictim->IsPC())

-					iDam = iDam * (100 - (pkVictim->GetPoint(POINT_RESIST_DAGGER) - pkVictim->GetPoint(POINT_ATTBONUS_DAGGER))) / 100;

+					iDam = iDam * (100 - (pkVictim->GetPoint(POINT_RESIST_DAGGER) - pkAttacker->GetPoint(POINT_ATTBONUS_DAGGER))) / 100;

 				else

 					iDam = iDam * (100 - pkVictim->GetPoint(POINT_RESIST_DAGGER)) / 100;

 #else

@@ -992,7 +1028,7 @@
 			iDam = iDam * (100 - pkVictim->GetPoint(POINT_RESIST_FIST)) / 100;

 	}

 

-	// ÃÖÁ¾ÀûÀÎ µ¥¹ÌÁö º¸Á¤. (2011³â 2¿ù ÇöÀç ´ë¿Õ°Å¹Ì¿¡°Ô¸¸ Àû¿ë.)

+	//   . (2011 2  հŹ̿Ը .)

 	float attMul = pkAttacker->GetAttMul();

 	float tempIDam = static_cast<float>(iDam);

 	iDam = static_cast<int>(attMul * tempIDam + 0.5f);

@@ -1016,19 +1052,19 @@
 		return 1000;

 

 	LPITEM item = ch->GetWear(WEAR_WEAPON);

-	DWORD default_bonus = SPEEDHACK_LIMIT_BONUS * 3; // À¯µÎ¸® °ø¼Ó(±âº» 80)

+	DWORD default_bonus = SPEEDHACK_LIMIT_BONUS * 3; // θ (⺻ 80)

 	DWORD riding_bonus = 0;

 

 	if (ch->IsRiding())

 	{

-		// ¹º°¡¸¦ ÅÀÀ¸¸é Ãß°¡°ø¼Ó 50

+		//   ߰ 50

 		riding_bonus = 50;

 	}

 

 	DWORD ani_speed = ani_attack_speed(ch);

 	DWORD real_speed = (ani_speed * 100) / (default_bonus + ch->GetPoint(POINT_ATT_SPEED) + riding_bonus);

 

-	// ´Ü°ËÀÇ °æ¿ì °ø¼Ó 2¹è

+	// ܰ   2

 	if (item && item->GetSubType() == WEAPON_DAGGER)

 		real_speed /= 2;

 	else if (item && item->GetSubType() == WEAPON_CLAW)


--- a/server/metin2/Source/Server/game/src/char_battle.cpp
+++ b/server/metin2/Source/Server/game/src/char_battle.cpp
@@ -169,7 +169,7 @@
 			else if (bMoving)

 				iAmount = 3 + GetMaxSP() * 2 / 100;

 			else

-				iAmount = 10 + GetMaxSP() * 3 / 100; // Æò»ó½Ã

+				iAmount = 10 + GetMaxSP() * 3 / 100; // 

 

 			iAmount += (iAmount * pkKiller->GetPoint(POINT_SP_REGEN)) / 100;

 			pkKiller->PointChange(POINT_SP, iAmount);

@@ -184,11 +184,11 @@
 				iAmount = 2 + pkKiller->GetMaxSP() / 100;

 			else

 			{

-				// Æò»ó½Ã

+				// 

 				if (pkKiller->GetHP() < pkKiller->GetMaxHP())

-					iAmount = 2 + (pkKiller->GetMaxSP() / 100); // ÇÇ ´Ù ¾ÈÃ¡À»¶§

+					iAmount = 2 + (pkKiller->GetMaxSP() / 100); //   á

 				else

-					iAmount = 9 + (pkKiller->GetMaxSP() / 100); // ±âº»

+					iAmount = 9 + (pkKiller->GetMaxSP() / 100); // ⺻

 			}

 

 			iAmount += (iAmount * pkKiller->GetPoint(POINT_SP_REGEN)) / 100;

@@ -219,6 +219,16 @@
 	if (!battle_is_attackable(this, pkVictim))

 		return false;

 

+	// [Anti-Exploit] Prevent remote aggro / "Mob Puller" via packet spam.

+	// Attack() sets SyncOwner/BeginFight before distance checks; a forged packet could

+	// start combat from very far away. This hard cap is far above any legitimate range.

+	if (IsPC() && pkVictim && (pkVictim->IsMonster() || pkVictim->IsStone()))

+	{

+		const int iDist = DISTANCE_APPROX(GetX() - pkVictim->GetX(), GetY() - pkVictim->GetY());

+		if (iDist > 5000)

+			return false;

+	}

+

 	DWORD dwCurrentTime = get_dword_time();

 

 	if (IsPC())

@@ -244,7 +254,7 @@
 	if (bType == 0)

 	{

 		//

-		// ÀÏ¹Ý °ø°Ý

+		// Ϲ 

 		//

 		switch (GetMobBattleType())

 		{

@@ -339,14 +349,14 @@
 	if (GetLevel() < 10)

 	{

 		sys_log(0, "NO_DEATH_PENALTY_LESS_LV10(%s)", GetName());

-		ChatPacket(CHAT_TYPE_INFO, LC_STRING("¿ë½ÅÀÇ °¡È£·Î °æÇèÄ¡°¡ ¶³¾îÁöÁö ¾Ê¾Ò½À´Ï´Ù."));

+		ChatPacket(CHAT_TYPE_INFO, LC_STRING(" ȣ ġ  ʾҽϴ."));

 		return;

 	}

 

 	if (number(0, 2))

 	{

 		sys_log(0, "NO_DEATH_PENALTY_LUCK(%s)", GetName());

-		ChatPacket(CHAT_TYPE_INFO, LC_STRING("¿ë½ÅÀÇ °¡È£·Î °æÇèÄ¡°¡ ¶³¾îÁöÁö ¾Ê¾Ò½À´Ï´Ù."));

+		ChatPacket(CHAT_TYPE_INFO, LC_STRING(" ȣ ġ  ʾҽϴ."));

 		return;

 	}

 

@@ -355,22 +365,22 @@
 		REMOVE_BIT(m_pointsInstant.instant_flag, INSTANT_FLAG_DEATH_PENALTY);

 

 		// NO_DEATH_PENALTY_BUG_FIX 

-		if (LC_IsYMIR()) // Ãµ¸¶ ¹öÀü¿¡¼­´Â ¾ðÁ¦³ª ¿ë½ÅÀÇ °¡È£ ¾ÆÀÌÅÛÀ» Ã¼Å©ÇÑ´Ù.

+		if (LC_IsYMIR()) // õ    ȣ  üũѴ.

 		{

 			if (FindAffect(AFFECT_NO_DEATH_PENALTY))

 			{

 				sys_log(0, "NO_DEATH_PENALTY_AFFECT(%s)", GetName());

-				ChatPacket(CHAT_TYPE_INFO, LC_STRING("¿ë½ÅÀÇ °¡È£·Î °æÇèÄ¡°¡ ¶³¾îÁöÁö ¾Ê¾Ò½À´Ï´Ù."));

+				ChatPacket(CHAT_TYPE_INFO, LC_STRING(" ȣ ġ  ʾҽϴ."));

 				RemoveAffect(AFFECT_NO_DEATH_PENALTY);

 				return;

 			}

 		}

-		else if (!bTown) // ±¹Á¦ ¹öÀü¿¡¼­´Â Á¦ÀÚ¸® ºÎÈ°½Ã¸¸ ¿ë½ÅÀÇ °¡È£¸¦ »ç¿ëÇÑ´Ù. (¸¶À» º¹±Í½Ã´Â °æÇèÄ¡ ÆÐ³ÎÆ¼ ¾øÀ½)

+		else if (!bTown) //   ڸ Ȱø  ȣ Ѵ. ( ͽô ġ гƼ )

 		{

 			if (FindAffect(AFFECT_NO_DEATH_PENALTY))

 			{

 				sys_log(0, "NO_DEATH_PENALTY_AFFECT(%s)", GetName());

-				ChatPacket(CHAT_TYPE_INFO, LC_STRING("¿ë½ÅÀÇ °¡È£·Î °æÇèÄ¡°¡ ¶³¾îÁöÁö ¾Ê¾Ò½À´Ï´Ù."));

+				ChatPacket(CHAT_TYPE_INFO, LC_STRING(" ȣ ġ  ʾҽϴ."));

 				RemoveAffect(AFFECT_NO_DEATH_PENALTY);

 				return;

 			}

@@ -464,7 +474,7 @@
 

 	CloseMyShop();

 

-	event_cancel(&m_pkRecoveryEvent); // È¸º¹ ÀÌº¥Æ®¸¦ Á×ÀÎ´Ù.

+	event_cancel(&m_pkRecoveryEvent); // ȸ ̺Ʈ δ.

 

 	TPacketGCStun pack;

 	pack.header = HEADER_GC_STUN;

@@ -614,7 +624,7 @@
 	bool isAutoLoot =

 		(pkAttacker->GetPremiumRemainSeconds(PREMIUM_AUTOLOOT) > 0 ||

 			pkAttacker->IsEquipUniqueGroup(UNIQUE_GROUP_AUTO_LOOT))

-		? true : false; // Á¦3ÀÇ ¼Õ

+		? true : false; // 3 

 	// END_OF_ADD_PREMIUM

 

 	PIXEL_POSITION pos;

@@ -625,7 +635,7 @@
 

 	int iTotalGold = 0;

 	//

-	// --------- µ· µå·Ó È®·ü °è»ê ----------

+	// ---------   Ȯ  ----------

 	//

 	int iGoldPercent = MobRankStats[GetMobRank()].iGoldPercent;

 

@@ -659,35 +669,35 @@
 

 	int iGoldMultipler = GetGoldMultipler();

 

-	if (1 == number(1, 50000)) // 1 / 50000 È®·ü·Î µ·ÀÌ 10¹è

+	if (1 == number(1, 50000)) // 1 / 50000 Ȯ  10

 		iGoldMultipler *= 10;

-	else if (1 == number(1, 10000)) // 1 / 10000 È®·ü·Î µ·ÀÌ 5¹è

+	else if (1 == number(1, 10000)) // 1 / 10000 Ȯ  5

 		iGoldMultipler *= 5;

 

-	// °³ÀÎ Àû¿ë

+	//  

 	if (pkAttacker->GetPoint(POINT_GOLD_DOUBLE_BONUS))

 		if (number(1, 100) <= pkAttacker->GetPoint(POINT_GOLD_DOUBLE_BONUS))

 			iGoldMultipler *= 2;

 

 	//

-	// --------- µ· µå·Ó ¹è¼ö °áÁ¤ ----------

+	// ---------     ----------

 	//

 	if (test_server)

 		pkAttacker->ChatPacket(CHAT_TYPE_PARTY, "gold_mul %d rate %d", iGoldMultipler, CHARACTER_MANAGER::instance().GetMobGoldAmountRate(pkAttacker));

 

 	//

-	// --------- ½ÇÁ¦ µå·Ó Ã³¸® -------------

+	// ---------   ó -------------

 	//

 	LPITEM item;

 

 	int iGold10DropPct = 100;

 	iGold10DropPct = (iGold10DropPct * 100) / (100 + CPrivManager::instance().GetPriv(pkAttacker, PRIV_GOLD10_DROP));

 

-	// MOB_RANK°¡ BOSSº¸´Ù ³ôÀ¸¸é ¹«Á¶°Ç µ·ÆøÅº

+	// MOB_RANK BOSS   ź

 	if (GetMobRank() >= MOB_RANK_BOSS && !IsStone() && GetMobTable().dwGoldMax != 0)

 	{

 		if (1 == number(1, iGold10DropPct))

-			iGoldMultipler *= 10; // 1% È®·ü·Î µ· 10¹è

+			iGoldMultipler *= 10; // 1% Ȯ  10

 

 		int iSplitCount = number(25, 35);

 

@@ -710,7 +720,7 @@
 				sys_log(0, "Drop Money gold %d GoldMin %d GoldMax %d", iGold, GetMobTable().dwGoldMax, GetMobTable().dwGoldMax);

 			}

 

-			// NOTE: µ· ÆøÅºÀº Á¦ 3ÀÇ ¼Õ Ã³¸®¸¦ ÇÏÁö ¾ÊÀ½

+			// NOTE:  ź  3  ó  

 			if ((item = ITEM_MANAGER::instance().CreateItem(1, iGold)))

 			{

 				pos.x = GetX() + ((number(-14, 14) + number(-14, 14)) * 23);

@@ -723,11 +733,11 @@
 			}

 		}

 	}

-	// 1% È®·ü·Î µ·À» 10°³ ¶³¾î ¶ß¸°´Ù. (10¹è µå·ÓÀÓ)

+	// 1% Ȯ  10  ߸. (10 )

 	else if (1 == number(1, iGold10DropPct))

 	{

 		//

-		// µ· ÆøÅº½Ä µå·Ó

+		//  ź 

 		//

 		for (int i = 0; i < 10; ++i)

 		{

@@ -740,7 +750,7 @@
 				continue;

 			}

 

-			// NOTE : µ· ÆøÅºÀº Á¦ 3ÀÇ ¼Õ Ã³¸®¸¦ ÇÏÁö ¾ÊÀ½

+			// NOTE :  ź  3  ó  

 			if ((item = ITEM_MANAGER::instance().CreateItem(1, iGold)))

 			{

 				pos.x = GetX() + (number(-7, 7) * 20);

@@ -756,7 +766,7 @@
 	else

 	{

 		//

-		// ÀÏ¹ÝÀûÀÎ ¹æ½ÄÀÇ µ· µå·Ó

+		// Ϲ   

 		//

 		int iGold = number(GetMobTable().dwGoldMin, GetMobTable().dwGoldMax);

 		iGold = iGold * CHARACTER_MANAGER::instance().GetMobGoldAmountRate(pkAttacker) / 100;

@@ -806,7 +816,7 @@
 

 void CHARACTER::Reward(bool bItemDrop)

 {

-	if (GetRaceNum() == 5001) // ¿Ö±¸´Â µ·À» ¹«Á¶°Ç µå·Ó

+	if (GetRaceNum() == 5001) // ֱ   

 	{

 		PIXEL_POSITION pos;

 

@@ -909,7 +919,7 @@
 		return;

 

 	//

-	// µ· µå·Ó

+	//  

 	//

 	//PROF_UNIT pu2("r2");

 	if (test_server)

@@ -918,7 +928,7 @@
 	//pu2.Pop();

 

 	//

-	// ¾ÆÀÌÅÛ µå·Ó

+	//  

 	//

 	//PROF_UNIT pu3("r3");

 	LPITEM item;

@@ -998,7 +1008,7 @@
 

 			if (v.empty())

 			{

-				// µ¥¹ÌÁö¸¦ Æ¯º°È÷ ¸¹ÀÌ ÁØ »ç¶÷ÀÌ ¾øÀ¸´Ï ¼ÒÀ¯±Ç ¾øÀ½

+				//  Ư      

 				while (iItemIdx >= 0)

 				{

 					item = s_vec_item[iItemIdx--];

@@ -1013,7 +1023,7 @@
 #ifdef ENABLE_EXTENDED_BATTLE_PASS

 					pkAttacker->UpdateExtBattlePassMissionProgress(BP_ITEM_COLLECT, item->GetCount(), item->GetVnum());

 #endif

-					// 10% ÀÌÇÏ µ¥¹ÌÁö ÁØ »ç¶÷³¢¸®´Â ¼ÒÀ¯±Ç¾øÀ½

+					// 10%     Ǿ

 					//item->SetOwnership(pkAttacker);

 					item->StartDestroyEvent();

 

@@ -1027,7 +1037,7 @@
 			}

 			else

 			{

-				// µ¥¹ÌÁö ¸¹ÀÌ ÁØ »ç¶÷µé ³¢¸®¸¸ ¼ÒÀ¯±Ç ³ª´²°¡Áü

+				//       

 				std::vector<LPCHARACTER>::iterator it = v.begin();

 

 				while (iItemIdx >= 0)

@@ -1101,20 +1111,20 @@
 

 TItemDropPenalty aItemDropPenalty_kor[9] =

 {

-	{ 0, 0, 0, 0 }, // ¼±¿Õ

-	{ 0, 0, 0, 0 }, // ¿µ¿õ

-	{ 0, 0, 0, 0 }, // ¼ºÀÚ

-	{ 0, 0, 0, 0 }, // ÁöÀÎ

-	{ 0, 0, 0, 0 }, // ¾ç¹Î

-	{ 20, 5, 5, 1 }, // ³¶ÀÎ

-	{ 30, 10, 10, 2 }, // ¾ÇÀÎ

-	{ 40, 20, 35, 3 }, // ¸¶µÎ

-	{ 80, 40, 40, 4 }, // ÆÐ¿Õ

+	{ 0, 0, 0, 0 }, // 

+	{ 0, 0, 0, 0 }, // 

+	{ 0, 0, 0, 0 }, // 

+	{ 0, 0, 0, 0 }, // 

+	{ 0, 0, 0, 0 }, // 

+	{ 20, 5, 5, 1 }, // 

+	{ 30, 10, 10, 2 }, // 

+	{ 40, 20, 35, 3 }, // 

+	{ 80, 40, 40, 4 }, // п

 };

 

 void CHARACTER::ItemDropPenalty(LPCHARACTER pkKiller)

 {

-	// °³ÀÎ»óÁ¡À» ¿¬ »óÅÂ¿¡¼­´Â ¾ÆÀÌÅÛÀ» µå·ÓÇÏÁö ¾Ê´Â´Ù.

+	// λ  ¿   ʴ´.

 	if (GetMyShop())

 		return;

 

@@ -1375,7 +1385,7 @@
 	if (!pkKiller && m_dwKillerPID)

 		pkKiller = CHARACTER_MANAGER::instance().FindByPID(m_dwKillerPID);

 

-	m_dwKillerPID = 0; // ¹Ýµå½Ã ÃÊ±âÈ­ ÇØ¾ßÇÔ DO NOT DELETE THIS LINE UNLESS YOU ARE 1000000% SURE

+	m_dwKillerPID = 0; // ݵ ʱȭ ؾ DO NOT DELETE THIS LINE UNLESS YOU ARE 1000000% SURE

 

 #if defined(__SKILL_COOLTIME_UPDATE__)

 	if (IsPC())

@@ -1497,7 +1507,7 @@
 

 				if (GetPoint(POINT_EMPIRE_POINT) < 10)

 				{

-					// TODO : ÀÔ±¸·Î ³¯¸®´Â ÄÚµå¸¦ ³Ö¾î¾ß ÇÑ´Ù.

+					// TODO : Ա  ڵ带 ־ Ѵ.

 				}

 

 				char buf[256];

@@ -1523,7 +1533,7 @@
 					}

 

 					if (number(1, 100) < iNoPenaltyProb)

-						pkKiller->ChatPacket(CHAT_TYPE_INFO, LC_STRING("¿ë½ÅÀÇ º¸È£·Î ¾ÆÀÌÅÛÀÌ ¶³¾îÁöÁö ¾Ê¾Ò½À´Ï´Ù."));

+						pkKiller->ChatPacket(CHAT_TYPE_INFO, LC_STRING(" ȣ   ʾҽϴ."));

 					else

 					{

 						if (g_iUseLocale && pkKiller->GetParty())

@@ -1565,7 +1575,7 @@
 	ClearSync();

 

 	//sys_log(1, "stun cancel %s[%d]", GetName(), (DWORD)GetVID());

-	event_cancel(&m_pkStunEvent); // ±âÀý ÀÌº¥Æ®´Â Á×ÀÎ´Ù.

+	event_cancel(&m_pkStunEvent); //  ̺Ʈ δ.

 

 	if (IsPC())

 	{

@@ -1575,12 +1585,12 @@
 	}

 	else

 	{

-		// °¡µå¿¡°Ô °ø°Ý¹ÞÀº ¸ó½ºÅÍ´Â º¸»óÀÌ ¾ø¾î¾ß ÇÑ´Ù.

+		// 忡 ݹ ʹ   Ѵ.

 		if (!IS_SET(m_pointsInstant.instant_flag, INSTANT_FLAG_NO_REWARD))

 		{

 			if (!(pkKiller && pkKiller->IsPC() && pkKiller->GetGuild() && pkKiller->GetGuild()->UnderAnyWar(GUILD_WAR_TYPE_FIELD)))

 			{

-				// ºÎÈ°ÇÏ´Â ¸ó½ºÅÍ´Â º¸»óÀ» ÁÖÁö ¾Ê´Â´Ù.

+				// Ȱϴ ʹ   ʴ´.

 				if (GetMobTable().dwResurrectionVnum)

 				{

 					// DUNGEON_MONSTER_REBIRTH_BUG_FIX

@@ -1607,7 +1617,7 @@
 				if (pkKiller->m_dwUnderGuildWarInfoMessageTime < get_dword_time())

 				{

 					pkKiller->m_dwUnderGuildWarInfoMessageTime = get_dword_time() + 60000;

-					pkKiller->ChatPacket(CHAT_TYPE_INFO, LC_STRING("<±æµå> ±æµåÀüÁß¿¡´Â »ç³É¿¡ µû¸¥ ÀÌÀÍÀÌ ¾ø½À´Ï´Ù."));

+					pkKiller->ChatPacket(CHAT_TYPE_INFO, LC_STRING("<> ߿ ɿ   ϴ."));

 				}

 			}

 		}

@@ -1640,11 +1650,11 @@
 

 	REMOVE_BIT(m_pointsInstant.instant_flag, INSTANT_FLAG_STUN);

 

-	// ÇÃ·¹ÀÌ¾î Ä³¸¯ÅÍÀÌ¸é

+	// ÷̾ ĳ̸

 	if (GetDesc() != NULL)

 	{

 		//

-		// Å¬¶óÀÌ¾ðÆ®¿¡ ¿¡ÆåÆ® ÆÐÅ¶À» ´Ù½Ã º¸³½´Ù.

+		// Ŭ̾Ʈ Ʈ Ŷ ٽ .

 		//

 		auto it = m_list_pkAffect.begin();

 		while (it != m_list_pkAffect.end())

@@ -1652,11 +1662,11 @@
 	}

 

 	//

-	// Dead ÀÌº¥Æ® »ý¼º,

+	// Dead ̺Ʈ ,

 	//

-	// Dead ÀÌº¥Æ®¿¡¼­´Â ¸ó½ºÅÍÀÇ °æ¿ì ¸îÃÊ ÈÄ¿¡ Destroy µÇµµ·Ï ÇØÁÖ¸ç,

-	// PCÀÇ °æ¿ì 3ºÐ ÀÖ´Ù°¡ ¸¶À»¿¡¼­ ³ª¿Àµµ·Ï ÇØ ÁØ´Ù. 3ºÐ ³»¿¡´Â À¯Àú·ÎºÎÅÍ

-	// ¸¶À»¿¡¼­ ½ÃÀÛÇÒ °ÇÁö, ¿©±â¼­ ½ÃÀÛÇÒ °ÇÁö °áÁ¤À» ¹Þ´Â´Ù.

+	// Dead ̺Ʈ    Ŀ Destroy ǵ ָ,

+	// PC  3 ִٰ    ش. 3  κ

+	//   , ⼭    ޴´.

 	if (isDuel == false)

 	{

 		if (m_pkDeadEvent)

@@ -1826,12 +1836,12 @@
 }

 

 //

-// CHARACTER::Damage ¸Þ¼Òµå´Â this°¡ µ¥¹ÌÁö¸¦ ÀÔ°Ô ÇÑ´Ù.

+// CHARACTER::Damage ޼ҵ this  ԰ Ѵ.

 //

 // Arguments

-//	pAttacker : °ø°ÝÀÚ

-//	dam : µ¥¹ÌÁö

-//	EDamageType : ¾î¶² Çü½ÄÀÇ °ø°ÝÀÎ°¡?

+//	pAttacker : 

+//	dam : 

+//	EDamageType :   ΰ?

 //

 // Return value

 //	true : dead

@@ -2079,7 +2089,7 @@
 		}

 	}

 

-	// ÆòÅ¸°¡ ¾Æ´Ò ¶§´Â °øÆ÷ Ã³¸®

+	// Ÿ ƴ   ó

 	if (type != EDamageType::DAMAGE_TYPE_NORMAL && type != EDamageType::DAMAGE_TYPE_NORMAL_RANGE)

 	{

 		if (IsAffectFlag(AFF_TERROR))

@@ -2101,19 +2111,19 @@
 	//PROF_UNIT puAttr("Attr");

 

 	//

-	// ¸¶¹ýÇü ½ºÅ³°ú, ·¹ÀÎÁöÇü ½ºÅ³Àº(±ÃÀÚ°´) Å©¸®Æ¼ÄÃ°ú, °üÅë°ø°Ý °è»êÀ» ÇÑ´Ù.

-	// ¿ø·¡´Â ÇÏÁö ¾Ê¾Æ¾ß ÇÏ´Âµ¥ Nerf(´Ù¿î¹ë·±½º)ÆÐÄ¡¸¦ ÇÒ ¼ö ¾ø¾î¼­ Å©¸®Æ¼ÄÃ°ú

-	// °üÅë°ø°ÝÀÇ ¿ø·¡ °ªÀ» ¾²Áö ¾Ê°í, /2 ÀÌ»óÇÏ¿© Àû¿ëÇÑ´Ù.

+	//  ų,  ų(ڰ) ũƼð,   Ѵ.

+	//   ʾƾ ϴµ Nerf(ٿ뷱)ġ    ũƼð

+	//     ʰ, /2 ̻Ͽ Ѵ.

 	//

-	// ¹«»ç ÀÌ¾ß±â°¡ ¸¹¾Æ¼­ ¹Ð¸® ½ºÅ³µµ Ãß°¡

+	//  ̾߱Ⱑ Ƽ и ų ߰

 	//

-	// 20091109 : ¹«»ç°¡ °á°úÀûÀ¸·Î ¾öÃ»³ª°Ô °­ÇØÁø °ÍÀ¸·Î °á·Ð³², µ¶ÀÏ ±âÁØ ¹«»ç ºñÀ² 70% À°¹Ú

+	// 20091109 : 簡  û   г,     70% 

 	//

 	if (type == EDamageType::DAMAGE_TYPE_MELEE || type == EDamageType::DAMAGE_TYPE_RANGE || type == EDamageType::DAMAGE_TYPE_MAGIC)

 	{

 		if (pAttacker)

 		{

-			// Å©¸®Æ¼ÄÃ

+			// ũƼ

 			int iCriticalPct = pAttacker->GetPoint(POINT_CRITICAL_PCT);

 

 			if (!IsPC())

@@ -2121,12 +2131,12 @@
 

 			if (iCriticalPct)

 			{

-				if (iCriticalPct >= 10) // 10º¸´Ù Å©¸é 5% + (4¸¶´Ù 1%¾¿ Áõ°¡), µû¶ó¼­ ¼öÄ¡°¡ 50ÀÌ¸é 20%

+				if (iCriticalPct >= 10) // 10 ũ 5% + (4 1% ),  ġ 50̸ 20%

 					iCriticalPct = 5 + (iCriticalPct - 10) / 4;

-				else // 10º¸´Ù ÀÛÀ¸¸é ´Ü¼øÈ÷ ¹ÝÀ¸·Î ±ðÀ½, 10 = 5%

+				else // 10  ܼ  , 10 = 5%

 					iCriticalPct /= 2;

 

-				// Å©¸®Æ¼ÄÃ ÀúÇ× °ª Àû¿ë.

+				// ũƼ   .

 				iCriticalPct -= GetPoint(POINT_RESIST_CRITICAL);

 

 				if (number(1, 100) <= iCriticalPct)

@@ -2146,7 +2156,7 @@
 				}

 			}

 

-			// °üÅë°ø°Ý

+			// 

 			int iPenetratePct = pAttacker->GetPoint(POINT_PENETRATE_PCT);

 

 			if (!IsPC())

@@ -2167,16 +2177,16 @@
 

 				if (iPenetratePct >= 10)

 				{

-					// 10º¸´Ù Å©¸é 5% + (4¸¶´Ù 1%¾¿ Áõ°¡), µû¶ó¼­ ¼öÄ¡°¡ 50ÀÌ¸é 20%

+					// 10 ũ 5% + (4 1% ),  ġ 50̸ 20%

 					iPenetratePct = 5 + (iPenetratePct - 10) / 4;

 				}

 				else

 				{

-					// 10º¸´Ù ÀÛÀ¸¸é ´Ü¼øÈ÷ ¹ÝÀ¸·Î ±ðÀ½, 10 = 5%

+					// 10  ܼ  , 10 = 5%

 					iPenetratePct /= 2;

 				}

 

-				// °üÅëÅ¸°Ý ÀúÇ× °ª Àû¿ë.

+				// Ÿ   .

 				iPenetratePct -= GetPoint(POINT_RESIST_PENETRATE);

 

 				if (number(1, 100) <= iPenetratePct)

@@ -2184,7 +2194,7 @@
 					IsPenetrate = true;

 

 					if (test_server)

-						ChatPacket(CHAT_TYPE_INFO, LC_STRING("°üÅë Ãß°¡ µ¥¹ÌÁö %d", GetPoint(POINT_DEF_GRADE) * (100 + GetPoint(POINT_DEF_BONUS)) / 100));

+						ChatPacket(CHAT_TYPE_INFO, LC_STRING(" ߰  %d", GetPoint(POINT_DEF_GRADE) * (100 + GetPoint(POINT_DEF_BONUS)) / 100));

 

 					dam += GetPoint(POINT_DEF_GRADE) * (100 + GetPoint(POINT_DEF_BONUS)) / 100;

 					if (iPenetratePct > 100)

@@ -2201,19 +2211,19 @@
 		}

 	}

 	//

-	// ÄÞº¸ °ø°Ý, È° °ø°Ý, Áï ÆòÅ¸ ÀÏ ¶§¸¸ ¼Ó¼º°ªµéÀ» °è»êÀ» ÇÑ´Ù.

+	// ޺ , Ȱ ,  Ÿ   Ӽ  Ѵ.

 	//

 	else if (type == EDamageType::DAMAGE_TYPE_NORMAL || type == EDamageType::DAMAGE_TYPE_NORMAL_RANGE)

 	{

 		if (type == EDamageType::DAMAGE_TYPE_NORMAL)

 		{

-			// ±ÙÁ¢ ÆòÅ¸ÀÏ °æ¿ì ¸·À» ¼ö ÀÖÀ½

+			//  Ÿ    

 			if (GetPoint(POINT_BLOCK) && number(1, 100) <= GetPoint(POINT_BLOCK))

 			{

 				if (test_server)

 				{

-					pAttacker->ChatPacket(CHAT_TYPE_INFO, LC_STRING("%s ºí·°! (%d%%)", GetName(), GetPoint(POINT_BLOCK)));

-					ChatPacket(CHAT_TYPE_INFO, LC_STRING("%s ºí·°! (%d%%)", GetName(), GetPoint(POINT_BLOCK)));

+					pAttacker->ChatPacket(CHAT_TYPE_INFO, LC_STRING("%s ! (%d%%)", GetName(), GetPoint(POINT_BLOCK)));

+					ChatPacket(CHAT_TYPE_INFO, LC_STRING("%s ! (%d%%)", GetName(), GetPoint(POINT_BLOCK)));

 				}

 

 				SendDamagePacket(pAttacker, 0, DAMAGE_BLOCK);

@@ -2228,13 +2238,13 @@
 		}

 		else if (type == EDamageType::DAMAGE_TYPE_NORMAL_RANGE)

 		{

-			// ¿ø°Å¸® ÆòÅ¸ÀÇ °æ¿ì ÇÇÇÒ ¼ö ÀÖÀ½

+			// Ÿ Ÿ    

 			if (GetPoint(POINT_DODGE) && number(1, 100) <= GetPoint(POINT_DODGE))

 			{

 				if (test_server)

 				{

-					pAttacker->ChatPacket(CHAT_TYPE_INFO, LC_STRING("%s È¸ÇÇ! (%d%%)", GetName(), GetPoint(POINT_DODGE)));

-					ChatPacket(CHAT_TYPE_INFO, LC_STRING("%s È¸ÇÇ! (%d%%)", GetName(), GetPoint(POINT_DODGE)));

+					pAttacker->ChatPacket(CHAT_TYPE_INFO, LC_STRING("%s ȸ! (%d%%)", GetName(), GetPoint(POINT_DODGE)));

+					ChatPacket(CHAT_TYPE_INFO, LC_STRING("%s ȸ! (%d%%)", GetName(), GetPoint(POINT_DODGE)));

 				}

 

 				SendDamagePacket(pAttacker, 0, DAMAGE_DODGE);

@@ -2252,19 +2262,19 @@
 			dam = dam * (100 - GetPoint(POINT_RESIST_NORMAL_DAMAGE)) / 100;

 

 		//

-		// °ø°ÝÀÚ ¼Ó¼º Àû¿ë

+		//  Ӽ 

 		//

 		if (pAttacker)

 		{

 			if (type == EDamageType::DAMAGE_TYPE_NORMAL)

 			{

-				// ¹Ý»ç

+				// ݻ

 				if (GetPoint(POINT_REFLECT_MELEE))

 				{

 					int reflectDamage = dam * GetPoint(POINT_REFLECT_MELEE) / 100;

 

-					// NOTE: °ø°ÝÀÚ°¡ IMMUNE_REFLECT ¼Ó¼ºÀ» °®°íÀÖ´Ù¸é ¹Ý»ç¸¦ ¾È ÇÏ´Â °Ô 

-					// ¾Æ´Ï¶ó 1/3 µ¥¹ÌÁö·Î °íÁ¤ÇØ¼­ µé¾î°¡µµ·Ï ±âÈ¹¿¡¼­ ¿äÃ».

+					// NOTE: ڰ IMMUNE_REFLECT Ӽ ִٸ ݻ縦  ϴ  

+					// ƴ϶ 1/3  ؼ  ȹ û.

 					if (pAttacker->IsImmune(IMMUNE_REFLECT))

 						reflectDamage = int(reflectDamage / 3.0f + 0.5f);

 

@@ -2273,7 +2283,7 @@
 				}

 			}

 

-			// Å©¸®Æ¼ÄÃ

+			// ũƼ

 			int iCriticalPct = pAttacker->GetPoint(POINT_CRITICAL_PCT);

 

 			if (!IsPC())

@@ -2281,7 +2291,7 @@
 

 			if (iCriticalPct)

 			{

-				//Å©¸®Æ¼ÄÃ ÀúÇ× °ª Àû¿ë.

+				//ũƼ   .

 				iCriticalPct -= GetPoint(POINT_RESIST_CRITICAL);

 

 				if (number(1, 100) <= iCriticalPct)

@@ -2292,7 +2302,7 @@
 				}

 			}

 

-			// °üÅë°ø°Ý

+			// 

 			int iPenetratePct = pAttacker->GetPoint(POINT_PENETRATE_PCT);

 

 			if (!IsPC())

@@ -2311,7 +2321,7 @@
 

 			if (iPenetratePct)

 			{

-				// °üÅëÅ¸°Ý ÀúÇ× °ª Àû¿ë.

+				// Ÿ   .

 				iPenetratePct -= GetPoint(POINT_RESIST_PENETRATE);

 

 				if (number(1, 100) <= iPenetratePct)

@@ -2319,7 +2329,7 @@
 					IsPenetrate = true;

 

 					if (test_server)

-						ChatPacket(CHAT_TYPE_INFO, LC_STRING("°üÅë Ãß°¡ µ¥¹ÌÁö %d", GetPoint(POINT_DEF_GRADE) * (100 + GetPoint(POINT_DEF_BONUS)) / 100));

+						ChatPacket(CHAT_TYPE_INFO, LC_STRING(" ߰  %d", GetPoint(POINT_DEF_GRADE) * (100 + GetPoint(POINT_DEF_BONUS)) / 100));

 

 					dam += GetPoint(POINT_DEF_GRADE) * (100 + GetPoint(POINT_DEF_BONUS)) / 100;

 					if (iPenetratePct > 100)

@@ -2329,7 +2339,7 @@
 				}

 			}

 

-			// HP ½ºÆ¿

+			// HP ƿ

 			if (pAttacker->GetPoint(POINT_STEAL_HP))

 			{

 				int pct = 1;

@@ -2347,7 +2357,7 @@
 				}

 			}

 

-			// SP ½ºÆ¿

+			// SP ƿ

 			if (pAttacker->GetPoint(POINT_STEAL_SP))

 			{

 				int pct = 1;

@@ -2374,7 +2384,7 @@
 				}

 			}

 

-			// µ· ½ºÆ¿

+			//  ƿ

 			if (pAttacker->GetPoint(POINT_STEAL_GOLD))

 			{

 				if (number(1, 100) <= pAttacker->GetPoint(POINT_STEAL_GOLD))

@@ -2385,8 +2395,8 @@
 				}

 			}

 

-			// Ä¥ ¶§¸¶´Ù HPÈ¸º¹

-			if (pAttacker->GetPoint(POINT_HIT_HP_RECOVERY) && number(0, 4) > 0) // 80% È®·ü

+			// ĥ  HPȸ

+			if (pAttacker->GetPoint(POINT_HIT_HP_RECOVERY) && number(0, 4) > 0) // 80% Ȯ

 			{

 				int i = ((iCurHP >= 0) ? MIN(dam, iCurHP) : dam) * pAttacker->GetPoint(POINT_HIT_HP_RECOVERY) / 100;

 

@@ -2397,8 +2407,8 @@
 				}

 			}

 

-			// Ä¥ ¶§¸¶´Ù SPÈ¸º¹

-			if (pAttacker->GetPoint(POINT_HIT_SP_RECOVERY) && number(0, 4) > 0) // 80% È®·ü

+			// ĥ  SPȸ

+			if (pAttacker->GetPoint(POINT_HIT_SP_RECOVERY) && number(0, 4) > 0) // 80% Ȯ

 			{

 				int i = ((iCurHP >= 0) ? MIN(dam, iCurHP) : dam) * pAttacker->GetPoint(POINT_HIT_SP_RECOVERY) / 100;

 

@@ -2409,7 +2419,7 @@
 				}

 			}

 

-			// »ó´ë¹æÀÇ ¸¶³ª¸¦ ¾ø¾Ø´Ù.

+			//   ش.

 			if (pAttacker->GetPoint(POINT_MANA_BURN_PCT))

 			{

 				if (number(1, 100) <= pAttacker->GetPoint(POINT_MANA_BURN_PCT))

@@ -2419,7 +2429,7 @@
 	}

 

 	//

-	// ÆòÅ¸ ¶Ç´Â ½ºÅ³·Î ÀÎÇÑ º¸³Ê½º ÇÇÇØ/¹æ¾î °è»ê

+	// Ÿ Ǵ ų  ʽ / 

 	//

 	switch (type)

 	{

@@ -2496,16 +2506,16 @@
 	}

 

 	//

-	// ¸¶³ª½¯µå(Èæ½Å¼öÈ£)

+	// (żȣ)

 	//

 	if (IsAffectFlag(AFF_MANASHIELD))

 	{

-		// POINT_MANASHIELD ´Â ÀÛ¾ÆÁú¼ö·Ï ÁÁ´Ù

+		// POINT_MANASHIELD  ۾ 

 		int iDamageSPPart = dam / 3;

 		int iDamageToSP = iDamageSPPart * GetPoint(POINT_MANASHIELD) / 100;

 		int iSP = GetSP();

 

-		// SP°¡ ÀÖÀ¸¸é ¹«Á¶°Ç µ¥¹ÌÁö Àý¹Ý °¨¼Ò

+		// SP     

 		if (iDamageToSP <= iSP)

 		{

 			PointChange(POINT_SP, -iDamageToSP);

@@ -2513,14 +2523,14 @@
 		}

 		else

 		{

-			// Á¤½Å·ÂÀÌ ¸ðÀÚ¶ó¼­ ÇÇ°¡ ´õ ±ï¿©¾ßÇÒ‹š

+			// ŷ ڶ ǰ  ￩ҋ

 			PointChange(POINT_SP, -GetSP());

 			dam -= iSP * 100 / MAX(GetPoint(POINT_MANASHIELD), 1);

 		}

 	}

 

 	//

-	// ÀüÃ¼ ¹æ¾î·Â »ó½Â (¸ô ¾ÆÀÌÅÛ)

+	// ü   ( )

 	//

 	if (GetPoint(POINT_MALL_DEFBONUS) > 0)

 	{

@@ -2531,7 +2541,7 @@
 	if (pAttacker)

 	{

 		//

-		// ÀüÃ¼ °ø°Ý·Â »ó½Â (¸ô ¾ÆÀÌÅÛ)

+		// ü ݷ  ( )

 		//

 		if (pAttacker->GetPoint(POINT_MALL_ATTBONUS) > 0)

 		{

@@ -2540,7 +2550,7 @@
 		}

 

 		//

-		// Á¦±¹À¸·Î ÀÎÇÑ º¸³Ê½º (ÇÑ±¹ ¿Ãµå ¹öÀü¸¸ Àû¿ë)

+		//   ʽ (ѱ õ  )

 		//

 		int iEmpire = GetEmpire();

 		long lMapIndex = GetMapIndex();

@@ -2592,17 +2602,17 @@
 		}

 

 		//

-		// ±ºÁÖÀÇ ±Ý°­±Ç & »çÀÚÈÄ 

+		//  ݰ &  

 		//

 		if (pAttacker->IsPC() && CMonarch::instance().IsPowerUp(pAttacker->GetEmpire()))

 		{

-			// 10% ÇÇÇØ Áõ°¡

+			// 10%  

 			dam += dam / 10;

 		}

 

 		if (IsPC() && CMonarch::instance().IsDefenceUp(GetEmpire()))

 		{

-			// 10% ÇÇÇØ °¨¼Ò

+			// 10%  

 			dam -= dam / 10;

 		}

 

@@ -2657,7 +2667,7 @@
 		else

 			SetLastAttacked(get_dword_time());

 

-		// ¸ó½ºÅÍ ´ë»ç : ¸ÂÀ» ¶§

+		//   :  

 		MonsterChat(MONSTER_CHAT_ATTACKED);

 	}

 

@@ -2670,7 +2680,7 @@
 	if (IsDead())

 		return true;

 

-	// µ¶ °ø°ÝÀ¸·Î Á×Áö ¾Êµµ·Ï ÇÔ.

+	//    ʵ .

 	if (type == DAMAGE_TYPE_POISON)

 	{

 		if (GetHP() - dam <= 0)

@@ -2688,7 +2698,7 @@
 	}

 

 	// ------------------------

-	// µ¶ÀÏ ÇÁ¸®¹Ì¾ö ¸ðµå 

+	//  ̾  

 	// -----------------------

 	if (pAttacker && pAttacker->IsPC())

 	{

@@ -2696,7 +2706,7 @@
 		dam = dam * iDmgPct / 100;

 	}

 

-	// STONE SKIN : ÇÇÇØ ¹ÝÀ¸·Î °¨¼Ò

+	// STONE SKIN :   

 	if (IsMonster() && IsStoneSkinner())

 	{

 		if (GetHPPct() < GetMobTable().bStoneSkinPoint)

@@ -2706,7 +2716,7 @@
 	//PROF_UNIT puRest1("Rest1");

 	if (pAttacker)

 	{

-		// DEATH BLOW : È®·ü ÀûÀ¸·Î 4¹è ÇÇÇØ (!? ÇöÀç ÀÌº¥Æ®³ª °ø¼ºÀü¿ë ¸ó½ºÅÍ¸¸ »ç¿ëÇÔ)

+		// DEATH BLOW : Ȯ  4  (!?  ̺Ʈ  ͸ )

 		if (pAttacker->IsMonster() && pAttacker->IsDeathBlower())

 		{

 			if (pAttacker->IsDeathBlow())

@@ -2752,7 +2762,7 @@
 	if (IsPenetrate == true)

 		damageFlag |= DAMAGE_PENETRATE;

 

-	// ÃÖÁ¾ µ¥¹ÌÁö º¸Á¤

+	//   

 	float damMul = this->GetDamMul();

 	float tempDam = dam;

 	dam = tempDam * damMul + 0.5f;

@@ -2792,12 +2802,12 @@
 	{

 		if (m_bDetailLog)

 		{

-			ChatPacket(CHAT_TYPE_INFO, LC_STRING("%s[%d]°¡ °ø°Ý À§Ä¡: %d %d", pAttacker->GetName(), (DWORD)pAttacker->GetVID(), pAttacker->GetX(), pAttacker->GetY()));

+			ChatPacket(CHAT_TYPE_INFO, LC_STRING("%s[%d]  ġ: %d %d", pAttacker->GetName(), (DWORD)pAttacker->GetVID(), pAttacker->GetX(), pAttacker->GetY()));

 		}

 	}

 

 	//

-	// !!!!!!!!! ½ÇÁ¦ HP¸¦ ÁÙÀÌ´Â ºÎºÐ !!!!!!!!!

+	// !!!!!!!!!  HP ̴ κ !!!!!!!!!

 	//

 

 #ifdef ENABLE_EXTENDED_BATTLE_PASS

@@ -2855,7 +2865,7 @@
 		//puRest20.Pop();

 

 		//PROF_UNIT puRest21("Rest21");

-		StartRecoveryEvent(); // ¸ó½ºÅÍ´Â µ¥¹ÌÁö¸¦ ÀÔÀ¸¸é È¸º¹À» ½ÃÀÛÇÑ´Ù.

+		StartRecoveryEvent(); // ʹ   ȸ Ѵ.

 		//puRest21.Pop();

 

 		//PROF_UNIT puRest22("Rest22");

@@ -2885,7 +2895,7 @@
 

 void CHARACTER::DistributeHP(LPCHARACTER pkKiller)

 {

-	if (pkKiller->GetDungeon()) // ´øÁ¯³»¿¡¼± ¸¸µÎ°¡³ª¿ÀÁö¾Ê´Â´Ù

+	if (pkKiller->GetDungeon()) //  ΰʴ´

 		return;

 }

 

@@ -2919,7 +2929,7 @@
 		}

 	}

 

-	// ·¹º§Â÷ °æÇèÄ¡ °¡°¨ºñÀ²

+	//  ġ 

 	iExp = CALCULATE_VALUE_LVDELTA(to->GetLevel(), from->GetLevel(), iExp);

 	const int iBaseExp = iExp;

 

@@ -2930,25 +2940,25 @@
 

 	int iRate = 100;

 

-	// Á¡¼ú, È¸»ç °æÇèÄ¡ ÀÌº¥Æ® Àû¿ë

+	// , ȸ ġ ̺Ʈ 

 	iRate += CPrivManager::instance().GetPriv(to, PRIV_EXP_PCT);

 

-	// °ÔÀÓ³» ±âº» Á¦°øµÇ´Â °æÇèÄ¡ º¸³Ê½º

-	{

-		// ³ëµ¿Àý ¸Þ´Þ

+	// ӳ ⺻ Ǵ ġ ʽ

+	{

+		// 뵿 ޴

 		if (to->IsEquipUniqueItem(UNIQUE_ITEM_LARBOR_MEDAL))

 			iRate += 20;

 

 		// Devil tower experience bonus

 		if (to->GetMapIndex() >= 660000 && to->GetMapIndex() < 670000)

-			iRate += 20; // 1.2¹è (20%)

-

-		// ¾ÆÀÌÅÛ °æÇèÄ¡ µÎ¹è ¼Ó¼º

+			iRate += 20; // 1.2 (20%)

+

+		//  ġ ι Ӽ

 		if (to->GetPoint(POINT_EXP_DOUBLE_BONUS))

 			if (number(1, 100) <= to->GetPoint(POINT_EXP_DOUBLE_BONUS))

-				iRate += 30; // 1.3¹è (30%)

-

-		// °æÇèÀÇ ¹ÝÁö (2½Ã°£Â¥¸®)

+				iRate += 30; // 1.3 (30%)

+

+		//   (2ð¥)

 		// NOTE: Experience rings now work like special rings.

 		/*

 		if (to->IsEquipUniqueGroup(UNIQUE_GROUP_RING_OF_EXP))

@@ -2959,11 +2969,11 @@
 		}

 		*/

 

-		// ¾ÆÀÌÅÛ ¸ô ÆÇ¸Å °æÇèÄ¡ º¸³Ê½º

-		if (to->GetPremiumRemainSeconds(PREMIUM_EXP) > 0) // ¾ÆÀÌÅÛ ¸ô: °æÇèÄ¡ °áÁ¦

+		//   Ǹ ġ ʽ

+		if (to->GetPremiumRemainSeconds(PREMIUM_EXP) > 0) //  : ġ 

 			iRate += 50;

 

-		iRate += to->GetMarriageBonus(UNIQUE_ITEM_MARRIAGE_EXP_BONUS); // °áÈ¥ º¸³Ê½º

+		iRate += to->GetMarriageBonus(UNIQUE_ITEM_MARRIAGE_EXP_BONUS); // ȥ ʽ

 		iRate += to->GetPoint(POINT_RAMADAN_CANDY_BONUS_EXP);

 		iRate += to->GetPoint(POINT_MALL_EXPBONUS);

 	}

@@ -2977,7 +2987,7 @@
 		);

 	}

 

-	// ±âÈ¹Ãø Á¶Á¤°ª 2005.04.21 ÇöÀç 85%

+	// ȹ  2005.04.21  85%

 	iRate *= CHARACTER_MANAGER::instance().GetMobExpRate(to) / 100;

 

 	iExp *= (iRate / 100.0);

@@ -2985,7 +2995,7 @@
 	iConquerorExp *= (iRate / 100.0);

 #endif

 

-	// °æÇèÄ¡ ÇÑ¹ø È¹µæ·® Á¦ÇÑ

+	// ġ ѹ ȹ淮 

 	//iExp = MIN(to->GetNextExp() / 10, iExp);

 

 	//iExp = AdjustExpByLevel(to, iExp);

@@ -3006,10 +3016,10 @@
 

 	{

 		LPCHARACTER you = to->GetMarryPartner();

-		// ºÎºÎ°¡ ¼­·Î ÆÄÆ¼ÁßÀÌ¸é ±Ý½½ÀÌ ¿À¸¥´Ù

+		// κΰ  Ƽ̸ ݽ 

 		if (you)

 		{

-			// 1¾ïÀÌ 100%

+			// 1 100%

 			DWORD dwUpdatePoint = 2000 * iExp / to->GetLevel() / to->GetLevel() / 3;

 

 			if (to->GetPremiumRemainSeconds(PREMIUM_MARRIAGE_FAST) > 0 ||

@@ -3159,7 +3169,7 @@
 					pParty->ChatPacketToAllMember(CHAT_TYPE_INFO, "exp party bonus %d%%", pParty->GetExpBonusPercent());

 			}

 

-			// °æÇèÄ¡ ¸ô¾ÆÁÖ±â (ÆÄÆ¼°¡ È¹µæÇÑ °æÇèÄ¡¸¦ 5% »©¼­ ¸ÕÀú ÁÜ)

+			// ġ ֱ (Ƽ ȹ ġ 5%   )

 			if (pParty->GetExpCentralizeCharacter())

 			{

 				LPCHARACTER tch = pParty->GetExpCentralizeCharacter();

@@ -3218,7 +3228,7 @@
 

 	TDamageMap::iterator it = m_map_kDamage.begin();

 

-	// ÀÏ´Ü ÁÖÀ§¿¡ ¾ø´Â »ç¶÷À» °É·¯ ³½´Ù. (50m)

+	// ϴ    ɷ . (50m)

 	while (it != m_map_kDamage.end())

 	{

 		const VID& c_VID = it->first;

@@ -3228,7 +3238,7 @@
 

 		LPCHARACTER pAttacker = CHARACTER_MANAGER::instance().Find(c_VID);

 

-		// NPC°¡ ¶§¸®±âµµ ÇÏ³ª? -.-;

+		// NPC ⵵ ϳ? -.-;

 		if (!pAttacker || pAttacker->IsNPC() || DISTANCE_APPROX(GetX() - pAttacker->GetX(), GetY() - pAttacker->GetY()) > 5000)

 			continue;

 

@@ -3281,10 +3291,10 @@
 #endif

 	//m_map_kDamage.clear();

 

-	if (iTotalDam == 0) // µ¥¹ÌÁö ÁØ°Ô 0ÀÌ¸é ¸®ÅÏ

+	if (iTotalDam == 0) //  ذ 0̸ 

 		return NULL;

 

-	if (m_pkChrStone)	// µ¹ÀÌ ÀÖÀ» °æ¿ì °æÇèÄ¡ÀÇ ¹ÝÀ» µ¹¿¡°Ô ³Ñ±ä´Ù.

+	if (m_pkChrStone)	//    ġ   ѱ.

 	{

 		//sys_log(0, "__ Give half to Stone : %d", iExpToDistribute>>1);

 		int iExp = iExpToDistribute >> 1;

@@ -3300,11 +3310,11 @@
 	if (damage_info_table.empty())

 		return NULL;

 

-	// Á¦ÀÏ µ¥¹ÌÁö¸¦ ¸¹ÀÌ ÁØ »ç¶÷ÀÌ HP È¸º¹À» ÇÑ´Ù.

-	DistributeHP(pkChrMostAttacked); // ¸¸µÎ ½Ã½ºÅÛ

-

-	{

-		// Á¦ÀÏ µ¥¹ÌÁö¸¦ ¸¹ÀÌ ÁØ »ç¶÷ÀÌ³ª ÆÄÆ¼°¡ ÃÑ °æÇèÄ¡ÀÇ 20% + ÀÚ±â°¡ ¶§¸°¸¸Å­ÀÇ °æÇèÄ¡¸¦ ¸Ô´Â´Ù.

+	//      HP ȸ Ѵ.

+	DistributeHP(pkChrMostAttacked); //  ý

+

+	{

+		//     ̳ Ƽ  ġ 20% + ڱⰡ ŭ ġ Դ´.

 		TDamageInfoTable::iterator di = damage_info_table.begin();

 		{

 			TDamageInfoTable::iterator it;

@@ -3345,7 +3355,7 @@
 		di->Distribute(this, iExp);

 #endif

 

-		// 100% ´Ù ¸Ô¾úÀ¸¸é ¸®ÅÏÇÑ´Ù.

+		// 100%  Ծ Ѵ.

 		if (fPercent == 1.0f)

 			return pkChrMostAttacked;

 

@@ -3353,7 +3363,7 @@
 	}

 

 	{

-		// ³²Àº 80%ÀÇ °æÇèÄ¡¸¦ ºÐ¹èÇÑ´Ù.

+		//  80% ġ йѴ.

 		TDamageInfoTable::iterator it;

 

 		for (it = damage_info_table.begin(); it != damage_info_table.end(); ++it)

@@ -3380,7 +3390,7 @@
 	return pkChrMostAttacked;

 }

 

-// È­»ì °³¼ö¸¦ ¸®ÅÏÇØ ÁÜ

+// ȭ   

 int CHARACTER::GetArrowAndBow(LPITEM* ppkBow, LPITEM* ppkArrow, int iArrowCount/* = 1 */)

 {

 	LPITEM pkBow;

@@ -3465,7 +3475,7 @@
 		if (!pkVictim)

 			return;

 

-		// °ø°Ý ºÒ°¡

+		//  Ұ

 		if (!battle_is_attackable(m_me, pkVictim))

 			return;

 

@@ -3479,7 +3489,7 @@
 

 		switch (m_bType)

 		{

-			case 0: // ÀÏ¹ÝÈ°

+			case 0: // ϹȰ

 			{

 				int iDam = 0;

 

@@ -3516,7 +3526,7 @@
 

 				NormalAttackAffect(m_me, pkVictim);

 

-				// µ¥¹ÌÁö °è»ê

+				//  

 				iDam = iDam * (100 - pkVictim->GetPoint(POINT_RESIST_BOW)) / 100;

 

 				//sys_log(0, "%s arrow %s dam %d", m_me->GetName(), pkVictim->GetName(), iDam);

@@ -3528,11 +3538,11 @@
 					pkVictim->BeginFight(m_me);

 

 				pkVictim->Damage(m_me, iDam, EDamageType::DAMAGE_TYPE_NORMAL_RANGE);

-				// Å¸°ÝÄ¡ °è»êºÎ ³¡

+				// Ÿġ  

 			}

 			break;

 

-			case 1: // ÀÏ¹Ý ¸¶¹ý

+			case 1: // Ϲ 

 			{

 				int iDam;

 

@@ -3543,15 +3553,14 @@
 

 				NormalAttackAffect(m_me, pkVictim);

 

-				// µ¥¹ÌÁö °è»ê

-#if defined(__MAGIC_REDUCTION__)

+				//  

+{

+				// [Fix] Safe magic resistance/penetration: clamp resist to [0..100] and apply penetration correctly

 				const int c_iResMagic = MINMAX(0, pkVictim->GetPoint(POINT_RESIST_MAGIC), 100);

 				const int c_iResMagicReduction = MINMAX(0, (m_me->GetJob() == JOB_SURA) ? m_me->GetPoint(POINT_RESIST_MAGIC_REDUCTION) / 2 : m_me->GetPoint(POINT_RESIST_MAGIC_REDUCTION), 50);

 				const int c_iTotalMagicRes = MINMAX(0, c_iResMagic - c_iResMagicReduction, 100);

 				iDam = iDam * (100 - c_iTotalMagicRes) / 100;

-#else

-				iDam = iDam * (100 - pkVictim->GetPoint(POINT_RESIST_MAGIC)) / 100;

-#endif

+			}

 

 				//sys_log(0, "%s arrow %s dam %d", m_me->GetName(), pkVictim->GetName(), iDam);

 

@@ -3562,16 +3571,16 @@
 					pkVictim->BeginFight(m_me);

 

 				pkVictim->Damage(m_me, iDam, DAMAGE_TYPE_MAGIC);

-				// Å¸°ÝÄ¡ °è»êºÎ ³¡

+				// Ÿġ  

 			}

 			break;

 

-			case SKILL_YEONSA: // ¿¬»ç

+			case SKILL_YEONSA: // 

 			{

 				//int iUseArrow = 2 + (m_me->GetSkillPower(SKILL_YEONSA) *6/100);

 				int iUseArrow = 1;

 

-				// ÅäÅ»¸¸ °è»êÇÏ´Â°æ¿ì

+				// Ż ϴ°

 				{

 					if (iUseArrow == m_me->GetArrowAndBow(&pkBow, &pkArrow, iUseArrow))

 					{

@@ -3712,7 +3721,7 @@
 				sys_log(0, "%s - Skill %d -> %s", m_me->GetName(), m_bType, pkVictim->GetName());

 				m_me->ComputeSkill(m_bType, pkVictim);

 

-				// TODO ¿©·¯¸í¿¡°Ô ½µ ½µ ½µ ÇÏ±â

+				// TODO     ϱ

 			}

 			break;

 

@@ -3806,7 +3815,7 @@
 

 	TDamageMap::iterator it = m_map_kDamage.begin();

 

-	// ÀÏ´Ü ÁÖÀ§¿¡ ¾ø´Â »ç¶÷À» °É·¯ ³½´Ù.

+	// ϴ    ɷ .

 	while (it != m_map_kDamage.end())

 	{

 		const VID& c_VID = it->first;

@@ -3859,7 +3868,7 @@
 	return CHARACTER_MANAGER::instance().Find(m_kVIDVictim);

 }

 

-LPCHARACTER CHARACTER::GetProtege() const // º¸È£ÇØ¾ß ÇÒ ´ë»óÀ» ¸®ÅÏ

+LPCHARACTER CHARACTER::GetProtege() const // ȣؾ   

 {

 	if (m_pkChrStone)

 		return m_pkChrStone;

@@ -4043,7 +4052,7 @@
 			if (ch->GetVictim())

 				return;

 

-			if (number(1, 100) <= 50) // ÀÓ½Ã·Î 50% È®·ü·Î ÀûÀ» ²ø¾î¿Â´Ù

+			if (number(1, 100) <= 50) // ӽ÷ 50% Ȯ  ´

 				if (DISTANCE_APPROX(ch->GetX() - m_ch->GetX(), ch->GetY() - m_ch->GetY()) < 5000)

 					if (ch->CanBeginFight())

 						ch->BeginFight(m_ch);

@@ -4176,6 +4185,9 @@
 

 void CHARACTER::UpdateAggrPointEx(LPCHARACTER pAttacker, EDamageType type, int dam, CHARACTER::TBattleInfo& info)

 {

+	if (!pAttacker)

+		return;

+

 #if defined(__DEFENSE_WAVE__)

 	if (GetDefenseWave())

 	{

@@ -4187,7 +4199,7 @@
 	}

 #endif

 

-	// Æ¯Á¤ °ø°ÝÅ¸ÀÔ¿¡ µû¶ó ´õ ¿Ã¶ó°£´Ù

+	// Ư ŸԿ   ö󰣴

 	switch (type)

 	{

 		case EDamageType::DAMAGE_TYPE_NORMAL_RANGE:

@@ -4206,7 +4218,7 @@
 			break;

 	}

 

-	// °ø°ÝÀÚ°¡ ÇöÀç ´ë»óÀÎ °æ¿ì º¸³Ê½º¸¦ ÁØ´Ù.

+	// ڰ    ʽ ش.

 	if (pAttacker == GetVictim())

 		dam = (int)(dam * 1.2f);

 

@@ -4220,7 +4232,7 @@
 	{

 		LPPARTY pParty = GetParty();

 

-		// ¸®´õÀÎ °æ¿ì ¿µÇâ·ÂÀÌ Á»´õ °­ÇÏ´Ù

+		//     ϴ

 		int iPartyAggroDist = dam;

 

 		if (pParty->GetLeaderPID() == GetVID())

@@ -4239,6 +4251,9 @@
 	if (IsDead() || IsStun())

 		return;

 

+	if (!pAttacker)

+		return;

+

 	TDamageMap::iterator it = m_map_kDamage.find(pAttacker->GetVID());

 	if (it == m_map_kDamage.end())

 	{

@@ -4251,7 +4266,7 @@
 

 void CHARACTER::ChangeVictimByAggro(int iNewAggro, LPCHARACTER pNewVictim)

 {

-	if (get_dword_time() - m_dwLastVictimSetTime < 3000) // 3ÃÊ´Â ±â´Ù·Á¾ßÇÑ´Ù

+	if (get_dword_time() - m_dwLastVictimSetTime < 3000) // 3ʴ ٷѴ

 		return;

 

 	if (pNewVictim == GetVictim())

@@ -4262,7 +4277,7 @@
 			return;

 		}

 

-		// Aggro°¡ °¨¼ÒÇÑ °æ¿ì

+		// Aggro  

 		TDamageMap::iterator it;

 		TDamageMap::iterator itFind = m_map_kDamage.end();

 


--- a/server/metin2/Source/Server/game/src/char_skill.cpp
+++ b/server/metin2/Source/Server/game/src/char_skill.cpp
@@ -95,7 +95,7 @@
 

 bool TSkillUseInfo::HitOnce(DWORD dwVnum)

 {

-	// ¾²Áöµµ¾Ê¾ÒÀ¸¸é ¶§¸®Áöµµ ¸øÇÑ´Ù.

+	// ʾ  Ѵ.

 	if (!bUsed)

 		return false;

 

@@ -134,7 +134,7 @@
 	this->isGrandMaster = isGrandMaster;

 	DWORD dwCur = get_dword_time();

 

-	// ¾ÆÁ÷ ÄðÅ¸ÀÓÀÌ ³¡³ªÁö ¾Ê¾Ò´Ù.

+	//  Ÿ  ʾҴ.

 	if (bUsed && dwNextSkillUsableTime > dwCur)

 	{

 		sys_log(0, "cooltime is not over delta %u", dwNextSkillUsableTime - dwCur);

@@ -316,7 +316,7 @@
 

 	if (!IsLearnableSkill(dwSkillVnum))

 	{

-		ChatPacket(CHAT_TYPE_INFO, LC_STRING("¼ö·ÃÇÒ ¼ö ¾ø´Â ½ºÅ³ÀÔ´Ï´Ù."));

+		ChatPacket(CHAT_TYPE_INFO, LC_STRING("   ųԴϴ."));

 		return false;

 	}

 

@@ -329,9 +329,9 @@
 		{

 			if (FindAffect(AFFECT_SKILL_NO_BOOK_DELAY))

 			{

-				// ÁÖ¾È¼ú¼­ »ç¿ëÁß¿¡´Â ½Ã°£ Á¦ÇÑ ¹«½Ã

+				// ־ȼ ߿ ð  

 				RemoveAffect(AFFECT_SKILL_NO_BOOK_DELAY);

-				ChatPacket(CHAT_TYPE_INFO, LC_STRING("ÁÖ¾È¼ú¼­¸¦ ÅëÇØ ÁÖÈ­ÀÔ¸¶¿¡¼­ ºüÁ®³ª¿Ô½À´Ï´Ù."));

+				ChatPacket(CHAT_TYPE_INFO, LC_STRING("־ȼ  ȭԸ Խϴ."));

 			}

 			else

 			{

@@ -342,19 +342,19 @@
 	}

 	*/

 

-	// bType ÀÌ 0ÀÌ¸é Ã³À½ºÎÅÍ Ã¥À¸·Î ¼ö·Ã °¡´É

+	// bType  0̸ ó å  

 	if (pkSk->dwType == SKILL_BOOK_TYPE_SUPPORT)

 	{

-		ChatPacket(CHAT_TYPE_INFO, LC_STRING("±×·£µå ¸¶½ºÅÍ ¼ö·ÃÀ» ÇÒ ¼ö ¾ø´Â ½ºÅ³ÀÔ´Ï´Ù."));

+		ChatPacket(CHAT_TYPE_INFO, LC_STRING("׷      ųԴϴ."));

 		return false;

 	}

 

 	if (GetSkillMasterType(dwSkillVnum) != SKILL_GRAND_MASTER)

 	{

 		if (GetSkillMasterType(dwSkillVnum) > SKILL_GRAND_MASTER)

-			ChatPacket(CHAT_TYPE_INFO, LC_STRING("ÆÛÆåÆ® ¸¶½ºÅÍµÈ ½ºÅ³ÀÔ´Ï´Ù. ´õ ÀÌ»ó ¼ö·Ã ÇÒ ¼ö ¾ø½À´Ï´Ù."));

+			ChatPacket(CHAT_TYPE_INFO, LC_STRING("Ʈ ͵ ųԴϴ.  ̻    ϴ."));

 		else

-			ChatPacket(CHAT_TYPE_INFO, LC_STRING("ÀÌ ½ºÅ³Àº ¾ÆÁ÷ ±×·£µå ¸¶½ºÅÍ ¼ö·ÃÀ» ÇÒ °æÁö¿¡ ÀÌ¸£Áö ¾Ê¾Ò½À´Ï´Ù."));

+			ChatPacket(CHAT_TYPE_INFO, LC_STRING(" ų  ׷     ̸ ʾҽϴ."));

 		return false;

 	}

 

@@ -365,7 +365,7 @@
 		strTrainSkill = os.str();

 	}

 

-	// ¿©±â¼­ È®·üÀ» °è»êÇÕ´Ï´Ù.

+	// ⼭ Ȯ մϴ.

 	BYTE bLastLevel = GetSkillLevel(dwSkillVnum);

 

 	int idx = MIN(9, GetSkillLevel(dwSkillVnum) - 30);

@@ -435,15 +435,15 @@
 

 	if (bLastLevel == GetSkillLevel(dwSkillVnum))

 	{

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("Å©À¹, ±â°¡ ¿ª·ùÇÏ°í ÀÖ¾î! ÀÌ°Å ¼³¸¶ ÁÖÈ­ÀÔ¸¶ÀÎ°¡!? Á¨Àå!"));

-		ChatPacket(CHAT_TYPE_INFO, LC_STRING("¼ö·ÃÀÌ ½ÇÆÐ·Î ³¡³µ½À´Ï´Ù. ´Ù½Ã µµÀüÇØÁÖ½Ã±â ¹Ù¶ø´Ï´Ù."));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("ũ, Ⱑ ϰ ־! ̰  ȭԸΰ!? !"));

+		ChatPacket(CHAT_TYPE_INFO, LC_STRING(" з ϴ. ٽ ֽñ ٶϴ."));

 		LogManager::instance().CharLog(this, dwSkillVnum, "GM_READ_FAIL", "");

 		return false;

 	}

 

-	ChatPacket(CHAT_TYPE_TALKING, LC_STRING("¸ö¿¡¼­ ¹º°¡ ÈûÀÌ ÅÍÁ® ³ª¿À´Â ±âºÐÀÌ¾ß!"));

-	ChatPacket(CHAT_TYPE_TALKING, LC_STRING("¶ß°Å¿î ¹«¾ùÀÌ °è¼Ó ¿ë¼ÚÀ½Ä¡°í ÀÖ¾î! ÀÌ°Ç, ÀÌ°ÍÀº!"));

-	ChatPacket(CHAT_TYPE_INFO, LC_STRING("´õ ³ôÀº °æÁöÀÇ ¼ö·ÃÀ» ¼º°øÀûÀ¸·Î ³¡³»¼Ì½À´Ï´Ù."));

+	ChatPacket(CHAT_TYPE_TALKING, LC_STRING("     ̾!"));

+	ChatPacket(CHAT_TYPE_TALKING, LC_STRING("߰ſ   ġ ־! ̰, ̰!"));

+	ChatPacket(CHAT_TYPE_INFO, LC_STRING("     ̽ϴ."));

 	LogManager::instance().CharLog(this, dwSkillVnum, "GM_READ_SUCCESS", "");

 	return true;

 }

@@ -468,7 +468,7 @@
 

 	if (!IsLearnableSkill(dwSkillVnum))

 	{

-		ChatPacket(CHAT_TYPE_INFO, LC_STRING("¼ö·ÃÇÒ ¼ö ¾ø´Â ½ºÅ³ÀÔ´Ï´Ù."));

+		ChatPacket(CHAT_TYPE_INFO, LC_STRING("   ųԴϴ."));

 		return false;

 	}

 

@@ -490,21 +490,21 @@
 #if defined(__CONQUEROR_LEVEL__)

 		if (bConquerorSkill && GetConquerorExp() < need_exp)

 		{

-			ChatPacket(CHAT_TYPE_INFO, LC_STRING("°æÇèÄ¡°¡ ºÎÁ·ÇÏ¿© Ã¥À» ÀÐÀ» ¼ö ¾ø½À´Ï´Ù."));

+			ChatPacket(CHAT_TYPE_INFO, LC_STRING("ġ Ͽ å   ϴ."));

 			return false;

 		}

 		else

 		{

 			if (GetExp() < need_exp)

 			{

-				ChatPacket(CHAT_TYPE_INFO, LC_STRING("°æÇèÄ¡°¡ ºÎÁ·ÇÏ¿© Ã¥À» ÀÐÀ» ¼ö ¾ø½À´Ï´Ù."));

+				ChatPacket(CHAT_TYPE_INFO, LC_STRING("ġ Ͽ å   ϴ."));

 				return false;

 			}

 		}

 #else

 		if (GetExp() < need_exp)

 		{

-			ChatPacket(CHAT_TYPE_INFO, LC_STRING("°æÇèÄ¡°¡ ºÎÁ·ÇÏ¿© Ã¥À» ÀÐÀ» ¼ö ¾ø½À´Ï´Ù."));

+			ChatPacket(CHAT_TYPE_INFO, LC_STRING("ġ Ͽ å   ϴ."));

 			return false;

 		}

 #endif

@@ -516,7 +516,7 @@
 		{

 			if (GetSkillMasterType(dwSkillVnum) > SKILL_MASTER)

 			{

-				ChatPacket(CHAT_TYPE_INFO, LC_STRING("ÀÌ ½ºÅ³Àº Ã¥À¸·Î ´õÀÌ»ó ¼ö·ÃÇÒ ¼ö ¾ø½À´Ï´Ù."));

+				ChatPacket(CHAT_TYPE_INFO, LC_STRING(" ų å ̻   ϴ."));

 				return false;

 			}

 			else

@@ -527,7 +527,7 @@
 #endif

 					)

 				{

-					ChatPacket(CHAT_TYPE_INFO, LC_STRING("ÀÌ ½ºÅ³Àº ¾ÆÁ÷ Ã¥À¸·Î ¼ö·ÃÇÒ °æÁö¿¡ ÀÌ¸£Áö ¾Ê¾Ò½À´Ï´Ù."));

+					ChatPacket(CHAT_TYPE_INFO, LC_STRING(" ų  å   ̸ ʾҽϴ."));

 					return false;

 				}

 			}

@@ -540,9 +540,9 @@
 		{

 			if (FindAffect(AFFECT_SKILL_NO_BOOK_DELAY))

 			{

-				// ÁÖ¾È¼ú¼­ »ç¿ëÁß¿¡´Â ½Ã°£ Á¦ÇÑ ¹«½Ã

+				// ־ȼ ߿ ð  

 				RemoveAffect(AFFECT_SKILL_NO_BOOK_DELAY);

-				ChatPacket(CHAT_TYPE_INFO, LC_STRING("ÁÖ¾È¼ú¼­¸¦ ÅëÇØ ÁÖÈ­ÀÔ¸¶¿¡¼­ ºüÁ®³ª¿Ô½À´Ï´Ù."));

+				ChatPacket(CHAT_TYPE_INFO, LC_STRING("־ȼ  ȭԸ Խϴ."));

 			}

 			else

 			{

@@ -552,7 +552,7 @@
 		}

 	}

 

-	// ¿©±â¼­ È®·üÀ» °è»êÇÕ´Ï´Ù.

+	// ⼭ Ȯ մϴ.

 	BYTE bLastLevel = GetSkillLevel(dwSkillVnum);

 

 	if (bProb != 0)

@@ -616,13 +616,13 @@
 

 				if (number(1, 100) > percent)

 				{

-					// Ã¥ÀÐ±â¿¡ ¼º°ø

+					// åб⿡ 

 					if (read_count >= need_bookcount)

 					{

 						SkillLevelUp(dwSkillVnum, SKILL_UP_BY_BOOK);

 						pPC->SetFlag(flag, 0);

 

-						ChatPacket(CHAT_TYPE_INFO, LC_STRING("Ã¥À¸·Î ´õ ³ôÀº °æÁöÀÇ ¼ö·ÃÀ» ¼º°øÀûÀ¸·Î ³¡³»¼Ì½À´Ï´Ù."));

+						ChatPacket(CHAT_TYPE_INFO, LC_STRING("å      ̽ϴ."));

 						LogManager::instance().CharLog(this, dwSkillVnum, "READ_SUCCESS", "");

 						return true;

 					}

@@ -633,27 +633,27 @@
 						switch (number(1, 3))

 						{

 							case 1:

-								ChatPacket(CHAT_TYPE_TALKING, LC_STRING("¾î´ÀÁ¤µµ ÀÌ ±â¼ú¿¡ ´ëÇØ ÀÌÇØ°¡ µÇ¾úÁö¸¸ Á¶±Ý ºÎÁ·ÇÑµí ÇÑµ¥.."));

+								ChatPacket(CHAT_TYPE_TALKING, LC_STRING("    ذ Ǿ  ѵ ѵ.."));

 								break;

 

 							case 2:

-								ChatPacket(CHAT_TYPE_TALKING, LC_STRING("µåµð¾î ³¡ÀÌ º¸ÀÌ´Â °Ç°¡...  ÀÌ ±â¼úÀº ÀÌÇØÇÏ±â°¡ ³Ê¹« Èûµé¾î.."));

+								ChatPacket(CHAT_TYPE_TALKING, LC_STRING("  ̴ ǰ...    ϱⰡ ʹ .."));

 								break;

 

 							case 3:

 							default:

-								ChatPacket(CHAT_TYPE_TALKING, LC_STRING("¿­½ÉÈ÷ ÇÏ´Â ¹è¿òÀ» °¡Áö´Â °Í¸¸ÀÌ ±â¼úÀ» ¹è¿ï¼ö ÀÖ´Â À¯ÀÏÇÑ ±æÀÌ´Ù.."));

+								ChatPacket(CHAT_TYPE_TALKING, LC_STRING(" ϴ   ͸   ִ  ̴.."));

 								break;

 						}

 

-						ChatPacket(CHAT_TYPE_INFO, LC_STRING("%d ±ÇÀ» ´õ ÀÐ¾î¾ß ¼ö·ÃÀ» ¿Ï·á ÇÒ ¼ö ÀÖ½À´Ï´Ù.", need_bookcount - read_count));

+						ChatPacket(CHAT_TYPE_INFO, LC_STRING("%d   о  Ϸ   ֽϴ.", need_bookcount - read_count));

 						return true;

 					}

 				}

 			}

 			else

 			{

-				// »ç¿ëÀÚÀÇ Äù½ºÆ® Á¤º¸ ·Îµå ½ÇÆÐ

+				//  Ʈ  ε 

 			}

 		}

 		// INTERNATIONAL_VERSION

@@ -691,15 +691,15 @@
 

 	if (bLastLevel != GetSkillLevel(dwSkillVnum))

 	{

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("¸ö¿¡¼­ ¹º°¡ ÈûÀÌ ÅÍÁ® ³ª¿À´Â ±âºÐÀÌ¾ß!"));

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("¶ß°Å¿î ¹«¾ùÀÌ °è¼Ó ¿ë¼ÚÀ½Ä¡°í ÀÖ¾î! ÀÌ°Ç, ÀÌ°ÍÀº!"));

-		ChatPacket(CHAT_TYPE_INFO, LC_STRING("Ã¥À¸·Î ´õ ³ôÀº °æÁöÀÇ ¼ö·ÃÀ» ¼º°øÀûÀ¸·Î ³¡³»¼Ì½À´Ï´Ù."));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("     ̾!"));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("߰ſ   ġ ־! ̰, ̰!"));

+		ChatPacket(CHAT_TYPE_INFO, LC_STRING("å      ̽ϴ."));

 		LogManager::instance().CharLog(this, dwSkillVnum, "READ_SUCCESS", "");

 	}

 	else

 	{

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("Å©À¹, ±â°¡ ¿ª·ùÇÏ°í ÀÖ¾î! ÀÌ°Å ¼³¸¶ ÁÖÈ­ÀÔ¸¶ÀÎ°¡!? Á¨Àå!"));

-		ChatPacket(CHAT_TYPE_INFO, LC_STRING("¼ö·ÃÀÌ ½ÇÆÐ·Î ³¡³µ½À´Ï´Ù. ´Ù½Ã µµÀüÇØÁÖ½Ã±â ¹Ù¶ø´Ï´Ù."));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("ũ, Ⱑ ϰ ־! ̰  ȭԸΰ!? !"));

+		ChatPacket(CHAT_TYPE_INFO, LC_STRING(" з ϴ. ٽ ֽñ ٶϴ."));

 		LogManager::instance().CharLog(this, dwSkillVnum, "READ_FAIL", "");

 	}

 

@@ -783,7 +783,7 @@
 

 	if (IsPolymorphed())

 	{

-		ChatPacket(CHAT_TYPE_INFO, LC_STRING("µÐ°© Áß¿¡´Â ´É·ÂÀ» ¿Ã¸± ¼ö ¾ø½À´Ï´Ù."));

+		ChatPacket(CHAT_TYPE_INFO, LC_STRING("а ߿ ɷ ø  ϴ."));

 		return;

 	}

 

@@ -810,7 +810,7 @@
 	if (!IsLearnableSkill(dwVnum))

 		return;

 

-	// ±×·£µå ¸¶½ºÅÍ´Â Äù½ºÆ®·Î¸¸ ¼öÇà°¡´É

+	// ׷ ʹ Ʈθ డ

 	if (pkSk->dwType != SKILL_BOOK_TYPE_SUPPORT && pkSk->dwType != SKILL_BOOK_TYPE_PASSIVE)

 	{

 		switch (GetSkillMasterType(pkSk->dwVnum))

@@ -827,7 +827,7 @@
 

 	if (bMethod == SKILL_UP_BY_POINT)

 	{

-		// ¸¶½ºÅÍ°¡ ¾Æ´Ñ »óÅÂ¿¡¼­¸¸ ¼ö·Ã°¡´É

+		// Ͱ ƴ ¿ ð

 		if (GetSkillMasterType(pkSk->dwVnum) != SKILL_NORMAL)

 			return;

 

@@ -836,7 +836,7 @@
 	}

 	else if (bMethod == SKILL_UP_BY_BOOK)

 	{

-		// Á÷¾÷¿¡ ¼ÓÇÏÁö ¾Ê¾Ò°Å³ª Æ÷ÀÎÆ®·Î ¿Ã¸±¼ö ¾ø´Â ½ºÅ³Àº Ã³À½ºÎÅÍ Ã¥À¸·Î ¹è¿ï ¼ö ÀÖ´Ù.

+		//   ʾҰų Ʈ ø  ų ó å   ִ.

 		if (pkSk->dwType != SKILL_BOOK_TYPE_SUPPORT && pkSk->dwType != SKILL_BOOK_TYPE_PASSIVE)

 			if (GetSkillMasterType(pkSk->dwVnum) != SKILL_MASTER

 #if defined(__CONQUEROR_LEVEL__)

@@ -895,11 +895,11 @@
 

 	if (pkSk->dwType != 0)

 	{

-		// °©ÀÚ±â ±×·¹ÀÌµå ¾÷ÇÏ´Â ÄÚµù

+		// ڱ ׷̵ ϴ ڵ

 		switch (GetSkillMasterType(pkSk->dwVnum))

 		{

 			case SKILL_NORMAL:

-				// ¹ø¼·Àº ½ºÅ³ ¾÷±×·¹ÀÌµå 17~20 »çÀÌ ·£´ý ¸¶½ºÅÍ ¼ö·Ã

+				//  ų ׷̵ 17~20    

 				if (GetSkillLevel(pkSk->dwVnum) >= 17)

 				{

 					if (GetQuestFlag("reset_scroll.force_to_master_skill") > 0)

@@ -959,7 +959,7 @@
 	if (NULL == m_pSkillLevels)

 		return;

 

-	// º¸Á¶ ½ºÅ³Àº ¸®¼Â½ÃÅ°Áö ¾Ê´Â´Ù

+	//  ų ½Ű ʴ´

 	std::vector<std::pair<DWORD, TPlayerSkill>> vec;

 	size_t count = sizeof(s_adwSubSkillVnums) / sizeof(s_adwSubSkillVnums[0]);

 

@@ -1092,7 +1092,7 @@
 

 	sys_log(1, "chainlighting event %s", pkChr->GetName());

 

-	if (pkChrVictim->GetParty()) // ÆÄÆ¼ ¸ÕÀú

+	if (pkChrVictim->GetParty()) // Ƽ 

 	{

 		pkTarget = pkChrVictim->GetParty()->GetNextOwnership(NULL, pkChrVictim->GetX(), pkChrVictim->GetY());

 		if (pkTarget == pkChrVictim || !number(0, 2) || pkChr->GetChainLightingExcept().find(pkTarget) != pkChr->GetChainLightingExcept().end())

@@ -1196,7 +1196,7 @@
 		}

 

 		if (m_pkChr->IsPC())

-			// ±æµå ½ºÅ³Àº ÄðÅ¸ÀÓ Ã³¸®¸¦ ÇÏÁö ¾Ê´Â´Ù.

+			//  ų Ÿ ó  ʴ´.

 			if (!(m_pkSk->dwVnum >= GUILD_SKILL_START && m_pkSk->dwVnum <= GUILD_SKILL_END))

 				if (!m_bDisableCooltime && m_pInfo && !m_pInfo->HitOnce(m_pkSk->dwVnum) && m_pkSk->dwVnum != SKILL_MUYEONG

 #if defined(__PVP_BALANCE_IMPROVING__)

@@ -1270,7 +1270,7 @@
 		m_pkSk->SetPointVar("chain", m_pkChr->GetChainLightningIndex());

 		m_pkChr->IncChainLightningIndex();

 

-		bool bUnderEunhyung = m_pkChr->GetAffectedEunhyung() > 0 ? true : false; // ÀÌ°Ç ¿Ö ¿©±â¼­ ÇÏÁö??

+		bool bUnderEunhyung = m_pkChr->GetAffectedEunhyung() > 0 ? true : false; // ̰  ⼭ ??

 

 		m_pkSk->SetPointVar("ek", m_pkChr->GetAffectedEunhyung() * 1. / 100);

 		//m_pkChr->ClearAffectedEunhyung();

@@ -1289,7 +1289,7 @@
 

 		if (test_server && iAmount == 0 && m_pkSk->wPointOn != POINT_NONE)

 		{

-			m_pkChr->ChatPacket(CHAT_TYPE_INFO, "È¿°ú°¡ ¾ø½À´Ï´Ù. ½ºÅ³ °ø½ÄÀ» È®ÀÎÇÏ¼¼¿ä");

+			m_pkChr->ChatPacket(CHAT_TYPE_INFO, "ȿ ϴ. ų  Ȯϼ");

 		}

 		////////////////////////////////////////////////////////////////////////////////

 		iAmount = -iAmount;

@@ -1405,11 +1405,11 @@
 

 		if (m_pkChr->IsPC() && m_pkChr->m_SkillUseInfo[m_pkSk->dwVnum].GetMainTargetVID() != (DWORD)pkChrVictim->GetVID())

 		{

-			// µ¥¹ÌÁö °¨¼Ò

+			//  

 			iDam = (int)(iDam * m_pkSk->kSplashAroundDamageAdjustPoly.Eval());

 		}

 

-		// TODO ½ºÅ³¿¡ µû¸¥ µ¥¹ÌÁö Å¸ÀÔ ±â·ÏÇØ¾ßÇÑ´Ù.

+		// TODO ų   Ÿ ؾѴ.

 		EDamageType dt = DAMAGE_TYPE_NONE;

 

 		switch (m_pkSk->bSkillAttrType)

@@ -1432,7 +1432,7 @@
 

 						case WEAPON_TWO_HANDED:

 							iDam = iDam * (100 - pkChrVictim->GetPoint(POINT_RESIST_TWOHAND)) / 100;

-							// ¾ç¼Õ°Ë Æä³ÎÆ¼ 10%

+							// հ Ƽ 10%

 							//iDam = iDam * 95 / 100;

 							break;

 

@@ -1461,8 +1461,8 @@
 

 			case SKILL_ATTR_TYPE_RANGE:

 				dt = DAMAGE_TYPE_RANGE;

-				// À¸¾Æ¾Æ¾Æ¾Ç

-				// ¿¹Àü¿¡ Àû¿ë¾ÈÇß´ø ¹ö±×°¡ ÀÖ¾î¼­ ¹æ¾î·Â °è»êÀ» ´Ù½ÃÇÏ¸é À¯Àú°¡ ³­¸®³²

+				// ƾƾƾ

+				//  ߴ װ ־   ٽϸ  

 				//iDam -= pkChrVictim->GetPoint(POINT_DEF_GRADE);

 				iDam = iDam * (100 - pkChrVictim->GetPoint(POINT_RESIST_BOW)) / 100;

 				break;

@@ -1470,19 +1470,16 @@
 			case SKILL_ATTR_TYPE_MAGIC:

 				dt = DAMAGE_TYPE_MAGIC;

 				iDam = CalcAttBonus(m_pkChr, pkChrVictim, iDam);

-				// À¸¾Æ¾Æ¾Æ¾Ç

-				// ¿¹Àü¿¡ Àû¿ë¾ÈÇß´ø ¹ö±×°¡ ÀÖ¾î¼­ ¹æ¾î·Â °è»êÀ» ´Ù½ÃÇÏ¸é À¯Àú°¡ ³­¸®³²

+				// ƾƾƾ

+				//  ߴ װ ־   ٽϸ  

 				//iDam -= pkChrVictim->GetPoint(POINT_MAGIC_DEF_GRADE);

-#if defined(__MAGIC_REDUCTION__)

-				{

+{

+					// [Fix] Safe magic resistance/penetration: clamp resist to [0..100] and apply penetration correctly

 					const int c_iResMagic = MINMAX(0, pkChrVictim->GetPoint(POINT_RESIST_MAGIC), 100);

 					const int c_iResMagicReduction = MINMAX(0, (m_pkChr->GetJob() == JOB_SURA) ? m_pkChr->GetPoint(POINT_RESIST_MAGIC_REDUCTION) / 2 : m_pkChr->GetPoint(POINT_RESIST_MAGIC_REDUCTION), 50);

 					const int c_iTotalMagicRes = MINMAX(0, c_iResMagic - c_iResMagicReduction, 100);

 					iDam = iDam * (100 - c_iTotalMagicRes) / 100;

 				}

-#else

-				iDam = iDam * (100 - pkChrVictim->GetPoint(POINT_RESIST_MAGIC)) / 100;

-#endif

 				break;

 

 			default:

@@ -1491,13 +1488,13 @@
 		}

 

 		//

-		// 20091109 µ¶ÀÏ ½ºÅ³ ¼Ó¼º ¿äÃ» ÀÛ¾÷

-		// ±âÁ¸ ½ºÅ³ Å×ÀÌºí¿¡ SKILL_FLAG_WIND, SKILL_FLAG_ELEC, SKILL_FLAG_FIRE¸¦ °¡Áø ½ºÅ³ÀÌ

-		// ÀüÇô ¾ø¾úÀ¸¹Ç·Î ¸ó½ºÅÍÀÇ RESIST_WIND, RESIST_ELEC, RESIST_FIREµµ »ç¿ëµÇÁö ¾Ê°í ÀÖ¾ú´Ù.

+		// 20091109  ų Ӽ û ۾

+		//  ų ̺ SKILL_FLAG_WIND, SKILL_FLAG_ELEC, SKILL_FLAG_FIRE  ų

+		//  Ƿ  RESIST_WIND, RESIST_ELEC, RESIST_FIRE  ʰ ־.

 		//

-		// PvP¿Í PvE¹ë·±½º ºÐ¸®¸¦ À§ÇØ ÀÇµµÀûÀ¸·Î NPC¸¸ Àû¿ëÇÏµµ·Ï ÇßÀ¸¸ç ±âÁ¸ ¹ë·±½º¿Í Â÷ÀÌÁ¡À»

-		// ´À³¢Áö ¸øÇÏ±â À§ÇØ mob_protoÀÇ RESIST_MAGICÀ» RESIST_WIND, RESIST_ELEC, RESIST_FIRE·Î

-		// º¹»çÇÏ¿´´Ù.

+		// PvP PvE뷱 и  ǵ NPC ϵ   뷱 

+		//  ϱ  mob_proto RESIST_MAGIC RESIST_WIND, RESIST_ELEC, RESIST_FIRE

+		// Ͽ.

 		//

 		if (pkChrVictim->IsNPC())

 		{

@@ -2031,7 +2028,7 @@
 	{

 		PIXEL_POSITION pos;

 

-		// ¼º°ø

+		// 

 		if (SECTREE_MANAGER::instance().GetRecallPositionByEmpire(ch->GetMapIndex(), ch->GetEmpire(), pos))

 		{

 			sys_log(1, "Recall: %s %d %d -> %d %d", ch->GetName(), ch->GetX(), ch->GetY(), pos.x, pos.y);

@@ -2045,8 +2042,8 @@
 	}

 	else

 	{

-		// ½ÇÆÐ

-		ch->ChatPacket(CHAT_TYPE_INFO, LC_STRING("±ÍÈ¯¿¡ ½ÇÆÐÇÏ¿´½À´Ï´Ù."));

+		// 

+		ch->ChatPacket(CHAT_TYPE_INFO, LC_STRING("ȯ Ͽϴ."));

 	}

 	return 0;

 }

@@ -2073,11 +2070,11 @@
 			GetName(), dwVnum, posTarget.x, posTarget.y, bSkillLevel);

 	}

 

-	// ³ª¿¡°Ô ¾²´Â ½ºÅ³Àº ³» À§Ä¡¸¦ ¾´´Ù.

+	//   ų  ġ .

 	//if (IS_SET(pkSk->dwFlag, SKILL_FLAG_SELFONLY))

 	//	posTarget = GetXYZ();

 

-	// ½ºÇÃ·¡½¬°¡ ¾Æ´Ñ ½ºÅ³Àº ÁÖÀ§ÀÌ¸é ÀÌ»óÇÏ´Ù

+	// ÷ ƴ ų ̸ ̻ϴ

 	if (!IS_SET(pkSk->dwFlag, SKILL_FLAG_SPLASH))

 		return BATTLE_NONE;

 

@@ -2161,7 +2158,7 @@
 

 	if (test_server && iAmount == 0 && pkSk->wPointOn != POINT_NONE)

 	{

-		ChatPacket(CHAT_TYPE_INFO, "È¿°ú°¡ ¾ø½À´Ï´Ù. ½ºÅ³ °ø½ÄÀ» È®ÀÎÇÏ¼¼¿ä");

+		ChatPacket(CHAT_TYPE_INFO, "ȿ ϴ. ų  Ȯϼ");

 	}

 

 	if (IS_SET(pkSk->dwFlag, SKILL_FLAG_REMOVE_BAD_AFFECT))

@@ -2176,7 +2173,7 @@
 	if (IS_SET(pkSk->dwFlag, SKILL_FLAG_ATTACK | SKILL_FLAG_USE_MELEE_DAMAGE | SKILL_FLAG_USE_MAGIC_DAMAGE))

 	{

 		//

-		// °ø°Ý ½ºÅ³ÀÏ °æ¿ì

+		//  ų 

 		//

 		bool bAdded = false;

 

@@ -2203,7 +2200,7 @@
 			int iDur = (int)pkSk->kDurationPoly.Eval();

 

 			if (IsPC())

-				if (!(dwVnum >= GUILD_SKILL_START && dwVnum <= GUILD_SKILL_END)) // ±æµå ½ºÅ³Àº ÄðÅ¸ÀÓ Ã³¸®¸¦ ÇÏÁö ¾Ê´Â´Ù.

+				if (!(dwVnum >= GUILD_SKILL_START && dwVnum <= GUILD_SKILL_END)) //  ų Ÿ ó  ʴ´.

 					if (!m_bDisableCooltime && !m_SkillUseInfo[dwVnum].HitOnce(dwVnum) && dwVnum != SKILL_MUYEONG)

 					{

 						//if (dwVnum == SKILL_CHAIN) sys_log(0, "CHAIN skill cannot hit %s", GetName());

@@ -2293,7 +2290,7 @@
 		if (iDur > 0)

 		{

 			iDur += GetPoint(POINT_PARTY_BUFFER_BONUS);

-			// AffectFlag°¡ ¾ø°Å³ª, toggle ÇÏ´Â °ÍÀÌ ¾Æ´Ï¶ó¸é..

+			// AffectFlag ų, toggle ϴ  ƴ϶..

 			pkSk->kDurationSPCostPoly.SetVar("k", k/* bSkillLevel */);

 

 			AddAffect(pkSk->dwVnum,

@@ -2547,13 +2544,13 @@
 }

 #endif

 

-// bSkillLevel ÀÎÀÚ°¡ 0ÀÌ ¾Æ´Ò °æ¿ì¿¡´Â m_abSkillLevels¸¦ »ç¿ëÇÏÁö ¾Ê°í °­Á¦·Î

-// bSkillLevel·Î °è»êÇÑ´Ù.

+// bSkillLevel ڰ 0 ƴ 쿡 m_abSkillLevels  ʰ 

+// bSkillLevel Ѵ.

 int CHARACTER::ComputeSkill(DWORD dwVnum, LPCHARACTER pkVictim, BYTE bSkillLevel)

 {

 	const bool bCanUseHorseSkill = CanUseHorseSkill();

 

-	// ¸»À» Å¸°íÀÖÁö¸¸ ½ºÅ³Àº »ç¿ëÇÒ ¼ö ¾ø´Â »óÅÂ¶ó¸é return

+	//  Ÿ ų    ¶ return

 #ifdef SORF_TAHTASI

 	if (GetMountVnum() != SURFBOARD)

 	{

@@ -2600,7 +2597,7 @@
 		return BATTLE_NONE;

 #endif

 

-	// »ó´ë¹æ¿¡°Ô ¾²´Â °ÍÀÌ ¾Æ´Ï¸é ³ª¿¡°Ô ½á¾ß ÇÑ´Ù.

+	// 濡   ƴϸ   Ѵ.

 	if (IS_SET(pkSk->dwFlag, SKILL_FLAG_SELFONLY))

 		pkVictim = this;

 

@@ -2730,7 +2727,7 @@
 

 	if (test_server && iAmount == 0 && pkSk->wPointOn != POINT_NONE)

 	{

-		ChatPacket(CHAT_TYPE_INFO, "È¿°ú°¡ ¾ø½À´Ï´Ù. ½ºÅ³ °ø½ÄÀ» È®ÀÎÇÏ¼¼¿ä");

+		ChatPacket(CHAT_TYPE_INFO, "ȿ ϴ. ų  Ȯϼ");

 	}

 	// END_OF_ADD_GRANDMASTER_SKILL

 

@@ -2775,7 +2772,7 @@
 			int iDur = (int)pkSk->kDurationPoly.Eval();

 

 			if (IsPC())

-				if (!(dwVnum >= GUILD_SKILL_START && dwVnum <= GUILD_SKILL_END)) // ±æµå ½ºÅ³Àº ÄðÅ¸ÀÓ Ã³¸®¸¦ ÇÏÁö ¾Ê´Â´Ù.

+				if (!(dwVnum >= GUILD_SKILL_START && dwVnum <= GUILD_SKILL_END)) //  ų Ÿ ó  ʴ´.

 					if (!m_bDisableCooltime && !m_SkillUseInfo[dwVnum].HitOnce(dwVnum) && dwVnum != SKILL_MUYEONG)

 						return BATTLE_NONE;

 

@@ -2900,7 +2897,7 @@
 			}

 

 			iDur += GetPoint(POINT_PARTY_BUFFER_BONUS);

-			// AffectFlag°¡ ¾ø°Å³ª, toggle ÇÏ´Â °ÍÀÌ ¾Æ´Ï¶ó¸é..

+			// AffectFlag ų, toggle ϴ  ƴ϶..

 			pkSk->kDurationSPCostPoly.SetVar("k", k/* bSkillLevel */);

 

 			if (pkSk->wPointOn2 != POINT_NONE)

@@ -3113,14 +3110,14 @@
 			return false;

 

 		if (GetHorseLevel() <= 0)

-			ChatPacket(CHAT_TYPE_INFO, LC_STRING("¸»ÀÌ ¾ø½À´Ï´Ù. ¸¶±Â°£ °æºñº´À» Ã£¾Æ°¡¼¼¿ä."));

+			ChatPacket(CHAT_TYPE_INFO, LC_STRING(" ϴ. °  ãư."));

 		else

-			ChatPacket(CHAT_TYPE_INFO, LC_STRING("¸» ¼ÒÈ¯ ¾ÆÀÌÅÛÀ» »ç¿ëÇÏ¼¼¿ä."));

+			ChatPacket(CHAT_TYPE_INFO, LC_STRING(" ȯ  ϼ."));

 

 		return true;

 	}

 

-	// ¸»À» Å¸°íÀÖÁö¸¸ ½ºÅ³Àº »ç¿ëÇÒ ¼ö ¾ø´Â »óÅÂ¶ó¸é return false

+	//  Ÿ ų    ¶ return false

 #ifdef SORF_TAHTASI

 	if (GetMountVnum() != SURFBOARD)

 	{

@@ -3184,7 +3181,7 @@
 			}

 

 			m_SkillUseInfo[dwVnum].SetMainTargetVID(pkVictim->GetVID());

-			// DASH »óÅÂÀÇ ÅºÈ¯°ÝÀº °ø°Ý±â¼ú

+			// DASH  źȯ ݱ

 			ComputeSkill(dwVnum, pkVictim);

 			RemoveAffect(dwVnum);

 			return true;

@@ -3202,7 +3199,7 @@
 		return true;

 	}

 

-	// Toggle ÇÒ ¶§´Â SP¸¦ ¾²Áö ¾ÊÀ½ (SelfOnly·Î ±¸ºÐ)

+	// Toggle   SP   (SelfOnly )

 	if ((0 != pkSk->dwAffectFlag || pkSk->dwVnum == SKILL_MUYEONG) && (pkSk->dwFlag & SKILL_FLAG_TOGGLE) && RemoveAffect(pkSk->dwVnum))

 	{

 		return true;

@@ -3216,7 +3213,7 @@
 	pkSk->SetPointVar("k", k);

 	pkSk->kSplashAroundDamageAdjustPoly.SetVar("k", k);

 

-	// ÄðÅ¸ÀÓ Ã¼Å©

+	// Ÿ üũ

 	pkSk->kCooldownPoly.SetVar("k", k);

 	int iCooltime = (int)pkSk->kCooldownPoly.Eval();

 	int lMaxHit = pkSk->lMaxHit ? pkSk->lMaxHit : -1;

@@ -3273,7 +3270,7 @@
 			return false;

 

 		if (test_server)

-			ChatPacket(CHAT_TYPE_INFO, LC_STRING("%s SP¼Ò¸ð: %d", LC_SKILL(pkSk->dwVnum), iNeededSP));

+			ChatPacket(CHAT_TYPE_INFO, LC_STRING("%s SPҸ: %d", LC_SKILL(pkSk->dwVnum), iNeededSP));

 

 		PointChange(POINT_SP, -iNeededSP);

 	}

@@ -3283,7 +3280,7 @@
 

 	if ((pkSk->dwVnum == SKILL_MUYEONG) || (pkSk->IsChargeSkill() && !IsAffectFlag(AFF_TANHWAN_DASH) && !pkVictim))

 	{

-		// Ã³À½ »ç¿ëÇÏ´Â ¹«¿µÁøÀº ÀÚ½Å¿¡°Ô Affect¸¦ ºÙÀÎ´Ù.

+		// ó ϴ  ڽſ Affect δ.

 		pkVictim = this;

 	}

 

@@ -3396,7 +3393,7 @@
 

 int CHARACTER::GetSkillPower(DWORD dwVnum, BYTE bLevel) const

 {

-	// ÀÎ¾î¹ÝÁö ¾ÆÀÌÅÛ

+	// ξ 

 	if (dwVnum >= SKILL_LANGUAGE1 && dwVnum <= SKILL_LANGUAGE3 && IsEquipUniqueGroup(UNIQUE_GROUP_RING_OF_LANGUAGE))

 	{

 		return 100;

@@ -3614,41 +3611,41 @@
 	// const char* str = "";

 	//

 	if (ms < 3 * 60)

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("¸ö ¼ÓÀÌ ¶ß°Ì±º. ÇÏÁö¸¸ ¾ÆÁÖ Æí¾ÈÇØ. ÀÌ´ë·Î ±â¸¦ ¾ÈÁ¤½ÃÅ°ÀÚ."));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("  ̱߰.   . ̴ ⸦ Ű."));

 	else if (ms < 5 * 60)

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("±×·¡, ÃµÃµÈ÷. Á»´õ ÃµÃµÈ÷, ±×·¯³ª ¸·Èû ¾øÀÌ ºü¸£°Ô!"));

-	else if (ms < 10 * 60) // 10ºÐ

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("±×·¡, ÀÌ ´À³¦ÀÌ¾ß. Ã¼³»¿¡ ±â°¡ ¾ÆÁÖ Ãæ¸¸ÇØ."));

-	else if (ms < 30 * 60) // 30ºÐ

-	{

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("´Ù ÀÐ¾ú´Ù! ÀÌÁ¦ ºñ±Þ¿¡ ÀûÇôÀÖ´Â ´ë·Î Àü½Å¿¡ ±â¸¦ µ¹¸®±â¸¸ ÇÏ¸é,"));

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("±×°ÍÀ¸·Î ¼ö·ÃÀº ³¡³­ °Å¾ß!"));

-	}

-	else if (ms < 1 * 3600) // 1½Ã°£

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("ÀÌÁ¦ Ã¥ÀÇ ¸¶Áö¸· ÀåÀÌ¾ß! ¼ö·ÃÀÇ ³¡ÀÌ ´«¿¡ º¸ÀÌ°í ÀÖ¾î!"));

-	else if (ms < 2 * 3600) // 2½Ã°£

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("¾ó¸¶ ¾È ³²¾Ò¾î! Á¶±Ý¸¸ ´õ!"));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("׷, õõ.  õõ, ׷   !"));

+	else if (ms < 10 * 60) // 10

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("׷,  ̾. ü Ⱑ  游."));

+	else if (ms < 30 * 60) // 30

+	{

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING(" о!  ޿ ִ  ſ ⸦ ⸸ ϸ,"));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("װ   ž!"));

+	}

+	else if (ms < 1 * 3600) // 1ð

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING(" å  ̾!    ̰ ־!"));

+	else if (ms < 2 * 3600) // 2ð

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("  Ҿ! ݸ !"));

 	else if (ms < 3 * 3600)

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("ÁÁ¾Ò¾î! Á¶±Ý¸¸ ´õ ÀÐÀ¸¸é ³¡ÀÌ´Ù!"));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("Ҿ! ݸ   ̴!"));

 	else if (ms < 6 * 3600)

 	{

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("Ã¥Àåµµ ÀÌÁ¦ ¾ó¸¶ ³²Áö ¾Ê¾Ò±º."));

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("¹º°¡ ¸ö ¾È¿¡ ÈûÀÌ »ý±â´Â ±âºÐÀÎ °É."));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("å嵵    ʾұ."));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("  ȿ    ."));

 	}

 	else if (ms < 12 * 3600)

 	{

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("ÀÌÁ¦ Á» ½½½½ °¡´ÚÀÌ ÀâÈ÷´Â °Í °°Àºµ¥."));

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("ÁÁ¾Æ, ÀÌ ±â¼¼·Î °è¼Ó ³ª°£´Ù!"));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("      ."));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING(",  ⼼  !"));

 	}

 	else if (ms < 18 * 3600)

 	{

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("¾Æ´Ï ¾î¶»°Ô µÈ °Ô Á¾ÀÏ ÀÐ¾îµµ ¸Ó¸®¿¡ ¾È µé¾î¿À³Ä."));

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("°øºÎÇÏ±â ½È¾îÁö³×."));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("ƴ     о Ӹ  ."));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("ϱ Ⱦ."));

 	}

 	else //if (ms < 2 * 86400)

 	{

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("»ý°¢¸¸Å­ ÀÐ±â°¡ ½±Áö°¡ ¾Ê±º. ÀÌÇØµµ ¾î·Æ°í ³»¿ëµµ ³­ÇØÇØ."));

-		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("ÀÌ·¡¼­¾ß °øºÎ°¡ ¾ÈµÈ´Ù±¸."));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("ŭ бⰡ  ʱ. ص ư 뵵 ."));

+		ChatPacket(CHAT_TYPE_TALKING, LC_STRING("̷ ΰ ȵȴٱ."));

 	}

 

 	/*

@@ -4132,10 +4129,10 @@
 

 	static DWORD s_anMotion2SkillVnumList[MOTION_MAX_NUM][SKILL_LIST_MAX_COUNT] =

 	{

-		//	½ºÅ³¼ö	¹«»ç½ºÅ³ID	ÀÚ°´½ºÅ³ID	¼ö¶ó½ºÅ³ID	¹«´ç½ºÅ³ID	¼öÀÎÁ·(WOLFMAN) ½ºÅ³ID

+		//	ų	罺ųID	ڰųID	ųID	罺ųID	(WOLFMAN) ųID

 		{	0,		0,			0,			0,			0,			0		}, // 0 (RESERVED)

 

-		// 1¹ø Á÷±º ±âº» ½ºÅ³ SKILL GROUP 1 - TRAINING

+		// 1  ⺻ ų SKILL GROUP 1 - TRAINING

 		{	5,		1,			31,			61,			91,			170		}, // 1

 		{	5,		2,			32,			62,			92,			171		}, // 2

 		{	5,		3,			33,			63,			93,			172		}, // 3

@@ -4146,17 +4143,17 @@
 		{	0,		0,			0,			0,			0,			0		}, // 8

 		{	5,		176,		177,		179,		181,		183		}, // 9

 		{	0,		0,			0,			0,			0,			0		}, // 10

-		// 1¹ø Á÷±º ±âº» ½ºÅ³ ³¡ END

-

-		// ¿©À¯ºÐ MARGIN

+		// 1  ⺻ ų  END

+

+		//  MARGIN

 		{	0,		0,			0,			0,			0,			0		}, // 11

 		{	0,		0,			0,			0,			0,			0		}, // 12

 		{	0,		0,			0,			0,			0,			0		}, // 13

 		{	0,		0,			0,			0,			0,			0		}, // 14

 		{	0,		0,			0,			0,			0,			0		}, // 15

-		// ¿©À¯ºÐ ³¡ END

-

-		// 2¹ø Á÷±º ±âº» ½ºÅ³ SKILL GROUP 2 - TRAINING

+		//   END

+

+		// 2  ⺻ ų SKILL GROUP 2 - TRAINING

 		{	4,		16,			46,			76,			106,		0		}, // 16

 		{	4,		17,			47,			77,			107,		0		}, // 17

 		{	4,		18,			48,			78,			108,		0		}, // 18

@@ -4167,9 +4164,9 @@
 		{	0,		0,			0,			0,			0,			0		}, // 23

 		{	4,		176,		178,		180,		182,		0		}, // 24

 		{	0,		0,			0,			0,			0,			0		}, // 25

-		// 2¹ø Á÷±º ±âº» ½ºÅ³ ³¡ END

-

-		// 1¹ø Á÷±º ¸¶½ºÅÍ ½ºÅ³ SKILL GROUP 1 - MASTER

+		// 2  ⺻ ų  END

+

+		// 1   ų SKILL GROUP 1 - MASTER

 		{	5,		1,			31,			61,			91,			170		}, // 26

 		{	5,		2,			32,			62,			92,			171		}, // 27

 		{	5,		3,			33,			63,			93,			172		}, // 28

@@ -4180,17 +4177,17 @@
 		{	0,		0,			0,			0,			0,			0		}, // 33

 		{	5,		176,		177,		179,		181,		183		}, // 34

 		{	0,		0,			0,			0,			0,			0		}, // 35

-		// 1¹ø Á÷±º ¸¶½ºÅÍ ½ºÅ³ ³¡ END

-

-		// ¿©À¯ºÐ MARGIN

+		// 1   ų  END

+

+		//  MARGIN

 		{	0,		0,			0,			0,			0,			0		}, // 36

 		{	0,		0,			0,			0,			0,			0		}, // 37

 		{	0,		0,			0,			0,			0,			0		}, // 38

 		{	0,		0,			0,			0,			0,			0		}, // 39

 		{	0,		0,			0,			0,			0,			0		}, // 40

-		// ¿©À¯ºÐ ³¡ END

-

-		// 2¹ø Á÷±º ¸¶½ºÅÍ ½ºÅ³ SKILL GROUP 2 - MASTER

+		//   END

+

+		// 2   ų SKILL GROUP 2 - MASTER

 		{	4,		16,			46,			76,			106,		0		}, // 41

 		{	4,		17,			47,			77,			107,		0		}, // 42

 		{	4,		18,			48,			78,			108,		0		}, // 43

@@ -4201,9 +4198,9 @@
 		{	0,		0,			0,			0,			0,			0		}, // 48

 		{	4,		176,		178,		180,		182,		0		}, // 49

 		{	0,		0,			0,			0,			0,			0		}, // 50

-		// 2¹ø Á÷±º ¸¶½ºÅÍ ½ºÅ³ ³¡ END

-

-		// 1¹ø Á÷±º ±×·£µå ¸¶½ºÅÍ ½ºÅ³ SKILL GROUP 1 - GRAND MASTER

+		// 2   ų  END

+

+		// 1  ׷  ų SKILL GROUP 1 - GRAND MASTER

 		{	5,		1,			31,			61,			91,			170		}, // 51

 		{	5,		2,			32,			62,			92,			171		}, // 52

 		{	5,		3,			33,			63,			93,			172		}, // 53

@@ -4214,17 +4211,17 @@
 		{	0,		0,			0,			0,			0,			0		}, // 58

 		{	5,		176,		177,		179,		181,		183		}, // 59

 		{	0,		0,			0,			0,			0,			0		}, // 60

-		// 1¹ø Á÷±º ±×·£µå ¸¶½ºÅÍ ½ºÅ³ ³¡ END

-

-		// ¿©À¯ºÐ MARGIN

+		// 1  ׷  ų  END

+

+		//  MARGIN

 		{	0,		0,			0,			0,			0,			0		}, // 61

 		{	0,		0,			0,			0,			0,			0		}, // 62

 		{	0,		0,			0,			0,			0,			0		}, // 63

 		{	0,		0,			0,			0,			0,			0		}, // 64

 		{	0,		0,			0,			0,			0,			0		}, // 65

-		// ¿©À¯ºÐ ³¡ END

-

-		// 2¹ø Á÷±º ±×·£µå ¸¶½ºÅÍ ½ºÅ³ SKILL GROUP 2 - GRAND MASTER

+		//   END

+

+		// 2  ׷  ų SKILL GROUP 2 - GRAND MASTER

 		{	4,		16,			46,			76,			106,		0		}, // 66

 		{	4,		17,			47,			77,			107,		0		}, // 67

 		{	4,		18,			48,			78,			108,		0		}, // 68

@@ -4235,9 +4232,9 @@
 		{	0,		0,			0,			0,			0,			0		}, // 73

 		{	4,		176,		178,		180,		182,		0		}, // 74

 		{	0,		0,			0,			0,			0,			0		}, // 75

-		// 2¹ø Á÷±º ±×·£µå ¸¶½ºÅÍ ½ºÅ³ ³¡ END

-

-		// 1¹ø Á÷±º ÆÛÆåÆ® ¸¶½ºÅÍ ½ºÅ³ SKILL GROUP 1 - PERFECT MASTER

+		// 2  ׷  ų  END

+

+		// 1  Ʈ  ų SKILL GROUP 1 - PERFECT MASTER

 		{	5,		1,			31,			61,			91,			170		}, // 76

 		{	5,		2,			32,			62,			92,			171		}, // 77

 		{	5,		3,			33,			63,			93,			172		}, // 78

@@ -4248,17 +4245,17 @@
 		{	0,		0,			0,			0,			0,			0		}, // 83

 		{	5,		176,		177,		179,		181,		183		}, // 84

 		{	0,		0,			0,			0,			0,			0		}, // 85

-		// 1¹ø Á÷±º ÆÛÆåÆ® ¸¶½ºÅÍ ½ºÅ³ ³¡ END

-

-		// ¿©À¯ºÐ MARGIN

+		// 1  Ʈ  ų  END

+

+		//  MARGIN

 		{	0,		0,			0,			0,			0,			0		}, // 86

 		{	0,		0,			0,			0,			0,			0		}, // 87

 		{	0,		0,			0,			0,			0,			0		}, // 88

 		{	0,		0,			0,			0,			0,			0		}, // 89

 		{	0,		0,			0,			0,			0,			0		}, // 90

-		// ¿©À¯ºÐ ³¡ END

-

-		// 2¹ø Á÷±º ÆÛÆåÆ® ¸¶½ºÅÍ ½ºÅ³ SKILL GROUP 2 - PERFECT MASTER

+		//   END

+

+		// 2  Ʈ  ų SKILL GROUP 2 - PERFECT MASTER

 		{	4,		16,			46,			76,			106,		0		}, // 91

 		{	4,		17,			47,			77,			107,		0		}, // 92

 		{	4,		18,			48,			78,			108,		0		}, // 93

@@ -4269,18 +4266,18 @@
 		{	0,		0,			0,			0,			0,			0		}, // 98

 		{	4,		176,		178,		180,		182,		0		}, // 99

 		{	0,		0,			0,			0,			0,			0		}, // 100

-		// 2¹ø Á÷±º ÆÛÆåÆ® ¸¶½ºÅÍ ½ºÅ³ ³¡ END

-

-		// ±æµå ½ºÅ³ GUILD SKILLS

+		// 2  Ʈ  ų  END

+

+		//  ų GUILD SKILLS

 		{	1,		152,		0,			0,			0,			0		}, // 101

 		{	1,		153,		0,			0,			0,			0		}, // 102

 		{	1,		154,		0,			0,			0,			0		}, // 103

 		{	1,		155,		0,			0,			0,			0		}, // 104

 		{	1,		156,		0,			0,			0,			0		}, // 105

 		{	1,		157,		0,			0,			0,			0		}, // 106

-		// ±æµå ½ºÅ³ ³¡ END

-

-		// ¿©À¯ºÐ MARGIN

+		//  ų  END

+

+		//  MARGIN

 		{	0,		0,			0,			0,			0,			0		}, // 107

 		{	0,		0,			0,			0,			0,			0		}, // 108

 		{	0,		0,			0,			0,			0,			0		}, // 109

@@ -4295,13 +4292,13 @@
 		{	0,		0,			0,			0,			0,			0		}, // 118

 		{	0,		0,			0,			0,			0,			0		}, // 119

 		{	0,		0,			0,			0,			0,			0		}, // 120

-		// ¿©À¯ºÐ ³¡ END

-

-		// ½Â¸¶ ½ºÅ³ HORSE SKILLS

+		//   END

+

+		// ¸ ų HORSE SKILLS

 		{	2,		137,		140,		0,			0,			0		}, // 121

 		{	1,		138,		0,			0,			0,			0		}, // 122

 		{	1,		139,		0,			0,			0,			0		}, // 123

-		// ½Â¸¶ ½ºÅ³ ³¡ END

+		// ¸ ų  END

 	};

 

 	if (dwMotionIndex >= MOTION_MAX_NUM)

@@ -4474,7 +4471,14 @@
 			{ { 170, 171, 172, 173, 174, 175, 183 }, { 0, 0, 0, 0, 0, 0, 0 } },

 		};

 

-		const DWORD* pSkill = SkillList[GetJob()][GetSkillGroup() - 1];

+		const BYTE bJob = GetJob();

+		const BYTE bGroup = GetSkillGroup();

+		if (bJob >= JOB_MAX_NUM)

+			return false;

+		if (bGroup == 0 || bGroup > SKILL_GROUP_MAX_NUM)

+			return false;

+

+		const DWORD* pSkill = SkillList[bJob][bGroup - 1];

 

 		for (int i = 0; i < SKILL_COUNT; ++i)

 		{

@@ -4486,7 +4490,7 @@
 

 	if (true == IsRiding())

 	{

-		//¸¶¿îÆ® Å»°ÍÁß °í±Þ¸»¸¸ ½ºÅ³ »ç¿ë°¡´É

+		//Ʈ Ż ޸ ų 밡

 		/*

 		if (GetMountVnum())

 		{

@@ -4525,10 +4529,6 @@
 		case SKILL_INSIGHT:

 #endif

 		case SKILL_HIT:

-		case SKILL_HORSE_WILDATTACK:

-		case SKILL_HORSE_CHARGE:

-		case SKILL_HORSE_ESCAPE:

-		case SKILL_HORSE_WILDATTACK_RANGE:

 		case SKILL_ADD_HP:

 		case SKILL_RESIST_PENETRATE:

 		case GUILD_SKILL_EYE:

@@ -4541,6 +4541,13 @@
 		case GUILD_SKILL_TELEPORT:

 		case GUILD_SKILL_DOOR:

 			return true;

+

+		// [Security Fix] Horse combat skills must not be usable while not mounted (prevents packet injection)

+		case SKILL_HORSE_WILDATTACK:

+		case SKILL_HORSE_CHARGE:

+		case SKILL_HORSE_ESCAPE:

+		case SKILL_HORSE_WILDATTACK_RANGE:

+			return IsRiding();

 	}

 

 	return false;


--- a/server/metin2/Source/Server/game/src/panama.cpp
+++ b/server/metin2/Source/Server/game/src/panama.cpp
@@ -66,6 +66,7 @@
 		M2_DELETE_ARRAY(it->second);

 		++it;

 	}

+	s_panamaVector.clear();

 }

 

 void SendPanamaList(LPDESC d)

@@ -84,7 +85,7 @@
 		DWORD* ivs = (DWORD*)pack.abIV;

 		for (int i = 0; i != 32 / sizeof(DWORD); i++)

 		{

-			ivs[i] ^= d->GetPanamaKey() + i * 16777619; // ´õºí¿öµå´ÜÀ§·Î º¯ÇüµÈ ÆÄ³ª¸¶ Å°¸¦ XOR ÇØÁØ´Ù

+			ivs[i] ^= d->GetPanamaKey() + i * 16777619; //   ĳ Ű XOR ش

 		}

 		++it;

 


--- a/server/metin2/Source/Server/game/src/skill.cpp
+++ b/server/metin2/Source/Server/game/src/skill.cpp
@@ -334,7 +334,7 @@
 

 	if (!bError)

 	{

-		// ±âÁ¸ Å×ÀÌºíÀÇ ³»¿ëÀ» Áö¿î´Ù.

+		//  ̺  .

 		auto it = m_map_pkSkillProto.begin();

 		while (it != m_map_pkSkillProto.end())

 		{

@@ -344,7 +344,7 @@
 

 		m_map_pkSkillProto.clear();

 

-		// »õ·Î¿î ³»¿ëÀ» »ðÀÔ

+		// ο  

 		it = map_pkSkillProto.begin();

 

 		while (it != map_pkSkillProto.end())

@@ -354,11 +354,19 @@
 		}

 

 		SendLog("Skill Prototype reloaded!");

+		return true;

 	}

 	else

-		SendLog("There were erros when loading skill table");

-

-	return !bError;

+	{

+		SendLog("There were errors when loading skill table");

+

+		// On error, avoid leaking newly allocated prototypes.

+		for (auto& kv : map_pkSkillProto)

+			M2_DELETE(kv.second);

+		map_pkSkillProto.clear();

+	}

+

+	return false;

 }

 

 CSkillProto* CSkillManager::Get(DWORD dwVnum)


