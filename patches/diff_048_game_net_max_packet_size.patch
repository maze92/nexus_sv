--- a/Nexus OS/server/metin2/Source/Server/game/src/input.cpp
+++ b/Nexus OS/server/metin2/Source/Server/game/src/input.cpp
@@ -66,6 +66,8 @@
 	int iLastPacketLen = 0;
 	int iPacketLen;
 
+	static const int MAX_PACKET_SIZE_HARD_CAP = 32768;
+
 	if (!m_pPacketInfo)
 	{
 		sys_err("No packet info has been binded to");
@@ -106,6 +108,14 @@
 				return true;
 
 			iPacketLen += iExtraPacketSize;
+			if (iPacketLen <= 0 || iPacketLen > MAX_PACKET_SIZE_HARD_CAP)
+			{
+				sys_err("OVERSIZE PACKET: header %u len %d name %s fd %d", bHeader, iPacketLen, c_pszName ? c_pszName : "?", lpDesc->GetSocket());
+				lpDesc->SetPhase(PHASE_CLOSE);
+				return true;
+			}
+			if (m_iBufferLeft < iPacketLen)
+				return true;
 			lpDesc->Log("%s %d", c_pszName, iPacketLen);
 			m_pPacketInfo->End();
 		}
