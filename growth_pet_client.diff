Binary files client_base/client/client/pack/icon/item/55000.tga and client_final/client/client/pack/icon/item/55000.tga differ
Binary files client_base/client/client/pack/icon/item/55001.tga and client_final/client/client/pack/icon/item/55001.tga differ
Binary files client_base/client/client/pack/icon/item/55002.tga and client_final/client/client/pack/icon/item/55002.tga differ
Binary files client_base/client/client/pack/icon/item/55003.tga and client_final/client/client/pack/icon/item/55003.tga differ
Binary files client_base/client/client/pack/icon/item/55004.tga and client_final/client/client/pack/icon/item/55004.tga differ
Binary files client_base/client/client/pack/icon/item/55005.tga and client_final/client/client/pack/icon/item/55005.tga differ
Binary files client_base/client/client/pack/icon/item/55006.tga and client_final/client/client/pack/icon/item/55006.tga differ
Binary files client_base/client/client/pack/icon/item/55007.tga and client_final/client/client/pack/icon/item/55007.tga differ
Binary files client_base/client/client/pack/icon/item/55008.tga and client_final/client/client/pack/icon/item/55008.tga differ
Binary files client_base/client/client/pack/icon/item/55009.tga and client_final/client/client/pack/icon/item/55009.tga differ
Binary files client_base/client/client/pack/icon/item/55010.tga and client_final/client/client/pack/icon/item/55010.tga differ
Binary files client_base/client/client/pack/icon/item/55011.tga and client_final/client/client/pack/icon/item/55011.tga differ
Binary files client_base/client/client/pack/icon/item/55012.tga and client_final/client/client/pack/icon/item/55012.tga differ
Binary files client_base/client/client/pack/icon/item/55028.tga and client_final/client/client/pack/icon/item/55028.tga differ
Binary files client_base/client/client/pack/icon/item/55029.tga and client_final/client/client/pack/icon/item/55029.tga differ
Binary files client_base/client/client/pack/icon/item/55030.tga and client_final/client/client/pack/icon/item/55030.tga differ
Binary files client_base/client/client/pack/icon/item/55031.tga and client_final/client/client/pack/icon/item/55031.tga differ
Binary files client_base/client/client/pack/icon/item/55032.tga and client_final/client/client/pack/icon/item/55032.tga differ
Binary files client_base/client/client/pack/icon/item/55033.tga and client_final/client/client/pack/icon/item/55033.tga differ
Binary files client_base/client/client/pack/icon/item/55100.tga and client_final/client/client/pack/icon/item/55100.tga differ
Binary files client_base/client/client/pack/icon/item/55400.tga and client_final/client/client/pack/icon/item/55400.tga differ
Binary files client_base/client/client/pack/icon/item/55401.tga and client_final/client/client/pack/icon/item/55401.tga differ
Binary files client_base/client/client/pack/icon/item/55402.tga and client_final/client/client/pack/icon/item/55402.tga differ
Binary files client_base/client/client/pack/icon/item/55403.tga and client_final/client/client/pack/icon/item/55403.tga differ
Binary files client_base/client/client/pack/icon/item/55404.tga and client_final/client/client/pack/icon/item/55404.tga differ
Binary files client_base/client/client/pack/icon/item/55405.tga and client_final/client/client/pack/icon/item/55405.tga differ
Binary files client_base/client/client/pack/icon/item/55406.tga and client_final/client/client/pack/icon/item/55406.tga differ
Binary files client_base/client/client/pack/icon/item/55407.tga and client_final/client/client/pack/icon/item/55407.tga differ
Binary files client_base/client/client/pack/icon/item/55408.tga and client_final/client/client/pack/icon/item/55408.tga differ
Binary files client_base/client/client/pack/icon/item/55409.tga and client_final/client/client/pack/icon/item/55409.tga differ
Binary files client_base/client/client/pack/icon/item/55410.tga and client_final/client/client/pack/icon/item/55410.tga differ
Binary files client_base/client/client/pack/icon/item/55411.tga and client_final/client/client/pack/icon/item/55411.tga differ
Binary files client_base/client/client/pack/icon/item/55701.tga and client_final/client/client/pack/icon/item/55701.tga differ
Binary files client_base/client/client/pack/icon/item/55702.tga and client_final/client/client/pack/icon/item/55702.tga differ
Binary files client_base/client/client/pack/icon/item/55703.tga and client_final/client/client/pack/icon/item/55703.tga differ
Binary files client_base/client/client/pack/icon/item/55704.tga and client_final/client/client/pack/icon/item/55704.tga differ
Binary files client_base/client/client/pack/icon/item/55705.tga and client_final/client/client/pack/icon/item/55705.tga differ
Binary files client_base/client/client/pack/icon/item/55706.tga and client_final/client/client/pack/icon/item/55706.tga differ
Binary files client_base/client/client/pack/icon/item/55707.tga and client_final/client/client/pack/icon/item/55707.tga differ
Binary files client_base/client/client/pack/icon/item/55708.tga and client_final/client/client/pack/icon/item/55708.tga differ
Binary files client_base/client/client/pack/icon/item/55709.tga and client_final/client/client/pack/icon/item/55709.tga differ
Binary files client_base/client/client/pack/icon/item/55710.tga and client_final/client/client/pack/icon/item/55710.tga differ
Binary files client_base/client/client/pack/icon/item/55711.tga and client_final/client/client/pack/icon/item/55711.tga differ
diff -ruN client_base/client/client/pack/locale/locale/pt/item_list.txt client_final/client/client/pack/locale/locale/pt/item_list.txt
--- client_base/client/client/pack/locale/locale/pt/item_list.txt	1970-01-01 00:00:00.000000000 +0000
+++ client_final/client/client/pack/locale/locale/pt/item_list.txt	2026-02-20 18:14:11.311729497 +0000
@@ -0,0 +1,57 @@
+55001	ETC	icon/item/55001.tga
+55002	ETC	icon/item/55002.tga
+55003	ETC	icon/item/55003.tga
+55004	ETC	icon/item/55004.tga
+55005	ETC	icon/item/55005.tga
+55006	ETC	icon/item/55006.tga
+55007	ETC	icon/item/55007.tga
+55009	ETC	icon/item/55009.tga
+55010	ETC	icon/item/55012.tga
+55011	ETC	icon/item/55012.tga
+55012	ETC	icon/item/55012.tga
+55013	ETC	icon/item/55012.tga
+55014	ETC	icon/item/55012.tga
+55015	ETC	icon/item/55012.tga
+55016	ETC	icon/item/55012.tga
+55017	ETC	icon/item/55012.tga
+55018	ETC	icon/item/55012.tga
+55019	ETC	icon/item/55011.tga
+55020	ETC	icon/item/55012.tga
+55021	ETC	icon/item/55012.tga
+55022	ETC	icon/item/55012.tga
+55023	ETC	icon/item/55012.tga
+55024	ETC	icon/item/55012.tga
+55025	ETC	icon/item/55012.tga
+55026	ETC	icon/item/55011.tga
+55027	ETC	icon/item/55011.tga
+55028	ETC	icon/item/55028.tga
+55029	ETC	icon/item/55029.tga
+55030	ETC	icon/item/55030.tga
+55031	ETC	icon/item/55031.tga
+55032	ETC	icon/item/55033.tga
+55033	ETC	icon/item/55032.tga
+55034	ETC	icon/item/55012.tga
+55035	ETC	icon/item/55012.tga
+55036	ETC	icon/item/55012.tga
+55037	ETC	icon/item/55012.tga
+55038	ETC	icon/item/55011.tga
+55100	ETC	icon/item/55100.tga
+55400	ETC	icon/item/55400.tga
+55401	ETC	icon/item/55401.tga
+55402	ETC	icon/item/55402.tga
+55403	ETC	icon/item/55403.tga
+55404	ETC	icon/item/55404.tga
+55405	ETC	icon/item/55405.tga
+55406	ETC	icon/item/55406.tga
+55409	ETC	icon/item/55409.tga
+55410	ETC	icon/item/55410.tga
+55411	ETC	icon/item/55411.tga
+55701	ETC	icon/item/55701.tga
+55702	ETC	icon/item/55702.tga
+55703	ETC	icon/item/55703.tga
+55704	ETC	icon/item/55704.tga
+55705	ETC	icon/item/55705.tga
+55706	ETC	icon/item/55706.tga
+55709	ETC	icon/item/55709.tga
+55710	ETC	icon/item/55710.tga
+55711	ETC	icon/item/55711.tga
\ No newline at end of file
diff -ruN client_base/client/client/pack/root/constinfo.py client_final/client/client/pack/root/constinfo.py
--- client_base/client/client/pack/root/constinfo.py	2026-02-13 09:22:34.000000000 +0000
+++ client_final/client/client/pack/root/constinfo.py	2026-02-20 18:13:16.273736624 +0000
@@ -14,16 +14,12 @@
 FOG_LEVEL1 = 9600.0
 FOG_LEVEL2 = 12800.0
 FOG_LEVEL = FOG_LEVEL0
-FOG_LEVEL_LIST = [FOG_LEVEL0, FOG_LEVEL1, FOG_LEVEL2]
+FOG_LEVEL_LIST=[FOG_LEVEL0, FOG_LEVEL1, FOG_LEVEL2]
 
-import systemSetting
 CAMERA_MAX_DISTANCE_SHORT = 2500.0
 CAMERA_MAX_DISTANCE_LONG = 3500.0 * 2
-CAMERA_MAX_DISTANCE_LIST = [CAMERA_MAX_DISTANCE_SHORT, CAMERA_MAX_DISTANCE_LONG]
-CAMERA_MAX_DISTANCE = CAMERA_MAX_DISTANCE_LIST[systemSetting.GetCameraMode()]
-
-GOLD_MAX = 2000000000
-CHEQUE_MAX = 999
+CAMERA_MAX_DISTANCE_LIST=[CAMERA_MAX_DISTANCE_SHORT, CAMERA_MAX_DISTANCE_LONG]
+CAMERA_MAX_DISTANCE = CAMERA_MAX_DISTANCE_SHORT
 
 CHRNAME_COLOR_INDEX = 0
 
@@ -62,14 +58,6 @@
 
 isItemQuestionDialog = 0
 
-if app.ENABLE_REFINE_RENEWAL:
-	IS_AUTO_REFINE = False
-	AUTO_REFINE_TYPE = 0
-	AUTO_REFINE_DATA = {
-		"ITEM" : [-1, -1],
-		"NPC" : [0, -1, -1, 0]
-	}
-
 def GET_ITEM_QUESTION_DIALOG_STATUS():
 	global isItemQuestionDialog
 	return isItemQuestionDialog
@@ -169,28 +157,17 @@
 import item
 
 ACCESSORY_MATERIAL_LIST = [50623, 50624, 50625, 50626, 50627, 50628, 50629, 50630, 50631, 50632, 50633, 50634, 50635, 50636, 50637, 50638, 50639]
-if app.ENABLE_CONQUEROR_LEVEL:
-	ACCESSORY_MATERIAL_LIST += [50661, 50662, 50663, 50664]
-
+#ACCESSORY_MATERIAL_LIST = [50623, 50623, 50624, 50624, 50625, 50625, 50626, 50627, 50628, 50629, 50630, 50631, 50632, 50633, 
+#				50623, 50623, 50624, 50624, ]
 JewelAccessoryInfos = [
-		# jewel wrist neck ear
-		[ 50634, 14420, 16220, 17220 ],
-		[ 50635, 14500, 16500, 17500 ],
-		[ 50636, 14520, 16520, 17520 ],
-		[ 50637, 14540, 16540, 17540 ],
-		[ 50638, 14560, 16560, 17560 ],
-		[ 50639, 14570, 16570, 0 ], # 오광귀걸이는 없음(귀걸이는 수인관련)
-	]
-
-if app.ENABLE_CONQUEROR_LEVEL:
-	JewelAccessoryInfos += [
-		# jewel wrist neck ear
-		[ 50661, 14590, 16590, 17580 ],
-		[ 50662, 14600, 16600, 17590 ],
-		[ 50663, 14610, 16610, 17600 ],
-		[ 50664, 14580, 16580, 17570 ],
+		# jewel		wrist	neck	ear
+		[ 50634,	14420,	16220,	17220 ],
+		[ 50635,	14500,	16500,	17500 ],
+		[ 50636,	14520,	16520,	17520 ],
+		[ 50637,	14540,	16540,	17540 ],
+		[ 50638,	14560,	16560,	17560 ],
+		[ 50639,	14570,	16570,	0 ],# 오광귀걸이는 없음(귀걸이는 수인관련)
 	]
-
 def GET_ACCESSORY_MATERIAL_VNUM(vnum, subType):
 	ret = vnum
 	item_base = (vnum / 10) * 10
@@ -204,7 +181,7 @@
 		elif item.ARMOR_EAR == subType:
 			if info[3] == item_base:
 				return info[0]
-
+ 
 	if vnum >= 16210 and vnum <= 16219:
 		return 50625
 
@@ -220,9 +197,9 @@
 
 	type = ret/20
 
-	if type < 0 or type >= len(ACCESSORY_MATERIAL_LIST):
-		type = (ret - 170) / 20
-		if type < 0 or type >= len(ACCESSORY_MATERIAL_LIST):
+	if type<0 or type>=len(ACCESSORY_MATERIAL_LIST):
+		type = (ret-170) / 20
+		if type<0 or type>=len(ACCESSORY_MATERIAL_LIST):
 			return 0
 
 	return ACCESSORY_MATERIAL_LIST[type]
@@ -246,7 +223,7 @@
 def IS_AUTO_POTION_HP(itemVnum):
 	if 72723 <= itemVnum and 72726 >= itemVnum:
 		return 1
-	elif itemVnum >= 76021 and itemVnum <= 76022: ## 새로 들어간 선물용 화룡의 축복
+	elif itemVnum >= 76021 and itemVnum <= 76022:		## 새로 들어간 선물용 화룡의 축복
 		return 1
 	elif itemVnum == 79012:
 		return 1
@@ -257,13 +234,13 @@
 def IS_AUTO_POTION_SP(itemVnum):
 	if 72727 <= itemVnum and 72730 >= itemVnum:
 		return 1
-	elif itemVnum >= 76004 and itemVnum <= 76005: ## 새로 들어간 선물용 수룡의 축복
+	elif itemVnum >= 76004 and itemVnum <= 76005:		## 새로 들어간 선물용 수룡의 축복
 		return 1
 	elif itemVnum == 79013:
 		return 1
 
 	return 0
-
+    
 if app.ENABLE_GROWTH_PET_SYSTEM:
 	def IS_PET_ITEM(itemVnum):
 		if itemVnum == 0:
@@ -277,3 +254,84 @@
 			return 1
 			
 		return 0
+
+def NumberToStrRomanNumerals(number):
+	ROMAN = [
+		(1000, "M"),
+		( 900, "CM"),
+		( 500, "D"),
+		( 400, "CD"),
+		( 100, "C"),
+		(  90, "XC"),
+		(  50, "L"),
+		(  40, "XL"),
+		(  10, "X"),
+		(   9, "IX"),
+		(   5, "V"),
+		(   4, "IV"),
+		(   1, "I"),
+	]
+	
+	result = ""
+	for (arabic, roman) in ROMAN:
+		(factor, number) = divmod(number, arabic)
+		result += roman * factor
+	return result
+
+def CanSwitchItemBonus(itemIndex):
+	#trajes inicias
+	if (itemIndex >= 41005 and itemIndex <= 41010 or itemIndex >= 40136 and itemIndex <= 40153):
+		return False;
+	
+	#penteados inicias
+	if (itemIndex == 45274 or itemIndex == 45276):
+		return False;
+	
+	#penteados da loja de penteados de guerreiro
+	if (itemIndex >= 73001 and itemIndex <= 73012 or itemIndex >= 75001 and itemIndex <= 75012):
+		return False;
+
+	#penteados da loja de penteados de ninja
+	if (itemIndex >= 73251 and itemIndex <= 73262 or itemIndex >= 75201 and itemIndex <= 75212):
+		return False;
+
+	#penteados da loja de penteados de sura
+	if (itemIndex >= 73501 and itemIndex <= 73512 or itemIndex >= 75401 and itemIndex <= 75412):
+		return False;
+
+	#penteados da loja de penteados de shaman
+	if (itemIndex >= 73751 and itemIndex <= 73762 or itemIndex >= 75601 and itemIndex <= 75612):
+		return False;
+	
+	#Fatos e vestidos de casamentos
+	if (itemIndex >= 11901 and itemIndex <= 11904 or itemIndex >= 11911 and itemIndex <= 11914):
+		return False;
+	
+	#Ramo de flores
+	if (itemIndex == 50201 or itemIndex == 50202):
+		return False;
+	
+	return True
+
+def CanPutItemInSwitchbot(itemIndex):
+	item.SelectItem(itemIndex)
+
+	if not CanSwitchItemBonus(itemIndex):
+		return False
+	
+	if not item.GetItemType() in [item.ITEM_TYPE_WEAPON, item.ITEM_TYPE_ARMOR, item.ITEM_TYPE_COSTUME]:
+		return False
+	
+	if item.GetItemType() == item.ITEM_TYPE_WEAPON and\
+		item.GetItemSubType() in [item.WEAPON_ARROW,item.WEAPON_QUIVER]:
+		return False
+
+	if item.GetItemType() == item.ITEM_TYPE_ARMOR and\
+		not item.GetItemSubType() in [item.ARMOR_BODY, item.ARMOR_HEAD, item.ARMOR_SHIELD, item.ARMOR_WRIST, item.ARMOR_FOOTS, item.ARMOR_NECK, item.ARMOR_EAR, item.ARMOR_PENDANT]:
+		return False
+
+	if item.GetItemType() == item.ITEM_TYPE_COSTUME and\
+		not item.GetItemSubType() in [item.COSTUME_TYPE_BODY, item.COSTUME_TYPE_HAIR, item.COSTUME_TYPE_WEAPON]:
+		return False
+	
+	return True
diff -ruN client_base/client/client/pack/root/game.py client_final/client/client/pack/root/game.py
--- client_base/client/client/pack/root/game.py	2026-02-13 09:22:34.000000000 +0000
+++ client_final/client/client/pack/root/game.py	2026-02-20 18:13:16.274774235 +0000
@@ -22,6 +22,7 @@
 import messenger
 import localeInfo
 import constInfo
+import osfInfo
 import exchange
 import ime
 
@@ -52,9 +53,6 @@
 if app.ENABLE_KEYCHANGE_SYSTEM:
 	import uiKeyChange
 
-if app.ENABLE_EVENT_BANNER:
-	import ingameEventSystem
-
 from _weakref import proxy
 
 # TEXTTAIL_LIVINGTIME_CONTROL
@@ -80,17 +78,7 @@
 
 testAlignment = 0
 
-if app.ENABLE_REFINE_MSG_ADD:
-	REFINE_FAIL_GRADE_DOWN = 0
-	REFINE_FAIL_DEL_ITEM = 1
-	REFINE_FAIL_KEEP_GRADE = 2
-	REFINE_FAIL_MAX = 3
-
 class GameWindow(ui.ScriptWindow):
-
-	if app.ENABLE_LEFT_SEAT:
-		left_seat_dialog = None
-
 	def __init__(self, stream):
 		ui.ScriptWindow.__init__(self, "GAME")
 		self.SetWindowName("game")
@@ -104,8 +92,6 @@
 		self.guildWarQuestionDialog = None
 		self.interface = None
 		self.targetBoard = None
-		if app.ENABLE_DEFENSE_WAVE:
-			self.allianceTargetBoard = None
 		self.console = None
 		self.mapNameShower = None
 		self.affectShower = None
@@ -113,7 +99,7 @@
 		if app.ENABLE_KEYCHANGE_SYSTEM:
 			self.wndKeyChange = None
 
-		self.stream = stream
+		self.stream=stream
 		self.interface = interfaceModule.Interface()
 		self.interface.MakeInterface()
 		self.interface.ShowDefaultWindows()
@@ -127,11 +113,6 @@
 		self.targetBoard.Hide()
 		self.interface.SettargetBoard(self.targetBoard)
 
-		if app.ENABLE_DEFENSE_WAVE:
-			self.allianceTargetBoard = uiTarget.AllianceTargetBoard()
-			self.allianceTargetBoard.Hide()
-			self.interface.SetAllianceTargetBoard(self.allianceTargetBoard)
-
 		self.console = consoleModule.ConsoleWindow()
 		self.console.BindGameClass(self)
 		self.console.SetConsoleSize(wndMgr.GetScreenWidth(), 200)
@@ -146,22 +127,19 @@
 
 		#wj 2014.1.2. ESC키를 누를 시 우선적으로 DropQuestionDialog를 끄도록 만들었다. 하지만 처음에 itemDropQuestionDialog가 선언되어 있지 않아 ERROR가 발생하여 init에서 선언과 동시에 초기화 시킴.
 		self.itemDropQuestionDialog = None
-		if app.ENABLE_NEW_DROP_DIALOG:
-			self.itemDestroyQuestionDialog = None
 
 		self.__SetQuickSlotMode()
 
 		self.__ServerCommand_Build()
 		self.__ProcessPreservedServerCommand()
-
-		if app.ENABLE_GROWTH_PET_SYSTEM:
-			self.interface.PetInfoBindAffectShower(self.affectShower)
-
 		if app.ENABLE_KEYCHANGE_SYSTEM:
 			self.wndKeyChange = uiKeyChange.KeyChangeWindow(self, self.interface)
 			self.ADDKEYBUFFERCONTROL = player.KEY_ADDKEYBUFFERCONTROL
 			self.ADDKEYBUFFERALT = player.KEY_ADDKEYBUFFERALT
 			self.ADDKEYBUFFERSHIFT = player.KEY_ADDKEYBUFFERSHIFT
+			
+		if app.ENABLE_GROWTH_PET_SYSTEM:
+			self.interface.PetInfoBindAffectShower(self.affectShower)
 
 		self.partyRequestQuestionDialog = None
 		self.partyInviteQuestionDialog = None
@@ -241,13 +219,19 @@
 		exchange.InitTrading()
 		# END_OF_UNKNOWN_UPDATE
 
-		if debugInfo.IsDebugMode():
+		if debugInfo.IsDebugMode() or osfInfo.IsDebugMode():
 			self.ToggleDebugInfo()
 
 		## Sound
-		snd.SetMusicVolume(systemSetting.GetMusicVolume() * net.GetFieldMusicVolume())
+		snd.SetMusicVolume(systemSetting.GetMusicVolume()*net.GetFieldMusicVolume())
 		snd.SetSoundVolume(systemSetting.GetSoundVolume())
 
+		if app.ENABLE_FOG_FIX:
+			if systemSetting.GetFogMode():
+				background.SetFogMode(True)
+			else:
+				background.SetFogMode(False)
+
 		netFieldMusicFileName = net.GetFieldMusicFileName()
 		if netFieldMusicFileName:
 			snd.FadeInMusic("BGM/" + netFieldMusicFileName)
@@ -263,14 +247,8 @@
 
 		net.SendEnterGamePacket()
 
-		if app.ENABLE_MONSTER_CARD:
-			app.IllustratedCreate()
-
-		if app.ENABLE_MYSHOP_DECO:
-			app.MyShopDecoBGCreate()
-
-		if app.ENABLE_MINI_GAME_YUTNORI:
-			app.YutnoriCreate()
+		#if app.ENABLE_MYSHOP_DECO:
+		#	app.MyShopDecoBGCreate()
 
 		# START_GAME_ERROR_EXIT
 		try:
@@ -282,12 +260,13 @@
 
 		# NPC가 큐브시스템으로 만들 수 있는 아이템들의 목록을 캐싱
 		# ex) cubeInformation[20383] = [ {"rewordVNUM": 72723, "rewordCount": 1, "materialInfo": "101,1&102,2", "price": 999 }, ... ]
-		if not app.ENABLE_CUBE_RENEWAL:
-			self.cubeInformation = {}
-			self.currentCubeNPC = 0
+		self.cubeInformation = {}
+		self.currentCubeNPC = 0
 
 		mouseModule.mouseController.CreateNumberLine()
 
+		self.__LateSummerEvent()
+
 	def Close(self):
 		self.Hide()
 
@@ -325,8 +304,6 @@
 
 		# UNKNOWN_UPDATE
 		self.itemDropQuestionDialog = None
-		if app.ENABLE_NEW_DROP_DIALOG:
-			self.itemDestroyQuestionDialog = None
 		# END_OF_UNKNOWN_UPDATE
 
 		# QUEST_CONFIRM
@@ -363,16 +340,6 @@
 			self.targetBoard.Destroy()
 			self.targetBoard = None
 
-		if app.ENABLE_DEFENSE_WAVE:
-			if self.allianceTargetBoard:
-				self.allianceTargetBoard.Destroy()
-				self.allianceTargetBoard = None
-
-		if app.ENABLE_LEFT_SEAT:
-			if self.left_seat_dialog:
-				del self.left_seat_dialog
-				self.left_seat_dialog = None
-
 		player.ClearSkillDict()
 		player.ResetCameraRotation()
 
@@ -440,13 +407,17 @@
 		onPressKeyDict[app.DIK_NUMPAD8] = lambda: app.MoviePitchCamera(app.CAMERA_TO_NEGATIVE)
 		onPressKeyDict[app.DIK_NUMPAD2] = lambda: app.MoviePitchCamera(app.CAMERA_TO_POSITIVE)
 		onPressKeyDict[app.DIK_GRAVE] = lambda : self.PickUpItem()
-		onPressKeyDict[app.DIK_Z] = lambda : self.PickUpItem()
+		if app.ENABLE_QUICK_PICKUP:
+			onPressKeyDict[app.DIK_Z] = lambda : self.PickUpAllItems()
+		else:
+			onPressKeyDict[app.DIK_Z] = lambda : self.PickUpItem()
 		onPressKeyDict[app.DIK_C] = lambda state = "STATUS": self.interface.ToggleCharacterWindow(state)
 		onPressKeyDict[app.DIK_V] = lambda state = "SKILL": self.interface.ToggleCharacterWindow(state)
 		#onPressKeyDict[app.DIK_B] = lambda state = "EMOTICON": self.interface.ToggleCharacterWindow(state)
 		onPressKeyDict[app.DIK_N] = lambda state = "QUEST": self.interface.ToggleCharacterWindow(state)
 		onPressKeyDict[app.DIK_I] = lambda : self.interface.ToggleInventoryWindow()
 		onPressKeyDict[app.DIK_O] = lambda : self.__PressOKey()
+
 		onPressKeyDict[app.DIK_M] = lambda : self.interface.PressMKey()
 		#onPressKeyDict[app.DIK_H] = lambda : self.interface.OpenHelpWindow()
 		onPressKeyDict[app.DIK_ADD] = lambda : self.interface.MiniMapScaleUp()
@@ -455,9 +426,6 @@
 		onPressKeyDict[app.DIK_COMMA] = lambda : self.ShowConsole() # "`" key
 		onPressKeyDict[app.DIK_LSHIFT] = lambda : self.__SetQuickPageMode()
 
-		if app.ENABLE_GROWTH_PET_SYSTEM:
-			onPressKeyDict[app.DIK_P] = lambda : self.interface.TogglePetInformationWindow()
-
 		onPressKeyDict[app.DIK_J] = lambda : self.__PressJKey()
 		onPressKeyDict[app.DIK_H] = lambda : self.__PressHKey()
 		onPressKeyDict[app.DIK_B] = lambda : self.__PressBKey()
@@ -467,6 +435,9 @@
 		#onPressKeyDict[app.DIK_K] = lambda : self.interface.OpenCubeWindow()
 		# CUBE_TEST_END
 
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			onPressKeyDict[app.DIK_K] = lambda : self.interface.ToggleSpecialInventoryWindow()
+
 		self.onPressKeyDict = onPressKeyDict
 
 		onClickKeyDict = {}
@@ -503,6 +474,7 @@
 
 	def __PressNumKey(self,num):
 		if app.IsPressed(app.DIK_LCONTROL) or app.IsPressed(app.DIK_RCONTROL):
+
 			if num >= 1 and num <= 9:
 				if (chrmgr.IsPossibleEmoticon(-1)):
 					chrmgr.SetEmoticon(-1, int(num)-1)
@@ -521,9 +493,9 @@
 	def __PressJKey(self):
 		if app.IsPressed(app.DIK_LCONTROL) or app.IsPressed(app.DIK_RCONTROL):
 			if player.IsMountingHorse():
-				net.SendCommandPacket("/unmount")
+				net.SendChatPacket("/unmount")
 			else:
-				#net.SendCommandPacket("/user_horse_ride")
+				#net.SendChatPacket("/user_horse_ride")
 				if not uiPrivateShopBuilder.IsBuildingPrivateShop():
 					for i in xrange(player.INVENTORY_PAGE_SIZE):
 						if player.GetItemIndex(i) in (71114, 71116, 71118, 71120):
@@ -532,7 +504,7 @@
 
 	def __PressHKey(self):
 		if app.IsPressed(app.DIK_LCONTROL) or app.IsPressed(app.DIK_RCONTROL):
-			net.SendCommandPacket("/user_horse_ride")
+			net.SendChatPacket("/user_horse_ride")
 		else:
 			self.interface.OpenHelpWindow()
 
@@ -545,20 +517,20 @@
 
 	def __PressBKey(self):
 		if app.IsPressed(app.DIK_LCONTROL) or app.IsPressed(app.DIK_RCONTROL):
-			net.SendCommandPacket("/user_horse_back")
+			net.SendChatPacket("/user_horse_back")
 		else:
 			state = "EMOTICON"
 			self.interface.ToggleCharacterWindow(state)
 
 	def __PressFKey(self):
 		if app.IsPressed(app.DIK_LCONTROL) or app.IsPressed(app.DIK_RCONTROL):
-			net.SendCommandPacket("/user_horse_feed")
+			net.SendChatPacket("/user_horse_feed")
 		else:
 			app.ZoomCamera(app.CAMERA_TO_POSITIVE)
 
 	def __PressGKey(self):
 		if app.IsPressed(app.DIK_LCONTROL) or app.IsPressed(app.DIK_RCONTROL):
-			net.SendCommandPacket("/ride")
+			net.SendChatPacket("/ride")
 		else:
 			if self.ShowNameFlag:
 				self.interface.ToggleGuildWindow()
@@ -603,9 +575,9 @@
 					localSlotIndex = 3 - localSlotIndex
 				else:
 					localSlotIndex = 11 - localSlotIndex
-
+			
 			result = player.CanUseGrowthPetQuickSlot(localSlotIndex)
-
+			
 			if player.QUICK_SLOT_POS_ERROR == result:
 				return
 			elif result in [player.QUICK_SLOT_ITEM_USE_SUCCESS, player.QUICK_SLOT_IS_NOT_ITEM, player.QUICK_SLOT_PET_ITEM_USE_SUCCESS]:
@@ -614,7 +586,7 @@
 				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.PET_CAN_NOT_SUMMON_BECAUSE_LIFE_TIME_END)
 			elif player.QUICK_SLOT_CAN_NOT_USE_PET_ITEM == result:
 				return
-
+			
 		else:
 			if localeInfo.IsARABIC():
 				if 0 <= localSlotIndex and localSlotIndex < 4:
@@ -622,7 +594,7 @@
 				else:
 					player.RequestUseLocalQuickSlot(11-localSlotIndex)
 			else:
-				player.RequestUseLocalQuickSlot(localSlotIndex)
+				player.RequestUseLocalQuickSlot(localSlotIndex)	
 
 	if app.ENABLE_KEYCHANGE_SYSTEM:
 		def OpenKeyChangeWindow(self):
@@ -645,16 +617,10 @@
 				self.interface.ToggleMessenger()
 			elif type == player.KEY_OPEN_HELP:
 				self.interface.ToggleHelpWindow()
-			elif app.ENABLE_EVENT_BANNER and type == player.KEY_OPEN_IN_GAME_EVENT:
-				self.interface.ShowInGameEvent()
-			elif app.ENABLE_GROWTH_PET_SYSTEM:
-				self.interface.TogglePetInformationWindow()
-
-			if app.ENABLE_DSS_KEY_SELECT:
-				if type == player.KEY_SELECT_DSS_1:
-					self.interface.DragonSoulKeySelect(0)
-				elif type == player.KEY_SELECT_DSS_2:
-					self.interface.DragonSoulKeySelect(1)
+
+			if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+				if type == player.KEY_SPECIAL_INVENTORY:
+					self.interface.ToggleSpecialInventoryWindow()
 
 		def ScrollOnOff(self):
 			if 0 == interfaceModule.IsQBHide:
@@ -663,7 +629,6 @@
 			else:
 				interfaceModule.IsQBHide = 0
 				self.interface.ShowAllQuestButton()
-
 	def __SelectQuickPage(self, pageIndex):
 		self.quickSlotPageIndex = pageIndex
 		player.SetQuickPage(pageIndex)
@@ -760,7 +725,7 @@
 		elif nextPKMode == player.PK_MODE_MAX_NUM:
 			nextPKMode = 0
 
-		net.SendCommandPacket("/PKMode " + str(nextPKMode))
+		net.SendChatPacket("/PKMode " + str(nextPKMode))
 		print "/PKMode " + str(nextPKMode)
 
 	def OnChangePKMode(self):
@@ -791,6 +756,15 @@
 		self.RefreshCharacter()
 		self.RefreshSkill()
 
+	if app.ENABLE_MAP_LOCATION_APP_NAME:
+		def SetApplicationText(self):
+			try:
+				mapName = background.GetCurrentMapName()
+				if mapName in localeInfo.MINIMAP_ZONE_NAME_DICT:
+					app.SetText(localeInfo.APP_TITLE + " - " + localeInfo.MINIMAP_ZONE_NAME_DICT[background.GetCurrentMapName()])
+			except:
+				pass
+
 	# Refresh
 	def CheckGameButton(self):
 		if self.interface:
@@ -816,15 +790,8 @@
 		if self.interface:
 			self.interface.RefreshSkill()
 
-	if app.ENABLE_QUEST_RENEWAL:
-		def RefreshQuest(self, quest_type, quest_index):
-			self.interface.RefreshQuest(quest_type, quest_index)
-
-		def DeleteQuest(self, quest_type, quest_index):
-			self.interface.DeleteQuest(quest_type, quest_index)
-	else:
-		def RefreshQuest(self):
-			self.interface.RefreshQuest()
+	def RefreshQuest(self):
+		self.interface.RefreshQuest()
 
 	def RefreshMessenger(self):
 		self.interface.RefreshMessenger()
@@ -851,6 +818,9 @@
 		self.interface.OnBlockMode(mode)
 
 	def OpenQuestWindow(self, skin, idx):
+		if osfInfo.INPUT_IGNORE == 1:
+			return
+
 		self.interface.OpenQuestWindow(skin, idx)
 
 	def AskGuildName(self):
@@ -906,12 +876,7 @@
 
 	# UNKNOWN_UPDATE
 	def BINARY_NEW_AddAffect(self, type, pointIdx, value, duration):
-		if app.ENABLE_SET_ITEM:
-			if self.affectShower:
-				self.affectShower.BINARY_NEW_AddAffect(type, pointIdx, value, duration)
-		else:
-			self.affectShower.BINARY_NEW_AddAffect(type, pointIdx, value, duration)
-
+		self.affectShower.BINARY_NEW_AddAffect(type, pointIdx, value, duration)
 		if chr.NEW_AFFECT_DRAGON_SOUL_DECK1 == type or chr.NEW_AFFECT_DRAGON_SOUL_DECK2 == type:
 			self.interface.DragonSoulActivate(type - chr.NEW_AFFECT_DRAGON_SOUL_DECK1)
 		elif chr.NEW_AFFECT_DRAGON_SOUL_QUALIFIED == type:
@@ -920,21 +885,17 @@
 			self.interface.DragonSoulSetGrade(value)
 
 	def BINARY_NEW_RemoveAffect(self, type, pointIdx):
-		if app.ENABLE_SET_ITEM:
-			if self.affectShower:
-				self.affectShower.BINARY_NEW_RemoveAffect(type, pointIdx)
-		else:
-			self.affectShower.BINARY_NEW_RemoveAffect(type, pointIdx)
-
+		self.affectShower.BINARY_NEW_RemoveAffect(type, pointIdx)
 		if chr.NEW_AFFECT_DRAGON_SOUL_DECK1 == type or chr.NEW_AFFECT_DRAGON_SOUL_DECK2 == type:
 			self.interface.DragonSoulDeactivate()
 		elif app.ENABLE_DS_SET and chr.NEW_AFFECT_DS_SET == type:
 			self.interface.DragonSoulSetGrade(0)
-
-	def BINARY_NEW_UpdateAffect(self, type, point_type, value, duration):
-		self.affectShower.BINARY_NEW_UpdateAffect(type, point_type, value, duration)
 	# END_OF_UNKNOWN_UPDATE
 
+	if app.ENABLE_SKILL_COOLTIME_UPDATE:
+		def SkillClearCoolTime(self, slotIndex):
+			self.interface.SkillClearCoolTime(slotIndex)
+
 	def ActivateSkillSlot(self, slotIndex):
 		if self.interface:
 			self.interface.OnActivateSkill(slotIndex)
@@ -955,12 +916,12 @@
 		if self.interface:
 			self.interface.RefreshCharacter()
 
-	def OnGameOver(self, map_index, dialog_type):
+	def OnGameOver(self):
 		self.CloseTargetBoard()
-		self.OpenRestartDialog(map_index, dialog_type)
+		self.OpenRestartDialog()
 
-	def OpenRestartDialog(self, map_index, dialog_type):
-		self.interface.OpenRestartDialog(map_index, dialog_type)
+	def OpenRestartDialog(self):
+		self.interface.OpenRestartDialog()
 
 	def ChangeCurrentSkill(self, skillSlotNumber):
 		self.interface.OnChangeCurrentSkill(skillSlotNumber)
@@ -1018,22 +979,6 @@
 			self.targetBoard.SetHP(hpPercentage)
 			self.targetBoard.Show()
 
-	if app.ENABLE_DEFENSE_WAVE:
-		def SetHPAllianceTargetBoard(self, vid, hp, hpMax):
-			if self.interface.IsHideUiMode == True:
-				return
-
-			if not vid:
-				self.allianceTargetBoard.Close()
-				return
-
-			if vid != self.allianceTargetBoard.GetTargetVID():
-				self.allianceTargetBoard.ResetTargetBoard()
-				self.allianceTargetBoard.SetTarget(vid)
-
-			self.allianceTargetBoard.SetHP(hp, hpMax)
-			self.allianceTargetBoard.Show()
-
 	def CloseTargetBoardIfDifferent(self, vid):
 		if vid != self.targetBoard.GetTargetVID():
 			self.targetBoard.Close()
@@ -1050,14 +995,14 @@
 	def OpenEquipmentDialog(self, vid):
 		self.interface.OpenEquipmentDialog(vid)
 
-	def SetEquipmentDialogItem(self, window, vid, slot_index, vnum, count, change_look_vnum, refine_element, apply_random_list, set_value):
-		self.interface.SetEquipmentDialogItem(window, vid, slot_index, vnum, count, change_look_vnum, refine_element, apply_random_list, set_value)
+	def SetEquipmentDialogItem(self, vid, slotIndex, vnum, count):
+		self.interface.SetEquipmentDialogItem(vid, slotIndex, vnum, count)
 
-	def SetEquipmentDialogSocket(self, window, vid, slot_index, socket_index, value):
-		self.interface.SetEquipmentDialogSocket(window, vid, slot_index, socket_index, value)
+	def SetEquipmentDialogSocket(self, vid, slotIndex, socketIndex, value):
+		self.interface.SetEquipmentDialogSocket(vid, slotIndex, socketIndex, value)
 
-	def SetEquipmentDialogAttr(self, window, vid, slot_index, attr_index, type, value):
-		self.interface.SetEquipmentDialogAttr(window, vid, slot_index, attr_index, type, value)
+	def SetEquipmentDialogAttr(self, vid, slotIndex, attrIndex, type, value):
+		self.interface.SetEquipmentDialogAttr(vid, slotIndex, attrIndex, type, value)
 
 	# SHOW_LOCAL_MAP_NAME
 	def ShowMapName(self, mapName, x, y):
@@ -1068,63 +1013,15 @@
 			self.interface.SetMapName(mapName)
 	# END_OF_SHOW_LOCAL_MAP_NAME
 
-	if app.ENABLE_EXTENDED_BATTLE_PASS:
-		def BINARY_ExtOpenBattlePass(self):
-			if self.interface:
-				self.interface.ReciveOpenExtBattlePass()
-			
-		def BINARY_ExtBattlePassAddGeneralInfo(self, BattlePassType, BattlePassName, BattlePassID, battlePassStartTime, battlePassEndTime):
-			if self.interface:
-				self.interface.AddExtendedBattleGeneralInfo(BattlePassType, BattlePassName, BattlePassID, battlePassStartTime, battlePassEndTime)
-				
-		def BINARY_ExtBattlePassAddMission(self, battlepassType, battlepassID, missionIndex, missionType, missionInfo1, missionInfo2, missionInfo3):
-			if self.interface:
-				self.interface.AddExtendedBattlePassMission(battlepassType, battlepassID, missionIndex, missionType, missionInfo1, missionInfo2, missionInfo3)
-
-		def BINARY_ExtBattlePassAddMissionReward(self, battlepassType, battlepassID, missionIndex, missionType, itemVnum, itemCount):
-			if self.interface:
-				self.interface.AddExtendedBattlePassMissionReward(battlepassType, battlepassID, missionIndex, missionType, itemVnum, itemCount)
-
-		def BINARY_ExtBattlePassUpdate(self, battlepassType, missionIndex, missionType, newProgress):
-			if self.interface:
-				self.interface.UpdateExtendedBattlePassMission(battlepassType, missionIndex, missionType, newProgress)
-
-		def BINARY_ExtBattlePassAddReward(self, battlepassType, battlepassID, itemVnum, itemCount):
-			if self.interface:
-				self.interface.AddExtendedBattlePassReward(battlepassType, battlepassID, itemVnum, itemCount)
-		
-		def BINARY_ExtBattlePassAddRanklistEntry(self, playername, battlepassType, battlepassID, startTime, endTime):
-			if self.interface:
-				self.interface.AddExtBattlePassRanklistEntry(playername, battlepassType, battlepassID, startTime, endTime)
-
 	def BINARY_OpenAtlasWindow(self):
 		self.interface.BINARY_OpenAtlasWindow()
 
 	## Chat
-	if app.ENABLE_MULTI_LANGUAGE_SYSTEM:
-		def OnRecvWhisper(self, mode, name, line, language):
-			if mode == chat.WHISPER_TYPE_GM:
-				self.interface.RegisterGameMasterName(name)
-
-			if localeInfo.IsARABIC():
-				chat.AppendWhisper(mode, name, name + " : ", language)
-				chat.AppendWhisper(mode, name, line)
-			else:
-				chat.AppendWhisper(mode, name, line, language)
-
-			self.interface.RecvWhisper(name)
-	else:
-		def OnRecvWhisper(self, mode, name, line):
-			if mode == chat.WHISPER_TYPE_GM:
-				self.interface.RegisterGameMasterName(name)
-
-			if localeInfo.IsARABIC():
-				chat.AppendWhisper(mode, name, name + " : ")
-				chat.AppendWhisper(mode, name, line)
-			else:
-				chat.AppendWhisper(mode, name, line)
-
-			self.interface.RecvWhisper(name)
+	def OnRecvWhisper(self, mode, name, line):
+		if mode == chat.WHISPER_TYPE_GM:
+			self.interface.RegisterGameMasterName(name)
+		chat.AppendWhisper(mode, name, line)
+		self.interface.RecvWhisper(name)
 
 	def OnRecvWhisperSystemMessage(self, mode, name, line):
 		chat.AppendWhisper(chat.WHISPER_TYPE_SYSTEM, name, line)
@@ -1148,32 +1045,36 @@
 
 	if app.ENABLE_CHEQUE_SYSTEM:
 		def OnPickCheque(self, cheque):
-			if app.ENABLE_CHATTING_WINDOW_RENEWAL:
-				chat.AppendChat(chat.CHAT_TYPE_MONEY_INFO, localeInfo.CHEQUE_SYSTEM_PICK_WON % (cheque))
-			else:
-				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.CHEQUE_SYSTEM_PICK_WON % (cheque))
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.CHEQUE_SYSTEM_PICK_WON % (cheque))
 
 	if app.ENABLE_GEM_SYSTEM:
 		def OnPickGem(self, gem):
-			if app.ENABLE_CHATTING_WINDOW_RENEWAL:
-				chat.AppendChat(chat.CHAT_TYPE_MONEY_INFO, localeInfo.GEM_SYSTEM_PICK_GEM % (gem))
-			else:
-				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.GEM_SYSTEM_PICK_GEM % (gem))
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.GEM_SYSTEM_PICK_GEM % (gem))
+
+		def OpenGuiGem(self):
+			self.interface.OpenGuiGem()
+
+		def GemCheck(self):
+			self.interface.GemCheck()
+
+		def OpenGuiGemMarket(self):
+			self.interface.OpenGuiGemMarket()
+
+		def GemMarketItems(self, vnums, gem, count):
+			self.interface.GemMarketItems(vnums, gem, count)
+
+		def GemMarketSlotsDesblock(self, slot0, slot1, slot2, slot3, slot4, slot5):
+			self.interface.GemMarketSlotsDesblock(slot0, slot1, slot2, slot3, slot4, slot5)
+
+		def GemMarketClear(self):
+			self.interface.GemMarketClear()
 
-		def OpenGemShop(self):
-			self.interface.OpenGemShop()
-		def CloseGemShop(self):
-			self.interface.CloseGemShop()
-		def RefreshGemShopWindow(self):
-			self.interface.RefreshGemShopWindow()
-		def GemShopSlotBuy(self, slotindex, enable):
-			self.interface.GemShopSlotBuy(slotindex, enable)
-		def BINARY_OpenSelectItemWindowEx(self):
-			self.interface.BINARY_OpenSelectItemWindowEx()
-		def BINARY_RefreshSelectItemWindowEx(self):
-			self.interface.BINARY_RefreshSelectItemWindowEx()
-		def GemShopSlotAdd(self, slotindex, enable):
-			self.interface.GemShopSlotAdd(slotindex, enable)
+		def GemTimeMarket(self, time):
+			self.interface.GemTime(time)
+
+	if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+		def OpenSpecialInventoryWindow(self, category):
+			self.interface.OpenSpecialInventoryWindow(int(category))
 
 	def OpenCostumeWindow(self):
 		self.interface.OpenCostumeWindow()
@@ -1199,7 +1100,7 @@
 				print "GameWindow.__LoadChannelInfo - OpenError"
 				return -1, -1, -1
 
-		def __SeverInfo(self, channelNumber, mapIndex):
+		def ChannelInfo(self, channelNumber, mapIndex):
 			_chNum = int(channelNumber.strip())
 			_mapIdx = int(mapIndex.strip())
 
@@ -1220,6 +1121,25 @@
 
 			self.interface.RefreshServerInfo()
 
+	if app.ENABLE_EXPRESSING_EMOTION:
+		def ClearSpecialEmotions(self):
+			osfInfo.EXPRESSING_EMOTIONS = {}
+			self.interface.ClearSpecialEmotions()
+
+		def RegisterSpecialEmotion(self, emotionIdx, leftTime, notice):
+			emotionIdx, leftTime, notice = int(emotionIdx), int(leftTime), int(notice)
+			self.interface.RegisterSpecialEmotions(emotionIdx, leftTime)
+
+			if notice != 0:
+				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.OPEN_THE_SPECIAL_ACTION_KIT % osfInfo.GET_SPECIAL_EMOTION_NAME(emotionIdx))
+
+	if app.ENABLE_CAPTCHA_SYSTEM:
+		def IsAFKMode(self, qid):
+			osfInfo.AFKMode = int(qid)
+
+		def ShowCaptcha(self, timeLeft):
+			self.interface.ShowCaptcha(int(timeLeft))
+
 	def OnShopError(self, type):
 		try:
 			self.PopupMessage(localeInfo.SHOP_ERROR_DICT[type])
@@ -1238,9 +1158,6 @@
 
 	def OnFishingWrongPlace(self):
 		chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.FISHING_WRONG_PLACE)
-
-	def OnCannotFishingRideMount(self, vid):
-		textTail.RegisterInfoTail(vid, localeInfo.CANNOT_FISHING_RIDE_MOUNT)
 	# END_OF_ADD_FISHING_MESSAGE
 
 	def OnFishingNotify(self, isFish, fishName):
@@ -1264,7 +1181,7 @@
 		if localeInfo.USE_SKILL_ERROR_CHAT_DICT.has_key(type):
 			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.USE_SKILL_ERROR_CHAT_DICT[type])
 
-	def OnCannotShotError(self, vid, type):
+	def	OnCannotShotError(self, vid, type):
 		textTail.RegisterInfoTail(vid, localeInfo.SHOT_ERROR_TAIL_DICT.get(type, localeInfo.SHOT_ERROR_UNKNOWN % (type)))
 
 	## PointReset
@@ -1300,7 +1217,7 @@
 
 	## Party
 	# 파티 가입 제한 시간때문에 수정.
-	if app.ENABLE_NEW_USER_CARE:
+	if app.WJ_NEW_USER_CARE:
 		def RecvPartyInviteQuestion(self, leaderVID, leaderName):
 			partyInviteQuestionDialog = uiCommon.QuestionDialogWithTimeLimit()
 			partyInviteQuestionDialog.SetAcceptEvent(lambda arg=True: self.AnswerPartyInvite(arg))
@@ -1327,7 +1244,7 @@
 		partyLeaderVID = self.partyInviteQuestionDialog.partyLeaderVID
 
 		# 파티가입에 대한 거리 제한 삭제.
-		if not app.ENABLE_NEW_USER_CARE:
+		if not app.WJ_NEW_USER_CARE:
 			distance = player.GetCharacterDistance(partyLeaderVID)
 			if distance < 0.0 or distance > 5000:
 				answer = False
@@ -1337,12 +1254,9 @@
 		self.partyInviteQuestionDialog.Close()
 		self.partyInviteQuestionDialog = None
 
-	if app.WJ_SHOW_PARTY_ON_MINIMAP and app.ENABLE_PARTY_CHANNEL_FIX:
+	if app.WJ_SHOW_PARTY_ON_MINIMAP:
 		def AddPartyMember(self, pid, name, mapIdx, channel):
 			self.interface.AddPartyMember(pid, name, mapIdx, channel)
-	elif app.WJ_SHOW_PARTY_ON_MINIMAP:
-		def AddPartyMember(self, pid, name, mapIdx):
-			self.interface.AddPartyMember(pid, name, mapIdx)
 	else:
 		def AddPartyMember(self, pid, name):
 			self.interface.AddPartyMember(pid, name)
@@ -1354,12 +1268,9 @@
 		self.interface.RemovePartyMember(pid)
 		self.__RefreshTargetBoard()
 
-	if app.WJ_SHOW_PARTY_ON_MINIMAP and app.ENABLE_PARTY_CHANNEL_FIX:
+	if app.WJ_SHOW_PARTY_ON_MINIMAP:
 		def LinkPartyMember(self, pid, vid, mapIdx, channel):
 			self.interface.LinkPartyMember(pid, vid, mapIdx, channel)
-	elif app.WJ_SHOW_PARTY_ON_MINIMAP:
-		def LinkPartyMember(self, pid, vid, mapIdx):
-			self.interface.LinkPartyMember(pid, vid, mapIdx)
 	else:
 		def LinkPartyMember(self, pid, vid):
 			self.interface.LinkPartyMember(pid, vid)
@@ -1390,13 +1301,13 @@
 
 	def OnAcceptAddFriend(self):
 		name = self.messengerAddFriendQuestion.name
-		net.SendCommandPacket("/messenger_auth y " + name)
+		net.SendChatPacket("/messenger_auth y " + name)
 		self.OnCloseAddFriendQuestionDialog()
 		return True
 
 	def OnDenyAddFriend(self):
 		name = self.messengerAddFriendQuestion.name
-		net.SendCommandPacket("/messenger_auth n " + name)
+		net.SendChatPacket("/messenger_auth n " + name)
 		self.OnCloseAddFriendQuestionDialog()
 		return True
 
@@ -1453,9 +1364,6 @@
 	def HideClock(self):
 		self.interface.HideClock()
 
-	def UseInventoryItemInQuickSlot(self, global_slot_index):
-		self.interface.UseInventoryItemInQuickSlot(global_slot_index)
-
 	## Emotion
 	def BINARY_ActEmotion(self, emotionIndex):
 		if self.interface.wndCharacter:
@@ -1497,7 +1405,7 @@
 			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.SCREENSHOT_SAVE_FAILURE)
 
 	def ShowConsole(self):
-		if debugInfo.IsDebugMode() or True == self.consoleEnable:
+		if debugInfo.IsDebugMode() or True == self.consoleEnable or osfInfo.IsDebugMode():
 			player.EndKeyWalkingImmediately()
 			self.console.OpenWindow()
 
@@ -1563,6 +1471,10 @@
 	def PickUpItem(self):
 		player.PickCloseItem()
 
+	if app.ENABLE_QUICK_PICKUP:
+		def PickUpAllItems(self):
+			player.PickAllCloseItems()
+
 	###############################################################################################
 	###############################################################################################
 	## Event Handler
@@ -1571,10 +1483,6 @@
 		if self.interface.wndWeb and self.interface.wndWeb.IsShow():
 			return
 
-		if app.ENABLE_POPUP_NOTICE:
-			if self.interface.wndPopupNotice and self.interface.wndPopupNotice.IsShow():
-				return
-
 		if key == app.DIK_ESC:
 			self.RequestDropItem(False)
 			constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(0)
@@ -1656,7 +1564,12 @@
 				player.RequestDeleteGlobalQuickSlot(attachedItemSlotPos)
 
 			## Inventory
-			elif player.SLOT_TYPE_INVENTORY == attachedType:
+			elif player.SLOT_TYPE_INVENTORY == attachedType or\
+				(player.SLOT_TYPE_SKILL_BOOK_INVENTORY == attachedType or\
+				player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == attachedType or\
+				player.SLOT_TYPE_STONE_INVENTORY == attachedType or\
+				player.SLOT_TYPE_GIFT_BOX_INVENTORY == attachedType and app.ENABLE_SPECIAL_INVENTORY_SYSTEM):
+
 				if player.ITEM_MONEY == attachedItemIndex:
 					# Note : 인벤 돈 셋팅 후, 다른 유저 클릭하면 들어오는 함수
 					if app.ENABLE_CHEQUE_SYSTEM:
@@ -1671,20 +1584,6 @@
 			elif player.SLOT_TYPE_DRAGON_SOUL_INVENTORY == attachedType:
 				self.__PutItem(attachedType, attachedItemIndex, attachedItemSlotPos, attachedItemCount, self.PickingCharacterIndex)
 
-			if app.ENABLE_ACCE_COSTUME_SYSTEM:
-				## 바닥에 떨궜을때 악세서리(조합,흡수) 아이템 빼기.
-				if player.SLOT_TYPE_ACCE == attachedType:
-					self.__PutItem(attachedType, attachedItemIndex, attachedItemSlotPos, attachedItemCount, self.PickingCharacterIndex)
-
-			if app.ENABLE_EXTEND_INVEN_SYSTEM:
-				if player.SLOT_TYPE_EQUIPMENT == attachedType or \
-					player.SLOT_TYPE_BELT_INVENTORY == attachedType:
-					self.__PutItem(attachedType, attachedItemIndex, attachedItemSlotPos, attachedItemCount, self.PickingCharacterIndex)
-
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				if player.SLOT_TYPE_CHANGE_LOOK == attachedType:
-					self.__PutItem(attachedType, attachedItemIndex, attachedItemSlotPos, attachedItemCount, self.PickingCharacterIndex)
-
 			mouseModule.mouseController.DeattachObject()
 		else:
 			hyperlink = ui.GetHyperlink()
@@ -1702,54 +1601,40 @@
 		return True
 
 	def __PutItem(self, attachedType, attachedItemIndex, attachedItemSlotPos, attachedItemCount, dstChrID):
-		attachedInvenType = player.SlotTypeToInvenType(attachedType)
-
-		if player.INVENTORY == attachedInvenType or \
-			player.DRAGON_SOUL_INVENTORY == attachedInvenType or \
-			player.EQUIPMENT == attachedInvenType or \
-			player.BELT_INVENTORY == attachedInvenType:
+		if player.SLOT_TYPE_INVENTORY == attachedType or player.SLOT_TYPE_DRAGON_SOUL_INVENTORY == attachedType or\
+			(player.SLOT_TYPE_SKILL_BOOK_INVENTORY == attachedType or\
+			player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == attachedType or\
+			player.SLOT_TYPE_STONE_INVENTORY == attachedType or\
+			player.SLOT_TYPE_GIFT_BOX_INVENTORY == attachedType and app.ENABLE_SPECIAL_INVENTORY_SYSTEM):
 
+			attachedInvenType = player.SlotTypeToInvenType(attachedType)
 			if True == chr.HasInstance(self.PickingCharacterIndex) and player.GetMainCharacterIndex() != dstChrID:
-				if player.IsEquipmentSlot(attachedInvenType, attachedItemSlotPos):
+				if player.IsEquipmentSlot(attachedItemSlotPos) and player.SLOT_TYPE_DRAGON_SOUL_INVENTORY != attachedType:
 					self.stream.popupWindow.Close()
 					self.stream.popupWindow.Open(localeInfo.EXCHANGE_FAILURE_EQUIP_ITEM, 0, localeInfo.UI_OK)
 				else:
-					if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
-						if chr.IsNPC(dstChrID) or chr.IsStone(dstChrID):
-							net.SendGiveItemPacket(dstChrID, attachedInvenType, attachedItemSlotPos, attachedItemCount)
-						else:
-							net.SendExchangeStartPacket(dstChrID)
-							net.SendExchangeItemAddPacket(attachedInvenType, attachedItemSlotPos, 0)
-							if app.ENABLE_REFINE_RENEWAL:
-								constInfo.AUTO_REFINE_TYPE = 2
-								constInfo.AUTO_REFINE_DATA["NPC"][0] = dstChrID
-								constInfo.AUTO_REFINE_DATA["NPC"][1] = attachedInvenType
-								constInfo.AUTO_REFINE_DATA["NPC"][2] = attachedItemSlotPos
-								constInfo.AUTO_REFINE_DATA["NPC"][3] = attachedItemCount
+					if chr.IsNPC(dstChrID):
+						if app.ENABLE_AUTO_REFINE:
+							osfInfo.AUTO_REFINE_TYPE = 2
+							osfInfo.AUTO_REFINE_DATA["NPC"][0] = dstChrID
+							osfInfo.AUTO_REFINE_DATA["NPC"][1] = attachedInvenType
+							osfInfo.AUTO_REFINE_DATA["NPC"][2] = attachedItemSlotPos
+							osfInfo.AUTO_REFINE_DATA["NPC"][3] = attachedItemCount
+
+						net.SendGiveItemPacket(dstChrID, attachedInvenType, attachedItemSlotPos, attachedItemCount)
 					else:
-						if chr.IsNPC(dstChrID):
-							net.SendGiveItemPacket(dstChrID, attachedInvenType, attachedItemSlotPos, attachedItemCount)
+						if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
+							if chr.IsStone(dstChrID):
+								net.SendGiveItemPacket(dstChrID, attachedInvenType, attachedItemSlotPos, attachedItemCount)
+							else:
+								net.SendExchangeStartPacket(dstChrID)
+								net.SendExchangeItemAddPacket(attachedInvenType, attachedItemSlotPos, 0)
 						else:
 							net.SendExchangeStartPacket(dstChrID)
 							net.SendExchangeItemAddPacket(attachedInvenType, attachedItemSlotPos, 0)
-							if app.ENABLE_REFINE_RENEWAL:
-								constInfo.AUTO_REFINE_TYPE = 2
-								constInfo.AUTO_REFINE_DATA["NPC"][0] = dstChrID
-								constInfo.AUTO_REFINE_DATA["NPC"][1] = attachedInvenType
-								constInfo.AUTO_REFINE_DATA["NPC"][2] = attachedItemSlotPos
-								constInfo.AUTO_REFINE_DATA["NPC"][3] = attachedItemCount
 			else:
 				self.__DropItem(attachedType, attachedItemIndex, attachedItemSlotPos, attachedItemCount)
 
-		if app.ENABLE_ACCE_COSTUME_SYSTEM:
-			## 바닥에 떨궜을때 악세서리(조합,흡수) 아이템 빼기.
-			if player.SLOT_TYPE_ACCE == attachedType:
-				self.__DropItem(attachedType, attachedItemIndex, attachedItemSlotPos, attachedItemCount)
-
-		if app.ENABLE_CHANGE_LOOK_SYSTEM:
-			if player.SLOT_TYPE_CHANGE_LOOK == attachedType:
-				self.__DropItem(attachedType, attachedItemIndex, attachedItemSlotPos, attachedItemCount)
-
 	if app.ENABLE_CHEQUE_SYSTEM:
 		def __PutMoney(self, attachedType, attachedMoney, dstChrID, cheque):
 			if True == chr.HasInstance(dstChrID) and player.GetMainCharacterIndex() != dstChrID:
@@ -1796,22 +1681,20 @@
 			return
 		# END_OF_PRIVATESHOP_DISABLE_ITEM_DROP
 
-		window_type = player.SlotTypeToInvenType(attachedType)
-
-		if player.IsEquipmentSlot(window_type, attachedItemSlotPos):
+		if player.SLOT_TYPE_INVENTORY == attachedType and player.IsEquipmentSlot(attachedItemSlotPos):
 			self.stream.popupWindow.Close()
 			self.stream.popupWindow.Open(localeInfo.DROP_ITEM_FAILURE_EQUIP_ITEM, 0, localeInfo.UI_OK)
-
 		else:
 			if player.SLOT_TYPE_INVENTORY == attachedType or\
-				player.SLOT_TYPE_BELT_INVENTORY == attachedType:
+				(player.SLOT_TYPE_SKILL_BOOK_INVENTORY == attachedType or\
+				player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == attachedType or\
+				player.SLOT_TYPE_STONE_INVENTORY == attachedType or\
+				player.SLOT_TYPE_GIFT_BOX_INVENTORY == attachedType and app.ENABLE_SPECIAL_INVENTORY_SYSTEM):
 
-				dropItemIndex = player.GetItemIndex(window_type, attachedItemSlotPos)
+				dropItemIndex = player.GetItemIndex(attachedItemSlotPos)
 
 				item.SelectItem(dropItemIndex)
 				dropItemName = item.GetItemName()
-				if app.ENABLE_SET_ITEM:
-					dropItemName = item.GetItemNameBySetValue(player.GetItemSetValue(window_type, attachedItemSlotPos))
 
 				## Question Text
 				questionText = localeInfo.HOW_MANY_ITEM_DO_YOU_DROP(dropItemName, attachedItemCount)
@@ -1820,21 +1703,25 @@
 				if app.ENABLE_NEW_DROP_DIALOG:
 					itemDropQuestionDialog = uiCommon.QuestionDropDialog()
 					itemDropQuestionDialog.SetText(questionText)
-					itemDropQuestionDialog.SetItemSlot(window_type, attachedItemSlotPos)
-					itemDropQuestionDialog.SetAcceptEvent(lambda arg = True : self.RequestDropItem(arg))
-					itemDropQuestionDialog.SetDestroyEvent(ui.__mem_func__(self.RequestDestroyItem))
-					itemDropQuestionDialog.SetCancelEvent(lambda arg = False : self.RequestDropItem(arg))
+					itemDropQuestionDialog.SetAcceptEvent(lambda arg=True: self.RequestDropItem(arg))
+					itemDropQuestionDialog.SetDestroyEvent(lambda arg=True: self.RequestDestroyItem(arg))
+					itemDropQuestionDialog.SetCancelEvent(lambda arg=False: self.RequestDropItem(arg))
+					itemDropQuestionDialog.SetItemSlot(attachedItemSlotPos)
+					itemDropQuestionDialog.Open()
+					itemDropQuestionDialog.dropType = attachedType
+					itemDropQuestionDialog.dropNumber = attachedItemSlotPos
+					itemDropQuestionDialog.dropCount = attachedItemCount
+					self.itemDropQuestionDialog = itemDropQuestionDialog
 				else:
 					itemDropQuestionDialog = uiCommon.QuestionDialog()
 					itemDropQuestionDialog.SetText(questionText)
-					itemDropQuestionDialog.SetAcceptEvent(lambda arg = True : self.RequestDropItem(arg))
-					itemDropQuestionDialog.SetCancelEvent(lambda arg = False : self.RequestDropItem(arg))
-
-				itemDropQuestionDialog.Open()
-				itemDropQuestionDialog.dropType = attachedType
-				itemDropQuestionDialog.dropNumber = attachedItemSlotPos
-				itemDropQuestionDialog.dropCount = attachedItemCount
-				self.itemDropQuestionDialog = itemDropQuestionDialog
+					itemDropQuestionDialog.SetAcceptEvent(lambda arg=True: self.RequestDropItem(arg))
+					itemDropQuestionDialog.SetCancelEvent(lambda arg=False: self.RequestDropItem(arg))
+					itemDropQuestionDialog.Open()
+					itemDropQuestionDialog.dropType = attachedType
+					itemDropQuestionDialog.dropNumber = attachedItemSlotPos
+					itemDropQuestionDialog.dropCount = attachedItemCount
+					self.itemDropQuestionDialog = itemDropQuestionDialog
 
 				constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(1)
 
@@ -1848,19 +1735,10 @@
 				questionText = localeInfo.HOW_MANY_ITEM_DO_YOU_DROP(dropItemName, attachedItemCount)
 
 				## Dialog
-				if app.ENABLE_NEW_DROP_DIALOG:
-					itemDropQuestionDialog = uiCommon.QuestionDropDialog()
-					itemDropQuestionDialog.SetText(questionText)
-					itemDropQuestionDialog.SetItemSlot(window_type, attachedItemSlotPos)
-					itemDropQuestionDialog.SetAcceptEvent(lambda arg = True : self.RequestDropItem(arg))
-					itemDropQuestionDialog.SetDestroyEvent(ui.__mem_func__(self.RequestDestroyItem))
-					itemDropQuestionDialog.SetCancelEvent(lambda arg = False : self.RequestDropItem(arg))
-				else:
-					itemDropQuestionDialog = uiCommon.QuestionDialog()
-					itemDropQuestionDialog.SetText(questionText)
-					itemDropQuestionDialog.SetAcceptEvent(lambda arg = True : self.RequestDropItem(arg))
-					itemDropQuestionDialog.SetCancelEvent(lambda arg = False : self.RequestDropItem(arg))
-
+				itemDropQuestionDialog = uiCommon.QuestionDialog()
+				itemDropQuestionDialog.SetText(questionText)
+				itemDropQuestionDialog.SetAcceptEvent(lambda arg=True: self.RequestDropItem(arg))
+				itemDropQuestionDialog.SetCancelEvent(lambda arg=False: self.RequestDropItem(arg))
 				itemDropQuestionDialog.Open()
 				itemDropQuestionDialog.dropType = attachedType
 				itemDropQuestionDialog.dropNumber = attachedItemSlotPos
@@ -1869,15 +1747,6 @@
 
 				constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(1)
 
-			if app.ENABLE_ACCE_COSTUME_SYSTEM:
-				## 바닥에 떨궜을때 악세서리(조합,흡수) 아이템 빼기.
-				if player.SLOT_TYPE_ACCE == attachedType:
-					net.SendAcceRefineCheckOut(attachedItemSlotPos)
-
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				if player.SLOT_TYPE_CHANGE_LOOK == attachedType:
-					net.SendChangeLookCheckOut(attachedItemSlotPos)
-
 	def RequestDropItem(self, answer):
 		if not self.itemDropQuestionDialog:
 			return
@@ -1887,22 +1756,27 @@
 			dropCount = self.itemDropQuestionDialog.dropCount
 			dropNumber = self.itemDropQuestionDialog.dropNumber
 
-			if player.SLOT_TYPE_INVENTORY == dropType:
+			if player.SLOT_TYPE_INVENTORY == dropType or\
+				(player.SLOT_TYPE_SKILL_BOOK_INVENTORY == dropType or\
+				player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == dropType or\
+				player.SLOT_TYPE_STONE_INVENTORY == dropType or\
+				player.SLOT_TYPE_GIFT_BOX_INVENTORY == dropType and app.ENABLE_SPECIAL_INVENTORY_SYSTEM):
+
 				if dropNumber == player.ITEM_MONEY:
 					net.SendGoldDropPacketNew(dropCount)
 					snd.PlaySound("sound/ui/money.wav")
+				elif dropNumber == player.ITEM_MONEY and app.ENABLE_CHEQUE_SYSTEM:
+					net.SendChequeDropPacketNew(dropCount)
+					snd.PlaySound("sound/ui/money.wav")
 				else:
 					# PRIVATESHOP_DISABLE_ITEM_DROP
 					self.__SendDropItemPacket(dropNumber, dropCount)
 					# END_OF_PRIVATESHOP_DISABLE_ITEM_DROP
 
-			elif player.SLOT_TYPE_BELT_INVENTORY == dropType:
-				self.__SendDropItemPacket(dropNumber, dropCount, player.BELT_INVENTORY)
-
 			elif player.SLOT_TYPE_DRAGON_SOUL_INVENTORY == dropType:
-				# PRIVATESHOP_DISABLE_ITEM_DROP
-				self.__SendDropItemPacket(dropNumber, dropCount, player.DRAGON_SOUL_INVENTORY)
-				# END_OF_PRIVATESHOP_DISABLE_ITEM_DROP
+					# PRIVATESHOP_DISABLE_ITEM_DROP
+					self.__SendDropItemPacket(dropNumber, dropCount, player.DRAGON_SOUL_INVENTORY)
+					# END_OF_PRIVATESHOP_DISABLE_ITEM_DROP
 
 		self.itemDropQuestionDialog.Close()
 		self.itemDropQuestionDialog = None
@@ -1910,59 +1784,47 @@
 		constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(0)
 
 	if app.ENABLE_NEW_DROP_DIALOG:
-		def RequestDestroyItem(self):
+		def RequestDestroyItem(self, answer):
 			if not self.itemDropQuestionDialog:
 				return
 
-			itemDestroyQuestionDialog = uiCommon.QuestionDialogWithTimeLimit()
-			itemDestroyQuestionDialog.SetAcceptEvent(lambda arg=True: self.__ConfirmDestroyItem(arg))
-			itemDestroyQuestionDialog.SetCancelEvent(lambda arg=False: self.__ConfirmDestroyItem(arg))
-			itemDestroyQuestionDialog.Open(localeInfo.DESTROY_ITEM_CONFIRM, 3)
-			itemDestroyQuestionDialog.SetCancelOnTimeOver()
-			self.itemDestroyQuestionDialog = itemDestroyQuestionDialog
-
-		def __ConfirmDestroyItem(self, arg):
-			if not self.itemDropQuestionDialog or not self.itemDestroyQuestionDialog:
-				return
-
-			if arg:
+			if answer:
 				dropType = self.itemDropQuestionDialog.dropType
+				dropCount = self.itemDropQuestionDialog.dropCount
 				dropNumber = self.itemDropQuestionDialog.dropNumber
 
-				if player.SLOT_TYPE_INVENTORY == dropType:
+				if player.SLOT_TYPE_INVENTORY == dropType or\
+					(player.SLOT_TYPE_SKILL_BOOK_INVENTORY == dropType or\
+					player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == dropType or\
+					player.SLOT_TYPE_STONE_INVENTORY == dropType or\
+					player.SLOT_TYPE_GIFT_BOX_INVENTORY == dropType and app.ENABLE_SPECIAL_INVENTORY_SYSTEM):
+
 					if dropNumber == player.ITEM_MONEY:
 						return
+					elif dropNumber == player.ITEM_MONEY and app.ENABLE_CHEQUE_SYSTEM:
+						return
 					else:
 						self.__SendDestroyItemPacket(dropNumber)
 
-				elif player.SLOT_TYPE_BELT_INVENTORY == dropType:
-					self.__SendDestroyItemPacket(dropNumber, player.BELT_INVENTORY)
-
-				elif player.SLOT_TYPE_DRAGON_SOUL_INVENTORY == dropType:
-					self.__SendDestroyItemPacket(dropNumber, player.DRAGON_SOUL_INVENTORY)
-
-			self.itemDestroyQuestionDialog.Close()
-			self.itemDestroyQuestionDialog = None
-
 			self.itemDropQuestionDialog.Close()
 			self.itemDropQuestionDialog = None
 
 			constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(0)
 
-		def __SendDestroyItemPacket(self, itemInvenPos, itemInvenType = player.INVENTORY):
+		def __SendDestroyItemPacket(self, itemVNum, itemInvenType = player.INVENTORY):
 			if uiPrivateShopBuilder.IsBuildingPrivateShop():
 				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.DROP_ITEM_FAILURE_PRIVATE_SHOP)
 				return
 
-			net.SendItemDestroyPacket(itemInvenType, itemInvenPos)
+			net.SendItemDestroyPacket(itemVNum)
 
 	# PRIVATESHOP_DISABLE_ITEM_DROP
-	def __SendDropItemPacket(self, itemInvenPos, itemCount, itemInvenType = player.INVENTORY):
+	def __SendDropItemPacket(self, itemVNum, itemCount, itemInvenType = player.INVENTORY):
 		if uiPrivateShopBuilder.IsBuildingPrivateShop():
 			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.DROP_ITEM_FAILURE_PRIVATE_SHOP)
 			return
 
-		net.SendItemDropPacketNew(itemInvenType, itemInvenPos, itemCount)
+		net.SendItemDropPacketNew(itemInvenType, itemVNum, itemCount)
 	# END_OF_PRIVATESHOP_DISABLE_ITEM_DROP
 
 	def OnMouseRightButtonDown(self):
@@ -2011,7 +1873,7 @@
 		nRenderFPS = app.GetRenderFPS()
 		nFaceCount = app.GetFaceCount()
 		fFaceSpeed = app.GetFaceSpeed()
-		nST = background.GetRenderShadowTime()
+		nST=background.GetRenderShadowTime()
 		(fAveRT, nCurRT) = app.GetRenderTime()
 		(iNum, fFogStart, fFogEnd, fFarCilp) = background.GetDistanceSetInfo()
 		(iPatch, iSplat, fSplatRatio, sTextureNum) = background.GetRenderedSplatNum()
@@ -2072,6 +1934,10 @@
 			self.PickingItemIndex = textTail.Pick(x, y)
 		# END_OF_ADD_ALWAYS_SHOW_NAME
 
+		if app.ENABLE_GRAPHIC_ON_OFF:
+			if systemSetting.IsShowSalesText():
+				uiPrivateShopBuilder.UpdateADBoard()
+
 		textTail.UpdateShowingTextTail()
 		textTail.ArrangeTextTail()
 		if -1 != self.PickingItemIndex:
@@ -2132,6 +1998,7 @@
 		confirmDialog.Open(msg, timeout)
 		confirmDialog.SetAcceptEvent(lambda answer=True, pid=pid: net.SendQuestConfirmPacket(answer, pid) or self.confirmDialog.Hide())
 		confirmDialog.SetCancelEvent(lambda answer=False, pid=pid: net.SendQuestConfirmPacket(answer, pid) or self.confirmDialog.Hide())
+		confirmDialog.SetCancelOnTimeOver() # hotfix
 		self.confirmDialog = confirmDialog
 	# END_OF_QUEST_CONFIRM
 
@@ -2143,157 +2010,147 @@
 		self.interface.HideGift()
 
 	# CUBE
-	if app.ENABLE_CUBE_RENEWAL:
-		def BINARY_Cube_Open(self, npc_vnum):
-			self.interface.OpenCubeWindow(npc_vnum)
+	def BINARY_Cube_Open(self, npcVNUM, reload = 0):
+		self.currentCubeNPC = npcVNUM
 
-		def BINARY_Cube_Close(self):
-			self.interface.CloseCubeWindow()
+		if reload:
+			self.cubeInformation.clear()
+			self.interface.wndCube.ClearOldSlots()
 
-		def BINARY_Cube_Result(self, is_success):
-			self.interface.CubeResult(is_success)
-	else:
-		def BINARY_Cube_Open(self, npcVNUM, reload = 0):
-			self.currentCubeNPC = npcVNUM
+		self.interface.OpenCubeWindow()
 
-			if reload:
-				self.cubeInformation.clear()
-				self.interface.wndCube.ClearOldSlots()
-
-			self.interface.OpenCubeWindow()
-
-			if npcVNUM not in self.cubeInformation:
-				net.SendCommandPacket("/cube r_info")
-			else:
-				cubeInfoList = self.cubeInformation[npcVNUM]
-
-				i = 0
-				for cubeInfo in cubeInfoList:
-					self.interface.wndCube.AddCubeResultItem(cubeInfo["vnum"], cubeInfo["count"])
+		if npcVNUM not in self.cubeInformation:
+			net.SendChatPacket("/cube r_info")
+		else:
+			cubeInfoList = self.cubeInformation[npcVNUM]
 
-					j = 0
-					for materialList in cubeInfo["materialList"]:
-						for materialInfo in materialList:
-							itemVnum, itemCount = materialInfo
-							self.interface.wndCube.AddMaterialInfo(i, j, itemVnum, itemCount)
-						j = j + 1
+			i = 0
+			for cubeInfo in cubeInfoList:
+				self.interface.wndCube.AddCubeResultItem(cubeInfo["vnum"], cubeInfo["count"])
 
-					i = i + 1
+				j = 0
+				for materialList in cubeInfo["materialList"]:
+					for materialInfo in materialList:
+						itemVnum, itemCount = materialInfo
+						self.interface.wndCube.AddMaterialInfo(i, j, itemVnum, itemCount)
+					j = j + 1
 
-				self.interface.wndCube.Refresh()
+				i = i + 1
 
-		def BINARY_Cube_Close(self):
-			self.interface.CloseCubeWindow()
+			self.interface.wndCube.Refresh()
 
-		# 제작에 필요한 골드, 예상되는 완성품의 VNUM과 개수 정보 update
-		def BINARY_Cube_UpdateInfo(self, gold, itemVnum, count):
-			self.interface.UpdateCubeInfo(gold, itemVnum, count)
-
-		def BINARY_Cube_Succeed(self, itemVnum, count):
-			print "큐브 제작 성공"
-			self.interface.SucceedCubeWork(itemVnum, count)
-			pass
+	def BINARY_Cube_Close(self):
+		self.interface.CloseCubeWindow()
 
-		def BINARY_Cube_Failed(self):
-			print "큐브 제작 실패"
-			self.interface.FailedCubeWork()
-			pass
+	# 제작에 필요한 골드, 예상되는 완성품의 VNUM과 개수 정보 update
+	def BINARY_Cube_UpdateInfo(self, gold, itemVnum, count):
+		self.interface.UpdateCubeInfo(gold, itemVnum, count)
 
-		def BINARY_Cube_ResultList(self, npcVNUM, listText):
-			# ResultList Text Format : 72723,1/72725,1/72730.1/50001,5 이런식으로 "/" 문자로 구분된 리스트를 줌
-			#print listText
+	def BINARY_Cube_Succeed(self, itemVnum, count):
+		print "큐브 제작 성공"
+		self.interface.SucceedCubeWork(itemVnum, count)
+		pass
 
-			if npcVNUM == 0:
-				npcVNUM = self.currentCubeNPC
+	def BINARY_Cube_Failed(self):
+		print "큐브 제작 실패"
+		self.interface.FailedCubeWork()
+		pass
 
-			self.cubeInformation[npcVNUM] = []
+	def BINARY_Cube_ResultList(self, npcVNUM, listText):
+		# ResultList Text Format : 72723,1/72725,1/72730.1/50001,5 이런식으로 "/" 문자로 구분된 리스트를 줌
+		#print listText
 
-			try:
-				for eachInfoText in listText.split("/"):
-					eachInfo = eachInfoText.split(",")
-					itemVnum = int(eachInfo[0])
-					itemCount = int(eachInfo[1])
-
-					self.cubeInformation[npcVNUM].append({"vnum": itemVnum, "count": itemCount})
-					self.interface.wndCube.AddCubeResultItem(itemVnum, itemCount)
-
-				resultCount = len(self.cubeInformation[npcVNUM])
-				requestCount = 5
-				modCount = resultCount % requestCount
-				splitCount = resultCount / requestCount
-				for i in xrange(splitCount):
-					#print("/cube r_info %d %d" % (i * requestCount, requestCount))
-					net.SendCommandPacket("/cube r_info %d %d" % (i * requestCount, requestCount))
-
-				if 0 < modCount:
-					#print("/cube r_info %d %d" % (splitCount * requestCount, modCount))
-					net.SendCommandPacket("/cube r_info %d %d" % (splitCount * requestCount, modCount))
+		if npcVNUM == 0:
+			npcVNUM = self.currentCubeNPC
 
-			except RuntimeError, msg:
-				dbg.TraceError(msg)
-				return 0
+		self.cubeInformation[npcVNUM] = []
 
-			pass
+		try:
+			for eachInfoText in listText.split("/"):
+				eachInfo = eachInfoText.split(",")
+				itemVnum = int(eachInfo[0])
+				itemCount = int(eachInfo[1])
+
+				self.cubeInformation[npcVNUM].append({"vnum": itemVnum, "count": itemCount})
+				self.interface.wndCube.AddCubeResultItem(itemVnum, itemCount)
+
+			resultCount = len(self.cubeInformation[npcVNUM])
+			requestCount = 5
+			modCount = resultCount % requestCount
+			splitCount = resultCount / requestCount
+			for i in xrange(splitCount):
+				#print("/cube r_info %d %d" % (i * requestCount, requestCount))
+				net.SendChatPacket("/cube r_info %d %d" % (i * requestCount, requestCount))
+
+			if 0 < modCount:
+				#print("/cube r_info %d %d" % (splitCount * requestCount, modCount))
+				net.SendChatPacket("/cube r_info %d %d" % (splitCount * requestCount, modCount))
 
-		def BINARY_Cube_MaterialInfo(self, startIndex, listCount, listText):
-			# Material Text Format : 125,1|126,2|127,2|123,5&555,5&555,4/120000
-			try:
-				#print listText
+		except RuntimeError, msg:
+			dbg.TraceError(msg)
+			return 0
 
-				if 3 > len(listText):
-					dbg.TraceError("Wrong Cube Material Infomation")
-					return 0
+		pass
 
-				eachResultList = listText.split("@")
+	def BINARY_Cube_MaterialInfo(self, startIndex, listCount, listText):
+		# Material Text Format : 125,1|126,2|127,2|123,5&555,5&555,4/120000
+		try:
+			#print listText
 
-				cubeInfo = self.cubeInformation[self.currentCubeNPC]
+			if 3 > len(listText):
+				dbg.TraceError("Wrong Cube Material Infomation")
+				return 0
 
-				itemIndex = 0
-				for eachResultText in eachResultList:
-					cubeInfo[startIndex + itemIndex]["materialList"] = [[], [], [], [], []]
-					materialList = cubeInfo[startIndex + itemIndex]["materialList"]
+			eachResultList = listText.split("@")
 
-					gold = 0
-					splitResult = eachResultText.split("/")
-					if 1 < len(splitResult):
-						gold = int(splitResult[1])
+			cubeInfo = self.cubeInformation[self.currentCubeNPC]
 
-					#print "splitResult : ", splitResult
-					eachMaterialList = splitResult[0].split("&")
+			itemIndex = 0
+			for eachResultText in eachResultList:
+				cubeInfo[startIndex + itemIndex]["materialList"] = [[], [], [], [], []]
+				materialList = cubeInfo[startIndex + itemIndex]["materialList"]
+
+				gold = 0
+				splitResult = eachResultText.split("/")
+				if 1 < len(splitResult):
+					gold = int(splitResult[1])
 
-					i = 0
-					for eachMaterialText in eachMaterialList:
-						complicatedList = eachMaterialText.split("|")
+				#print "splitResult : ", splitResult
+				eachMaterialList = splitResult[0].split("&")
 
-						if 0 < len(complicatedList):
-							for complicatedText in complicatedList:
-								(itemVnum, itemCount) = complicatedText.split(",")
-								itemVnum = int(itemVnum)
-								itemCount = int(itemCount)
-								self.interface.wndCube.AddMaterialInfo(itemIndex + startIndex, i, itemVnum, itemCount)
+				i = 0
+				for eachMaterialText in eachMaterialList:
+					complicatedList = eachMaterialText.split("|")
 
-								materialList[i].append((itemVnum, itemCount))
-						else:
-							itemVnum, itemCount = eachMaterialText.split(",")
+					if 0 < len(complicatedList):
+						for complicatedText in complicatedList:
+							(itemVnum, itemCount) = complicatedText.split(",")
 							itemVnum = int(itemVnum)
 							itemCount = int(itemCount)
 							self.interface.wndCube.AddMaterialInfo(itemIndex + startIndex, i, itemVnum, itemCount)
 
 							materialList[i].append((itemVnum, itemCount))
+					else:
+						itemVnum, itemCount = eachMaterialText.split(",")
+						itemVnum = int(itemVnum)
+						itemCount = int(itemCount)
+						self.interface.wndCube.AddMaterialInfo(itemIndex + startIndex, i, itemVnum, itemCount)
 
-						i = i + 1
+						materialList[i].append((itemVnum, itemCount))
 
-					itemIndex = itemIndex + 1
+					i = i + 1
 
-				self.interface.wndCube.Refresh()
+				itemIndex = itemIndex + 1
 
-			except RuntimeError, msg:
-				dbg.TraceError(msg)
-				return 0
+			self.interface.wndCube.Refresh()
 
-			pass
+		except RuntimeError, msg:
+			dbg.TraceError(msg)
+			return 0
+
+		pass
 
-		# END_OF_CUBE
+	# END_OF_CUBE
 
 	# 용혼석
 	def BINARY_Highlight_Item(self, inven_type, inven_pos):
@@ -2302,12 +2159,8 @@
 	def BINARY_DragonSoulGiveQuilification(self):
 		self.interface.DragonSoulGiveQuilification()
 
-	if app.ENABLE_DS_CHANGE_ATTR:
-		def BINARY_DragonSoulRefineWindow_Open(self, type):
-			self.interface.OpenDragonSoulRefineWindow(type)
-	else:
-		def BINARY_DragonSoulRefineWindow_Open(self):
-			self.interface.OpenDragonSoulRefineWindow()
+	def BINARY_DragonSoulRefineWindow_Open(self):
+		self.interface.OpenDragonSoulRefineWindow()
 
 	def BINARY_DragonSoulRefineWindow_RefineFail(self, reason, inven_type, inven_pos):
 		self.interface.FailDragonSoulRefine(reason, inven_type, inven_pos)
@@ -2320,21 +2173,170 @@
 	def BINARY_SetBigMessage(self, message):
 		self.interface.bigBoard.SetTip(message)
 
-	if app.ENABLE_OX_RENEWAL:
-		def BINARY_SetBigControlMessage(self, message):
-			self.interface.bigBoardControl.SetTip(message)
-
 	def BINARY_SetTipMessage(self, message):
 		self.interface.tipBoard.SetTip(message)
 
-	def BINARY_SetMissionMessage(self, message):
-		self.interface.missionBoard.SetMission(message)
+	if app.ENABLE_12ZI:
+		def BINARY_SetMissionMessage(self, message):
+			self.interface.missionBoard.SetMission(message)
+
+		def BINARY_SetSubMissionMessage(self, message):
+			self.interface.missionBoard.SetSubMission(message)
+
+		def BINARY_CleanMissionMessage(self):
+			self.interface.missionBoard.CleanMission()
+
+	if app.ENABLE_DUNGEON_INFO_SYSTEM:
+		def DungeonInfo(self, questindex):
+			osfInfo.dungeonData["quest_index"] = questindex
+
+		def CleanDungeonInfo(self):
+			osfInfo.dungeonInfo = []
+
+		def CleanDungeonRanking(self):
+			osfInfo.dungeonRanking["ranking_list"] = []
+			osfInfo.dungeonRanking["my_ranking"] = []
+
+		def GetDungeonInfo(self, cmd):
+			cmd = cmd.split("#")
+
+			if cmd[0] == "INPUT":
+				osfInfo.INPUT_IGNORE = int(cmd[1])
+
+			elif cmd[0] == "CMD":
+				net.SendQuestInputStringPacket(osfInfo.dungeonData["quest_cmd"])
+				osfInfo.dungeonData["quest_cmd"] = ""
+
+			else:
+				pass
+
+		def UpdateDungeonInfo(self, status, waitTime, type, organization, levelMinLimit, levelMaxLimit, partyMemberMinLimit, partyMemberMaxLimit, mapIndex, mapCoordX, mapCoordY, cooldown, duration, entranceMapIndex, strengthBonusName, resistanceBonusName, itemVnum, itemCount, finished, fastestTime, highestDamage):
+			status = int(status)
+			waitTime = int(waitTime)
+			type = int(type)
+			organization = int(organization)
+			levelMinLimit = int(levelMinLimit)
+			levelMaxLimit = int(levelMaxLimit)
+			partyMemberMinLimit = int(partyMemberMinLimit)
+			partyMemberMaxLimit = int(partyMemberMaxLimit)
+			mapIndex = int(mapIndex)
+			mapCoordX = int(mapCoordX)
+			mapCoordY = int(mapCoordY)
+			cooldown = int(cooldown)
+			duration = int(duration)
+			entranceMapIndex = int(entranceMapIndex)
+			strengthBonusName = str(strengthBonusName).replace("_", " ")
+			resistanceBonusName = str(resistanceBonusName).replace("_", " ")
+			itemVnum = int(itemVnum)
+			itemCount = int(itemCount)
+			finished = int(finished)
+			fastestTime = int(fastestTime)
+			highestDamage = int(highestDamage)
+
+			osfInfo.dungeonInfo.append(
+				{
+					"status" : status,
+					"wait_time" : waitTime,
+					"type" : type,
+					"organization" : organization,
+					"level_limit" : [levelMinLimit, levelMaxLimit],
+					"party_member_limit" : [partyMemberMinLimit, partyMemberMaxLimit],
+					"map_index" : mapIndex,
+					"map_coords" : [mapCoordX, mapCoordY],
+					"cooldown" : cooldown,
+					"duration" : duration,
+					"entrance_map_index" : entranceMapIndex,
+					"strength_bonus" : strengthBonusName,
+					"resistance_bonus" : resistanceBonusName,
+					"required_item" : [itemVnum, itemCount],
+					"finished" : finished,
+					"fastest_time" : fastestTime,
+					"highest_damage" : highestDamage,
+				},
+			)
+
+		def UpdateDungeonRanking(self, name, level, rankType):
+			name = str(name)
+			level = int(level)
+			rankType = int(rankType)
+
+			osfInfo.dungeonRanking["ranking_list"].append([name, level, rankType],)
+
+		def UpdateMyDungeonRanking(self, position, name, level, rankType):
+			position = int(position)
+			name = str(name)
+			level = int(level)
+			rankType = int(rankType)
+
+			osfInfo.dungeonRanking["my_ranking"].append([position, name, level, rankType],)
+
+		def OpenDungeonRanking(self):
+			import uiDungeonInfo
+			self.DungeonRank = uiDungeonInfo.DungeonRank()
+			self.DungeonRank.Open()
+
+	if app.ENABLE_HIDE_COSTUME_SYSTEM:
+		def SetBodyCostumeHidden(self, hidden):
+			osfInfo.HIDDEN_BODY_COSTUME = int(hidden)
+			self.interface.RefreshVisibleCostume()
+
+		def SetHairCostumeHidden(self, hidden):
+			osfInfo.HIDDEN_HAIR_COSTUME = int(hidden)
+			self.interface.RefreshVisibleCostume()
+
+		def SetAcceCostumeHidden(self, hidden):
+			if app.ENABLE_ACCE_COSTUME_SYSTEM:
+				osfInfo.HIDDEN_ACCE_COSTUME = int(hidden)
+				self.interface.RefreshVisibleCostume()
+			else:
+				pass
+
+		def SetWeaponCostumeHidden(self, hidden):
+			if app.ENABLE_WEAPON_COSTUME_SYSTEM:
+				osfInfo.HIDDEN_WEAPON_COSTUME = int(hidden)
+				self.interface.RefreshVisibleCostume()
+			else:
+				pass
 
-	def BINARY_SetSubMissionMessage(self, message):
-		self.interface.missionBoard.SetSubMission(message)
+	## EVENTS
+	def __LateSummerEvent(self):
+		EnvironmentData = {
+			0:	"d:/ymir work/environment/late_summer.msenv",
+			1:	"d:/ymir work/environment/late_summer.msenv",
+			2:	"d:/ymir work/environment/late_summer.msenv",
+			3:	"d:/ymir work/environment/late_summer.msenv",
+			4:	"d:/ymir work/environment/late_summer.msenv",
+			5:	"d:/ymir work/environment/late_summer.msenv",
+			6:	"d:/ymir work/environment/late_summer.msenv",
+			7:	"d:/ymir work/environment/late_summer.msenv",
+			8:	"d:/ymir work/environment/late_summer.msenv",
+			9:	"d:/ymir work/environment/late_summer.msenv",
+			10:	"d:/ymir work/environment/late_summer.msenv",
+			11:	"d:/ymir work/environment/late_summer.msenv",
+			12:	"d:/ymir work/environment/late_summer.msenv",
+			13:	"d:/ymir work/environment/late_summer.msenv",
+			14:	"d:/ymir work/environment/late_summer.msenv",
+			15:	"d:/ymir work/environment/late_summer.msenv",
+			16:	"d:/ymir work/environment/late_summer.msenv",
+			17:	"d:/ymir work/environment/late_summer.msenv",
+			18:	"d:/ymir work/environment/late_summer.msenv",
+			19:	"d:/ymir work/environment/late_summer.msenv",
+			20:	"d:/ymir work/environment/late_summer.msenv",
+			21:	"d:/ymir work/environment/late_summer.msenv",
+			22:	"d:/ymir work/environment/late_summer.msenv",
+			23:	"d:/ymir work/environment/late_summer.msenv",
+		}
 
-	def BINARY_CleanMissionMessage(self):
-		self.interface.missionBoard.CleanMission()
+		hour = (app.GetGlobalTimeStamp() / 60) / 60 % 24
+		for key, c_pszName in EnvironmentData.iteritems():
+			if hour is key and app.IsExistFile(c_pszName):
+				background.RegisterEnvironmentData(0, c_pszName)
+				background.SetEnvironmentData(0)
+	## END_OF_EVENTS
+
+	def BINARY_RecieveWhisperDetails(self, name, country):
+		if self.interface:
+			self.interface.RecieveWhisperDetails(name, country)
 
 	def BINARY_AppendNotifyMessage(self, type):
 		if not type in localeInfo.NOTIFY_MESSAGE:
@@ -2405,7 +2407,7 @@
 	def __GuildWar_OnAccept(self):
 		guildName = self.guildWarQuestionDialog.GetGuildName()
 
-		net.SendCommandPacket("/war " + guildName)
+		net.SendChatPacket("/war " + guildName)
 		self.__GuildWar_CloseAskDialog()
 
 		return 1
@@ -2413,7 +2415,7 @@
 	def __GuildWar_OnDecline(self):
 		guildName = self.guildWarQuestionDialog.GetGuildName()
 
-		net.SendCommandPacket("/nowar " + guildName)
+		net.SendChatPacket("/nowar " + guildName)
 		self.__GuildWar_CloseAskDialog()
 
 		return 1
@@ -2467,76 +2469,86 @@
 			# END_OF_PRIVATE_SHOP_PRICE_LIST
 		}
 
-		#if app.ENABLE_ACCE_COSTUME_SYSTEM:
-		#	serverCommandList["ShowAcceCombineDialog"] = self.__AcceCombineDialog
-		#	serverCommandList["ShowAcceAbsorbDialog"] = self.__AcceAbsorbDialog
-
-		if app.ENABLE_MOVE_COSTUME_ATTR:
-			serverCommandList["ShowItemCombinationDialog"] = self.__ItemCombinationDialog
-
-		if app.ENABLE_MINI_GAME_RUMI:
-			serverCommandList["mini_game_okey"] = self.__MiniGameOkey
-			serverCommandList["mini_game_okey_normal"] = self.__MiniGameOkeyNormal
+		if app.ENABLE_GEM_SYSTEM:
+			serverCommandList.update({
+				"OpenGuiGem" : self.OpenGuiGem,
+				"GemCheck" : self.GemCheck,
+				"OpenGuiGemMarket" : self.OpenGuiGemMarket,
+				"GemMarketSlotsDesblock" : self.GemMarketSlotsDesblock,
+				"GemMarketItems" : self.GemMarketItems,
+				"GemMarketClear" : self.GemMarketClear,
+				"GemMarketTime" : self.GemTimeMarket,
+			})
+
+		if app.ENABLE_CAPTCHA_SYSTEM:
+			serverCommandList.update({
+				"IsAFKMode" : self.IsAFKMode,
+				"ShowCaptcha" : self.ShowCaptcha,
+			})
+
+		if app.ENABLE_12ZI:
+			serverCommandList.update({
+				"SetMissionMessage" : self.BINARY_SetMissionMessage,
+				"SetSubMissionMessage" : self.BINARY_SetSubMissionMessage,
+				"CleanMissionMessage" : self.BINARY_CleanMissionMessage,
+			})
+
+		if app.ENABLE_DUNGEON_INFO_SYSTEM:
+			serverCommandList.update({
+				"DungeonInfo" : self.DungeonInfo,
+				"CleanDungeonInfo" : self.CleanDungeonInfo,
+				"CleanDungeonRanking" : self.CleanDungeonRanking,
+				"GetDungeonInfo" : self.GetDungeonInfo,
+				"UpdateDungeonInfo" : self.UpdateDungeonInfo,
+				"UpdateDungeonRanking" : self.UpdateDungeonRanking,
+				"UpdateMyDungeonRanking" : self.UpdateMyDungeonRanking,
+				"OpenDungeonRanking" : self.OpenDungeonRanking,
+			})
 
-		if app.ENABLE_MINI_GAME_CATCH_KING:
-			serverCommandList["mini_game_catchking"] = self.__MiniGameCatchKing
-
-		if app.ENABLE_CHANGE_LOOK_SYSTEM:
-			serverCommandList["ShowChangeDialog"] = self.__ChangeWindowOpen
+		if app.ENABLE_HIDE_COSTUME_SYSTEM:
+			serverCommandList.update({
+				"SetBodyCostumeHidden" : self.SetBodyCostumeHidden,
+				"SetHairCostumeHidden" : self.SetHairCostumeHidden,
+				"SetAcceCostumeHidden" : self.SetAcceCostumeHidden,
+				"SetWeaponCostumeHidden" : self.SetWeaponCostumeHidden,
+			})
+
+		if app.ENABLE_EXPRESSING_EMOTION:
+			serverCommandList.update({
+				"RegisterSpecialEmotion" : self.RegisterSpecialEmotion,
+				"ClearSpecialEmotions" : self.ClearSpecialEmotions,
+			})
+
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			serverCommandList.update({
+				"OpenSpecialInventoryWindow" : self.OpenSpecialInventoryWindow,
+			})
 
 		serverCommandList.update({
-			"SetMissionMessage" : self.BINARY_SetMissionMessage,
-			"SetSubMissionMessage" : self.BINARY_SetSubMissionMessage,
-			"CleanMissionMessage" : self.BINARY_CleanMissionMessage,
+			"OpenCostumeWindow" : self.OpenCostumeWindow,
 		})
 
-		serverCommandList["OpenCostumeWindow"] = self.OpenCostumeWindow
-
 		if app.ENABLE_MOVE_CHANNEL:
-			serverCommandList["server_info"] = self.__SeverInfo
+			serverCommandList.update({
+				"ChannelInfo" : self.ChannelInfo
+			})
 
-		if app.ENABLE_REFINE_MSG_ADD:
-			serverCommandList["RefineFailedType"] = self.__RefineFailedTypeMessage
-
-		if app.ENABLE_SKILLBOOK_COMB_SYSTEM:
-			serverCommandList["OpenSkillbookCombinationDialog"] = self.OpenSkillbookCombinationDialog
-
-		if app.ENABLE_MYSHOP_DECO:
-			serverCommandList["OpenMyShopDecoWnd"] = self.__OpenMyShopDecoWnd
-
-		if app.ENABLE_POPUP_NOTICE:
-			serverCommandList["PopupNoticeEventFlag"] = self.__SetPopupNoticeEventFlag
-			serverCommandList["PopupNoticeProcess"] = self.__PopupNoticeProcess
-
-		if app.ENABLE_MINI_GAME_YUTNORI:
-			serverCommandList["mini_game_yutnori"] = self.__MiniGameYutnori
-
-		if app.ENABLE_ATTR_6TH_7TH:
-			serverCommandList["__OpenAttr67AddDlg"] = self.__OpenAttr67AddDlg
+		if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
+			serverCommandList.update({
+				"ClearDragonLairRanking" : self.ClearDragonLairRanking,
+				"OpenDragonLairRanking" : self.OpenDragonLairRanking,
+				"AddDragonLairRanking" : self.AddDragonLairRanking,
+			})
 
 		if app.ENABLE_SOUL_SYSTEM:
 			serverCommandList["RefineSoulSuceeded"] = self.__RefineSoulSuceededMessage
 			serverCommandList["RefineSoulFailed"] = self.__RefineSoulFailedMessage
 
-		if app.ENABLE_SNOWFLAKE_STICK_EVENT:
-			serverCommandList["snowflake_stick_event"] = self.__SnowflakeStickEvent
-
-		if app.ENABLE_HIDE_COSTUME_SYSTEM:
-			serverCommandList["SetHiddenCostumePart"] = self.__SetHiddenCostumePart
-
-		if app.ENABLE_LEFT_SEAT:
-			serverCommandList["OpenLeftSeatDialog"] = self.OpenLeftSeatDialog
-			serverCommandList["CloseLeftSeatDialog"] = self.CloseLeftSeatDialog
-
-		if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
-			serverCommandList["clear_guild_reddragonlair_ranking"] = self.__ClearGuildRedDragonLairRanking
-			serverCommandList["check_reddragonlairranking_board"] = self.__CheckRedDragonLairRanking
-
-		if app.ENABLE_SUMMER_EVENT_ROULETTE:
-			serverCommandList["e_late_summer"] = self.__LateSummerEvent
+		if app.ENABLE_SKILLBOOK_COMB_SYSTEM:
+			serverCommandList["OpenSkillbookCombinationDialog"] = self.OpenSkillbookCombinationDialog
 
-		if app.ENABLE_FLOWER_EVENT:
-			serverCommandList["e_flower_drop"] = self.__FlowerEvent
+		if app.ENABLE_MYSHOP_DECO:
+			serverCommandList["OpenMyShopDecoWnd"] = self.__OpenMyShopDecoWnd
 
 		self.serverCommander = stringCommander.Analyzer()
 		for serverCommandItem in serverCommandList.items():
@@ -2544,10 +2556,6 @@
 				serverCommandItem[0], serverCommandItem[1]
 			)
 
-	if app.ENABLE_CHANGE_LOOK_SYSTEM:
-		def __ChangeWindowOpen(self, type):
-			self.interface.ChangeWindowOpen(type)
-
 	def BINARY_ServerCommand_Run(self, line):
 		#dbg.TraceError(line)
 		try:
@@ -2592,14 +2600,14 @@
 	def RefineSuceededMessage(self):
 		snd.PlaySound("sound/ui/make_soket.wav")
 		self.PopupMessage(localeInfo.REFINE_SUCCESS)
-		if app.ENABLE_REFINE_RENEWAL:
-			self.interface.CheckRefineDialog(False)
+		if app.ENABLE_AUTO_REFINE:
+			self.interface.RefineFail(False)
 
 	def RefineFailedMessage(self):
 		snd.PlaySound("sound/ui/jaeryun_fail.wav")
 		self.PopupMessage(localeInfo.REFINE_FAILURE)
-		if app.ENABLE_REFINE_RENEWAL:
-			self.interface.CheckRefineDialog(True)
+		if app.ENABLE_AUTO_REFINE:
+			self.interface.RefineFail(True)
 
 	if app.ENABLE_SOUL_SYSTEM:
 		def __RefineSoulSuceededMessage(self):
@@ -2610,30 +2618,27 @@
 			snd.PlaySound("sound/ui/jaeryun_fail.wav")
 			self.PopupMessage(localeInfo.SOUL_REFINE_FAILURE)
 
-	if app.ENABLE_REFINE_MSG_ADD:
-		def __RefineFailedTypeMessage(self, value):
-			snd.PlaySound("sound/ui/jaeryun_fail.wav")
+	if app.ENABLE_REFINE_FAIL_TYPE:
+		def BINARY_RefineFailedTypeMessage(self, type):
+			REFINE_FAILURE_DICT = {
+				player.REFINE_FAIL_GRADE_DOWN : localeInfo.REFINE_FAILURE_GRADE_DOWN,
+				player.REFINE_FAIL_DEL_ITEM : localeInfo.REFINE_FAILURE_DEL_ITEM,
+				player.REFINE_FAIL_KEEP_GRADE : localeInfo.REFINE_FAILURE_KEEP_GRADE,
+				player.REFINE_FAIL_MAX : localeInfo.REFINE_FAILURE
+			}
 
-			value = int(value)
-			print "type : ", value
-			print type(value)
-
-			if REFINE_FAIL_GRADE_DOWN == value:
-				self.PopupMessage(localeInfo.REFINE_FAILURE_GRADE_DOWN)
-			elif REFINE_FAIL_DEL_ITEM == value:
-				self.PopupMessage(localeInfo.REFINE_FAILURE_DEL_ITEM)
-			elif REFINE_FAIL_KEEP_GRADE == value:
-				self.PopupMessage(localeInfo.REFINE_FAILURE_KEEP_GRADE)
-			else:
-				self.PopupMessage(localeInfo.REFINE_FAILURE)
+			snd.PlaySound("sound/ui/jaeryun_fail.wav")
+			self.PopupMessage(REFINE_FAILURE_DICT.get(type, player.REFINE_FAIL_MAX))
+			if app.ENABLE_AUTO_REFINE:
+				self.interface.RefineFail(True)
 
 	def CommandCloseSafebox(self):
 		self.interface.CommandCloseSafebox()
 
 	# PRIVATE_SHOP_PRICE_LIST
-	def __PrivateShop_PriceList(self, itemVNum, itemPrice, itemCheque):
+	def __PrivateShop_PriceList(self, itemVNum, itemPrice):
 		if app.ENABLE_CHEQUE_SYSTEM:
-			uiPrivateShopBuilder.SetPrivateShopItemPrice(itemVNum, itemPrice, itemCheque)
+			return
 		else:
 			uiPrivateShopBuilder.SetPrivateShopItemPrice(itemVNum, itemPrice)
 	# END_OF_PRIVATE_SHOP_PRICE_LIST
@@ -2780,47 +2785,38 @@
 	def BINARY_PrivateShop_Disappear(self, vid):
 		self.interface.DisappearPrivateShop(vid)
 
-	if app.ENABLE_MINI_GAME_RUMI:
-		def __MiniGameOkey(self, enable):
-			player.SetMiniGameOkeyNormal(False)
-			if app.ENABLE_EVENT_BANNER:
-				ingameEventSystem.SetInGameEventEnable(ingameEventSystem.INGAME_EVENT_TYPE_OKEY_NORMAL, int(enable))
-
-		def __MiniGameOkeyNormal(self, enable):
-			player.SetMiniGameOkeyNormal(True)
-			if app.ENABLE_EVENT_BANNER:
-				ingameEventSystem.SetInGameEventEnable(ingameEventSystem.INGAME_EVENT_TYPE_OKEY_NORMAL, int(enable))
+	if app.ENABLE_MINI_GAME_OKEY:
+		## MiniGame Rumi
+		def BINARY_Cards_UpdateInfo(self, hand_1, hand_1_v, hand_2, hand_2_v, hand_3, hand_3_v, hand_4, hand_4_v, hand_5, hand_5_v, cards_left, points):
+			self.interface.UpdateCardsInfo(hand_1, hand_1_v, hand_2, hand_2_v, hand_3, hand_3_v, hand_4, hand_4_v, hand_5, hand_5_v, cards_left, points)
 
-			if self.interface:
-				self.interface.SetOkeyNormalBG()
-
-		def MiniGameRumiStart(self):
-			self.interface.MiniGameRumiStart()
-
-		def MiniGameRumiEnd(self):
-			self.interface.MiniGameRumiEnd()
+		def BINARY_Cards_FieldUpdateInfo(self, hand_1, hand_1_v, hand_2, hand_2_v, hand_3, hand_3_v, points):
+			self.interface.UpdateCardsFieldInfo(hand_1, hand_1_v, hand_2, hand_2_v, hand_3, hand_3_v, points)
 
-		def MiniGameRumiMoveCard(self, src_pos, src_index, src_color, src_number, dst_pos, dst_index, dst_color, dst_number):
-			srcCard = (src_pos, src_index, src_color, src_number)
-			dstCard = (dst_pos, dst_index, dst_color, dst_number)
-			self.interface.MiniGameRumiMoveCard(srcCard, dstCard)
+		def BINARY_Cards_PutReward(self, hand_1, hand_1_v, hand_2, hand_2_v, hand_3, hand_3_v, points):
+			self.interface.CardsPutReward(hand_1, hand_1_v, hand_2, hand_2_v, hand_3, hand_3_v, points)
 
-		def MiniGameRumiSetDeckCount(self, deck_card_count):
-			self.interface.MiniGameRumiSetDeckCount(deck_card_count)
+		def BINARY_Cards_ShowIcon(self, active):
+			IsRumiGameEvent = int(active)
+			if IsRumiGameEvent > 0:
+				osfInfo.RUMI_GAME_EVENT = True
+			else:
+				osfInfo.RUMI_GAME_EVENT = False
 
-		def MiniGameRumiIncreaseScore(self, score, total_score):
-			self.interface.MiniGameRumiIncreaseScore(score, total_score)
+			if osfInfo.EVENT_BANNER == True:
+				self.interface.IntegrationEventBanner()
+			else:
+				self.interface.MiniGameOkey()
 
-		if app.ENABLE_OKEY_EVENT_FLAG_RENEWAL:
-			def MiniGameRumiFlagProcess(self, process_type, data):
-				self.interface.MiniGameRumiFlagProcess(process_type, data)
+		def BINARY_Cards_Open(self, safemode):
+			self.interface.OpenCardsWindow(safemode)
 
 	if app.ENABLE_MINI_GAME_CATCH_KING:
-		def __MiniGameCatchKing(self, enable):
-			if app.ENABLE_EVENT_BANNER:
-				ingameEventSystem.SetInGameEventEnable(ingameEventSystem.INGAME_EVENT_TYPE_CATCHKING, int(enable))
-			else:
-				pass
+		def MiniGameCatchKingEvent(self, isEnable):
+			if self.interface:
+				self.interface.SetCatchKingEventStatus(isEnable)
+				if osfInfo.EVENT_BANNER == True:
+					self.interface.IntegrationEventBanner()
 
 		def MiniGameCatchKingEventStart(self, bigScore):
 			self.interface.MiniGameCatchKingEventStart(bigScore)
@@ -2837,10 +2833,6 @@
 		def MiniGameCatchKingReward(self, rewardCode):
 			self.interface.MiniGameCatchKingReward(rewardCode)
 
-		if app.ENABLE_CATCH_KING_EVENT_FLAG_RENEWAL:
-			def CatchKingFlagProcess(self, type, data):
-				self.interface.CatchKingFlagProcess(type, data)
-
 	## DayMode
 	def __PRESERVE_DayMode_Update(self, mode):
 		if "light" == mode:
@@ -2865,12 +2857,13 @@
 
 	def __DayMode_Update(self, mode):
 		if "light" == mode:
-			if app.ENABLE_ENVIRONMENT_EFFECT_OPTION:
-				if not background.IsBoomMap():
-					return
-				else:
-					if not self.__IsXMasMap():
+			if app.ENABLE_12ZI:
+				if app.ENABLE_ENVIRONMENT_EFFECT_OPTION:
+					if not background.IsBoomMap():
 						return
+					else:
+						if not self.__IsXMasMap():
+							return
 
 			self.curtain.SAFE_FadeOut(self.__DayMode_OnCompleteChangeToLight)
 		elif "dark" == mode:
@@ -2914,7 +2907,7 @@
 
 		snd.PlaySound3D(x+randX, -y+randY, z, "sound/common/etc/salute.mp3")
 
-	if app.ENABLE_NEW_USER_CARE:
+	if app.WJ_NEW_USER_CARE:
 		def __PartyRequestQuestion(self, vid, name):
 			vid = int(vid)
 			partyRequestQuestionDialog = uiCommon.QuestionDialogWithTimeLimit()
@@ -2947,9 +2940,9 @@
 		vid = self.partyRequestQuestionDialog.vid
 
 		if answer:
-			net.SendCommandPacket("/party_request_accept " + str(vid))
+			net.SendChatPacket("/party_request_accept " + str(vid))
 		else:
-			net.SendCommandPacket("/party_request_deny " + str(vid))
+			net.SendChatPacket("/party_request_deny " + str(vid))
 
 		self.partyRequestQuestionDialog.Close()
 		self.partyRequestQuestionDialog = None
@@ -3002,213 +2995,56 @@
 
 	# END_OF_WEDDING
 
-	if app.ENABLE_POPUP_NOTICE:
-		def __SetPopupNoticeEventFlag(self, flag_value):
-			self.interface.SetPopupNoticeEventFlag(int(flag_value))
-
-		def __PopupNoticeProcess(self, is_checked, url):
-			self.interface.PopupNoticeProcess(int(is_checked), url)
-
-	if app.ENABLE_ACCE_COSTUME_SYSTEM:
-		def OpenAcceWindow(self, type):
-			self.interface.AcceDialogOpen(type)
-
-		def CloseAcceWindow(self):
-			self.interface.AcceDialogClose()
-
-	if app.ENABLE_AURA_COSTUME_SYSTEM:
-		def OpenAuraWindow(self, type):
-			self.interface.AuraDialogOpen(type)
-
-		def CloseAuraWindow(self):
-			self.interface.AuraDialogClose()
-
-	if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
-		## HilightSlot Change
-		def DeactivateSlot(self, slotindex, type):
-			self.interface.DeactivateSlot(slotindex, type)
-
-		## HilightSlot Change
-		def ActivateSlot(self, slotindex, type):
-			self.interface.ActivateSlot(slotindex, type)
-
-	if app.ENABLE_MOVE_COSTUME_ATTR:
-		def __ItemCombinationDialog(self):
-			self.interface.ItemCombinationDialogOpen()
-	else:
-		def __ItemCombinationDialog(self):
-			return
-
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		def ExInvenItemUseMsg(self, item_vnum, msg, enough_count):
-			self.interface.ExInvenItemUseMsg(item_vnum, msg, enough_count)
-
-	if app.ENABLE_CHANGED_ATTR:
-		def OpenSelectAttrDialog(self, window_type, slotIdx):
-			self.interface.OpenSelectAttrDialog(window_type, slotIdx)
-
-	if app.ENABLE_RANKING_SYSTEM:
-		def OpenRankingBoard(self, type, category):
-			self.interface.OpenRankingBoardWindow(type, category)
-
-	if app.ENABLE_MAILBOX:
-		def MailBoxProcess(self, type, data):
-			if self.interface:
-				self.interface.MailBoxProcess(type, data)
-
-	if app.ENABLE_LOOTING_SYSTEM:
-		def LootingSystemProcess(self):
-			if self.interface:
-				self.interface.LootingSystemProcess()
-
-	if app.ENABLE_MINI_GAME_YUTNORI:
-		def __MiniGameYutnori(self, enable):
-			if app.ENABLE_EVENT_BANNER:
-				ingameEventSystem.SetInGameEventEnable(ingameEventSystem.INGAME_EVENT_TYPE_YUTNORI, int(enable))
-			else:
-				pass
-
-		def YutnoriProcess(self, type, data):
-			if self.interface:
-				self.interface.YutnoriProcess(type, data)
-
-		def YutnoriFlagProcess(self, type, data):
-			if self.interface:
-				self.interface.YutnoriFlagProcess(type, data)
-
-	if app.ENABLE_LUCKY_BOX:
-		def ShowLuckyBoxWindow(self, dwItemVnum, byItemCount, iNeedMoney, wSlotIndex):
-			if self.interface:
-				self.interface.ShowLuckyBoxWindow(dwItemVnum, byItemCount, iNeedMoney, wSlotIndex)
-
-	if app.ENABLE_ATTR_6TH_7TH:
-		def __OpenAttr67AddDlg(self):
+	if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
+		def ClearDragonLairRanking(self, type):
 			if self.interface:
-				self.interface.OpenAttr67AddDlg()
+				self.interface.ClearDragonLairRanking(int(type))
 
-	if app.ENABLE_FISHING_GAME:
-		def OnFishingGameStart(self, level):
+		def OpenDragonLairRanking(self, type):
 			if self.interface:
-				self.interface.OpenFishingGameWindow(level)
+				self.interface.OpenDragonLairRanking(int(type))
 
-		def OnFishingStopGame(self):
+		def AddDragonLairRanking(self, type, data):
 			if self.interface:
-				self.interface.CloseFishingGameWindow()
-
-	if app.ENABLE_CLIENT_TIMER:
-		def ClientTimerProcess(self, type, data = None):
-			self.interface.wndMiniMap.ClientTimerProcess(type, data)
-
-	if app.ENABLE_SKILL_COOLTIME_UPDATE:
-		def SkillClearCoolTime(self, slotIndex):
-			self.interface.SkillClearCoolTime(slotIndex)
-
-	if app.ENABLE_EXPRESSING_EMOTION:
-		def AddSpecialActionSlot(self, byType, dwDuration):
-			self.interface.AddSpecialActionSlot(byType, dwDuration)
-
-		def RemoveSpecialActionSlot(self, iIndex):
-			self.interface.RemoveSpecialActionSlot(iIndex)
+				line = int(data.split("#")[1])
+				guildname = str(data.split("#")[2])
+				membercount = int(data.split("#")[3])
+				sec = int(data.split("#")[4])
+				min = int(sec / 60)
+				sec %= 60
 
-		def RemoveQuickSlotIndex(self, iIndex):
-			self.interface.RemoveQuickSlotIndex(iIndex)
+				self.interface.AddDragonLairRanking(int(type), guildname, membercount, min, sec)
 
-	if app.ENABLE_SNOWFLAKE_STICK_EVENT:
-		def __SnowflakeStickEvent(self, end_time):
-			player.SetSnowflakeStickEvent(int(end_time))
-
-			if app.ENABLE_EVENT_BANNER:
-				ingameEventSystem.SetInGameEventEnable(ingameEventSystem.INGAME_EVENT_TYPE_SNOWFLAKE_STICK_EVENT, int(end_time))
-
-		def SnowflakeStickEventProcess(self, type, data):
+	if app.ENABLE_ACCE_COSTUME_SYSTEM:
+		def ActAcce(self, iAct, bWindow):
 			if self.interface:
-				self.interface.SnowflakeStickEventProcess(type, data)
+				self.interface.ActAcce(iAct, bWindow)
 
-	if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-		def RefineElementProcess(self, type, refine_type, data):
-			if self.interface:
-				self.interface.RefineElementProcess(type, refine_type, data)
+		def AlertAcce(self, bWindow):
+			snd.PlaySound("sound/ui/make_soket.wav")
+			if bWindow:
+				self.PopupMessage(localeInfo.ACCE_DEL_SERVEITEM)
+			else:
+				self.PopupMessage(localeInfo.ACCE_DEL_ABSORDITEM)
 
-	if app.ENABLE_HIDE_COSTUME_SYSTEM:
-		def __SetHiddenCostumePart(self, part, hidden):
+	if app.ENABLE_CHANGE_LOOK_SYSTEM:
+		def ActChangeLook(self, iAct):
 			if self.interface:
-				self.interface.SetHiddenCostumePart(int(part), int(hidden))
+				self.interface.ActChangeLook(iAct)
 
-	if app.ENABLE_EVENT_BANNER:
-		def RefreshInGameEvent(self):
-			if self.interface:
-				self.interface.RefreshInGameEvent()
+		def AlertChangeLook(self):
+			self.PopupMessage(localeInfo.CHANGE_LOOK_DEL_ITEM)
 
-	if app.ENABLE_LOCALE_CLIENT:
-		def LanguageChange(self):
-			if self.interface:
-				self.interface.LanguageChange()
+	if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+		def OpenPShopSearchDialogCash(self):
+			self.interface.OpenPShopSearchDialogCash()
+		def RefreshPShopSearchDialog(self):
+			self.interface.RefreshPShopSearchDialog()
 
-	if app.ENABLE_LEFT_SEAT:
-		def LoadLeftSeatWaitTimeIndexData(self):
+	if app.ENABLE_MAILBOX:
+		def MailBoxProcess(self, type, data):
 			if self.interface:
-				self.interface.LoadLeftSeatWaitTimeIndexData()
-
-		def OpenLeftSeatDialog(self):
-			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.LEFT_SEAT_STATE_ON)
-
-			self.left_seat_dialog = uiCommon.PopupDialog()
-			self.left_seat_dialog.SetText(localeInfo.LEFT_SEAT_RELEASE_ASK)
-			self.left_seat_dialog.SetAcceptEvent(ui.__mem_func__(self.__ReleaseLeftSeat))
-
-			w, h = self.left_seat_dialog.GetTextSize()
-			self.left_seat_dialog.SetWidth(w + 60)
-
-			self.left_seat_dialog.Open()
-
-		def CloseLeftSeatDialog(self):
-			if self.left_seat_dialog:
-				self.left_seat_dialog.Close()
-
-		def __ReleaseLeftSeat(self):
-			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.LEFT_SEAT_STATE_OFF)
-			net.DisableLeftSeatLogOutState()
-
-	if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
-		def __ClearGuildRedDragonLairRanking(self):
-			guild.ClearDragonLairRanking(guild.GUILD_DRAGONLAIR_TYPE_RED)
-
-		def __CheckRedDragonLairRanking(self):
-			if guild.CheckDragonLairRanking(guild.GUILD_DRAGONLAIR_TYPE_RED) == 0:
-				self.interface.RefreshGuildDragonLairRanking(guild.GUILD_DRAGONLAIR_TYPE_RED)
-				self.interface.OpenGuildDragonLairRanking(guild.GUILD_DRAGONLAIR_TYPE_RED)
-
-		def OpenGuildDragonLairRanking(self, type):
-			self.interface.OpenGuildDragonLairRanking(type)
-
-		def RefreshGuildDragonLairRanking(self, type):
-			self.interface.RefreshGuildDragonLairRanking(type)
-
-		if app.ENABLE_GUILD_DRAGONLAIR_PARTY_SYSTEM:
-			def SetGuildDragonLairFistGuildText(self, second):
-				self.interface.SetGuildDragonLairFistGuildText(second)
-			def SetGuildDragonLairStart(self):
-				self.interface.SetGuildDragonLairStart()
-			def SetGuildDragonLairSuccess(self):
-				self.interface.SetGuildDragonLairSuccess()
-
-	if app.ENABLE_SUMMER_EVENT_ROULETTE:
-		def __LateSummerEvent(self, enable):
-			background.SetLateSummerEvent(int(enable))
-			if app.ENABLE_EVENT_BANNER:
-				ingameEventSystem.SetInGameEventEnable(ingameEventSystem.INGAME_EVENT_TYPE_ROULETTE, int(enable))
-
-		def RouletteProcess(self, type, data = None):
-			self.interface.RouletteProcess(type, data)
-
-	if app.ENABLE_FLOWER_EVENT:
-		def __FlowerEvent(self, enable):
-			player.SetFlowerEventEnable(int(enable))
-			if app.ENABLE_EVENT_BANNER:
-				ingameEventSystem.SetInGameEventEnable(ingameEventSystem.INGAME_EVENT_TYPE_FLOWER_EVENT, int(enable))
-
-		def FlowerEventProcess(self, type, data = None):
-			self.interface.FlowerEventProcess(type, data)
+				self.interface.MailBoxProcess( type, data )
 
 	if app.ENABLE_GROWTH_PET_SYSTEM:
 		def PetHatchingWindowCommand(self, command):
@@ -3237,6 +3073,6 @@
 			
 		def PetReviveResult(self, result):
 			self.interface.PetReviveResult(result)
-			
-		def PetWindowTypeResult(self, result):
+
+		def PetWindowTypeResult(self, result): #checked
 			self.interface.PetWindowTypeResult(result)
diff -ruN client_base/client/client/pack/root/interfacemodule.py client_final/client/client/pack/root/interfacemodule.py
--- client_base/client/client/pack/root/interfacemodule.py	2026-02-20 12:28:54.000000000 +0000
+++ client_final/client/client/pack/root/interfacemodule.py	2026-02-20 18:13:16.291430071 +0000
@@ -11,8 +11,7 @@
 import uiTaskBar
 import uiCharacter
 import uiInventory
-if app.ENABLE_DRAGON_SOUL_SYSTEM:
-	import uiDragonSoul
+import uiDragonSoul
 import uiChat
 import uiMessenger
 import guild
@@ -37,85 +36,56 @@
 import uiEquipmentDialog
 import uiGameButton
 import uiTip
-if app.ENABLE_CUBE_RENEWAL:
-	import uiCubeRenewal
-else:
-	import uiCube
+import uiCube
 import miniMap
 # ACCESSORY_REFINE_ADD_METIN_STONE
 import uiselectitem
+# END_OF_ACCESSORY_REFINE_ADD_METIN_STONE
 if app.ENABLE_GEM_SYSTEM:
 	import uiselectitemEx
-# END_OF_ACCESSORY_REFINE_ADD_METIN_STONE
-
 import uiScriptLocale
 import event
 import localeInfo
 import item
-if app.ENABLE_QUEST_RENEWAL:
-	import quest
-
 if app.ENABLE_SKILLBOOK_COMB_SYSTEM:
 	import uiSkillBookCombination
-
 if app.ENABLE_ACCE_COSTUME_SYSTEM:
 	import uiAcce
 
-if app.ENABLE_AURA_COSTUME_SYSTEM:
-	import uiAura
-
-if app.ENABLE_MOVE_COSTUME_ATTR:
-	import uiItemCombination
-
-if app.ENABLE_CHANGED_ATTR:
-	import uiSelectAttr
-
-if app.ENABLE_ATTR_6TH_7TH:
-	import uiAttr67Add
-
-if app.ENABLE_EVENT_BANNER:
-	import uiMiniGame
-
-if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
-	import uiGuildDragonLairRanking
-
 if app.ENABLE_CHANGE_LOOK_SYSTEM:
 	import uiChangeLook
-	import shop
 
-if app.ENABLE_RANKING_SYSTEM:
-	import uiRankingBoard
+if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+	import uiSpecialInventory
 
-if app.ENABLE_MYSHOP_DECO:
-	import uiMyShopDecoration
+import uiMiniGame
+
+if app.ENABLE_MINI_GAME_OKEY:
+	import uiMiniGameRumi
 
 if app.ENABLE_GEM_SYSTEM:
 	import uiGemShop
 
-if app.ENABLE_MAILBOX:
-	import uiMailBox
-
-if app.ENABLE_LOOTING_SYSTEM:
-	import uiLootingSystem
-
-if app.ENABLE_POPUP_NOTICE:
-	import uiPopupNotice
+if app.ENABLE_DUNGEON_INFO_SYSTEM:
+	import uiDungeonInfo
 
-if app.ENABLE_LUCKY_BOX:
-	import uiLuckyBox
+if app.ENABLE_CAPTCHA_SYSTEM:
+	import uiCaptcha
 
-if app.ENABLE_FISHING_GAME:
-	import uiFishingGame
+if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+	import uiPrivateShopSearch
 
-if app.ENABLE_GAME_OPTION_ESCAPE:
-	import uiEscapePopup
+if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
+	import uiGuildDragonLairRanking
 
-if app.ENABLE_EXTENDED_BATTLE_PASS:
-	import uiBattlePassExtended
-	import net
+if app.ENABLE_MYSHOP_DECO:
+	import uiMyShopDecoration
+import uiPrivateShop
 
 if app.ENABLE_GROWTH_PET_SYSTEM:
-	import uiPetInfo
+	import uiPetInfo 
+if app.ENABLE_MAILBOX:
+	import uiMailBox
 
 IsQBHide = 0
 IsWisperHide = 0
@@ -132,10 +102,8 @@
 		self.tipBoard = None
 		self.bigBoard = None
 
-		if app.ENABLE_OX_RENEWAL:
-			self.bigBoardControl = None
-
-		self.missionBoard = None
+		if app.ENABLE_12ZI:
+			self.missionBoard = None
 
 		# ITEM_MALL
 		self.mallPageDlg = None
@@ -145,8 +113,6 @@
 		self.wndTaskBar = None
 		self.wndCharacter = None
 		self.wndInventory = None
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.wndEquipment = None
 		self.wndExpandedTaskBar = None
 		self.wndDragonSoul = None
 		self.wndDragonSoulRefine = None
@@ -161,11 +127,6 @@
 			self.dlgExchange = None
 			self.privateShopBuilder = None
 			self.wndSafebox = None
-		if app.ENABLE_MOVE_COSTUME_ATTR:
-			self.wndItemCombination = None
-		if app.ENABLE_EXTENDED_BATTLE_PASS:
-			self.wndBattlePassExtended = None
-			self.isFirstOpeningExtBattlePass = False
 		self.listGMName = {}
 		self.wndQuestWindow = {}
 		self.wndQuestWindowNewKey = 0
@@ -176,54 +137,29 @@
 		if app.ENABLE_SKILLBOOK_COMB_SYSTEM:
 			self.wndSkillBookCombination = None
 
-		if app.ENABLE_CHANGED_ATTR:
-			self.wndSelectAttr = None
-
-		if app.ENABLE_ATTR_6TH_7TH:
-			self.wndAttr67Add = None
-
 		if app.ENABLE_MYSHOP_DECO:
 			self.wndMyShopDeco = None
 
-		if app.ENABLE_EVENT_BANNER:
-			self.wndMiniGame = None
-
-		if app.ENABLE_ACCE_COSTUME_SYSTEM:
-			self.wndAcce = None
-
-		if app.ENABLE_AURA_COSTUME_SYSTEM:
-			self.wndAura = None
-
-		if app.ENABLE_CHANGE_LOOK_SYSTEM:
-			self.wndChangeLook = None
-
-		if app.ENABLE_RANKING_SYSTEM:
-			self.wndRankingBoardWindow = None
+		self.wndMiniGame = None
 
 		if app.ENABLE_GEM_SYSTEM:
 			self.wndExpandedMoneyTaskBar = None
-			self.wndGemShop = None
-
-		if app.ENABLE_MAILBOX:
-			self.mail_box = None
 
-		if app.ENABLE_LOOTING_SYSTEM:
-			self.wndLootFilter = None
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			self.wndSpecialInventory = None
 
-		if app.ENABLE_LUCKY_BOX:
-			self.wndLuckyBox = None
+		if app.ENABLE_DUNGEON_INFO_SYSTEM:
+			self.wndDungeonInfo = None
 
-		if app.ENABLE_FISHING_GAME:
-			self.wndFishingGame = None
+		if app.ENABLE_CAPTCHA_SYSTEM:
+			self.wndCaptcha = None
 
-		if app.ENABLE_GAME_OPTION_ESCAPE:
-			self.wndEscapePopup = None
+		if app.ENABLE_MAILBOX:
+			self.mail_box = None
 
 		event.SetInterfaceWindow(self)
 		self.uiAffectshower = None
 		self.uitargetBoard = None
-		if app.ENABLE_DEFENSE_WAVE:
-			self.uiAllianceTargetBoard = None
 		self.IsHideUiMode = False
 
 	def __del__(self):
@@ -245,7 +181,7 @@
 			self.wndMessenger.BindInterface(self)
 
 		from _weakref import proxy
-		self.wndMessenger.SetWhisperButtonEvent(lambda n, i = proxy(self) : i.OpenWhisperDialog(n))
+		self.wndMessenger.SetWhisperButtonEvent(lambda n,i=proxy(self):i.OpenWhisperDialog(n))
 		self.wndMessenger.SetGuildButtonEvent(ui.__mem_func__(self.ToggleGuildWindow))
 
 	def __MakeGuildWindow(self):
@@ -273,13 +209,18 @@
 		self.wndTaskBar.SetToggleButtonEvent(uiTaskBar.TaskBar.BUTTON_INVENTORY, ui.__mem_func__(self.ToggleInventoryWindow))
 		self.wndTaskBar.SetToggleButtonEvent(uiTaskBar.TaskBar.BUTTON_MESSENGER, ui.__mem_func__(self.ToggleMessenger))
 		self.wndTaskBar.SetToggleButtonEvent(uiTaskBar.TaskBar.BUTTON_SYSTEM, ui.__mem_func__(self.ToggleSystemDialog))
-		if app.ENABLE_EXTENDED_BATTLE_PASS:
-			self.wndTaskBar.SetToggleButtonEvent(uiTaskBar.TaskBar.BUTTON_BATTLEPASS, ui.__mem_func__(self.ToggleBattlePassExtended))
 		if uiTaskBar.TaskBar.IS_EXPANDED:
 			self.wndTaskBar.SetToggleButtonEvent(uiTaskBar.TaskBar.BUTTON_EXPAND, ui.__mem_func__(self.ToggleExpandedButton))
 			self.wndExpandedTaskBar = uiTaskBar.ExpandedTaskBar()
 			self.wndExpandedTaskBar.LoadWindow()
 			self.wndExpandedTaskBar.SetToggleButtonEvent(uiTaskBar.ExpandedTaskBar.BUTTON_DRAGON_SOUL, ui.__mem_func__(self.ToggleDragonSoulWindow))
+			if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+				self.wndExpandedTaskBar.SetToggleButtonEvent(uiTaskBar.ExpandedTaskBar.BUTTON_SPECIAL_INVENTORY, ui.__mem_func__(self.ToggleSpecialInventoryWindow))
+
+			if app.ENABLE_GROWTH_PET_SYSTEM:
+				self.PetInformationActivate()
+				self.wndExpandedTaskBar.SetToggleButtonEvent(uiTaskBar.ExpandedTaskBar.BUTTON_PET_INFO, ui.__mem_func__(self.TogglePetInformationWindow))
+
 		else:
 			self.wndTaskBar.SetToggleButtonEvent(uiTaskBar.TaskBar.BUTTON_CHAT, ui.__mem_func__(self.ToggleChat))
 
@@ -301,31 +242,6 @@
 		wndParty.Hide()
 		self.wndParty = wndParty
 
-	if app.ENABLE_POPUP_NOTICE:
-		def __MakePopupNoticeWindow(self):
-			wndPopupNotice = uiPopupNotice.PopupNoticeWindow()
-			wndPopupNotice.BindInterface(self)
-			wndPopupNotice.LoadWindow()
-			wndPopupNotice.Hide()
-			self.wndPopupNotice = wndPopupNotice
-
-		def __OnClickPopupNoticeUIOpen(self):
-			if self.wndPopupNotice:
-				self.wndPopupNotice.OnClickPopupNoticeUIOpen()
-
-		def IsPopUpNoticeUIOpen(self):
-			if self.wndPopupNotice and self.wndPopupNotice.IsShow():
-				return True
-			return False
-
-		def SetPopupNoticeEventFlag(self, flag_value):
-			if self.wndPopupNotice:
-				self.wndPopupNotice.SetPopupNoticeEventFlag(flag_value)
-
-		def PopupNoticeProcess(self, is_checked, url):
-			if self.wndPopupNotice:
-				self.wndPopupNotice.PopupNoticeProcess(is_checked, url)
-
 	def __MakeGameButtonWindow(self):
 		wndGameButton = uiGameButton.GameButtonWindow()
 		wndGameButton.SetTop()
@@ -335,14 +251,8 @@
 		wndGameButton.SetButtonEvent("QUEST", ui.__mem_func__(self.__OnClickQuestButton))
 		wndGameButton.SetButtonEvent("HELP", ui.__mem_func__(self.__OnClickHelpButton))
 		wndGameButton.SetButtonEvent("BUILD", ui.__mem_func__(self.__OnClickBuildButton))
-		if app.ENABLE_POPUP_NOTICE:
-			wndGameButton.SetButtonEvent("POPUP_NOTICE", ui.__mem_func__(self.__OnClickPopupNoticeUIOpen))
 
 		self.wndGameButton = wndGameButton
-		if app.ENABLE_POPUP_NOTICE:
-			if self.wndPopupNotice:
-				self.wndPopupNotice.BindGameButtonWindow(self.wndGameButton)
-				self.wndGameButton.BindPopupNoticeWindow(self.wndPopupNotice)
 
 	def __IsChatOpen(self):
 		return True
@@ -353,13 +263,6 @@
 		self.wndInventory = uiInventory.InventoryWindow()
 		self.wndInventory.BindInterfaceClass(self)
 
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.wndEquipment = uiInventory.EquipmentWindow()
-			self.wndEquipment.BindInterface(self)
-
-			self.wndEquipment.BindInventoryWindow(self.wndInventory)
-			self.wndInventory.BindEquipmentWindow(self.wndEquipment)
-
 		if app.ENABLE_DRAGON_SOUL_SYSTEM:
 			self.wndDragonSoul = uiDragonSoul.DragonSoulWindow()
 			self.wndDragonSoul.BindInterfaceClass(self)
@@ -369,47 +272,22 @@
 			wndDragonSoulRefine = None
 
 		self.wndMiniMap = uiMiniMap.MiniMap()
-		self.wndMiniMap.BindInterface(self)
-
+		if app.ENABLE_DUNGEON_INFO_SYSTEM:
+			self.wndMiniMap.BindInterfaceClass(self)
 		self.wndSafebox = uiSafebox.SafeboxWindow()
 		if app.WJ_ENABLE_TRADABLE_ICON:
 			self.wndSafebox.BindInterface(self)
 
-		if app.ENABLE_RANKING_SYSTEM:
-			self.wndRankingBoardWindow = uiRankingBoard.RankingBoardWindow()
-
-		if app.ENABLE_MYSHOP_DECO:
-			self.wndMyShopDeco = uiMyShopDecoration.MyShopDecoration()
-
-		self.wndMall = uiSafebox.MallWindow()
-
 		if app.ENABLE_SKILLBOOK_COMB_SYSTEM:
 			self.wndSkillBookCombination = uiSkillBookCombination.SkillBookCombinationWindow()
 
-		if app.ENABLE_CHANGED_ATTR:
-			self.wndSelectAttr = uiSelectAttr.SelectAttrWindow()
-
-		if app.ENABLE_ACCE_COSTUME_SYSTEM:
-			self.wndAcce = uiAcce.AcceWindow()
-
-		if app.ENABLE_CHANGE_LOOK_SYSTEM:
-			self.wndChangeLook = uiChangeLook.ChangeLookWindow()
-
-		if app.ENABLE_MOVE_COSTUME_ATTR:
-			wndItemCombination = uiItemCombination.ItemCombinationWindow()
-			wndItemCombination.BindInterface(self)
-			self.wndItemCombination = wndItemCombination
+		if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+			self.wndPrivateShopSearch = uiPrivateShopSearch.PrivateShopSeachWindow()
 
-		if app.ENABLE_GEM_SYSTEM:
-			self.wndGemShop = uiGemShop.GemShopWindow()
-
-		if app.ENABLE_ATTR_6TH_7TH:
-			wndAttr67Add = uiAttr67Add.Attr67AddWindow()
-			if app.WJ_ENABLE_TRADABLE_ICON:
-				wndAttr67Add.BindInterface(self)
-				wndAttr67Add.SetInven(self.wndInventory)
-			self.wndAttr67Add = wndAttr67Add
+		if app.ENABLE_MYSHOP_DECO:
+			self.wndMyShopDeco = uiMyShopDecoration.MyShopDecoration()
 
+		self.wndMall = uiSafebox.MallWindow()
 		wndChatLog = uiChat.ChatLogWindow()
 		wndChatLog.BindInterface(self)
 		self.wndChatLog = wndChatLog
@@ -419,38 +297,22 @@
 			self.wndDragonSoulRefine.SetInventoryWindows(self.wndInventory, self.wndDragonSoul)
 			self.wndInventory.SetDragonSoulRefineWindow(self.wndDragonSoulRefine)
 
-		if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
-			self.wndGuildDragonLairRanking = uiGuildDragonLairRanking.GuildDragonLairRankingDialog()
-
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			self.wndSpecialInventory = uiSpecialInventory.SpecialInventoryWindow()
+			self.wndSpecialInventory.BindInterfaceClass(self)
+
+		if app.ENABLE_DUNGEON_INFO_SYSTEM:
+			self.wndDungeonInfo = uiDungeonInfo.DungeonInfoWindow()
+
+		if app.ENABLE_CAPTCHA_SYSTEM:
+			self.wndCaptcha = uiCaptcha.CaptchaDialog()
+			self.wndCaptcha.BindInterface(self)
 		if app.ENABLE_MAILBOX:
 			self.mail_box = uiMailBox.MailBox()
 			self.mail_box.BindInterface(self)
 			self.mail_box.SetInven(self.wndInventory)
 			self.mail_box.SetDSWindow(self.wndDragonSoul)
 
-		if app.ENABLE_AURA_COSTUME_SYSTEM:
-			self.wndAura = uiAura.AuraWindow()
-
-		if app.ENABLE_LOOTING_SYSTEM:
-			self.wndLootFilter = uiLootingSystem.LootingSystem()
-
-		if app.ENABLE_LUCKY_BOX:
-			self.wndLuckyBox = uiLuckyBox.LuckyBoxWindow()
-			if app.WJ_ENABLE_TRADABLE_ICON:
-				self.wndLuckyBox.BindInterface(self)
-				self.wndLuckyBox.SetInven(self.wndInventory)
-
-		if app.ENABLE_FISHING_GAME:
-			self.wndFishingGame = uiFishingGame.FishGame()
-
-		if app.ENABLE_EVENT_BANNER:
-			self.wndMiniGame = uiMiniGame.MiniGameWindow()
-			self.wndMiniGame.BindInterface(self)
-			self.wndMiniGame.SetInven(self.wndInventory)
-
-		if app.ENABLE_EXTENDED_BATTLE_PASS:
-			self.wndBattlePassExtended = uiBattlePassExtended.BattlePassWindow()
-
 		if app.ENABLE_GROWTH_PET_SYSTEM:
 			self.wndPetInfoWindow = uiPetInfo.PetInformationWindow()
 			self.wndPetInfoWindow.BindInterfaceClass(self)
@@ -476,6 +338,9 @@
 			self.dlgShop.BindInterface(self)
 		self.dlgShop.Hide()
 
+		self.dlgPrivateShop = uiPrivateShop.PrivateShopDialog()
+		self.dlgPrivateShop.Hide()
+
 		self.dlgRestart = uiRestart.RestartDialog()
 		self.dlgRestart.LoadDialog()
 		self.dlgRestart.Hide()
@@ -483,8 +348,6 @@
 		self.dlgSystem = uiSystem.SystemDialog()
 		self.dlgSystem.LoadDialog()
 		self.dlgSystem.SetOpenHelpWindowEvent(ui.__mem_func__(self.OpenHelpWindow))
-		if app.ENABLE_LOOTING_SYSTEM or app.ENABLE_GAME_OPTION_ESCAPE or app.ENABLE_LEFT_SEAT:
-			self.dlgSystem.BindInterface(self)
 
 		self.dlgSystem.Hide()
 
@@ -516,17 +379,6 @@
 			self.tooltipPetSkill = uiToolTip.PetSkillToolTip()
 			self.tooltipPetSkill.Hide()
 
-		if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-			self.dlgRefineElement = uiRefine.RefineElementDialog()
-			if app.WJ_ENABLE_TRADABLE_ICON:
-				self.dlgRefineElement.SetInven(self.wndInventory)
-			self.dlgRefineElement.Hide()
-
-			self.dlgRefineElementChange = uiRefine.RefineElementChangeDialog()
-			if app.WJ_ENABLE_TRADABLE_ICON:
-				self.dlgRefineElementChange.SetInven(self.wndInventory)
-			self.dlgRefineElementChange.Hide()
-
 	def __MakeHelpWindow(self):
 		self.wndHelp = uiHelp.HelpWindow()
 		self.wndHelp.LoadDialog()
@@ -540,12 +392,9 @@
 		self.bigBoard = uiTip.BigBoard()
 		self.bigBoard.Hide()
 
-		if app.ENABLE_OX_RENEWAL:
-			self.bigBoardControl = uiTip.BigBoardControl()
-			self.bigBoardControl.Hide()
-
-		self.missionBoard = uiTip.MissionBoard()
-		self.missionBoard.Hide()
+		if app.ENABLE_12ZI:
+			self.missionBoard = uiTip.MissionBoard()
+			self.missionBoard.Hide()
 
 	def __MakeWebWindow(self):
 		if constInfo.IN_GAME_SHOP_ENABLE:
@@ -554,21 +403,80 @@
 			self.wndWeb.LoadWindow()
 			self.wndWeb.Hide()
 
+	if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
+		def __MakeGuildDragonLairRanking(self):
+			self.wndGuildDragonLairRanking = uiGuildDragonLairRanking.GuildDragonLairRankingDialog()
+			self.wndGuildDragonLairRanking.Hide()
+
+	if app.ENABLE_ACCE_COSTUME_SYSTEM:
+		def __MakeAcceWindow(self):
+			self.wndAcceCombine = uiAcce.CombineWindow()
+			self.wndAcceCombine.LoadWindow()
+			if app.WJ_ENABLE_TRADABLE_ICON:
+				self.wndAcceCombine.BindInterface(self)
+				if self.wndInventory:
+					self.wndAcceCombine.SetInven(self.wndInventory)
+				if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+					if self.wndSpecialInventory:
+						self.wndAcceCombine.SetSpecialInven(self.wndSpecialInventory)
+			self.wndAcceCombine.Hide()
+
+			self.wndAcceAbsorption = uiAcce.AbsorbWindow()
+			self.wndAcceAbsorption.LoadWindow()
+			if app.WJ_ENABLE_TRADABLE_ICON:
+				self.wndAcceAbsorption.BindInterface(self)
+				if self.wndInventory:
+					self.wndAcceAbsorption.SetInven(self.wndInventory)
+				if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+					if self.wndSpecialInventory:
+						self.wndAcceAbsorption.SetSpecialInven(self.wndSpecialInventory)
+
+			self.wndAcceAbsorption.Hide()
+
+			if self.wndInventory:
+				self.wndInventory.SetAcceWindow(self.wndAcceCombine, self.wndAcceAbsorption)
+
+	if app.ENABLE_CHANGE_LOOK_SYSTEM:
+		def __MakeChangeLookWindow(self):
+			self.wndChangeLook = uiChangeLook.ChangeLookWindow()
+			self.wndChangeLook.Open()
+			if app.WJ_ENABLE_TRADABLE_ICON:
+				self.wndChangeLook.BindInterface(self)
+				if self.wndInventory:
+					self.wndChangeLook.SetInven(self.wndInventory)
+				if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+					if self.wndSpecialInventory:
+						self.wndChangeLook.SetSpecialInven(self.wndSpecialInventory)
+			self.wndChangeLook.Hide()
+
+			if self.wndInventory:
+				self.wndInventory.SetChangeLookWindow(self.wndChangeLook)
+
 	def __MakeCubeWindow(self):
-		if app.ENABLE_CUBE_RENEWAL:
-			self.wndCube = uiCubeRenewal.CubeWindow()
-			self.wndCube.SetCenterPosition()
-			self.wndCube.Hide()
-		else:
-			self.wndCube = uiCube.CubeWindow()
-			self.wndCube.LoadWindow()
-			self.wndCube.Hide()
-
-	if not app.ENABLE_CUBE_RENEWAL:
-		def __MakeCubeResultWindow(self):
-			self.wndCubeResult = uiCube.CubeResultWindow()
-			self.wndCubeResult.LoadWindow()
-			self.wndCubeResult.Hide()
+		self.wndCube = uiCube.CubeWindow()
+		self.wndCube.LoadWindow()
+		self.wndCube.Hide()
+
+	def __MakeCubeResultWindow(self):
+		self.wndCubeResult = uiCube.CubeResultWindow()
+		self.wndCubeResult.LoadWindow()
+		self.wndCubeResult.Hide()
+
+	if app.ENABLE_MINI_GAME_OKEY:
+		def __MakeCardsInfoWindow(self):
+			self.wndCardsInfo = uiMiniGameRumi.CardsInfoWindow()
+			self.wndCardsInfo.LoadWindow()
+			self.wndCardsInfo.Hide()
+
+		def __MakeCardsWindow(self):
+			self.wndCards = uiMiniGameRumi.CardsWindow()
+			self.wndCards.LoadWindow()
+			self.wndCards.Hide()
+
+		def __MakeCardsIconWindow(self):
+			self.wndCardsIcon = uiMiniGameRumi.IngameWindow()
+			self.wndCardsIcon.LoadWindow()
+			self.wndCardsIcon.Hide()
 
 	# ACCESSORY_REFINE_ADD_METIN_STONE
 	def __MakeItemSelectWindow(self):
@@ -579,6 +487,16 @@
 		def __MakeItemSelectWindowEx(self):
 			self.wndItemSelectEx = uiselectitemEx.SelectItemWindowEx()
 			self.wndItemSelectEx.Hide()
+
+		def __MakeGemGui(self):
+			self.wndGemG = uiGemShop.SelectGems()
+			self.wndGemG.LoadWindow()
+			self.wndGemG.Hide()
+
+			self.wndGemM = uiGemShop.SelectGemsShop()
+			self.wndGemM.LoadWindow()
+			self.wndGemM.Hide()
+
 	# END_OF_ACCESSORY_REFINE_ADD_METIN_STONE
 
 	def MakeInterface(self):
@@ -589,29 +507,36 @@
 		self.__MakeParty()
 		self.__MakeWindows()
 		self.__MakeDialogs()
-		if app.ENABLE_POPUP_NOTICE:
-			self.__MakePopupNoticeWindow()
+		if app.ENABLE_GEM_SYSTEM:
+			self.__MakeGemGui()
 
 		self.__MakeUICurtain()
 		self.__MakeTaskBar()
 		self.__MakeGameButtonWindow()
 		self.__MakeHelpWindow()
 		self.__MakeWebWindow()
+		if app.ENABLE_ACCE_COSTUME_SYSTEM:
+			self.__MakeAcceWindow()
+		if app.ENABLE_CHANGE_LOOK_SYSTEM:
+			self.__MakeChangeLookWindow()
+		if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
+			self.__MakeGuildDragonLairRanking()
 		self.__MakeCubeWindow()
-		if not app.ENABLE_CUBE_RENEWAL:
-			self.__MakeCubeResultWindow()
+		self.__MakeCubeResultWindow()
 
 		# ACCESSORY_REFINE_ADD_METIN_STONE
 		self.__MakeItemSelectWindow()
 		# END_OF_ACCESSORY_REFINE_ADD_METIN_STONE
 
+		if app.ENABLE_MINI_GAME_OKEY:
+			self.__MakeCardsInfoWindow()
+			self.__MakeCardsWindow()
+			self.__MakeCardsIconWindow()
+
 		if app.ENABLE_GEM_SYSTEM:
 			self.__MakeItemSelectWindowEx()
 
 		self.questButtonList = []
-		if app.ENABLE_QUEST_RENEWAL:
-			self.__MakeQuestButton()
-
 		self.whisperButtonList = []
 		self.whisperDialogDict = {}
 		self.privateShopAdvertisementBoardDict = {}
@@ -621,22 +546,20 @@
 			self.wndDragonSoul.SetItemToolTip(self.tooltipItem)
 			self.wndDragonSoulRefine.SetItemToolTip(self.tooltipItem)
 		self.wndSafebox.SetItemToolTip(self.tooltipItem)
-		if not app.ENABLE_CUBE_RENEWAL:
-			self.wndCube.SetItemToolTip(self.tooltipItem)
-			self.wndCubeResult.SetItemToolTip(self.tooltipItem)
+		if app.ENABLE_ACCE_COSTUME_SYSTEM:
+			self.wndAcceCombine.SetItemToolTip(self.tooltipItem)
+			self.wndAcceAbsorption.SetItemToolTip(self.tooltipItem)
+		if app.ENABLE_CHANGE_LOOK_SYSTEM:
+			self.wndChangeLook.SetItemToolTip(self.tooltipItem)
+		if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+			self.wndPrivateShopSearch.SetItemToolTip(self.tooltipItem)
+		self.wndCube.SetItemToolTip(self.tooltipItem)
+		self.wndCubeResult.SetItemToolTip(self.tooltipItem)
 
 		# MT-818 [GF] 아이템 - 제조 성공된 아이템이 펫먹이가 되는 이슈
 		self.wndCube.SetInven(self.wndInventory)
-
-		if app.ENABLE_ACCE_COSTUME_SYSTEM:
-			self.wndAcce.SetItemToolTip(self.tooltipItem)
-
-		if app.ENABLE_AURA_COSTUME_SYSTEM:
-			self.wndAura.SetItemToolTip(self.tooltipItem)
-
-		if app.ENABLE_MOVE_COSTUME_ATTR:
-			self.wndItemCombination.SetInven(self.wndInventory)
-			self.wndItemCombination.SetItemToolTip(self.tooltipItem)
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			self.wndCube.SetSpecialInven(self.wndSpecialInventory)
 
 		# ITEM_MALL
 		self.wndMall.SetItemToolTip(self.tooltipItem)
@@ -644,54 +567,51 @@
 
 		if app.ENABLE_SKILLBOOK_COMB_SYSTEM:
 			self.wndSkillBookCombination.SetInven(self.wndInventory)
-
-		if app.ENABLE_CHANGED_ATTR:
-			self.wndSelectAttr.SetInven(self.wndInventory)
+			if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+				self.wndSkillBookCombination.SetSpecialInven(self.wndSpecialInventory)
 
 		self.wndCharacter.SetSkillToolTip(self.tooltipSkill)
 		self.wndTaskBar.SetItemToolTip(self.tooltipItem)
 		self.wndTaskBar.SetSkillToolTip(self.tooltipSkill)
 		self.wndGuild.SetSkillToolTip(self.tooltipSkill)
 
-		if app.ENABLE_CHANGE_LOOK_SYSTEM:
-			self.wndChangeLook.SetItemToolTip(self.tooltipItem)
-
 		# ACCESSORY_REFINE_ADD_METIN_STONE
 		self.wndItemSelect.SetItemToolTip(self.tooltipItem)
 		# END_OF_ACCESSORY_REFINE_ADD_METIN_STONE
 		if app.ENABLE_GEM_SYSTEM:
 			self.wndItemSelectEx.SetItemToolTip(self.tooltipItem)
 
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			self.wndSpecialInventory.SetItemToolTip(self.tooltipItem)
+
 		self.dlgShop.SetItemToolTip(self.tooltipItem)
+		self.dlgPrivateShop.SetItemToolTip(self.tooltipItem)
 
 		self.dlgExchange.SetItemToolTip(self.tooltipItem)
 		self.privateShopBuilder.SetItemToolTip(self.tooltipItem)
 		if app.WJ_ENABLE_TRADABLE_ICON:
 			self.privateShopBuilder.SetInven(self.wndInventory)
 			self.dlgExchange.SetInven(self.wndInventory)
-
-		if app.ENABLE_GROWTH_PET_SYSTEM:
-			self.wndPetInfoWindow.SetItemToolTip(self.tooltipItem)
-			self.wndPetInfoWindow.SetInven(self.wndInventory)
-			self.wndPetInfoWindow.SetPetSkillToolTip(self.tooltipPetSkill)
+			if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+				self.privateShopBuilder.SetSpecialInven(self.wndSpecialInventory)
+				self.dlgExchange.SetSpecialInven(self.wndSpecialInventory)
 
 		self.__InitWhisper()
+		self.DRAGON_SOUL_IS_QUALIFIED = False
 
-		if app.ENABLE_DRAGON_SOUL_SYSTEM:
-			self.DRAGON_SOUL_IS_QUALIFIED = False
-
-		if app.ENABLE_EVENT_BANNER:
-			self.wndMiniGame.SetItemToolTip(self.tooltipItem)
+		#self.IntegrationEventBanner()
 
 		if app.ENABLE_GEM_SYSTEM:
-			self.wndGemShop.SetItemToolTip(self.tooltipItem)
+			self.wndGemM.SetItemToolTip(self.tooltipItem)
 
 		if app.ENABLE_MAILBOX:
 			if self.mail_box:
 				self.mail_box.SetItemToolTip(self.tooltipItem)
 
-		if app.ENABLE_LUCKY_BOX:
-			self.wndLuckyBox.SetItemToolTip(self.tooltipItem)
+		if app.ENABLE_GROWTH_PET_SYSTEM:
+			self.wndPetInfoWindow.SetItemToolTip(self.tooltipItem)
+			self.wndPetInfoWindow.SetInven(self.wndInventory)
+			self.wndPetInfoWindow.SetPetSkillToolTip(self.tooltipPetSkill)
 
 	def MakeHyperlinkTooltip(self, hyperlink):
 		tokens = hyperlink.split(":")
@@ -699,16 +619,11 @@
 			type = tokens[0]
 			if "item" == type:
 				self.hyperlinkItemTooltip.SetHyperlinkItem(tokens)
-			if app.ENABLE_GROWTH_PET_SYSTEM and "petitem" == type:
-				self.hyperlinkItemTooltip.SetHyperlinkPetItem(tokens)
 
 	## Make Windows & Dialogs
 	################################
 
 	def Close(self):
-		if app.ENABLE_MOVE_COSTUME_ATTR and self.wndItemCombination:
-			self.wndItemCombination.Destroy()
-
 		if self.dlgWhisperWithoutTarget:
 			self.dlgWhisperWithoutTarget.Destroy()
 			del self.dlgWhisperWithoutTarget
@@ -746,26 +661,15 @@
 			self.wndCharacter.Destroy()
 
 		if self.wndInventory:
-			self.wndInventory.CancelDlgQuestion()
 			self.wndInventory.Hide()
 			self.wndInventory.Destroy()
 
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			if self.wndEquipment:
-				self.wndEquipment.Hide()
-				self.wndEquipment.Destroy()
-
 		if self.wndDragonSoul:
-			self.wndDragonSoul.CancelDlgQuestion()
 			self.wndDragonSoul.Destroy()
 
 		if self.wndDragonSoulRefine:
 			self.wndDragonSoulRefine.Destroy()
 
-		if app.ENABLE_RANKING_SYSTEM:
-			if self.wndRankingBoardWindow:
-				self.wndRankingBoardWindow.Destroy()
-
 		if self.dlgExchange:
 			self.dlgExchange.Destroy()
 
@@ -775,6 +679,9 @@
 		if self.dlgShop:
 			self.dlgShop.Destroy()
 
+		if self.dlgPrivateShop:
+			self.dlgPrivateShop.Destroy()
+
 		if self.dlgRestart:
 			self.dlgRestart.Destroy()
 
@@ -790,10 +697,6 @@
 		if self.wndSafebox:
 			self.wndSafebox.Destroy()
 
-		if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
-			if self.wndGuildDragonLairRanking:
-				self.wndGuildDragonLairRanking.Destory()
-
 		if self.wndWeb:
 			self.wndWeb.Destroy()
 			self.wndWeb = None
@@ -807,12 +710,26 @@
 		if self.wndHelp:
 			self.wndHelp.Destroy()
 
+		if app.ENABLE_ACCE_COSTUME_SYSTEM:
+			if self.wndAcceCombine:
+				self.wndAcceCombine.Destroy()
+
+			if self.wndAcceAbsorption:
+				self.wndAcceAbsorption.Destroy()
+
+		if app.ENABLE_CHANGE_LOOK_SYSTEM:
+			if self.wndChangeLook:
+				self.wndChangeLook.Destroy()
+
+		if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
+			if self.wndGuildDragonLairRanking:
+				self.wndGuildDragonLairRanking.Destroy()
+
 		if self.wndCube:
 			self.wndCube.Destroy()
 
-		if not app.ENABLE_CUBE_RENEWAL:
-			if self.wndCubeResult:
-				self.wndCubeResult.Destroy()
+		if self.wndCubeResult:
+			self.wndCubeResult.Destroy()
 
 		if self.wndMessenger:
 			self.wndMessenger.Destroy()
@@ -826,13 +743,6 @@
 		if self.dlgRefineNew:
 			self.dlgRefineNew.Destroy()
 
-		if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-			if self.dlgRefineElement:
-				self.dlgRefineElement.Destroy()
-
-			if self.dlgRefineElementChange:
-				self.dlgRefineElementChange.Destroy()
-
 		if self.wndGuildBuilding:
 			self.wndGuildBuilding.Destroy()
 
@@ -844,71 +754,59 @@
 			self.mallPageDlg.Destroy()
 		# END_OF_ITEM_MALL
 
-		if app.ENABLE_EXTENDED_BATTLE_PASS:
-			if self.wndBattlePassExtended:
-				self.wndBattlePassExtended.Destroy()
-
 		# ACCESSORY_REFINE_ADD_METIN_STONE
 		if self.wndItemSelect:
 			self.wndItemSelect.Destroy()
 		# END_OF_ACCESSORY_REFINE_ADD_METIN_STONE
 
-		if app.ENABLE_GEM_SYSTEM:
-			if self.wndItemSelectEx:
-				self.wndItemSelectEx.Destroy()
-
 		if app.ENABLE_SKILLBOOK_COMB_SYSTEM:
 			self.wndSkillBookCombination.Destroy()
 			del self.wndSkillBookCombination
 
-		if app.ENABLE_CHANGED_ATTR:
-			self.wndSelectAttr.Destroy()
-			del self.wndSelectAttr
-
-		if app.ENABLE_ATTR_6TH_7TH:
-			if self.wndAttr67Add:
-				self.wndAttr67Add.Destroy()
-				del self.wndAttr67Add
-
-		if app.ENABLE_ACCE_COSTUME_SYSTEM:
-			if self.wndAcce:
-				del self.wndAcce
-
-		if app.ENABLE_AURA_COSTUME_SYSTEM:
-			if self.wndAura:
-				del self.wndAura
-
-		if app.ENABLE_CHANGE_LOOK_SYSTEM:
-			if self.wndChangeLook:
-				del self.wndChangeLook
-
 		if app.ENABLE_MYSHOP_DECO:
 			if self.wndMyShopDeco:
 				self.wndMyShopDeco.Destroy()
 				del self.wndMyShopDeco
 
+		if app.ENABLE_MINI_GAME_OKEY:
+			if self.wndCardsInfo:
+				self.wndCardsInfo.Destroy()
+
+			if self.wndCards:
+				self.wndCards.Destroy()
+
+			if self.wndCardsIcon:
+				self.wndCardsIcon.Destroy()
+
+		if app.ENABLE_GEM_SYSTEM:
+			if self.wndItemSelectEx:
+				self.wndItemSelectEx.Destroy()
+
 		if app.ENABLE_GEM_SYSTEM:
-			if self.wndGemShop:
-				self.wndGemShop.Destroy()
-				del self.wndGemShop
-
-		if app.ENABLE_POPUP_NOTICE:
-			if self.wndPopupNotice:
-				self.wndPopupNotice.Destroy()
-
-		if app.ENABLE_LUCKY_BOX:
-			if self.wndLuckyBox:
-				self.wndLuckyBox.Destroy()
-
-		if app.ENABLE_FISHING_GAME:
-			if self.wndFishingGame:
-				self.wndFishingGame.Destroy()
-				del self.wndFishingGame
-
-		if app.ENABLE_GAME_OPTION_ESCAPE:
-			if self.wndEscapePopup:
-				self.wndEscapePopup.Destroy()
-				del self.wndEscapePopup
+			if self.wndGemG:
+				self.wndGemG.Destroy()
+				del self.wndGemG
+
+			if self.wndGemM:
+				self.wndGemM.Destroy()
+				del self.wndGemM
+
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			if self.wndSpecialInventory:
+				self.wndSpecialInventory.Destroy()
+
+		if app.ENABLE_DUNGEON_INFO_SYSTEM:
+			if self.wndDungeonInfo:
+				self.wndDungeonInfo.Destroy()
+
+		if app.ENABLE_CAPTCHA_SYSTEM:
+			if self.wndCaptcha:
+				self.wndCaptcha.Destroy()
+
+		if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+			if self.wndPrivateShopSearch:
+				self.wndPrivateShopSearch.Destroy()
+				del self.wndPrivateShopSearch
 
 		if app.ENABLE_GROWTH_PET_SYSTEM:
 			if self.wndPetInfoWindow:
@@ -945,31 +843,16 @@
 		del self.wndEnergyBar
 		del self.wndCharacter
 		del self.wndInventory
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			del self.wndEquipment
-
 		if self.wndDragonSoul:
 			del self.wndDragonSoul
 		if self.wndDragonSoulRefine:
 			del self.wndDragonSoulRefine
 
-		if app.ENABLE_RANKING_SYSTEM:
-			if self.wndRankingBoardWindow:
-				del self.wndRankingBoardWindow
-
 		if app.ENABLE_MAILBOX:
 			if self.mail_box:
 				self.mail_box.Destroy()
 				del self.mail_box
 
-		if app.ENABLE_LOOTING_SYSTEM:
-			if self.wndLootFilter:
-				del self.wndLootFilter
-
-		if app.ENABLE_LUCKY_BOX:
-			if self.wndLuckyBox:
-				del self.wndLuckyBox
-
 		del self.dlgExchange
 		del self.dlgPointReset
 		del self.dlgShop
@@ -984,51 +867,60 @@
 		del self.wndMall
 		del self.wndParty
 		del self.wndHelp
+		if app.ENABLE_ACCE_COSTUME_SYSTEM:
+			del self.wndAcceCombine
+			del self.wndAcceAbsorption
+		if app.ENABLE_CHANGE_LOOK_SYSTEM:
+			del self.wndChangeLook
+		if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
+			del self.wndGuildDragonLairRanking
 		del self.wndCube
-		if not app.ENABLE_CUBE_RENEWAL:
-			del self.wndCubeResult
+		del self.wndCubeResult
 		del self.privateShopBuilder
 		del self.inputDialog
 		del self.wndChatLog
 		del self.dlgRefineNew
-		if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-			del self.dlgRefineElement
-			del self.dlgRefineElementChange
 		del self.wndGuildBuilding
 		del self.wndGameButton
 		del self.tipBoard
 		del self.bigBoard
 		del self.wndItemSelect
 
+		if self.wndMiniGame:
+			self.wndMiniGame.Destroy()
+			del self.wndMiniGame
+
+		del self.dlgPrivateShop
+
+		if app.ENABLE_MINI_GAME_OKEY:
+			del self.wndCardsInfo
+			del self.wndCards
+			del self.wndCardsIcon
+
 		if app.ENABLE_GEM_SYSTEM:
 			del self.wndItemSelectEx
 
-		if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
-			del self.wndGuildDragonLairRanking
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			if self.wndSpecialInventory:
+				del self.wndSpecialInventory
+
+		if app.ENABLE_12ZI:
+			del self.missionBoard
+
+		if app.ENABLE_DUNGEON_INFO_SYSTEM:
+			if self.wndDungeonInfo:
+				del self.wndDungeonInfo
+
+		if app.ENABLE_CAPTCHA_SYSTEM:
+			if self.wndCaptcha:
+				del self.wndCaptcha
 
-		if app.ENABLE_OX_RENEWAL:
-			del self.bigBoardControl
-
-		if app.ENABLE_EVENT_BANNER:
-			if self.wndMiniGame:
-				self.wndMiniGame.Destroy()
-				del self.wndMiniGame
-
-		del self.missionBoard
-
-		if app.ENABLE_POPUP_NOTICE:
-			if self.wndPopupNotice:
-				del self.wndPopupNotice
-
-		if app.ENABLE_EXTENDED_BATTLE_PASS:
-			del self.wndBattlePassExtended
 
 		if app.ENABLE_GROWTH_PET_SYSTEM:
 			if self.wndPetInfoWindow:
 				del self.wndPetInfoWindow
 			self.wndPetInfoWindow = None
 			del self.tooltipPetSkill
-
 		self.questButtonList = []
 		self.whisperButtonList = []
 		self.whisperDialogDict = {}
@@ -1055,14 +947,14 @@
 	def OnChangeCurrentSkill(self, skillSlotNumber):
 		self.wndTaskBar.OnChangeCurrentSkill(skillSlotNumber)
 
-	def SelectMouseButtonEvent(self, dir, event):
-		self.wndTaskBar.SelectMouseButtonEvent(dir, event)
-
 	if app.ENABLE_SKILL_COOLTIME_UPDATE:
 		def SkillClearCoolTime(self, slotIndex):
 			self.wndCharacter.SkillClearCoolTime(slotIndex)
 			self.wndTaskBar.SkillClearCoolTime(slotIndex)
 
+	def SelectMouseButtonEvent(self, dir, event):
+		self.wndTaskBar.SelectMouseButtonEvent(dir, event)
+
 	## Refresh
 	def RefreshAlignment(self):
 		self.wndCharacter.RefreshAlignment()
@@ -1088,32 +980,17 @@
 	def RefreshInventory(self):
 		self.wndTaskBar.RefreshQuickSlot()
 		self.wndInventory.RefreshItemSlot()
-
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.wndEquipment.RefreshSlot()
-
 		if app.ENABLE_DRAGON_SOUL_SYSTEM:
 			self.wndDragonSoul.RefreshItemSlot()
-
-		if app.ENABLE_ACCE_COSTUME_SYSTEM:
-			if player.GetAcceRefineWindowOpen():
-				self.wndAcce.RefreshAcceWindow()
-
-		if app.ENABLE_CHANGE_LOOK_SYSTEM:
-			if player.GetChangeLookWindowOpen():
-				self.wndChangeLook.RefreshChangeLookWindow()
-
-		if app.ENABLE_AURA_COSTUME_SYSTEM:
-			if player.IsAuraWindowOpen():
-				self.wndAura.RefreshAuraWindow()
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			self.wndSpecialInventory.RefreshItemSlot()
 
 	def RefreshCharacter(self): ## Character 페이지의 얼굴, Inventory 페이지의 전신 그림 등의 Refresh
 		self.wndCharacter.RefreshCharacter()
 		self.wndTaskBar.RefreshQuickSlot()
 
-	if not app.ENABLE_QUEST_RENEWAL:
-		def RefreshQuest(self):
-			self.wndCharacter.RefreshQuest()
+	def RefreshQuest(self):
+		self.wndCharacter.RefreshQuest()
 
 	def RefreshSafebox(self):
 		self.wndSafebox.RefreshSafebox()
@@ -1176,14 +1053,36 @@
 	def OpenShopDialog(self, vid):
 		self.wndInventory.Show()
 		self.wndInventory.SetTop()
-		self.dlgShop.Open(vid)
-		self.dlgShop.SetTop()
+
+		import chr
+		if chr.IsNPC(vid):
+			self.dlgShop.Open(vid)
+			self.dlgShop.SetTop()
+		else:
+			self.dlgPrivateShop.Open(vid)
+			self.dlgPrivateShop.SetTop()
+
+		# self.dlgShop.Open(vid)
+		# self.dlgShop.SetTop()
+		# event.SetInterfaceWindow(self)
 
 	def CloseShopDialog(self):
-		self.dlgShop.Close()
+		# self.dlgShop.Close()
+		if self.dlgPrivateShop.IsShow():
+			self.dlgPrivateShop.Close()
+		elif self.dlgShop.IsShow():
+			self.dlgShop.Close()
+		else:
+			return
 
 	def RefreshShopDialog(self):
-		self.dlgShop.Refresh()
+		# self.dlgShop.Refresh()
+		if self.dlgPrivateShop.IsShow():
+			self.dlgPrivateShop.Refresh()
+		elif self.dlgShop.IsShow():
+			self.dlgShop.Refresh()
+		else:
+			return
 
 	## Quest
 	def OpenCharacterWindowQuestPage(self):
@@ -1201,12 +1100,12 @@
 			wnds = self.__HideWindows()
 
 			# UNKNOWN_UPDATE
-			q.AddOnDoneEvent(lambda tmp_self, args = wnds: self.__ShowWindows(args))
+			q.AddOnDoneEvent(lambda tmp_self, args=wnds: self.__ShowWindows(args))
 			# END_OF_UNKNOWN_UPDATE
 
 		if skin:
 			q.AddOnCloseEvent(q.Unlock)
-		q.AddOnCloseEvent(lambda key = self.wndQuestWindowNewKey : ui.__mem_func__(self.RemoveQuestDialog)(key))
+		q.AddOnCloseEvent(lambda key = self.wndQuestWindowNewKey:ui.__mem_func__(self.RemoveQuestDialog)(key))
 		self.wndQuestWindow[self.wndQuestWindowNewKey] = q
 
 		self.wndQuestWindowNewKey = self.wndQuestWindowNewKey + 1
@@ -1216,10 +1115,6 @@
 	def RemoveQuestDialog(self, key):
 		del self.wndQuestWindow[key]
 
-	def ShowAllQuestDialog(self):
-		for key, eachQuestWindow in self.wndQuestWindow.items():
-			eachQuestWindow.Show()
-
 	## Exchange
 	def StartExchange(self):
 		self.dlgExchange.OpenDialog()
@@ -1236,14 +1131,10 @@
 			self.dlgExchange.AddExchangeItemSlotIndex(idx)
 
 	## Party
-	if app.WJ_SHOW_PARTY_ON_MINIMAP and app.ENABLE_PARTY_CHANNEL_FIX:
+	if app.WJ_SHOW_PARTY_ON_MINIMAP:
 		def AddPartyMember(self, pid, name, mapIdx, channel):
 			self.wndParty.AddPartyMember(pid, name, mapIdx, channel)
 			self.__ArrangeQuestButton()
-	elif app.WJ_SHOW_PARTY_ON_MINIMAP:
-		def AddPartyMember(self, pid, name, mapIdx):
-			self.wndParty.AddPartyMember(pid, name, mapIdx)
-			self.__ArrangeQuestButton()
 	else:
 		def AddPartyMember(self, pid, name):
 			self.wndParty.AddPartyMember(pid, name)
@@ -1258,12 +1149,9 @@
 		##!! 20061026.levites.퀘스트_위치_보정
 		self.__ArrangeQuestButton()
 
-	if app.WJ_SHOW_PARTY_ON_MINIMAP and app.ENABLE_PARTY_CHANNEL_FIX:
+	if app.WJ_SHOW_PARTY_ON_MINIMAP:
 		def LinkPartyMember(self, pid, vid, mapIdx, channel):
 			self.wndParty.LinkPartyMember(pid, vid, mapIdx, channel)
-	elif app.WJ_SHOW_PARTY_ON_MINIMAP:
-		def LinkPartyMember(self, pid, vid, mapIdx):
-			self.wndParty.LinkPartyMember(pid, vid, mapIdx)
 	else:
 		def LinkPartyMember(self, pid, vid):
 			self.wndParty.LinkPartyMember(pid, vid)
@@ -1308,92 +1196,28 @@
 	def CommandCloseSafebox(self):
 		self.wndSafebox.CommandCloseSafebox()
 
-	if app.ENABLE_ACCE_COSTUME_SYSTEM:
-		def AcceDialogOpen(self, type):
-			if shop.GetNameDialogOpen():
-				return
-
-			if self.dlgRefineNew:
-				if self.dlgRefineNew.IsShow:
-					return
-
-			if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-				if self.IsRefineElementDialogOpen():
-					return
-
-			self.wndAcce.Open(type)
-			if False == self.wndInventory.IsShow():
-				self.wndInventory.Show()
-
-		def AcceDialogClose(self):
-			self.wndAcce.Close()
-
-	if app.ENABLE_AURA_COSTUME_SYSTEM:
-		def AuraDialogOpen(self, type):
-			if shop.GetNameDialogOpen():
-				return
-
-			if self.dlgRefineNew:
-				if self.dlgRefineNew.IsShow:
-					return
-
-			self.wndAura.Open(type)
-			if False == self.wndInventory.IsShow():
-				self.wndInventory.Show()
+	if app.ENABLE_GEM_SYSTEM:
+		def OpenGuiGem(self):
+			self.wndGemG.Open()
 
-		def AuraDialogClose(self):
-			self.wndAura.Close()
+		def GemCheck(self):
+			self.wndGemG.SucceedGem()
 
-	## HilightSlot Change
-	def DeactivateSlot(self, slotindex, type):
-		self.wndInventory.DeactivateSlot(slotindex, type)
-
-	## HilightSlot Change
-	def ActivateSlot(self, slotindex, type):
-		self.wndInventory.ActivateSlot(slotindex, type)
+		def OpenGuiGemMarket(self):
+			self.wndGemM.Open()
 
-	if app.ENABLE_CHANGE_LOOK_SYSTEM:
-		def ChangeWindowOpen(self, type):
-			if shop.GetNameDialogOpen():
-				return
+		def GemMarketItems(self, vnums, gem, count):
+			self.wndGemM.Information(vnums, gem, count)
+			self.wndGemM.LoadInformation()
 
-			if self.dlgRefineNew:
-				if self.dlgRefineNew.IsShow:
-					return
-
-			if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-				if self.IsRefineElementDialogOpen():
-					return
-
-			if self.wndChangeLook:
-				self.wndChangeLook.Open(type)
+		def GemMarketSlotsDesblock(self, slot0, slot1, slot2, slot3, slot4, slot5):
+			self.wndGemM.SlotsDesblock(slot0, slot1, slot2, slot3, slot4, slot5)
 
-	if app.ENABLE_MOVE_COSTUME_ATTR:
-		def ItemCombinationDialogOpen(self):
-			self.wndItemCombination.Open()
-			if False == self.wndInventory.IsShow():
-				self.wndInventory.Show()
+		def GemMarketClear(self):
+			self.wndGemM.Clear()
 
-	if app.ENABLE_GEM_SYSTEM:
-		def OpenGemShop(self):
-			if self.wndGemShop:
-				self.wndGemShop.Open()
-
-		def CloseGemShop(self):
-			if self.wndGemShop:
-				self.wndGemShop.Close()
-
-		def RefreshGemShopWindow(self):
-			if self.wndGemShop:
-				self.wndGemShop.RefreshGemShopWindow()
-
-		def GemShopSlotBuy(self, slotindex, enable):
-			if self.wndGemShop:
-				self.wndGemShop.GemShopSlotBuy(slotindex, enable)
-
-		def GemShopSlotAdd(self, slotindex, enable):
-			if self.wndGemShop:
-				self.wndGemShop.GemShopSlotAdd(slotindex, enable)
+		def GemTime(self,time):
+			self.wndGemM.Time(time)
 
 	if app.ENABLE_SKILLBOOK_COMB_SYSTEM:
 		def OpenSkillbookCombinationDialog(self):
@@ -1410,18 +1234,6 @@
 			if not self.wndInventory.IsShow():
 				self.wndInventory.Show()
 
-	if app.ENABLE_CHANGED_ATTR:
-		def OpenSelectAttrDialog(self, window_type, slotIdx):
-			if self.wndSelectAttr.IsShow():
-				return
-
-			if self.privateShopBuilder.IsShow():
-				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.SELECT_ATTR_NOT_OPEN)
-				return
-
-			self.wndSelectAttr.Open(window_type, slotIdx)
-			self.wndSelectAttr.Show()
-
 	# ITEM_MALL
 	def AskMallPassword(self):
 		if self.wndMall.IsShow():
@@ -1486,13 +1298,13 @@
 	def OpenRefineDialog(self, targetItemPos, nextGradeItemVnum, cost, prob, type, apply_random_list, src_vnum):
 		self.dlgRefineNew.Open(targetItemPos, nextGradeItemVnum, cost, prob, type, apply_random_list, src_vnum)
 
+	if app.ENABLE_AUTO_REFINE:
+		def RefineFail(self, isFail):
+			self.dlgRefineNew.CheckRefine(isFail)
+
 	def AppendMaterialToRefineDialog(self, vnum, count):
 		self.dlgRefineNew.AppendMaterial(vnum, count)
 
-	if app.ENABLE_REFINE_RENEWAL:
-		def CheckRefineDialog(self, isFail):
-			self.dlgRefineNew.CheckRefine(isFail)
-
 	def SetAffectShower(self, shower):
 		#from _weakref import proxy
 		#self.uiAffectshower = proxy(shower)
@@ -1503,12 +1315,6 @@
 		#self.uitargetBoard = proxy(targetBoard)
 		self.uitargetBoard = targetBoard
 
-	if app.ENABLE_DEFENSE_WAVE:
-		def SetAllianceTargetBoard(self, targetBoard):
-			#from _weakref import proxy
-			#self.uitargetBoard = proxy(targetBoard)
-			self.uiAllianceTargetBoard = targetBoard
-
 	## Show & Hide
 	def ShowDefaultWindows(self):
 		self.wndTaskBar.Show()
@@ -1519,15 +1325,15 @@
 		if self.wndGameButton:
 			self.wndGameButton.Show()
 
-		if app.ENABLE_EVENT_BANNER and not app.ENABLE_EVENT_BANNER:
-			if self.wndMiniGame:
-				self.wndMiniGame.show_mini_game_dialog()
-
 		if self.uiAffectshower:
 			self.uiAffectshower.Show()
 
-		#if self.wndParty:
-		#	self.wndParty.Show()
+		if self.wndParty:
+			self.wndParty.Show()
+
+		if app.ENABLE_CAPTCHA_SYSTEM:
+			if self.wndChat:
+				self.wndChat.Show()
 
 		self.IsHideUiMode = False
 
@@ -1538,8 +1344,6 @@
 		self.wndTaskBar.Show()
 		self.wndCharacter.Show()
 		self.wndInventory.Show()
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.wndEquipment.Show()
 
 		if app.ENABLE_DRAGON_SOUL_SYSTEM:
 			self.wndDragonSoul.Show()
@@ -1570,13 +1374,8 @@
 		if self.uitargetBoard:
 			self.uitargetBoard.Hide()
 
-		if app.ENABLE_DEFENSE_WAVE:
-			if self.uiAllianceTargetBoard:
-				self.uiAllianceTargetBoard.Hide()
-
-		if app.ENABLE_EVENT_BANNER:
-			if self.wndMiniGame:
-				self.wndMiniGame.hide_mini_game_dialog()
+		if self.wndMiniGame:
+			self.wndMiniGame.hide_mini_game_dialog()
 
 		if self.wndTaskBar:
 			self.wndTaskBar.Hide()
@@ -1587,24 +1386,20 @@
 		if self.wndEnergyBar:
 			self.wndEnergyBar.Hide()
 
-		if self.wndCharacter:
-			self.wndCharacter.Hide()
+		if app.ENABLE_DETAILS_UI or app.ENABLE_SKILL_COLOR_SYSTEM:
+			if self.wndCharacter:
+				self.wndCharacter.Close()
+		else:
+			if self.wndCharacter:
+				self.wndCharacter.Hide()
 
 		if self.wndInventory:
 			self.wndInventory.Hide()
 
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			if self.wndEquipment:
-				self.wndEquipment.Hide()
-
 		if app.ENABLE_DRAGON_SOUL_SYSTEM:
 			self.wndDragonSoul.Hide()
 			self.wndDragonSoulRefine.Hide()
 
-		if app.ENABLE_RANKING_SYSTEM:
-			if self.wndRankingBoardWindow:
-				self.wndRankingBoardWindow.Hide()
-
 		if self.wndChat:
 			self.wndChat.hide_btnChatSizing()
 			self.wndChat.Hide()
@@ -1618,10 +1413,6 @@
 		if self.wndGuild:
 			self.wndGuild.Hide()
 
-		if app.ENABLE_EXTENDED_BATTLE_PASS:
-			if self.wndBattlePassExtended:
-				self.wndBattlePassExtended.Hide()
-
 		if self.wndExpandedTaskBar:
 			self.wndExpandedTaskBar.Hide()
 
@@ -1633,30 +1424,28 @@
 			if self.wndSkillBookCombination:
 				self.wndSkillBookCombination.Hide()
 
-		if app.ENABLE_CHANGED_ATTR:
-			if self.wndSelectAttr:
-				self.wndSelectAttr.Hide()
-
 		if app.ENABLE_MYSHOP_DECO:
 			if self.wndMyShopDeco:
 				self.wndMyShopDeco.Hide()
 
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			if self.wndSpecialInventory:
+				self.wndSpecialInventory.Hide()
+
+		if app.ENABLE_DUNGEON_INFO_SYSTEM:
+			if self.wndDungeonInfo:
+				self.wndDungeonInfo.Hide()
 		if app.ENABLE_MAILBOX:
 			if self.mail_box:
 				self.mail_box.Hide()
-
-		if app.ENABLE_POPUP_NOTICE:
-			if self.wndPopupNotice:
-				self.wndPopupNotice.Hide()
-
-		self.IsHideUiMode = True
-
-		if app.ENABLE_GROWTH_PET_SYSTEM:
+		if app.ENABLE_GROWTH_PET_SYSTEM: 	
 			if self.wndPetInfoWindow:
 				self.wndPetInfoWindow.Hide()
 				if self.wndPetInfoWindow.wndPetMiniInfo:
 					self.wndPetInfoWindow.wndPetMiniInfo.Hide()
 
+		self.IsHideUiMode = True
+
 	def ShowMouseImage(self):
 		self.wndTaskBar.ShowMouseImage()
 
@@ -1670,8 +1459,6 @@
 			# 웹페이지가 열렸을때는 채팅 입력이 안됨
 			if self.wndWeb and self.wndWeb.IsShow():
 				pass
-			elif app.ENABLE_POPUP_NOTICE and self.wndPopupNotice and self.wndPopupNotice.IsShow():
-				pass
 			else:
 				self.wndChat.OpenChat()
 
@@ -1681,8 +1468,8 @@
 	def SetChatFocus(self):
 		self.wndChat.SetChatFocus()
 
-	def OpenRestartDialog(self, map_index, dialog_type):
-		self.dlgRestart.OpenDialog(map_index, dialog_type)
+	def OpenRestartDialog(self):
+		self.dlgRestart.OpenDialog()
 		self.dlgRestart.SetTop()
 
 	def CloseRestartDialog(self):
@@ -1738,7 +1525,10 @@
 			else:
 				if state == self.wndCharacter.GetState():
 					self.wndCharacter.OverOutItem()
-					self.wndCharacter.Hide()
+					if app.ENABLE_DETAILS_UI or app.ENABLE_SKILL_COLOR_SYSTEM:
+						self.wndCharacter.Close()
+					else:
+						self.wndCharacter.Hide()
 				else:
 					self.wndCharacter.SetState(state)
 
@@ -1754,71 +1544,12 @@
 	def ToggleInventoryWindow(self):
 		if False == player.IsObserverMode():
 			if False == self.wndInventory.IsShow():
-				if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-					self.wndEquipment.Show()
-					self.wndEquipment.SetTop()
-
 				self.wndInventory.Show()
 				self.wndInventory.SetTop()
 			else:
 				self.wndInventory.OverOutItem()
 				self.wndInventory.Close()
 
-				if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-					self.wndEquipment.Close()
-
-	if app.ENABLE_EXTENDED_BATTLE_PASS:
-		def ReciveOpenExtBattlePass(self):
-			if False == self.isFirstOpeningExtBattlePass:
-				self.isFirstOpeningExtBattlePass = True
-				self.wndBattlePassExtended.SetPage("NORMAL")
-			if False == self.wndBattlePassExtended.IsShow():
-				self.ToggleBattlePassExtended()
-			else:
-				self.wndBattlePassExtended.SetPage(self.wndBattlePassExtended.GetPage())
-
-		def ToggleBattlePassExtended(self):
-			if False == self.isFirstOpeningExtBattlePass:
-				net.SendExtBattlePassAction(1)
-			if False == self.wndBattlePassExtended.IsShow():
-				self.wndBattlePassExtended.Show()
-				self.wndBattlePassExtended.SetTop()
-			else:
-				self.wndBattlePassExtended.Close()
-		
-		def AddExtendedBattleGeneralInfo(self, BattlePassType, BattlePassName, BattlePassID, battlePassStartTime, battlePassEndTime):
-			if self.wndBattlePassExtended:
-				self.wndBattlePassExtended.RecvGeneralInfo(BattlePassType, BattlePassName, BattlePassID, battlePassStartTime, battlePassEndTime)
-		
-		def AddExtendedBattlePassMission(self, battlepassType, battlepassID, missionIndex, missionType, missionInfo1, missionInfo2, missionInfo3):
-			if self.wndBattlePassExtended:
-				self.wndBattlePassExtended.AddMission(battlepassType, battlepassID, missionIndex, missionType, missionInfo1, missionInfo2, missionInfo3)
-
-		def UpdateExtendedBattlePassMission(self, battlepassType, missionIndex, missionType, newProgress):
-			if self.wndBattlePassExtended:
-				self.wndBattlePassExtended.UpdateMission(battlepassType, missionIndex, missionType, newProgress)
-
-		def AddExtendedBattlePassMissionReward(self, battlepassType, battlepassID, missionIndex, missionType, itemVnum, itemCount):
-			if self.wndBattlePassExtended:
-				self.wndBattlePassExtended.AddMissionReward(battlepassType, battlepassID, missionIndex, missionType, itemVnum, itemCount)
-
-		def AddExtendedBattlePassReward(self, battlepassType, battlepassID, itemVnum, itemCount):
-			if self.wndBattlePassExtended:
-				self.wndBattlePassExtended.AddReward(battlepassType, battlepassID, itemVnum, itemCount)
-
-		def AddExtBattlePassRanklistEntry(self, playername, battlepassType, battlepassID, startTime, endTime):
-			if self.wndBattlePassExtended:
-				self.wndBattlePassExtended.AddRankingEntry(playername, battlepassType, battlepassID, startTime, endTime)
-
-	if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-		def ToggleEquipmentPage(self):
-			if False == player.IsObserverMode():
-				if False == self.wndEquipment.IsShow():
-					self.wndEquipment.Show()
-					self.wndEquipment.SetTop()
-			else:
-				self.wndEquipment.Close()
-
 	def ToggleExpandedButton(self):
 		if False == player.IsObserverMode():
 			if False == self.wndExpandedTaskBar.IsShow():
@@ -1839,11 +1570,25 @@
 			else:
 				self.wndExpandedMoneyTaskBar.Close()
 
+	if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+		def ToggleSpecialInventoryWindow(self):
+			if False == player.IsObserverMode():
+				if False == self.wndSpecialInventory.IsShow():
+					self.wndSpecialInventory.Show()
+					self.wndSpecialInventory.SetTop()
+				else:
+					self.wndSpecialInventory.OverOutItem()
+					self.wndSpecialInventory.Close()
+
+		def OpenSpecialInventoryWindow(self, category = 0):
+			if False == player.IsObserverMode():
+				if False == self.wndSpecialInventory.IsShow():
+					self.wndSpecialInventory.Show()
+					self.wndSpecialInventory.SetTop()
+					self.wndSpecialInventory.SetInventoryType(category)
+
 	def OpenCostumeWindow(self):
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.wndEquipment.ShowCostumeInventory()
-		else:
-			self.wndInventory.ShowCostumeInventory()
+		self.wndInventory.ShowCostumeInventory()
 
 	# wj.2014.12.2. 인벤토리와 DS인벤 간의 상태를 확인 및 설정하기 위한 함수.
 	def IsShowDlgQuestionWindow(self):
@@ -1862,18 +1607,13 @@
 
 	def SetUseItemMode(self, bUse):
 		self.wndInventory.SetUseItemMode(bUse)
-		if app.ENABLE_DRAGON_SOUL_SYSTEM:
-			self.wndDragonSoul.SetUseItemMode(bUse)
+		self.wndDragonSoul.SetUseItemMode(bUse)
 
 	# 용혼석
 	def DragonSoulActivate(self, deck):
 		if app.ENABLE_DRAGON_SOUL_SYSTEM:
 			self.wndDragonSoul.ActivateDragonSoulByExtern(deck)
 
-	def DragonSoulKeySelect(self, deck):
-		if app.ENABLE_DRAGON_SOUL_SYSTEM:
-			self.wndDragonSoul.DragonSoulKeySelect(deck)
-
 	def DragonSoulDeactivate(self):
 		if app.ENABLE_DRAGON_SOUL_SYSTEM:
 			self.wndDragonSoul.DeactivateDragonSoul()
@@ -1888,6 +1628,8 @@
 				self.wndDragonSoul.HighlightSlot(inven_pos)
 		elif app.WJ_ENABLE_PICKUP_ITEM_EFFECT and player.INVENTORY == inven_type:
 			self.wndInventory.HighlightSlot(inven_pos)
+			if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+				self.wndSpecialInventory.HighlightSlot(inven_pos)
 
 	def DragonSoulGiveQuilification(self):
 		self.DRAGON_SOUL_IS_QUALIFIED = True
@@ -1919,6 +1661,26 @@
 				else:
 					self.wndDragonSoul.Close()
 
+	if app.ENABLE_DUNGEON_INFO_SYSTEM:
+		def ToggleDungeonInfoWindow(self):
+			if False == player.IsObserverMode():
+				if False == self.wndDungeonInfo.IsShow():
+					self.wndDungeonInfo.Open()
+				else:
+					self.wndDungeonInfo.Close()
+
+		def DungeonInfoOpen(self):
+			if self.wndDungeonInfo:
+				self.wndDungeonInfo.OnOpen()
+
+		def DungeonInfoReload(self, onReset):
+			if self.wndDungeonInfo:
+				self.wndDungeonInfo.OnReload(onReset)
+
+		def DungeonCooldownInfo(self, key, cooldown):
+			if self.wndDungeonInfo:
+				self.wndDungeonInfo.SetCooldown(key, cooldown)
+
 	def FailDragonSoulRefine(self, reason, inven_type, inven_pos):
 		if False == player.IsObserverMode():
 			if app.ENABLE_DRAGON_SOUL_SYSTEM:
@@ -1931,25 +1693,14 @@
 				if True == self.wndDragonSoulRefine.IsShow():
 					self.wndDragonSoulRefine.RefineSucceed(inven_type, inven_pos)
 
-	if app.ENABLE_DS_CHANGE_ATTR:
-		def OpenDragonSoulRefineWindow(self, type):
-			if False == player.IsObserverMode():
-				if app.ENABLE_DRAGON_SOUL_SYSTEM:
-					if False == self.wndDragonSoulRefine.IsShow():
-						self.wndDragonSoulRefine.SetWindowType(type)
-						self.wndDragonSoulRefine.Show()
-						if None != self.wndDragonSoul:
-							if False == self.wndDragonSoul.IsShow():
-								self.wndDragonSoul.Show()
-	else:
-		def OpenDragonSoulRefineWindow(self):
-			if False == player.IsObserverMode():
-				if app.ENABLE_DRAGON_SOUL_SYSTEM:
-					if False == self.wndDragonSoulRefine.IsShow():
-						self.wndDragonSoulRefine.Show()
-						if None != self.wndDragonSoul:
-							if False == self.wndDragonSoul.IsShow():
-								self.wndDragonSoul.Show()
+	def OpenDragonSoulRefineWindow(self):
+		if False == player.IsObserverMode():
+			if app.ENABLE_DRAGON_SOUL_SYSTEM:
+				if False == self.wndDragonSoulRefine.IsShow():
+					self.wndDragonSoulRefine.Show()
+					if None != self.wndDragonSoul:
+						if False == self.wndDragonSoul.IsShow():
+							self.wndDragonSoul.Show()
 
 	def CloseDragonSoulRefineWindow(self):
 		if False == player.IsObserverMode():
@@ -1957,13 +1708,6 @@
 				if True == self.wndDragonSoulRefine.IsShow():
 					self.wndDragonSoulRefine.Close()
 
-	# 용혼석 끝
-
-	if app.ENABLE_RANKING_SYSTEM:
-		def OpenRankingBoardWindow(self, type, category):
-			if self.wndRankingBoardWindow:
-				self.wndRankingBoardWindow.Open(type, category)
-
 	if app.ENABLE_GROWTH_PET_SYSTEM:
 		def PetInformationActivate(self):
 			self.wndExpandedTaskBar.SetToolTipText(uiTaskBar.ExpandedTaskBar.BUTTON_PET_INFO, uiScriptLocale.TASKBAR_PET_INFO)
@@ -1975,6 +1719,8 @@
 				else:
 					self.wndPetInfoWindow.Close()
 
+	# 용혼석 끝
+
 	def ToggleGuildWindow(self):
 		if not self.wndGuild.IsShow():
 			if self.wndGuild.CanOpen():
@@ -2021,31 +1767,47 @@
 
 	def OpenHelpWindow(self):
 		self.wndHelp.Open()
-		if app.ENABLE_HELP_RENEWAL:
-			if self.wndTaskBar.LeftMouseButtonIsShow():
-				self.wndTaskBar.ToggleLeftMouseButtonModeWindow()
-
-			if self.wndTaskBar.RightMouseButtonIsShow():
-				self.wndTaskBar.ToggleRightMouseButtonModeWindow()
-
-			self.wndTaskBar.ToggleLeftMouseButtonModeWindow()
-			self.wndTaskBar.ToggleRightMouseButtonModeWindow()
-		else:
-			self.wndUICurtain.Show()
+		self.wndUICurtain.Show()
 
 	def CloseHelpWindow(self):
 		self.wndHelp.Close()
-		if app.ENABLE_HELP_RENEWAL:
-			self.wndTaskBar.ToggleLeftMouseButtonModeWindow()
-			self.wndTaskBar.ToggleRightMouseButtonModeWindow()
-		else:
-			self.wndUICurtain.Hide()
+		self.wndUICurtain.Hide()
 
 	def OpenWebWindow(self, url):
 		self.wndWeb.Open(url)
 		# 웹페이지를 열면 채팅을 닫는다
 		self.wndChat.CloseChat()
 
+	if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
+		def ClearDragonLairRanking(self, type):
+			self.wndGuildDragonLairRanking.ClearDragonLairRanking(type)
+
+		def OpenDragonLairRanking(self, type):
+			self.wndGuildDragonLairRanking.Open(type)
+			self.wndGuildDragonLairRanking.RefreshGuildDragonLairRanking(type)
+
+		def AddDragonLairRanking(self, type, guildname, membercount, min, sec):
+			self.wndGuildDragonLairRanking.AddDragonLairRanking(type, guildname, membercount, min, sec)
+
+	if app.ENABLE_MINI_GAME_OKEY:
+		def OpenCardsInfoWindow(self):
+			self.wndCardsInfo.Open()
+
+		def OpenCardsWindow(self, safemode):
+			self.wndCards.Open(safemode)
+
+		def UpdateCardsInfo(self, hand_1, hand_1_v, hand_2, hand_2_v, hand_3, hand_3_v, hand_4, hand_4_v, hand_5, hand_5_v, cards_left, points):
+			self.wndCards.UpdateCardsInfo(hand_1, hand_1_v, hand_2, hand_2_v, hand_3, hand_3_v, hand_4, hand_4_v, hand_5, hand_5_v, cards_left, points)
+
+		def UpdateCardsFieldInfo(self, hand_1, hand_1_v, hand_2, hand_2_v, hand_3, hand_3_v, points):
+			self.wndCards.UpdateCardsFieldInfo(hand_1, hand_1_v, hand_2, hand_2_v, hand_3, hand_3_v, points)
+
+		def CardsPutReward(self, hand_1, hand_1_v, hand_2, hand_2_v, hand_3, hand_3_v, points):
+			self.wndCards.CardsPutReward(hand_1, hand_1_v, hand_2, hand_2_v, hand_3, hand_3_v, points)
+
+		def CardsShowIcon(self):
+			self.wndCardsIcon.Show()
+
 	# Show GIFT
 	def ShowGift(self):
 		self.wndTaskBar.ShowGift()
@@ -2056,54 +1818,92 @@
 	def CloseWbWindow(self):
 		self.wndWeb.Close()
 
-	if app.ENABLE_FISHING_GAME:
-		def OpenFishingGameWindow(self, level):
-			if self.wndFishingGame:
-				self.wndFishingGame.Open(level)
-
-		def CloseFishingGameWindow(self):
-			if self.wndFishingGame:
-				self.wndFishingGame.Close()
+	if app.ENABLE_ACCE_COSTUME_SYSTEM:
+		def ActAcce(self, iAct, bWindow):
+			if iAct == 1:
+				if bWindow == True:
+					if not self.wndAcceCombine.IsOpened():
+						self.wndAcceCombine.Open()
 
-		def IsFishGameOpen(self):
-			if self.wndFishingGame and self.wndFishingGame.IsShow():
-				return True
-			return False
+					if not self.wndInventory.IsShow():
+						self.wndInventory.Show()
+				else:
+					if not self.wndAcceAbsorption.IsOpened():
+						self.wndAcceAbsorption.Open()
 
-	if app.ENABLE_CUBE_RENEWAL:
-		def OpenCubeWindow(self, npc_vnum):
-			self.wndCube.LoadCubeData(npc_vnum)
-			self.wndCube.Open()
+					if not self.wndInventory.IsShow():
+						self.wndInventory.Show()
 
-		def CloseCubeWindow(self):
-			self.wndCube.Close()
+				self.wndInventory.RefreshBagSlotWindow()
+			elif iAct == 2:
+				if bWindow == True:
+					if self.wndAcceCombine.IsOpened():
+						self.wndAcceCombine.Close()
+				else:
+					if self.wndAcceAbsorption.IsOpened():
+						self.wndAcceAbsorption.Close()
 
-		def CubeResult(self, is_success):
-			self.wndCube.CubeResult(is_success)
-	else:
-		def OpenCubeWindow(self):
-			self.wndCube.Open()
+				self.wndInventory.RefreshBagSlotWindow()
+			elif iAct == 3 or iAct == 4:
+				if bWindow == True:
+					if self.wndAcceCombine.IsOpened():
+						self.wndAcceCombine.Refresh(iAct)
+				else:
+					if self.wndAcceAbsorption.IsOpened():
+						self.wndAcceAbsorption.Refresh(iAct)
 
-			if False == self.wndInventory.IsShow():
-				self.wndInventory.Show()
+				self.wndInventory.RefreshBagSlotWindow()
+
+	if app.ENABLE_CHANGE_LOOK_SYSTEM:
+		def ActChangeLook(self, iAct):
+			if iAct == 1:
+				if not self.wndChangeLook.IsShow():
+					self.wndChangeLook.Open()
+
+				if not self.wndInventory.IsShow():
+					self.wndInventory.Show()
+
+				self.wndInventory.RefreshBagSlotWindow()
+
+			elif iAct == 2:
+				if self.wndChangeLook.IsShow():
+					self.wndChangeLook.Close()
+
+				self.wndInventory.RefreshBagSlotWindow()
+
+			elif iAct == 3 or iAct == 4:
+				if self.wndChangeLook.IsShow():
+					self.wndChangeLook.Refresh()
 
-		def UpdateCubeInfo(self, gold, itemVnum, count):
-			self.wndCube.UpdateInfo(gold, itemVnum, count)
+				self.wndInventory.RefreshBagSlotWindow()
+
+	if app.ENABLE_CAPTCHA_SYSTEM:
+		def ShowCaptcha(self, timeLeft):
+			self.wndCaptcha.Open(timeLeft)
+
+	def OpenCubeWindow(self):
+		self.wndCube.Open()
+
+		if False == self.wndInventory.IsShow():
+			self.wndInventory.Show()
+
+	def UpdateCubeInfo(self, gold, itemVnum, count):
+		self.wndCube.UpdateInfo(gold, itemVnum, count)
 
-		def CloseCubeWindow(self):
-			self.wndCube.Close()
+	def CloseCubeWindow(self):
+		self.wndCube.Close()
 
-		def FailedCubeWork(self):
-			self.wndCube.Refresh()
+	def FailedCubeWork(self):
+		self.wndCube.Refresh()
 
-		def SucceedCubeWork(self, itemVnum, count):
-			self.wndCube.Clear()
-
-			if 0: # 결과 메시지 출력은 생략 한다
-				self.wndCubeResult.SetPosition(*self.wndCube.GetGlobalPosition())
-				self.wndCubeResult.SetCubeResultItem(itemVnum, count)
-				self.wndCubeResult.Open()
-				self.wndCubeResult.SetTop()
+	def SucceedCubeWork(self, itemVnum, count):
+		self.wndCube.Clear()
+
+		if 0: # 결과 메시지 출력은 생략 한다
+			self.wndCubeResult.SetPosition(*self.wndCube.GetGlobalPosition())
+			self.wndCubeResult.SetCubeResultItem(itemVnum, count)
+			self.wndCubeResult.Open()
+			self.wndCubeResult.SetTop()
 
 	def __HideWindows(self):
 		hideWindows = self.wndTaskBar,\
@@ -2116,13 +1916,12 @@
 						self.wndParty,\
 						self.wndGameButton,
 
+		if self.wndMiniGame:
+			hideWindows += self.wndMiniGame,
+
 		if self.dlgSystem:
 			hideWindows += self.dlgSystem,
 
-		if app.ENABLE_EVENT_BANNER:
-			if self.wndMiniGame:
-				hideWindows += self.wndMiniGame,
-
 		if self.wndEnergyBar:
 			hideWindows += self.wndEnergyBar,
 
@@ -2137,38 +1936,25 @@
 			hideWindows += self.wndDragonSoul,\
 						self.wndDragonSoulRefine,
 
-		if app.ENABLE_RANKING_SYSTEM:
-			if self.wndRankingBoardWindow:
-				hideWindows += self.wndRankingBoardWindow,
-
 		if app.ENABLE_MYSHOP_DECO:
 			if self.wndMyShopDeco:
 				hideWindows += self.wndMyShopDeco,
 
-		if app.ENABLE_MAILBOX:
-			if self.mail_box:
-				hideWindows += self.mail_box,
-
-		if app.ENABLE_POPUP_NOTICE:
-			if self.wndPopupNotice:
-				hideWindows += self.wndPopupNotice,
-
-		if app.ENABLE_ATTR_6TH_7TH:
-			if self.wndAttr67Add:
-				hideWindows += self.wndAttr67Add,
-
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			if self.wndEquipment:
-				hideWindows += self.wndEquipment,
-
-		if app.ENABLE_EXTENDED_BATTLE_PASS:
-			if self.wndBattlePassExtended:
-				hideWindows += self.wndBattlePassExtended,
-
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			if self.wndSpecialInventory:
+				hideWindows += self.wndSpecialInventory,
 		if app.ENABLE_GROWTH_PET_SYSTEM:
 			if self.wndPetInfoWindow:
 				hideWindows += self.wndPetInfoWindow,
 
+		if app.ENABLE_DUNGEON_INFO_SYSTEM:
+			if self.wndDungeonInfo:
+				hideWindows += self.wndDungeonInfo,
+
+		if app.ENABLE_MAILBOX:
+			if self.mail_box:
+				hideWindows += self.mail_box,
+
 		hideWindows = filter(lambda x:x.IsShow(), hideWindows)
 		map(lambda x:x.Hide(), hideWindows)
 		import sys
@@ -2187,9 +1973,6 @@
 		if self.wndWeb:
 			self.wndWeb.CloseWhenOpenQuest()
 
-		if app.ENABLE_POPUP_NOTICE and self.wndPopupNotice:
-			self.wndPopupNotice.CloseWhenOpenQuest()
-
 		return hideWindows
 
 	def __ShowWindows(self, wnds):
@@ -2212,13 +1995,6 @@
 		if self.wndWeb:
 			self.wndWeb.OpenWhenOpenQuest()
 
-		if app.ENABLE_POPUP_NOTICE and self.wndPopupNotice:
-			self.wndPopupNotice.OpenWhenOpenQuest()
-
-		if self.wndChat:
-			if self.wndChat.IsShow():
-				self.wndChat.show_btnChatSizing()
-
 	def BINARY_OpenAtlasWindow(self):
 		if self.wndMiniMap:
 			self.wndMiniMap.ShowAtlas()
@@ -2234,6 +2010,7 @@
 	if app.ENABLE_GEM_SYSTEM:
 		def BINARY_OpenSelectItemWindowEx(self):
 			self.wndItemSelectEx.Open()
+
 		def BINARY_RefreshSelectItemWindowEx(self):
 			self.wndItemSelectEx.RefreshSlot()
 
@@ -2258,29 +2035,19 @@
 			if self.wndMyShopDeco.IsShow():
 				return
 
-			if app.ENABLE_SKILLBOOK_COMB_SYSTEM:
-				if self.wndSkillBookCombination.IsShow():
-					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.COMB_NOTICE)
-					return
-
-			if app.ENABLE_CHANGED_ATTR:
-				if self.wndSelectAttr.IsShow():
-					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.SELECT_ATTR_NOTICE)
-					return
-
-			if app.ENABLE_AURA_COSTUME_SYSTEM:
-				if self.wndAura and self.wndAura.IsShow():
-					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_OPEN_OTHER_WINDOW)
-					return
-
 			if app.ENABLE_GROWTH_PET_SYSTEM:
 				pet_id = player.GetActivePetItemId()
 				if pet_id:
 					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.PET_CAN_NOT_OPEN_SHOP_BECAUSE_SUMMON)
 					return
 
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				shop.SetNameDialogOpen(True)
+			if app.ENABLE_SKILLBOOK_COMB_SYSTEM:
+				if self.wndSkillBookCombination.IsShow():
+					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.COMB_NOTICE)
+					return
+
+			#if app.ENABLE_CHANGE_LOOK_SYSTEM:
+			#	shop.SetNameDialogOpen(True)
 			inputDialog = uiCommon.InputDialog()
 			inputDialog.SetTitle(localeInfo.PRIVATE_SHOP_INPUT_NAME_DIALOG_TITLE)
 			inputDialog.SetMaxLength(32)
@@ -2294,23 +2061,18 @@
 			#if player.IsInSafeArea():
 			#	chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.CANNOT_OPEN_PRIVATE_SHOP_IN_SAFE_AREA)
 			#	return
-
-			if app.ENABLE_SKILLBOOK_COMB_SYSTEM:
-				if self.wndSkillBookCombination.IsShow():
-					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.COMB_NOTICE)
-					return
-
-			if app.ENABLE_CHANGED_ATTR:
-				if self.wndSelectAttr.IsShow():
-					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.SELECT_ATTR_NOTICE)
-					return
-
 			if app.ENABLE_GROWTH_PET_SYSTEM:
 				pet_id = player.GetActivePetItemId()
 				if pet_id:
 					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.PET_CAN_NOT_OPEN_SHOP_BECAUSE_SUMMON)
 					return
 
+
+			if app.ENABLE_SKILLBOOK_COMB_SYSTEM:
+				if self.wndSkillBookCombination.IsShow():
+					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.COMB_NOTICE)
+					return
+
 			inputDialog = uiCommon.InputDialog()
 			inputDialog.SetTitle(localeInfo.PRIVATE_SHOP_INPUT_NAME_DIALOG_TITLE)
 			inputDialog.SetMaxLength(32)
@@ -2321,8 +2083,6 @@
 
 	def ClosePrivateShopInputNameDialog(self):
 		self.inputDialog = None
-		if app.ENABLE_CHANGE_LOOK_SYSTEM:
-			shop.SetNameDialogOpen(False)
 		return True
 
 	if app.ENABLE_CHEQUE_SYSTEM:
@@ -2333,24 +2093,22 @@
 			if not len(self.inputDialog.GetText()):
 				return True
 
+			if app.ENABLE_GROWTH_PET_SYSTEM:
+				pet_id = player.GetActivePetItemId()
+				if pet_id:
+					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.PET_CAN_NOT_OPEN_SHOP_BECAUSE_SUMMON)
+					return
+
 			if app.ENABLE_SKILLBOOK_COMB_SYSTEM:
 				if self.wndSkillBookCombination.IsShow():
 					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.COMB_NOTICE)
 					return
 
-			if app.ENABLE_CHANGED_ATTR:
-				if self.wndSelectAttr.IsShow():
-					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.SELECT_ATTR_NOTICE)
-					return
-
 			self.privateShopBuilder.Open(self.inputDialog.GetText())
 			self.privateShopBuilder.SetIsCashItem(bCashItem)
 			self.privateShopBuilder.SetTabCount(tabCnt)
 			self.ClosePrivateShopInputNameDialog()
 
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				shop.SetNameDialogOpen(True)
-
 			return True
 	else:
 		def OpenPrivateShopBuilder(self):
@@ -2359,23 +2117,20 @@
 
 			if not len(self.inputDialog.GetText()):
 				return True
+			if app.ENABLE_GROWTH_PET_SYSTEM:
+				pet_id = player.GetActivePetItemId()
+				if pet_id:
+					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.PET_CAN_NOT_OPEN_SHOP_BECAUSE_SUMMON)
+					return
 
 			if app.ENABLE_SKILLBOOK_COMB_SYSTEM:
 				if self.wndSkillBookCombination.IsShow():
 					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.COMB_NOTICE)
 					return
 
-			if app.ENABLE_CHANGED_ATTR:
-				if self.wndSelectAttr.IsShow():
-					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.SELECT_ATTR_NOTICE)
-					return
-
 			self.privateShopBuilder.Open(self.inputDialog.GetText())
 			self.ClosePrivateShopInputNameDialog()
 
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				shop.SetNameDialogOpen(True)
-
 			return True
 
 	def AppearPrivateShop(self, vid, text, type):
@@ -2408,20 +2163,20 @@
 
 		self.equipmentDialogDict[vid] = dlg
 
-	def SetEquipmentDialogItem(self, window, vid, slot_index, vnum, count, change_look_vnum, refine_element, apply_random_list, set_value):
+	def SetEquipmentDialogItem(self, vid, slotIndex, vnum, count):
 		if not vid in self.equipmentDialogDict:
 			return
-		self.equipmentDialogDict[vid].SetEquipmentDialogItem(window, slot_index, vnum, count, change_look_vnum, refine_element, apply_random_list, set_value)
+		self.equipmentDialogDict[vid].SetEquipmentDialogItem(slotIndex, vnum, count)
 
-	def SetEquipmentDialogSocket(self, window, vid, slot_index, socket_index, value):
+	def SetEquipmentDialogSocket(self, vid, slotIndex, socketIndex, value):
 		if not vid in self.equipmentDialogDict:
 			return
-		self.equipmentDialogDict[vid].SetEquipmentDialogSocket(window, slot_index, socket_index, value)
+		self.equipmentDialogDict[vid].SetEquipmentDialogSocket(slotIndex, socketIndex, value)
 
-	def SetEquipmentDialogAttr(self, window, vid, slot_index, attr_index, type, value):
+	def SetEquipmentDialogAttr(self, vid, slotIndex, attrIndex, type, value):
 		if not vid in self.equipmentDialogDict:
 			return
-		self.equipmentDialogDict[vid].SetEquipmentDialogAttr(window, slot_index, attr_index, type, value)
+		self.equipmentDialogDict[vid].SetEquipmentDialogAttr(slotIndex, attrIndex, type, value)
 
 	def CloseEquipmentDialog(self, vid):
 		if not vid in self.equipmentDialogDict:
@@ -2433,290 +2188,125 @@
 	#####################################################################################
 	### Quest ###
 
-	if app.ENABLE_QUEST_RENEWAL:
-		def RefreshQuest(self, quest_type, quest_index):
-			self.wndCharacter.RefreshQuest(quest_type, quest_index)
-
-			# Refresh quest button.
-			self.__RefreshQuestButton()
-
-		def DeleteQuest(self, quest_type, quest_index):
-			self.wndCharacter.DeleteQuest(quest_type, quest_index)
-
-		# Unused.
-		def ShowQuestButton(self):
-			pass
-
-		def __OnClickQuestLetterButton(self, btn):
-			self.OpenCharacterWindowWithState("QUEST")
-
-			if btn.type == quest.QUEST_TYPE_EVENT:
-				self.wndCharacter.OpenQuestCategory(quest.QUEST_TYPE_EVENT, True)
+	def BINARY_ClearQuest(self, index):
+		btn = self.__FindQuestButton(index)
+		if 0 != btn:
+			self.__DestroyQuestButton(btn)
 
-			if osfInfo.ENABLE_QUEST_LETTER_CATEGORY:
-				self.wndCharacter.OpenQuestCategory(btn.type, True)
+	def RecvQuest(self, index, name):
+		# QUEST_LETTER_IMAGE
+		self.BINARY_RecvQuest(index, name, "file", localeInfo.GetLetterImageName())
+		# END_OF_QUEST_LETTER_IMAGE
 
-			self.HideAllQuestButton()
-			global IsQBHide
-			IsQBHide = 1
+	def BINARY_RecvQuest(self, index, name, iconType, iconName):
+		btn = self.__FindQuestButton(index)
+		if 0 != btn:
+			self.__DestroyQuestButton(btn)
 
-		def __MakeQuestButton(self):
-			if osfInfo.ENABLE_QUEST_LETTER_CATEGORY:
-				for quest_type in range(quest.QUEST_TYPE_MAX):
-					if quest_type == quest.QUEST_TYPE_UNEXPOSED:
-						continue
-
-					btn = uiWhisper.WhisperButton()
-					if quest_type == quest.QUEST_TYPE_MAIN:
-						btn.SetUpVisual("d:/ymir work/ui/game/quest/scroll_close_red.tga")
-						btn.SetOverVisual("d:/ymir work/ui/game/quest/scroll_open_red.tga")
-						btn.SetDownVisual("d:/ymir work/ui/game/quest/scroll_close_red.tga")
-					elif quest_type == quest.QUEST_TYPE_SUB:
-						btn.SetUpVisual("d:/ymir work/ui/game/quest/scroll_close_orange.tga")
-						btn.SetOverVisual("d:/ymir work/ui/game/quest/scroll_open_orange.tga")
-						btn.SetDownVisual("d:/ymir work/ui/game/quest/scroll_close_orange.tga")
-					elif quest_type == quest.QUEST_TYPE_LEVELUP:
-						btn.SetUpVisual("d:/ymir work/ui/game/quest/scroll_close_purple.tga")
-						btn.SetOverVisual("d:/ymir work/ui/game/quest/scroll_open_purple.tga")
-						btn.SetDownVisual("d:/ymir work/ui/game/quest/scroll_close_purple.tga")
-					elif quest_type == quest.QUEST_TYPE_EVENT:
-						btn.SetUpVisual("d:/ymir work/ui/game/quest/scroll_close_sky_blue.tga")
-						btn.SetOverVisual("d:/ymir work/ui/game/quest/scroll_open_sky_blue.tga")
-						btn.SetDownVisual("d:/ymir work/ui/game/quest/scroll_close_sky_blue.tga")
-					elif quest_type == quest.QUEST_TYPE_COLLECTION:
-						btn.SetUpVisual("d:/ymir work/ui/game/quest/scroll_close_pink.tga")
-						btn.SetOverVisual("d:/ymir work/ui/game/quest/scroll_open_pink.tga")
-						btn.SetDownVisual("d:/ymir work/ui/game/quest/scroll_close_pink.tga")
-					elif quest_type == quest.QUEST_TYPE_SYSTEM:
-						btn.SetUpVisual("d:/ymir work/ui/game/quest/scroll_close_green.tga")
-						btn.SetOverVisual("d:/ymir work/ui/game/quest/scroll_open_green.tga")
-						btn.SetDownVisual("d:/ymir work/ui/game/quest/scroll_close_green.tga")
-					elif quest_type == quest.QUEST_TYPE_SCROLL:
-						btn.SetUpVisual("d:/ymir work/ui/game/quest/scroll_close_cyan.tga")
-						btn.SetOverVisual("d:/ymir work/ui/game/quest/scroll_open_cyan.tga")
-						btn.SetDownVisual("d:/ymir work/ui/game/quest/scroll_close_cyan.tga")
-					elif quest_type == quest.QUEST_TYPE_DAILY:
-						btn.SetUpVisual("d:/ymir work/ui/game/quest/scroll_close_blue.tga")
-						btn.SetOverVisual("d:/ymir work/ui/game/quest/scroll_open_blue.tga")
-						btn.SetDownVisual("d:/ymir work/ui/game/quest/scroll_close_blue.tga")
-					else:
-						btn.SetUpVisual("icon/item/scroll_close.tga")
-						btn.SetOverVisual("icon/item/scroll_open.tga")
-						btn.SetDownVisual("icon/item/scroll_close.tga")
-
-					btn.SetEvent(ui.__mem_func__(self.__OnClickQuestLetterButton), btn)
-					btn.Hide()
-					btn.type = quest_type
-					btn.count = 0
-
-					btn.counter_img = ui.ImageBox()
-					btn.counter_img.SetParent(btn)
-					btn.counter_img.AddFlag("not_pick")
-					btn.counter_img.SetPosition(0, 0)
-					btn.counter_img.LoadImage("d:/ymir work/ui/game/quest/counter_background.tga")
-					btn.counter_img.Show()
-
-					btn.counter = ui.TextLine()
-					btn.counter.SetParent(btn.counter_img)
-					btn.counter.SetText("99")
-					btn.counter.SetPosition(-1, -1)
-					btn.counter.SetWindowHorizontalAlignCenter()
-					btn.counter.SetHorizontalAlignCenter()
-					btn.counter.SetPackedFontColor(0xffffffff)
-					btn.counter.Show()
+		btn = uiWhisper.WhisperButton()
 
-					self.questButtonList.append(btn)
-			else:
-				btn = uiWhisper.WhisperButton()
-				btn.SetUpVisual(localeInfo.GetLetterCloseImageName())
-				btn.SetOverVisual(localeInfo.GetLetterOpenImageName())
-				btn.SetDownVisual(localeInfo.GetLetterOpenImageName())
-				btn.SetEvent(ui.__mem_func__(self.__OnClickQuestLetterButton), btn)
-				btn.Hide()
-				btn.type = quest.QUEST_TYPE_MAX
-				btn.count = 0
-				self.questButtonList.append(btn)
+		# QUEST_LETTER_IMAGE
+		##!! 20061026.levites.퀘스트_이미지_교체
+		import item
+
+		if "item" == iconType:
+			item.SelectItem(int(iconName))
+			buttonImageFileName = item.GetIconImageFileName()
+		elif "blue_quest" == iconType or name[0] == "*":
+			buttonImageFileName = localeInfo.GetBlueLetterImageName()
+		else:
+			buttonImageFileName = iconName
 
-				# Used for event quests in order to highlight it.
-				btn = uiWhisper.WhisperButton()
+		if localeInfo.IsEUROPE():
+			if name[0] == "*":
 				btn.SetUpVisual(localeInfo.GetBlueLetterImageName())
 				btn.SetOverVisual(localeInfo.GetBlueLetterOpenImageName())
-				btn.SetDownVisual(localeInfo.GetBlueLetterOpenImageName())
-				btn.SetEvent(ui.__mem_func__(self.__OnClickQuestLetterButton), btn)
-				btn.Hide()
-				btn.type = quest.QUEST_TYPE_EVENT
-				btn.count = 0
-				self.questButtonList.append(btn)
-
-			self.__ArrangeQuestButton()
-
-		def __ArrangeQuestButton(self):
-			screen_width = wndMgr.GetScreenWidth()
-			screen_height = wndMgr.GetScreenHeight()
-
-			x = 100 + 30 if self.wndParty.IsShow() else 20
-			if localeInfo.IsARABIC():
-				x += 15
-
-			y = 170 * screen_height / 600
-			y_count = (screen_height - 330) / 63
-
-			count = 0
-			for btn in self.questButtonList:
-				if btn.count != 0:
-					if osfInfo.ENABLE_QUEST_LETTER_CATEGORY:
-						if self.wndCharacter:
-							btn.SetToolTipText(self.wndCharacter.GetQuestLabelName(btn.type), -20, 35)
-						btn.counter.SetText("%d" % btn.count)
-						if localeInfo.IsARABIC():
-							btn.ToolTipText.SetHorizontalAlignRight()
-						else:
-							btn.ToolTipText.SetHorizontalAlignLeft()
-					else:
-						btn.SetToolTipText(str(btn.count), 0, 35)
-					btn.SetPosition(x + (int(count / y_count) * 100), y + (count % y_count * 63))
-					count += 1
-
-				global IsQBHide
-				if IsQBHide:
-					btn.Hide()
+				btn.SetDownVisual(localeInfo.GetBlueLetterCloseImageName())
+				name = name[1:]
+			else:
+				if "highlight" == iconType:
+					btn.SetUpVisual("locale/ymir_ui/highlighted_quest.tga")
+					btn.SetOverVisual("locale/ymir_ui/highlighted_quest_r.tga")
+					btn.SetDownVisual("locale/ymir_ui/highlighted_quest_r.tga")
 				else:
-					if btn.count > 0:
-						btn.Show()
-
-		def __RefreshQuestButton(self):
-			for btn in self.questButtonList:
-				btn.count = quest.GetQuestButtonNoticeCount(btn.type)
-			self.__ArrangeQuestButton()
-	else:
-		def BINARY_ClearQuest(self, index):
-			btn = self.__FindQuestButton(index)
-			if 0 != btn:
-				self.__DestroyQuestButton(btn)
+					btn.SetUpVisual(localeInfo.GetLetterCloseImageName())
+					btn.SetOverVisual(localeInfo.GetLetterOpenImageName())
+					btn.SetDownVisual(localeInfo.GetLetterOpenImageName())
+		else:
+			btn.SetUpVisual(buttonImageFileName)
+			btn.SetOverVisual(buttonImageFileName)
+			btn.SetDownVisual(buttonImageFileName)
+			btn.Flash()
+		# END_OF_QUEST_LETTER_IMAGE
+
+		if localeInfo.IsARABIC():
+			btn.SetToolTipText(name, -20, 35)
+			btn.ToolTipText.SetHorizontalAlignRight()
+		else:
+			btn.SetToolTipText(name, -20, 35)
+			btn.ToolTipText.SetHorizontalAlignLeft()
 
-		def RecvQuest(self, index, name):
-			# QUEST_LETTER_IMAGE
-			self.BINARY_RecvQuest(index, name, "file", localeInfo.GetLetterImageName())
-			# END_OF_QUEST_LETTER_IMAGE
+		btn.SetEvent(ui.__mem_func__(self.__StartQuest), btn)
+		btn.Show()
 
-		def BINARY_RecvQuest(self, index, name, iconType, iconName):
-			btn = self.__FindQuestButton(index)
-			if 0 != btn:
-				self.__DestroyQuestButton(btn)
+		btn.index = index
+		btn.name = name
 
-			btn = uiWhisper.WhisperButton()
-
-			# QUEST_LETTER_IMAGE
-			##!! 20061026.levites.퀘스트_이미지_교체
-			import item
-
-			if "item" == iconType:
-				item.SelectItem(int(iconName))
-				buttonImageFileName = item.GetIconImageFileName()
-			elif "blue_quest" == iconType or name[0] == "*":
-				buttonImageFileName = localeInfo.GetBlueLetterImageName()
-			else:
-				buttonImageFileName = iconName
+		self.questButtonList.insert(0, btn)
+		self.__ArrangeQuestButton()
 
-			if localeInfo.IsEUROPE():
-				if name[0] == "*":
-					btn.SetUpVisual(localeInfo.GetBlueLetterImageName())
-					btn.SetOverVisual(localeInfo.GetBlueLetterOpenImageName())
-					btn.SetDownVisual(localeInfo.GetBlueLetterCloseImageName())
-					name = name[1:]
-				else:
-					if "highlight" == iconType:
-						btn.SetUpVisual("locale/ymir_ui/highlighted_quest.tga")
-						btn.SetOverVisual("locale/ymir_ui/highlighted_quest_r.tga")
-						btn.SetDownVisual("locale/ymir_ui/highlighted_quest_r.tga")
-					elif "blue_quest" == iconType:
-						btn.SetUpVisual(localeInfo.GetBlueLetterCloseImageName())
-						btn.SetOverVisual(localeInfo.GetBlueLetterOpenImageName())
-						btn.SetDownVisual(localeInfo.GetBlueLetterOpenImageName())
-					else:
-						btn.SetUpVisual(localeInfo.GetLetterCloseImageName())
-						btn.SetOverVisual(localeInfo.GetLetterOpenImageName())
-						btn.SetDownVisual(localeInfo.GetLetterOpenImageName())
-			else:
-				btn.SetUpVisual(buttonImageFileName)
-				btn.SetOverVisual(buttonImageFileName)
-				btn.SetDownVisual(buttonImageFileName)
-				btn.Flash()
-			# END_OF_QUEST_LETTER_IMAGE
+		#chat.AppendChat(chat.CHAT_TYPE_NOTICE, localeInfo.QUEST_APPEND)
 
-			if localeInfo.IsARABIC():
-				btn.SetToolTipText(name, -20, 35)
-				btn.ToolTipText.SetHorizontalAlignRight()
-			else:
-				btn.SetToolTipText(name, -20, 35)
-				btn.ToolTipText.SetHorizontalAlignLeft()
+	def __ArrangeQuestButton(self):
+		screenWidth = wndMgr.GetScreenWidth()
+		screenHeight = wndMgr.GetScreenHeight()
 
-			btn.SetEvent(ui.__mem_func__(self.__StartQuest), btn)
-			btn.Show()
+		##!! 20061026.levites.퀘스트_위치_보정
+		if self.wndParty.IsShow():
+			xPos = 100 + 30
+		else:
+			xPos = 20
 
-			btn.index = index
-			btn.name = name
+		if localeInfo.IsARABIC():
+			xPos = xPos + 15
 
-			self.questButtonList.insert(0, btn)
-			self.__ArrangeQuestButton()
+		yPos = 170 * screenHeight / 600
+		yCount = (screenHeight - 330) / 63
 
-			#chat.AppendChat(chat.CHAT_TYPE_NOTICE, localeInfo.QUEST_APPEND)
+		count = 0
+		for btn in self.questButtonList:
+			btn.SetPosition(xPos + (int(count / yCount) * 100), yPos + (count % yCount * 63))
+			count += 1
 
-		def __ArrangeQuestButton(self):
-			screenWidth = wndMgr.GetScreenWidth()
-			screenHeight = wndMgr.GetScreenHeight()
-
-			##!! 20061026.levites.퀘스트_위치_보정
-			if self.wndParty.IsShow():
-				xPos = 100 + 30
+			global IsQBHide
+			if IsQBHide:
+				btn.Hide()
 			else:
-				xPos = 20
-
-			if localeInfo.IsARABIC():
-				xPos = xPos + 15
-
-			yPos = 170 * screenHeight / 600
-			yCount = (screenHeight - 330) / 63
-
-			count = 0
-			for btn in self.questButtonList:
-				btn.SetPosition(xPos + (int(count / yCount) * 100), yPos + (count % yCount * 63))
-				count += 1
-
-				global IsQBHide
-				if IsQBHide:
-					btn.Hide()
-				else:
-					btn.Show()
+				btn.Show()
 
-		def __StartQuest(self, btn):
-			event.QuestButtonClick(btn.index)
-			self.__DestroyQuestButton(btn)
+	def __StartQuest(self, btn):
+		event.QuestButtonClick(btn.index)
+		self.__DestroyQuestButton(btn)
 
-		def __FindQuestButton(self, index):
-			for btn in self.questButtonList:
-				if btn.index == index:
-					return btn
+	def __FindQuestButton(self, index):
+		for btn in self.questButtonList:
+			if btn.index == index:
+				return btn
 
-			return 0
+		return 0
 
-		def __DestroyQuestButton(self, btn):
-			btn.SetEvent(0)
-			self.questButtonList.remove(btn)
-			self.__ArrangeQuestButton()
+	def __DestroyQuestButton(self, btn):
+		btn.SetEvent(0)
+		self.questButtonList.remove(btn)
+		self.__ArrangeQuestButton()
 
 	def HideAllQuestButton(self):
 		for btn in self.questButtonList:
 			btn.Hide()
 
 	def ShowAllQuestButton(self):
-		if app.ENABLE_QUEST_RENEWAL:
-			for btn in self.questButtonList:
-				if btn.count > 0:
-					btn.Show()
-		else:
-			for btn in self.questButtonList:
-				btn.Show()
+		for btn in self.questButtonList:
+			btn.Show()
 
 	#####################################################################################
 
@@ -2765,6 +2355,14 @@
 		self.dlgWhisperWithoutTarget = None
 		self.__CheckGameMaster(name)
 
+	def RecieveWhisperDetails(self, name, country):
+		if self.whisperDialogDict.has_key(name):
+			self.whisperDialogDict[name].SetCountryFlag(country)
+		else:
+			btn = self.__FindWhisperButton(name)
+			if btn != 0:
+				btn.countryID = country
+
 	## 캐릭터 메뉴의 1:1 대화 하기를 눌렀을때 이름을 가지고 바로 창을 여는 함수
 	def OpenWhisperDialog(self, name):
 		if not self.whisperDialogDict.has_key(name):
@@ -2846,6 +2444,8 @@
 		yPos = 170 * screenHeight / 600
 		yCount = (screenHeight - 330) / 63
 		#yCount = (screenHeight - 285) / 63
+		if app.ENABLE_RTT_STATISTICS:
+			yPos += 30
 
 		count = 0
 		for button in self.whisperButtonList:
@@ -3015,37 +2615,26 @@
 	def EmptyFunction(self):
 		pass
 
-	if app.ENABLE_MINI_GAME_RUMI:
-		def MiniGameRumiStart(self):
-			if self.wndMiniGame:
-				self.wndMiniGame.MiniGameRumiStart()
-
-		def MiniGameRumiEnd(self):
-			if self.wndMiniGame:
-				self.wndMiniGame.MiniGameRumiEnd()
-
-		def MiniGameRumiMoveCard(self, srcCard, dstCard):
-			if self.wndMiniGame:
-				self.wndMiniGame.MiniGameRumiMoveCard(srcCard, dstCard)
-
-		def MiniGameRumiSetDeckCount(self, deck_card_count):
-			if self.wndMiniGame:
-				self.wndMiniGame.MiniGameRumiSetDeckCount(deck_card_count)
+	if app.ENABLE_MINI_GAME_OKEY:
+		def MiniGameOkey(self):
+			isOpen = osfInfo.RUMI_GAME_EVENT
+
+			if isOpen == True:
+				if not self.wndMiniGame:
+					self.wndMiniGame = uiMiniGame.MiniGameWindow()
 
-		def MiniGameRumiIncreaseScore(self, score, total_score):
-			if self.wndMiniGame:
-				self.wndMiniGame.MiniGameRumiIncreaseScore(score, total_score)
-
-		if app.ENABLE_OKEY_EVENT_FLAG_RENEWAL:
-			def MiniGameRumiFlagProcess(self, process_type, data):
+				self.wndMiniGame.MiniGameOkeyEvent(True)
+			else:
 				if self.wndMiniGame:
-					self.wndMiniGame.MiniGameRumiFlagProcess(process_type, data)
-
-		def SetOkeyNormalBG(self):
-			if self.wndMiniGame:
-				self.wndMiniGame.SetOkeyNormalBG()
+					self.wndMiniGame.MiniGameOkeyEvent(False)
 
 	if app.ENABLE_MINI_GAME_CATCH_KING:
+		def SetCatchKingEventStatus(self, isEnable):
+			if isEnable:
+				osfInfo.CATCH_KING_GAME_EVENT = True
+			else:
+				osfInfo.CATCH_KING_GAME_EVENT = False
+
 		def MiniGameCatchKingEventStart(self, bigScore):
 			if self.wndMiniGame:
 				self.wndMiniGame.MiniGameCatchKingEventStart(bigScore)
@@ -3066,18 +2655,30 @@
 			if self.wndMiniGame:
 				self.wndMiniGame.MiniGameCatchKingReward(rewardCode)
 
-		if app.ENABLE_CATCH_KING_EVENT_FLAG_RENEWAL:
-			def CatchKingFlagProcess(self, type, data):
-				if self.wndMiniGame:
-					self.wndMiniGame.CatchKingFlagProcess(type, data)
+	def IntegrationEventBanner(self):
+		isOpen = []
 
-	if app.WJ_ENABLE_TRADABLE_ICON or app.ENABLE_MOVE_COSTUME_ATTR or app.ENABLE_MAILBOX:
-		def AttachInvenItemToOtherWindowSlot(self, slotIndex, slotWindow):
-			if app.ENABLE_MOVE_COSTUME_ATTR:
-				if self.GetOnTopWindow() == player.ON_TOP_WND_ITEM_COMB and self.wndItemCombination and self.wndItemCombination.IsShow():
-					self.wndItemCombination.AttachToCombinationSlot(slotWindow, slotIndex)
-					return True
+		if app.ENABLE_MINI_GAME_OKEY:
+			isOpen.append(osfInfo.RUMI_GAME_EVENT)
 
+		if app.ENABLE_MINI_GAME_CATCH_KING:
+			isOpen.append(osfInfo.CATCH_KING_GAME_EVENT)
+
+		if True in isOpen:
+			if not self.wndMiniGame:
+				self.wndMiniGame = uiMiniGame.MiniGameWindow()
+
+				if self.tooltipItem:
+					self.wndMiniGame.SetItemToolTip(self.tooltipItem)
+
+			self.wndMiniGame.IntegrationMiniGame(True)
+		else:
+			if self.wndMiniGame:
+				self.wndMiniGame.IntegrationMiniGame(False)
+
+	if app.WJ_ENABLE_TRADABLE_ICON:
+		def AttachInvenItemToOtherWindowSlot(self, slotIndex):
+			# Used for (ENABLE_MOVE_COSTUME_ATTR, ENABLE_GROWTH_PET_SYSTEM)
 			return False
 
 		def MarkUnusableInvenSlotOnTopWnd(self, onTopWnd, InvenSlot):
@@ -3091,30 +2692,18 @@
 				elif onTopWnd == player.ON_TOP_WND_EXCHANGE and self.dlgExchange and self.dlgExchange.CantTradableItem(InvenSlot):
 					return True
 
-			if app.ENABLE_MOVE_COSTUME_ATTR:
-				if onTopWnd == player.ON_TOP_WND_ITEM_COMB and self.wndItemCombination and self.wndItemCombination.CantAttachToCombSlot(InvenSlot):
+			if app.ENABLE_ACCE_COSTUME_SYSTEM:
+				if onTopWnd == player.ON_TOP_WND_ACCE_COMBINE and self.wndAcceCombine and self.wndAcceCombine.CantTradableItem(InvenSlot):
 					return True
-
-			if app.ENABLE_MAILBOX:
-				if onTopWnd == player.ON_TOP_WND_MAILBOX and self.mail_box and self.mail_box.CantPostItemSlot(InvenSlot):
-					return True
-
-			if app.ENABLE_ATTR_6TH_7TH:
-				if onTopWnd == player.ON_TOP_WND_ATTR67 and self.wndAttr67Add and self.wndAttr67Add.CantAttachToAttrSlot(InvenSlot):
+				elif onTopWnd == player.ON_TOP_WND_ACCE_ABSORB and self.wndAcceAbsorption and self.wndAcceAbsorption.CantTradableItem(InvenSlot):
 					return True
 
-			if app.ENABLE_LUCKY_BOX:
-				if onTopWnd == player.ON_TOP_WND_LUCKY_BOX and self.wndLuckyBox:
+			if app.ENABLE_CHANGE_LOOK_SYSTEM:
+				if onTopWnd == player.ON_TOP_WND_CHANGE_LOOK and self.wndChangeLook and self.wndChangeLook.CantTradableItem(InvenSlot):
 					return True
 
-			if app.ENABLE_GROWTH_PET_SYSTEM:
-				if onTopWnd == player.ON_TOP_WND_PET_FEED and self.wndPetInfoWindow and self.wndPetInfoWindow.CantFeedItem(InvenSlot):
-					return True
-					
-				if onTopWnd == player.ON_TOP_WND_PET_ATTR_CHANGE and self.wndPetInfoWindow and self.wndPetInfoWindow.CantAttrChangeItem(InvenSlot):
-					return True
-					
-				if onTopWnd == player.ON_TOP_WND_PET_PRIMIUM_FEEDSTUFF and self.wndPetInfoWindow and self.wndPetInfoWindow.CantPremiumFeedItem(InvenSlot):
+			if app.ENABLE_MAILBOX:
+				if onTopWnd == player.ON_TOP_WND_MAILBOX and self.mail_box and self.mail_box.CantPostItemSlot(InvenSlot):
 					return True
 
 			return False
@@ -3140,15 +2729,34 @@
 				if self.wndDragonSoul and self.wndDragonSoul.IsShow():
 					self.wndDragonSoul.RefreshBagSlotWindow()
 
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		def ExInvenItemUseMsg(self, item_vnum, msg, enough_count):
-			self.wndInventory.ExInvenItemUseMsg(item_vnum, msg, enough_count)
+			if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+				if self.wndSpecialInventory and self.wndSpecialInventory.IsShow():
+					self.wndSpecialInventory.RefreshBagSlotWindow()
+
+	if app.ENABLE_HIDE_COSTUME_SYSTEM:
+		def RefreshVisibleCostume(self):
+			self.wndInventory.RefreshVisibleCostume()
 
 	if app.ENABLE_MOVE_CHANNEL:
 		def RefreshServerInfo(self):
 			if self.wndMiniMap:
 				self.wndMiniMap.RefreshServerInfo()
 
+	if app.ENABLE_EXPRESSING_EMOTION:
+		def ClearSpecialEmotions(self):
+			if self.wndCharacter:
+				self.wndCharacter.ClearSpecialEmotions()
+
+		def RegisterSpecialEmotions(self, emotionIdx, leftTime):
+			if self.wndCharacter:
+				self.wndCharacter.RegisterSpecialEmotions(emotionIdx, leftTime)
+
+	if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+		def OpenPShopSearchDialogCash(self):
+			self.wndPrivateShopSearch.Open(1)
+		def RefreshPShopSearchDialog(self):
+			self.wndPrivateShopSearch.RefreshList()
+
 	if app.ENABLE_MAILBOX:
 		def MailBoxProcess(self, type, data):
 			if not self.mail_box:
@@ -3162,152 +2770,6 @@
 
 			self.wndMiniMap.MiniMapMailProcess(type, data)
 
-	if app.ENABLE_LOOTING_SYSTEM:
-		def OpenLootingSystemWindow(self):
-			if self.wndLootFilter:
-				self.wndLootFilter.Open()
-
-		def LootingSystemProcess(self):
-			if self.wndLootFilter:
-				self.wndLootFilter.LootingSystemProcess()
-
-	if app.ENABLE_MINI_GAME_YUTNORI:
-		def YutnoriProcess(self, type, data):
-			if self.wndMiniGame:
-				self.wndMiniGame.YutnoriProcess(type, data)
-
-		def YutnoriFlagProcess(self, type, data):
-			if self.wndMiniGame:
-				self.wndMiniGame.YutnoriFlagProcess(type, data)
-
-	if app.ENABLE_LUCKY_BOX:
-		def ShowLuckyBoxWindow(self, dwItemVnum, byItemCount, iNeedMoney, wSlotIndex):
-			if self.wndLuckyBox:
-				self.wndLuckyBox.ShowLuckyBoxWindow(dwItemVnum, byItemCount, iNeedMoney, wSlotIndex)
-
-	if app.ENABLE_ATTR_6TH_7TH:
-		def OpenAttr67AddDlg(self):
-			if self.wndAttr67Add.IsShow():
-				return
-
-			self.wndAttr67Add.Show()
-
-	if app.ENABLE_CLIENT_TIMER:
-		def ClientTimerProcess(self, type, data):
-			if self.wndMiniMap:
-				self.wndMiniMap.ClientTimerProcess(type, data)
-
-	def UseInventoryItemInQuickSlot(self, global_slot_index):
-		if self.wndInventory:
-			self.wndInventory.UseInventoryItemInQuickSlot(global_slot_index)
-
-	if app.ENABLE_EXPRESSING_EMOTION:
-		def AddSpecialActionSlot(self, byType, dwDuration):
-			self.wndCharacter.AddSpecialActionSlot(byType, dwDuration)
-
-		def RemoveSpecialActionSlot(self, iIndex):
-			self.wndCharacter.RemoveSpecialActionSlot(iIndex)
-
-		def RemoveQuickSlotIndex(self, iIndex):
-			self.wndTaskBar.RemoveQuickSlotIndex(iIndex)
-
-	if app.ENABLE_SNOWFLAKE_STICK_EVENT:
-		def SnowflakeStickEventProcess(self, type, data):
-			if self.wndMiniGame:
-				self.wndMiniGame.SnowflakeStickEventProcess(type, data)
-
-	if app.ENABLE_GAME_OPTION_ESCAPE:
-		def IsEscapeQuestionPopupOpen(self):
-			return self.wndEscapePopup and self.wndEscapePopup.IsEscapeQuestionPopupOpen()
-
-		def OpenEscapeQuestionPopup(self):
-			if not self.wndEscapePopup:
-				self.wndEscapePopup = uiEscapePopup.EscapeManager()
-			self.wndEscapePopup.OpenEscapePopup()
-
-	if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-		def IsRefineElementDialogOpen(self):
-			if self.dlgRefineElement:
-				if self.dlgRefineElement.IsShow():
-					return True
-
-			if self.dlgRefineElementChange:
-				if self.dlgRefineElementChange.IsShow():
-					return True
-
-			return False
-
-		def RefineElementProcess(self, type, refine_type, data):
-			if not self.dlgRefineElement or not self.dlgRefineElementChange:
-				return
-
-			if refine_type == player.REFINE_ELEMENT_CHANGE:
-				self.dlgRefineElementChange.RefineElementChangeProcess(type, refine_type, data)
-			else:
-				self.dlgRefineElement.RefineElementProcess(type, refine_type, data)
-
-	if app.ENABLE_HIDE_COSTUME_SYSTEM:
-		def SetHiddenCostumePart(self, part, hidden):
-			if self.wndInventory:
-				self.wndInventory.SetHiddenCostumePart(part, hidden)
-
-	if app.ENABLE_EVENT_BANNER:
-		def ShowInGameEvent(self):
-			if self.wndMiniGame:
-				self.wndMiniGame.ShowInGameEvent()
-
-		def RefreshInGameEvent(self):
-			if self.wndMiniGame:
-				self.wndMiniGame.RefreshInGameEvent()
-
-		def ShowMiniMapInGameEventButton(self):
-			if self.wndMiniMap:
-				self.wndMiniMap.ShowMiniMapInGameEventButton()
-
-		def HideMiniMapInGameEventButton(self):
-			if self.wndMiniMap:
-				self.wndMiniMap.HideMiniMapInGameEventButton()
-
-	if app.ENABLE_LOCALE_CLIENT:
-		def LanguageChange(self):
-			if self.dlgSystem:
-				self.dlgSystem.LanguageChange()
-
-	if app.ENABLE_LEFT_SEAT:
-		def LoadLeftSeatWaitTimeIndexData(self):
-			if self.dlgSystem:
-				self.dlgSystem.LoadLeftSeatWaitTimeIndexData()
-
-	if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
-		def OpenGuildDragonLairRanking(self,type):
-			self.wndGuildDragonLairRanking.Open(type)
-
-		def RefreshGuildDragonLairRanking(self, type):
-			self.wndGuildDragonLairRanking.RefreshGuildDragonLairRanking(type)
-
-		def GetDragonLairType(self):
-			self.wndGuildDragonLairRanking.GetDragonLairType()
-
-		if app.ENABLE_GUILD_DRAGONLAIR_PARTY_SYSTEM:
-			def SetGuildDragonLairFistGuildText(self, second):
-				self.wndMiniMap.SetGuildDragonLairFistGuildText(second)
-			def SetGuildDragonLairStart(self):
-				self.wndMiniMap.SetGuildDragonLairStart()
-			def SetGuildDragonLairSuccess(self):
-				self.wndMiniMap.SetGuildDragonLairSuccess()
-
-	if app.ENABLE_SUMMER_EVENT_ROULETTE:
-		def RouletteProcess(self, type, data):
-			self.wndMiniGame.RouletteProcess(type, data)
-
-		def IsLateSummerRouletteGameOpen(self):
-			return self.wndMiniGame.IsLateSummerRouletteGameOpen()
-
-	if app.ENABLE_FLOWER_EVENT:
-		def FlowerEventProcess(self, type, data = None):
-			if self.wndMiniGame:
-				self.wndMiniGame.FlowerEventProcess(type, data)
-
 	if app.ENABLE_GROWTH_PET_SYSTEM:
 		def PetHatchingWindowCommand(self, command):
 			if self.wndPetInfoWindow:
@@ -3350,11 +2812,12 @@
 		def PetReviveResult(self, result):
 			if self.wndPetInfoWindow:
 				self.wndPetInfoWindow.PetReviveResult(result)
-				
-		def PetWindowTypeResult(self, result):
+
+		def PetWindowTypeResult(self, result): #checked
 			if self.wndPetInfoWindow:
 				self.wndPetInfoWindow.PetWindowTypeResult(result)
 
+
 if __name__ == "__main__":
 	import app
 	import wndMgr
diff -ruN client_base/client/client/pack/root/localeinfo.py client_final/client/client/pack/root/localeinfo.py
--- client_base/client/client/pack/root/localeinfo.py	2026-02-13 09:22:34.000000000 +0000
+++ client_final/client/client/pack/root/localeinfo.py	2026-02-20 18:13:16.292872274 +0000
@@ -2,15 +2,20 @@
 import constInfo
 import background
 
+if app.ENABLE_GENDER_ALIGNMENT:
+	import chr, net
+	GENDER_FEMALE = 0
+	GENDER_MALE = 1
+
 MAP_TRENT02 = "MAP_TRENT02" # 임시
 MAP_WL = "MAP_WL" # 임시
-MAP_NUSLUCK = "MAP_NUSLUCK" # 임시
+MAP_NUSLUCK = "MAP_NUSLUCK" # 임시 
 MAP_TREE2 = "MAP_TREE2"
 
 BLEND_POTION_NO_TIME = "BLEND_POTION_NO_TIME"
 BLEND_POTION_NO_INFO = "BLEND_POTION_NO_INFO"
 
-APP_TITLE = "METIN2"
+APP_TITLE = "METIN2 - OSF Project"
 
 GUILD_HEADQUARTER = "Main Building"
 GUILD_FACILITY = "Facility"
@@ -48,7 +53,6 @@
 __IS_WE_KOREA = "locale/we_korea" == app.GetLocalePath()
 __IS_TAIWAN = "locale/taiwan" == app.GetLocalePath()
 __IS_JAPAN = "locale/japan" == app.GetLocalePath()
-
 LOGIN_FAILURE_WRONG_SOCIALID = "ASDF"
 LOGIN_FAILURE_SHUTDOWN_TIME = "ASDF"
 
@@ -154,475 +158,37 @@
 		return text % x1
 	return f
 
-if app.ENABLE_LOCALE_CLIENT:
-	alsoExportToCharset = "windows-1250"
-	localeDict = {}
+def LoadLocaleFile(srcFileName, localeDict):
+	funcDict = {"SA":SA, "SNA":SNA, "SAA":SAA, "SAN":SAN, "SAAAA":SAAAA,}
 
-	def LoadLocaleFile(srcFileName):
-		funcDict = { "SA" : SA, "SNA" : SNA, "SAA" : SAA, "SAN" : SAN, "SAAAA" : SAAAA, }
+	lineIndex = 1
 
-		lineIndex = 1
+	try:
+		lines = open(srcFileName, "r").readlines()
+	except IOError:
+		import dbg
+		dbg.LogBox("LoadLocaleError(%(srcFileName)s)" % locals())
+		app.Abort()
 
+	for line in lines:
 		try:
-			lines = open(srcFileName, "r").readlines()
-		except IOError:
-			import dbg
-			dbg.LogBox("LoadLocaleError(%(srcFileName)s)" % locals())
-			app.Abort()
-
-		global localeDict
-
-		for line in lines:
-			try:
-				tokens = line[:-1].split("\t")
-				if len(tokens) == 2:
-					localeDict[tokens[0]] = tokens[1]
-				elif len(tokens) >= 3:
-					type = tokens[2].strip()
-					if type:
-						localeDict[tokens[0]] = funcDict[type](tokens[1])
-					else:
-						localeDict[tokens[0]] = tokens[1]
+			tokens = line[:-1].split("\t")
+			if len(tokens) == 2:
+				localeDict[tokens[0]] = tokens[1]
+			elif len(tokens) >= 3:
+				type = tokens[2].strip()
+				if type:
+					localeDict[tokens[0]] = funcDict[type](tokens[1])
 				else:
-					raise RuntimeError, "Unknown TokenSize"
-
-				lineIndex += 1
-
-			except:
-				import dbg
-				dbg.LogBox("%s: line(%d): %s" % (srcFileName, lineIndex, line), "Error")
-				raise
-
-			globals().update(localeDict)
-
-	def ReloadLocaleFile():
-		global localeDict
-		localeDict.clear()
-
-		global GUILD_BUILDING_LIST_TXT
-		GUILD_BUILDING_LIST_TXT = app.GetLocalePath() + "/GuildBuildingList.txt"
-
-		global __IS_ENGLISH
-		global __IS_HONGKONG
-		global __IS_NEWCIBN
-		global __IS_EUROPE
-		global __IS_CANADA
-		global __IS_BRAZIL
-		global __IS_SINGAPORE
-		global __IS_VIETNAM
-		global __IS_ARABIC
-		global __IS_CIBN10
-		global __IS_WE_KOREA
-		global __IS_TAIWAN
-		global __IS_JAPAN
-
-		__IS_ENGLISH = "ENGLISH" == app.GetLocaleServiceName()
-		__IS_HONGKONG = "HONGKONG" == app.GetLocaleServiceName()
-		__IS_NEWCIBN = "locale/newcibn" == app.GetLocalePath()
-		__IS_EUROPE = "EUROPE" == app.GetLocaleServiceName()
-		__IS_CANADA = "locale/ca" == app.GetLocalePath()
-		__IS_BRAZIL = "locale/br" == app.GetLocalePath()
-		__IS_SINGAPORE = "locale/sg" == app.GetLocalePath()
-		__IS_VIETNAM = "locale/vn" == app.GetLocalePath()
-		__IS_ARABIC = "locale/ae" == app.GetLocalePath()
-		__IS_CIBN10 = "locale/cibn10" == app.GetLocalePath()
-		__IS_WE_KOREA = "locale/we_korea" == app.GetLocalePath()
-		__IS_TAIWAN = "locale/taiwan" == app.GetLocalePath()
-		__IS_JAPAN = "locale/japan" == app.GetLocalePath()
-
-		global LOCALE_FILE_NAME
-		global NEW_LOCALE_FILE_NAME
-		LOCALE_FILE_NAME = "%s/locale_game.txt" % app.GetLocalePath()
-		NEW_LOCALE_FILE_NAME = "%s/new_locale_game.txt" % app.GetLocalePath()
-
-		LoadLocaleFile(LOCALE_FILE_NAME)
-		LoadLocaleFile(NEW_LOCALE_FILE_NAME)
-
-		## NOTE : Reset all global variables after reloading the locale file
-		## in order to change the strings properly.
-
-		## All other global variables that are defined in other modules can be moved
-		## into their class constructor which will reset them once they're loaded.
-
-		global OPTION_PVPMODE_MESSAGE_DICT
-		OPTION_PVPMODE_MESSAGE_DICT = {
-			0 : PVP_MODE_NORMAL,
-			1 : PVP_MODE_REVENGE,
-			2 : PVP_MODE_KILL,
-			3 : PVP_MODE_PROTECT,
-			4 : PVP_MODE_GUILD,
-		}
-
-		global GUILDWAR_NORMAL_DESCLIST
-		global GUILDWAR_WARP_DESCLIST
-		global GUILDWAR_CTF_DESCLIST
-		GUILDWAR_NORMAL_DESCLIST = [GUILD_WAR_USE_NORMAL_MAP, GUILD_WAR_LIMIT_30MIN, GUILD_WAR_WIN_CHECK_SCORE]
-		GUILDWAR_WARP_DESCLIST = [GUILD_WAR_USE_BATTLE_MAP, GUILD_WAR_WIN_WIPE_OUT_GUILD, GUILD_WAR_REWARD_POTION]
-		GUILDWAR_CTF_DESCLIST = [GUILD_WAR_USE_BATTLE_MAP, GUILD_WAR_WIN_TAKE_AWAY_FLAG1, GUILD_WAR_WIN_TAKE_AWAY_FLAG2, GUILD_WAR_REWARD_POTION]
-
-		global MINIMAP_ZONE_NAME_DICT
-		MINIMAP_ZONE_NAME_DICT = {
-			"metin2_map_a1" : MAP_A1,
-			"map_a2" : MAP_A2,
-			"metin2_map_a3" : MAP_A3,
-			"metin2_map_b1" : MAP_B1,
-			"map_b2" : MAP_B2,
-			"metin2_map_b3" : MAP_B3,
-			"metin2_map_c1" : MAP_C1,
-			"map_c2" : MAP_C2,
-			"metin2_map_c3" : MAP_C3,
-			"map_n_snowm_01" : MAP_SNOW,
-			"metin2_map_n_flame_01" : MAP_FLAME,
-			"metin2_map_n_desert_01" : MAP_DESERT,
-			"metin2_map_milgyo" : MAP_TEMPLE,
-			"metin2_map_spiderdungeon" : MAP_SPIDER,
-			"metin2_map_deviltower1" : MAP_SKELTOWER,
-			"metin2_map_guild_01" : MAP_AG,
-			"metin2_map_guild_02" : MAP_BG,
-			"metin2_map_guild_03" : MAP_CG,
-			"metin2_map_trent" : MAP_TREE,
-			"metin2_map_trent02" : MAP_TREE2,
-			"season1/metin2_map_WL_01" : MAP_WL,
-			"season1/metin2_map_nusluck01" : MAP_NUSLUCK,
-			"Metin2_map_CapeDragonHead" : MAP_CAPE,
-			"metin2_map_Mt_Thunder" : MAP_THUNDER,
-			"metin2_map_dawnmistwood" : MAP_DAWN,
-			"metin2_map_BayBlackSand" : MAP_BAY,
-			"metin2_map_anglar_dungeon_01" : MAP_FARMING_DUNGEON,
-			"metin2_map_battleroyale" : MAP_BATTLE_ROYALE,
-			"metin2_map_eastplain_01" : MAP_EASTPLAIN_01,
-			"metin2_map_eastplain_02" : MAP_EASTPLAIN_02,
-			"metin2_map_eastplain_03" : MAP_EASTPLAIN_03,
-			"metin2_map_empirecastle" : MAP_EMPIRECASTLE,
-			"metin2_map_golden_land" : MAP_GOLDEN_LAND,
-			"metin2_map_golden_land_stage" : MAP_GOLDEN_LAND_STAGE,
-			"metin2_map_icecrystalcave" : MAP_ICE_CRYSTALS_CAVE,
-			"metin2_map_mists_of_island" : MAP_MISTS_OF_ISLAND,
-			"metin2_map_privateshop" : MAP_PRIVATE_SHOP_MAP,
-			"metin2_map_smhgate_a1" : MAP_SUNGMAHEE_GATE_A1,
-			"metin2_map_smhgate_b1" : MAP_SUNGMAHEE_GATE_B1,
-			"metin2_map_smhgate_c1" : MAP_SUNGMAHEE_GATE_C1,
-			"metin2_map_smhgate_dawnmist" : MAP_SUNGMAHEE_GATE_DAWNMIST,
-			"metin2_map_smhgate_desert" : MAP_SUNGMAHEE_GATE_DESERT,
-			"metin2_map_smhgate_devils" : MAP_SUNGMAHEE_GATE_DEVILS,
-			"metin2_map_smhgate_flame" : MAP_SUNGMAHEE_GATE_FLAME,
-			"metin2_map_smhgate_snow" : MAP_SUNGMAHEE_GATE_SNOW,
-			"metin2_map_smhgate_threeway" : MAP_SUNGMAHEE_GATE_THREEWAY,
-			"metin2_map_snakevalley" : MAP_SNAKE_VALLEY,
-			"metin2_map_whitdragonvalley" : MAP_WHITE_DRAGON_VALLEY,
-			"metin2_map_whitedragoncave_01" : MAP_WHITE_DRAGON_CAVE_01,
-			"metin2_map_whitedragoncave_02" : MAP_WHITE_DRAGON_CAVE_02,
-			"metin2_map_whitedragoncave_boss" : MAP_WHITE_DRAGON_CAVE_BOSS,
-		}
-
-		global JOBINFO_TITLE
-		JOBINFO_TITLE = [
-			[ JOB_WARRIOR0, JOB_WARRIOR1, JOB_WARRIOR2, ],
-			[ JOB_ASSASSIN0, JOB_ASSASSIN1, JOB_ASSASSIN2, ],
-			[ JOB_SURA0, JOB_SURA1, JOB_SURA2, ],
-			[ JOB_SHAMAN0, JOB_SHAMAN1, JOB_SHAMAN2, ],
-			[ JOB_WOLFMAN0, JOB_WOLFMAN1, JOB_WOLFMAN1, ],
-		]
-
-		if app.WJ_SHOW_PARTY_ON_MINIMAP:
-			global MINIMAP_ZONE_NAME_DICT_BY_IDX
-			MINIMAP_ZONE_NAME_DICT_BY_IDX = {
-				0 : "",
-				1 : MAP_A1,
-				3 : MAP_A3,
-				4 : MAP_GUILD_01,
-				5 : MAP_MONKEY_DUNGEON_11,
-				6 : GUILD_VILLAGE_01,
-				21 : MAP_B1,
-				23 : MAP_B3,
-				24 : MAP_GUILD_02,
-				25 : MAP_MONKEY_DUNGEON_12,
-				26 : GUILD_VILLAGE_02,
-				41 : MAP_C1,
-				43 : MAP_C3,
-				44 : MAP_GUILD_03,
-				45 : MAP_MONKEY_DUNGEON_13,
-				46 : GUILD_VILLAGE_03,
-				61 : MAP_N_SNOWM_01,
-				62 : MAP_N_FLAME_01,
-				63 : MAP_N_DESERT_01,
-				64 : MAP_N_THREEWAY,
-				65 : MAP_MILGYO,
-				66 : MAP_DEVILTOWER1,
-				67 : MAP_TRENT,
-				68 : MAP_TRENT02,
-				69 : MAP_WL_01,
-				70 : MAP_NUSLUCK01,
-				71 : MAP_SPIDERDUNGEON_02,
-				72 : MAP_SKIPIA_DUNGEON_01,
-				73 : MAP_SKIPIA_DUNGEON_02,
-				74 : MAP_N_SNOWM_02,
-				75 : MAP_N_FLAME_02,
-				76 : MAP_N_DESERT_02,
-				77 : MAP_A2_1,
-				78 : MAP_MILGYO_A,
-				79 : MAP_TRENT_A,
-				80 : MAP_TRENT02_A,
-				81 : MAP_WEDDING_01,
-				91 : MAP_E,
-				92 : MAP_E,
-				93 : MAP_E,
-				103 : MAP_T1,
-				104 : MAP_SPIDERDUNGEON,
-				105 : MAP_T2,
-				107 : MAP_MONKEY_DUNGEON,
-				108 : MAP_MONKEY_DUNGEON2,
-				109 : MAP_MONKEY_DUNGEON3,
-				110 : MAP_T3,
-				111 : MAP_T4,
-				112 : MAP_DUEL,
-				113 : MAP_OXEVENT,
-				114 : MAP_SUNGZI,
-				118 : MAP_SUNGZI_FLAME_HILL_01,
-				119 : MAP_SUNGZI_FLAME_HILL_02,
-				120 : MAP_SUNGZI_FLAME_HILL_03,
-				121 : MAP_SUNGZI_SNOW,
-				122 : MAP_SUNGZI_SNOW_PASS01,
-				123 : MAP_SUNGZI_SNOW_PASS02,
-				124 : MAP_SUNGZI_SNOW_PASS03,
-				125 : MAP_SUNGZI_DESERT_01,
-				126 : MAP_SUNGZI_DESERT_HILL_01,
-				127 : MAP_SUNGZI_DESERT_HILL_02,
-				128 : MAP_SUNGZI_DESERT_HILL_03,
-				130 : GUILD_WAR1,
-				131 : GUILD_WAR2,
-				132 : GUILD_WAR3,
-				133 : GUILD_WAR4,
-				180 : METIN_TEST,
-				181 : MAP_EMPIREWAR01,
-				182 : MAP_EMPIREWAR02,
-				183 : MAP_EMPIREWAR03,
-				184 : MAP_SKIPIA_DUNGEON_011,
-				185 : MAP_SKIPIA_DUNGEON_021,
-				186 : MAP_SKIPIA_DUNGEON_012,
-				187 : MAP_SKIPIA_DUNGEON_022,
-				188 : MAP_SKIPIA_DUNGEON_013,
-				189 : MAP_SKIPIA_DUNGEON_023,
-				193 : MAP_SPIDERDUNGEON_02_1,
-				194 : MAP_HOLYPLACE_FLAME,
-				195 : MAP_PATHWAY_FLAME_01,
-				196 : MAP_PATHWAY_FLAME_02,
-				197 : MAP_PATHWAY_FLAME_03,
-				198 : MAP_HOLYPLACE_ICE,
-				199 : MAP_PATHWAY_ICE_01,
-				200 : MAP_PATHWAY_ICE_02,
-				201 : MAP_PATHWAY_ICE_03,
-				202 : MAP_HOLYPLACE_DESERT,
-				203 : MAP_PATHWAY_DESERT_01,
-				204 : MAP_PATHWAY_DESERT_02,
-				205 : MAP_PATHWAY_DESERT_03,
-				208 : MAP_SKIPIA_DUNGEON_BOSS,
-				209 : MAP_SKIPIA_DUNGEON_BOSS_1,
-				210 : MAP_SKIPIA_DUNGEON_BOSS_2,
-				211 : MAP_SKIPIA_DUNGEON_BOSS_3,
-				216 : MAP_DEVILCATACOMB,
-				217 : MAP_SPIDERDUNGEON_03,
-				301 : MAP_CAPEDRAGONHEAD,
-				302 : MAP_DAWNMISTWOOD,
-				303 : MAP_BAYBLACKSAND,
-				304 : MAP_MT_THUNDER,
-				351 : MAP_N_FLAME_DUNGEON_01,
-				352 : MAP_N_SNOW_DUNGEON_01,
-				358 : MAP_DEFENSE_WAVE,
-				359 : MAP_DEFENSE_WAVE_PORT,
-				360 : MAP_MISTS_OF_ISLAND,
-				361 : MAP_MINIBOSS_01,
-				362 : MAP_MINIBOSS_02,
-				363 : MAP_BOSS_LABYRINTH,
-				364 : MAP_BOSS_CRACK_SKIPIA,
-				365 : MAP_BOSS_CRACK_FLAME,
-				366 : MAP_BOSS_CRACK_SNOW,
-				367 : MAP_BOSS_CRACK_DAWNMIST,
-				368 : MAP_BOSS_AWAKEN_SKIPIA,
-				369 : MAP_BOSS_AWAKEN_FLAME,
-				370 : MAP_BOSS_AWAKEN_SNOW,
-				371 : MAP_BOSS_AWAKEN_DAWNMIST,
-				372 : MAP_GUILD_PVE,
-				373 : MAP_EASTPLAIN_01,
-				374 : MAP_EMPIRECASTLE,
-				375 : MAP_BATTLE_ROYALE,
-				376 : MAP_EASTPLAIN_02,
-				377 : MAP_EASTPLAIN_03,
-				378 : MAP_ELEMENTAL_DUNGEON,
-				379 : MAP_ELEMENTAL_DUNGEON,
-				380 : MAP_ELEMENTAL_DUNGEON,
-				381 : MAP_ELEMENTAL_DUNGEON,
-				382 : MAP_MAZE_DUNGEON_01,
-				383 : MAP_MAZE_DUNGEON_02,
-				384 : MAP_MAZE_DUNGEON_03,
-				385 : MAP_SNAKE_VALLEY,
-				386 : MAP_SUNGMAHEE_TOWER_WAIT,
-				387 : MAP_SUNGMAHEE_TOWER_DUNGEON,
-				388 : MAP_ICE_CRYSTALS_CAVE,
-				389 : MAP_WHITE_DRAGON_VALLEY,
-				390 : MAP_SNAKE_TEMPLE_1,
-				391 : MAP_SNAKE_TEMPLE_2,
-				392 : MAP_PRIVATE_SHOP_MAP,
-				393 : MAP_WHITE_DRAGON_CAVE_01,
-				394 : MAP_WHITE_DRAGON_CAVE_02,
-				395 : MAP_WHITE_DRAGON_CAVE_BOSS,
-				396 : MAP_FARMING_DUNGEON,
-				399 : MAP_SECRET_DUNGEON,
-				400 : MAP_OTHER_WORLD_01,
-				401 : MAP_OTHER_WORLD_02,
-				402 : MAP_OTHER_WORLD_03,
-				403 : MAP_OTHER_WORLD_04,
-				404 : MAP_SUNGMAHEE_GATE_A1,
-				405 : MAP_SUNGMAHEE_GATE_B1,
-				406 : MAP_SUNGMAHEE_GATE_C1,
-				407 : MAP_SUNGMAHEE_GATE_THREEWAY,
-				408 : MAP_SUNGMAHEE_GATE_DESERT,
-				409 : MAP_SUNGMAHEE_GATE_FLAME,
-				410 : MAP_SUNGMAHEE_GATE_SNOW,
-				411 : MAP_SUNGMAHEE_GATE_DEVILS,
-				412 : MAP_SUNGMAHEE_GATE_DAWNMIST,
-				416 : MAP_GOLDEN_LAND,
-				417 : MAP_GOLDEN_LAND_STAGE
-			}
-			#if background.IsMapInfoByMapName("metin2_map_dawnmist_dungeon_01"):
-			MINIMAP_ZONE_NAME_DICT_BY_IDX[353] = MAP_DAWNMIST_DUNGEON_01
-			#if background.IsMapInfoByMapName("metin2_map_Mt_Th_dungeon_01"):
-			MINIMAP_ZONE_NAME_DICT_BY_IDX[354] = MAP_MT_TH_DUNGEON_01
-			#if background.IsMapInfoByMapName("metin2_map_n_flame_dragon"):
-			MINIMAP_ZONE_NAME_DICT_BY_IDX[356] = MAP_N_FLAME_DRAGON
-			#if background.IsMapInfoByMapName("metin2_map_battlefied"):
-			MINIMAP_ZONE_NAME_DICT_BY_IDX[357] = MAP_BATTLE_FIELD
-			#if background.IsMapInfoByMapName("metin2_12zi_stage"):
-			MINIMAP_ZONE_NAME_DICT_BY_IDX[355] = MAP_CZ_DUNGEON
-
-		global WHISPER_ERROR
-		WHISPER_ERROR = {
-			1 : CANNOT_WHISPER_NOT_LOGON,
-			2 : CANNOT_WHISPER_DEST_REFUSE,
-			3 : CANNOT_WHISPER_SELF_REFUSE,
-		}
-
-		global NOTIFY_MESSAGE
-		NOTIFY_MESSAGE = {
-			"CANNOT_EQUIP_SHOP" : CANNOT_EQUIP_IN_SHOP,
-			"CANNOT_EQUIP_EXCHANGE" : CANNOT_EQUIP_IN_EXCHANGE,
-		}
-
-		global ATTACK_ERROR_TAIL_DICT
-		ATTACK_ERROR_TAIL_DICT = {
-			"IN_SAFE" : CANNOT_ATTACK_SELF_IN_SAFE,
-			"DEST_IN_SAFE" : CANNOT_ATTACK_DEST_IN_SAFE,
-		}
-
-		global SHOT_ERROR_TAIL_DICT
-		SHOT_ERROR_TAIL_DICT = {
-			"EMPTY_ARROW" : CANNOT_SHOOT_EMPTY_ARROW,
-			"IN_SAFE" : CANNOT_SHOOT_SELF_IN_SAFE,
-			"DEST_IN_SAFE" : CANNOT_SHOOT_DEST_IN_SAFE,
-		}
-
-		global USE_SKILL_ERROR_TAIL_DICT
-		USE_SKILL_ERROR_TAIL_DICT = {
-			"IN_SAFE" : CANNOT_SKILL_SELF_IN_SAFE,
-			"NEED_TARGET" : CANNOT_SKILL_NEED_TARGET,
-			"NEED_EMPTY_BOTTLE" : CANNOT_SKILL_NEED_EMPTY_BOTTLE,
-			"NEED_POISON_BOTTLE" : CANNOT_SKILL_NEED_POISON_BOTTLE,
-			"REMOVE_FISHING_ROD" : CANNOT_SKILL_REMOVE_FISHING_ROD,
-			"NOT_YET_LEARN" : CANNOT_SKILL_NOT_YET_LEARN,
-			"NOT_MATCHABLE_WEAPON" : CANNOT_SKILL_NOT_MATCHABLE_WEAPON,
-			"WAIT_COOLTIME" : CANNOT_SKILL_WAIT_COOLTIME,
-			"NOT_ENOUGH_HP" : CANNOT_SKILL_NOT_ENOUGH_HP,
-			"NOT_ENOUGH_SP" : CANNOT_SKILL_NOT_ENOUGH_SP,
-			"CANNOT_USE_SELF" : CANNOT_SKILL_USE_SELF,
-			"ONLY_FOR_ALLIANCE" : CANNOT_SKILL_ONLY_FOR_ALLIANCE,
-			"CANNOT_ATTACK_ENEMY_IN_SAFE_AREA" : CANNOT_SKILL_DEST_IN_SAFE,
-			"CANNOT_APPROACH" : CANNOT_SKILL_APPROACH,
-			"CANNOT_ATTACK" : CANNOT_SKILL_ATTACK,
-			"ONLY_FOR_CORPSE" : CANNOT_SKILL_ONLY_FOR_CORPSE,
-			"EQUIP_FISHING_ROD" : CANNOT_SKILL_EQUIP_FISHING_ROD,
-			"NOT_HORSE_SKILL" : CANNOT_SKILL_NOT_HORSE_SKILL,
-			"HAVE_TO_RIDE" : CANNOT_SKILL_HAVE_TO_RIDE,
-		}
-
-		global LEVEL_LIST
-		LEVEL_LIST = ["", HORSE_LEVEL1, HORSE_LEVEL2, HORSE_LEVEL3]
-
-		global HEALTH_LIST
-		HEALTH_LIST = [
-			HORSE_HEALTH0,
-			HORSE_HEALTH1,
-			HORSE_HEALTH2,
-			HORSE_HEALTH3,
-		]
-
-		global USE_SKILL_ERROR_CHAT_DICT
-		USE_SKILL_ERROR_CHAT_DICT = {
-			"NEED_EMPTY_BOTTLE" : SKILL_NEED_EMPTY_BOTTLE,
-			"NEED_POISON_BOTTLE" : SKILL_NEED_POISON_BOTTLE,
-			"ONLY_FOR_GUILD_WAR" : SKILL_ONLY_FOR_GUILD_WAR,
-		}
-
-		global SHOP_ERROR_DICT
-		SHOP_ERROR_DICT = {
-			"NOT_ENOUGH_MONEY" : SHOP_NOT_ENOUGH_MONEY,
-			"SOLDOUT" : SHOP_SOLDOUT,
-			"INVENTORY_FULL" : SHOP_INVENTORY_FULL,
-			"INVALID_POS" : SHOP_INVALID_POS,
-			"NOT_ENOUGH_MONEY_EX" : SHOP_NOT_ENOUGH_MONEY_EX,
-		}
-		if app.ENABLE_SHOPEX_RENEWAL:
-			SHOP_ERROR_DICT.update({"NOT_ENOUGH_ITEM": SHOP_NOT_ENOUGH_ITEM,})
-
-		global STAT_MINUS_DESCRIPTION
-		STAT_MINUS_DESCRIPTION = {
-			"HTH-" : STAT_MINUS_CON,
-			"INT-" : STAT_MINUS_INT,
-			"STR-" : STAT_MINUS_STR,
-			"DEX-" : STAT_MINUS_DEX,
-		}
-
-		global MODE_NAME_LIST
-		global TITLE_NAME_LIST
-		MODE_NAME_LIST = (PVP_OPTION_NORMAL, PVP_OPTION_REVENGE, PVP_OPTION_KILL, PVP_OPTION_PROTECT,)
-		TITLE_NAME_LIST = (PVP_LEVEL0, PVP_LEVEL1, PVP_LEVEL2, PVP_LEVEL3, PVP_LEVEL4, PVP_LEVEL5, PVP_LEVEL6, PVP_LEVEL7, PVP_LEVEL8,)
-
-		if app.ENABLE_GUILD_LEADER_GRADE_NAME:
-			global GUILD_LEADER_GRADE_NAME_LIST
-			GUILD_LEADER_GRADE_NAME_LIST = (GUILD_LEADER_GRADE0, GUILD_LEADER_GRADE1)
-
-else:
-	def LoadLocaleFile(srcFileName, localeDict):
-		funcDict = { "SA" : SA, "SNA" : SNA, "SAA" : SAA, "SAN" : SAN, "SAAAA" : SAAAA, }
-
-		lineIndex = 1
-
-		try:
-			lines = open(srcFileName, "r").readlines()
-		except IOError:
-			import dbg
-			dbg.LogBox("LoadLocaleError(%(srcFileName)s)" % locals())
-			app.Abort()
-
-		for line in lines:
-			try:
-				tokens = line[:-1].split("\t")
-				if len(tokens) == 2:
 					localeDict[tokens[0]] = tokens[1]
-				elif len(tokens) >= 3:
-					type = tokens[2].strip()
-					if type:
-						localeDict[tokens[0]] = funcDict[type](tokens[1])
-					else:
-						localeDict[tokens[0]] = tokens[1]
-				else:
-					raise RuntimeError, "Unknown TokenSize"
-
-				lineIndex += 1
+			else:
+				raise RuntimeError, "Unknown TokenSize"
 
-			except:
-				import dbg
-				dbg.LogBox("%s: line(%d): %s" % (srcFileName, lineIndex, line), "Error")
-				raise
+			lineIndex += 1
+		except:
+			import dbg
+			dbg.LogBox("%s: line(%d): %s" % (srcFileName, lineIndex, line), "Error")
+			raise
 
 all = ["locale", "error"]
 
@@ -660,42 +226,39 @@
 
 	constInfo.IN_GAME_SHOP_ENABLE = 1
 
-if app.ENABLE_LOCALE_CLIENT:
-	LoadLocaleFile(LOCALE_FILE_NAME)
-	LoadLocaleFile(NEW_LOCALE_FILE_NAME)
-else:
-	LoadLocaleFile(LOCALE_FILE_NAME, locals())
-	LoadLocaleFile(NEW_LOCALE_FILE_NAME, locals())
+LoadLocaleFile(LOCALE_FILE_NAME, locals())
+LoadLocaleFile(NEW_LOCALE_FILE_NAME, locals())
 
 ########################################################################################################
 ## NOTE : 아이템을 버릴때 "무엇을/를 버리시겠습니까?" 문자열의 조사 선택을 위한 코드
-dictSingleWord = {
-	"m":1, "n":1, "r":1, "M":1, "N":1, "R":1, "l":1, "L":1, "1":1, "3":1, "6":1, "7":1, "8":1, "0":1,
-}
+#dictSingleWord = {
+#	"m":1, "n":1, "r":1, "M":1, "N":1, "R":1, "l":1, "L":1, "1":1, "3":1, "6":1, "7":1, "8":1, "0":1,
+#}
+#
+#dictDoubleWord = {
+#	"가":1, "갸":1, "거":1, "겨":1, "고":1, "교":1, "구":1, "규":1, "그":1, "기":1, "개":1, "걔":1, "게":1, "계":1, "과":1, "괘":1, "궈":1, "궤":1, "괴":1, "귀":1, "긔":1,
+#	"까":1, "꺄":1, "꺼":1, "껴":1, "꼬":1, "꾜":1, "꾸":1, "뀨":1, "끄":1, "끼":1, "깨":1, "":1, "께":1, "꼐":1, "꽈":1, "꽤":1, "꿔":1, "꿰":1, "꾀":1, "뀌":1, "":1,
+#	"나":1, "냐":1, "너":1, "녀":1, "노":1, "뇨":1, "누":1, "뉴":1, "느":1, "니":1, "내":1, "v":1, "네":1, "녜":1, "놔":1, "R":1, "눠":1, "눼":1, "뇌":1, "뉘":1, "늬":1,
+#	"다":1, "댜":1, "더":1, "뎌":1, "도":1, "됴":1, "두":1, "듀":1, "드":1, "디":1, "대":1, "":1, "데":1, "뎨":1, "돠":1, "돼":1, "둬":1, "뒈":1, "되":1, "뒤":1, "듸":1,
+#	"따":1, "x":1, "떠":1, "뗘":1, "또":1, "":1, "뚜":1, "":1, "뜨":1, "띠":1, "때":1, "":1, "떼":1, "":1, "똬":1, "뙈":1, "":1, "뛔":1, "뙤":1, "뛰":1, "띄":1,
+#	"라":1, "랴":1, "러":1, "려":1, "로":1, "료":1, "루":1, "류":1, "르":1, "리":1, "래":1, "m":1, "레":1, "례":1, "롸":1, "O":1, "뤄":1, "뤠":1, "뢰":1, "뤼":1, "l":1,
+#	"마":1, "먀":1, "머":1, "며":1, "모":1, "묘":1, "무":1, "뮤":1, "므":1, "미":1, "매":1, "":1, "메":1, "몌":1, "뫄":1, "":1, "뭐":1, "뭬":1, "뫼":1, "뮈":1, "":1,
+#	"바":1, "뱌":1, "버":1, "벼":1, "보":1, "뵤":1, "부":1, "뷰":1, "브":1, "비":1, "배":1, "":1, "베":1, "볘":1, "봐":1, "봬":1, "붜":1, "붸":1, "뵈":1, "뷔":1, "":1,
+#	"빠":1, "뺘":1, "뻐":1, "뼈":1, "뽀":1, "뾰":1, "뿌":1, "쀼":1, "쁘":1, "삐":1, "빼":1, "":1, "뻬":1, "":1, "":1, "":1, "":1, "":1, "뾔":1, "":1, "u":1,
+#	"사":1, "샤":1, "서":1, "셔":1, "소":1, "쇼":1, "수":1, "슈":1, "스":1, "시":1, "새":1, "섀":1, "세":1, "셰":1, "솨":1, "쇄":1, "숴":1, "쉐":1, "쇠":1, "쉬":1, "":1,
+#	"싸":1, "X":1, "써":1, "":1, "쏘":1, "쑈":1, "쑤":1, "o":1, "쓰":1, "씨":1, "쌔":1, "y":1, "쎄":1, "":1, "쏴":1, "쐐":1, "쒀":1, "쒜":1, "쐬":1, "쒸":1, "씌":1,
+#	"아":1, "야":1, "어":1, "여":1, "오":1, "요":1, "우":1, "유":1, "으":1, "이":1, "애":1, "얘":1, "에":1, "예":1, "와":1, "왜":1, "워":1, "웨":1, "외":1, "위":1, "의":1,
+#	"자":1, "쟈":1, "저":1, "져":1, "조":1, "죠":1, "주":1, "쥬":1, "즈":1, "지":1, "재":1, "쟤":1, "제":1, "졔":1, "좌":1, "좨":1, "줘":1, "줴":1, "죄":1, "쥐":1, "p":1,
+#	"짜":1, "쨔":1, "쩌":1, "쪄":1, "쪼":1, "c":1, "쭈":1, "쮸":1, "쯔":1, "찌":1, "째":1, "":1, "쩨":1, "":1, "쫘":1, "쫴":1, "쭤":1, "R":1, "쬐":1, "쮜":1, "n":1,
+#	"차":1, "챠":1, "처":1, "쳐":1, "초":1, "쵸":1, "추":1, "츄":1, "츠":1, "치":1, "채":1, "":1, "체":1, "쳬":1, "촤":1, "":1, "춰":1, "췌":1, "최":1, "취":1, "M":1,
+#	"카":1, "캬":1, "커":1, "켜":1, "코":1, "쿄":1, "쿠":1, "큐":1, "크":1, "키":1, "캐":1, "m":1, "케":1, "켸":1, "콰":1, "쾌":1, "쿼":1, "퀘":1, "쾨":1, "퀴":1, "":1,
+#	"타":1, "탸":1, "터":1, "텨":1, "토":1, "툐":1, "투":1, "튜":1, "트":1, "티":1, "태":1, "O":1, "테":1, "톄":1, "톼":1, "퇘":1, "퉈":1, "퉤":1, "퇴":1, "튀":1, "틔":1,
+#	"파":1, "퍄":1, "퍼":1, "펴":1, "포":1, "표":1, "푸":1, "퓨":1, "프":1, "피":1, "패":1, "":1, "페":1, "폐":1, "퐈":1, "":1, "풔":1, "R":1, "푀":1, "퓌":1, "c":1,
+#	"하":1, "햐":1, "허":1, "혀":1, "호":1, "효":1, "후":1, "휴":1, "흐":1, "히":1, "해":1, "":1, "헤":1, "혜":1, "화":1, "홰":1, "훠":1, "훼":1, "회":1, "휘":1, "희":1,
+#}
 
-dictDoubleWord = {
-	"가":1, "갸":1, "거":1, "겨":1, "고":1, "교":1, "구":1, "규":1, "그":1, "기":1, "개":1, "걔":1, "게":1, "계":1, "과":1, "괘":1, "궈":1, "궤":1, "괴":1, "귀":1, "긔":1,
-	"까":1, "꺄":1, "꺼":1, "껴":1, "꼬":1, "꾜":1, "꾸":1, "뀨":1, "끄":1, "끼":1, "깨":1, "":1, "께":1, "꼐":1, "꽈":1, "꽤":1, "꿔":1, "꿰":1, "꾀":1, "뀌":1, "":1,
-	"나":1, "냐":1, "너":1, "녀":1, "노":1, "뇨":1, "누":1, "뉴":1, "느":1, "니":1, "내":1, "v":1, "네":1, "녜":1, "놔":1, "R":1, "눠":1, "눼":1, "뇌":1, "뉘":1, "늬":1,
-	"다":1, "댜":1, "더":1, "뎌":1, "도":1, "됴":1, "두":1, "듀":1, "드":1, "디":1, "대":1, "":1, "데":1, "뎨":1, "돠":1, "돼":1, "둬":1, "뒈":1, "되":1, "뒤":1, "듸":1,
-	"따":1, "x":1, "떠":1, "뗘":1, "또":1, "":1, "뚜":1, "":1, "뜨":1, "띠":1, "때":1, "":1, "떼":1, "":1, "똬":1, "뙈":1, "":1, "뛔":1, "뙤":1, "뛰":1, "띄":1,
-	"라":1, "랴":1, "러":1, "려":1, "로":1, "료":1, "루":1, "류":1, "르":1, "리":1, "래":1, "m":1, "레":1, "례":1, "롸":1, "O":1, "뤄":1, "뤠":1, "뢰":1, "뤼":1, "l":1,
-	"마":1, "먀":1, "머":1, "며":1, "모":1, "묘":1, "무":1, "뮤":1, "므":1, "미":1, "매":1, "":1, "메":1, "몌":1, "뫄":1, "":1, "뭐":1, "뭬":1, "뫼":1, "뮈":1, "":1,
-	"바":1, "뱌":1, "버":1, "벼":1, "보":1, "뵤":1, "부":1, "뷰":1, "브":1, "비":1, "배":1, "":1, "베":1, "볘":1, "봐":1, "봬":1, "붜":1, "붸":1, "뵈":1, "뷔":1, "":1,
-	"빠":1, "뺘":1, "뻐":1, "뼈":1, "뽀":1, "뾰":1, "뿌":1, "쀼":1, "쁘":1, "삐":1, "빼":1, "":1, "뻬":1, "":1, "":1, "":1, "":1, "":1, "뾔":1, "":1, "u":1,
-	"사":1, "샤":1, "서":1, "셔":1, "소":1, "쇼":1, "수":1, "슈":1, "스":1, "시":1, "새":1, "섀":1, "세":1, "셰":1, "솨":1, "쇄":1, "숴":1, "쉐":1, "쇠":1, "쉬":1, "":1,
-	"싸":1, "X":1, "써":1, "":1, "쏘":1, "쑈":1, "쑤":1, "o":1, "쓰":1, "씨":1, "쌔":1, "y":1, "쎄":1, "":1, "쏴":1, "쐐":1, "쒀":1, "쒜":1, "쐬":1, "쒸":1, "씌":1,
-	"아":1, "야":1, "어":1, "여":1, "오":1, "요":1, "우":1, "유":1, "으":1, "이":1, "애":1, "얘":1, "에":1, "예":1, "와":1, "왜":1, "워":1, "웨":1, "외":1, "위":1, "의":1,
-	"자":1, "쟈":1, "저":1, "져":1, "조":1, "죠":1, "주":1, "쥬":1, "즈":1, "지":1, "재":1, "쟤":1, "제":1, "졔":1, "좌":1, "좨":1, "줘":1, "줴":1, "죄":1, "쥐":1, "p":1,
-	"짜":1, "쨔":1, "쩌":1, "쪄":1, "쪼":1, "c":1, "쭈":1, "쮸":1, "쯔":1, "찌":1, "째":1, "":1, "쩨":1, "":1, "쫘":1, "쫴":1, "쭤":1, "R":1, "쬐":1, "쮜":1, "n":1,
-	"차":1, "챠":1, "처":1, "쳐":1, "초":1, "쵸":1, "추":1, "츄":1, "츠":1, "치":1, "채":1, "":1, "체":1, "쳬":1, "촤":1, "":1, "춰":1, "췌":1, "최":1, "취":1, "M":1,
-	"카":1, "캬":1, "커":1, "켜":1, "코":1, "쿄":1, "쿠":1, "큐":1, "크":1, "키":1, "캐":1, "m":1, "케":1, "켸":1, "콰":1, "쾌":1, "쿼":1, "퀘":1, "쾨":1, "퀴":1, "":1,
-	"타":1, "탸":1, "터":1, "텨":1, "토":1, "툐":1, "투":1, "튜":1, "트":1, "티":1, "태":1, "O":1, "테":1, "톄":1, "톼":1, "퇘":1, "퉈":1, "퉤":1, "퇴":1, "튀":1, "틔":1,
-	"파":1, "퍄":1, "퍼":1, "펴":1, "포":1, "표":1, "푸":1, "퓨":1, "프":1, "피":1, "패":1, "":1, "페":1, "폐":1, "퐈":1, "":1, "풔":1, "R":1, "푀":1, "퓌":1, "c":1,
-	"하":1, "햐":1, "허":1, "혀":1, "호":1, "효":1, "후":1, "휴":1, "흐":1, "히":1, "해":1, "":1, "헤":1, "혜":1, "화":1, "홰":1, "훠":1, "훼":1, "회":1, "휘":1, "희":1,
-}
-
-locale = mapping()
+locale = mapping(
+)
 
 def GetAuxiliaryWordType(text):
 	textLength = len(text)
@@ -841,7 +404,6 @@
 
 	return text
 
-#if app.ENABLE_GROWTH_PET_SYSTEM:
 def SecondToDay(time):
 	if time < 60:
 		return "1" + DAY
@@ -860,7 +422,6 @@
 	text = str(day) + DAY
 	return text
 
-#if app.ENABLE_GROWTH_PET_SYSTEM:
 def SecondToDayNumber(time):
 	if time < 60:
 		return 1
@@ -878,7 +439,6 @@
 
 	return day
 
-#if app.ENABLE_GROWTH_PET_SYSTEM:
 def SecondToH(time):
 	hour = int((time / 60) / 60)
 
@@ -888,52 +448,35 @@
 
 	return text
 
-#if app.ENABLE_BATTLE_FIELD:
-def SecondToColonTypeHM(time):
-	if time < 60:
-		return "00:00"
-
-	minute = int((time / 60) % 60)
-	hour = int((time / 60) / 60)
-
-	return "%02d:%02d" % (hour, minute)
+if app.ENABLE_GENDER_ALIGNMENT:
+	def GetAlignmentTitleName(currentAlignment):
+		titleNameTuple = TITLE_NAME_DICT.get(chr.RaceToSex(net.GetMainActorRace()), ('UNKNOWN_GENDER',))
+
+		for alignmentIndex, alignmentValue in enumerate((12000, 8000, 4000, 1000, 0, -4000, -8000, -12000)):
+			if currentAlignment >= alignmentValue:
+				return titleNameTuple[alignmentIndex]
 
-#if app.ENABLE_GUILD_DRAGONLAIR_PARTY_SYSTEM or app.ENABLE_12ZI:
-def SecondToColonTypeHMS(time):
-	if time < 60:
-		return "00:00:%02d" % (time)
-
-	second = int(time % 60)
-	minute = int((time / 60) % 60)
-	hour = int((time / 60) / 60)
-
-	return "%02d:%02d:%02d" % (hour, minute, second)
-
-def SecondToColonTypeMS(time):
-	second = int(time % 60)
-	minute = int((time / 60) % 60)
-
-	return "%02d:%02d" % (minute, second)
-
-def GetAlignmentTitleName(alignment):
-	if alignment >= 12000:
-		return TITLE_NAME_LIST[0]
-	elif alignment >= 8000:
-		return TITLE_NAME_LIST[1]
-	elif alignment >= 4000:
-		return TITLE_NAME_LIST[2]
-	elif alignment >= 1000:
-		return TITLE_NAME_LIST[3]
-	elif alignment >= 0:
-		return TITLE_NAME_LIST[4]
-	elif alignment > -4000:
-		return TITLE_NAME_LIST[5]
-	elif alignment > -8000:
-		return TITLE_NAME_LIST[6]
-	elif alignment > -12000:
-		return TITLE_NAME_LIST[7]
+		return titleNameTuple[-1]
+else:
+	def GetAlignmentTitleName(alignment):
+		if alignment >= 12000:
+			return TITLE_NAME_LIST[0]
+		elif alignment >= 8000:
+			return TITLE_NAME_LIST[1]
+		elif alignment >= 4000:
+			return TITLE_NAME_LIST[2]
+		elif alignment >= 1000:
+			return TITLE_NAME_LIST[3]
+		elif alignment >= 0:
+			return TITLE_NAME_LIST[4]
+		elif alignment > -4000:
+			return TITLE_NAME_LIST[5]
+		elif alignment > -8000:
+			return TITLE_NAME_LIST[6]
+		elif alignment > -12000:
+			return TITLE_NAME_LIST[7]
 
-	return TITLE_NAME_LIST[8]
+		return TITLE_NAME_LIST[8]
 
 OPTION_PVPMODE_MESSAGE_DICT = {
 	0 : PVP_MODE_NORMAL,
@@ -961,65 +504,40 @@
 GUILDWAR_CTF_DESCLIST = [GUILD_WAR_USE_BATTLE_MAP, GUILD_WAR_WIN_TAKE_AWAY_FLAG1, GUILD_WAR_WIN_TAKE_AWAY_FLAG2, GUILD_WAR_REWARD_POTION]
 
 MINIMAP_ZONE_NAME_DICT = {
-	"metin2_map_a1" : MAP_A1,
-	"map_a2" : MAP_A2,
-	"metin2_map_a3" : MAP_A3,
-	"metin2_map_b1" : MAP_B1,
-	"map_b2" : MAP_B2,
-	"metin2_map_b3" : MAP_B3,
-	"metin2_map_c1" : MAP_C1,
-	"map_c2" : MAP_C2,
-	"metin2_map_c3" : MAP_C3,
-	"map_n_snowm_01" : MAP_SNOW,
-	"metin2_map_n_flame_01" : MAP_FLAME,
-	"metin2_map_n_desert_01" : MAP_DESERT,
-	"metin2_map_milgyo" : MAP_TEMPLE,
-	"metin2_map_spiderdungeon" : MAP_SPIDER,
-	"metin2_map_deviltower1" : MAP_SKELTOWER,
-	"metin2_map_guild_01" : MAP_AG,
-	"metin2_map_guild_02" : MAP_BG,
-	"metin2_map_guild_03" : MAP_CG,
-	"metin2_map_trent" : MAP_TREE,
-	"metin2_map_trent02" : MAP_TREE2,
-	"season1/metin2_map_WL_01" : MAP_WL,
-	"season1/metin2_map_nusluck01" : MAP_NUSLUCK,
-	"Metin2_map_CapeDragonHead" : MAP_CAPE,
-	"metin2_map_Mt_Thunder" : MAP_THUNDER,
-	"metin2_map_dawnmistwood" : MAP_DAWN,
-	"metin2_map_BayBlackSand" : MAP_BAY,
-	"metin2_map_anglar_dungeon_01" : MAP_FARMING_DUNGEON,
-	"metin2_map_battleroyale" : MAP_BATTLE_ROYALE,
-	"metin2_map_eastplain_01" : MAP_EASTPLAIN_01,
-	"metin2_map_eastplain_02" : MAP_EASTPLAIN_02,
-	"metin2_map_eastplain_03" : MAP_EASTPLAIN_03,
-	"metin2_map_empirecastle" : MAP_EMPIRECASTLE,
-	"metin2_map_golden_land" : MAP_GOLDEN_LAND,
-	"metin2_map_golden_land_stage" : MAP_GOLDEN_LAND_STAGE,
-	"metin2_map_icecrystalcave" : MAP_ICE_CRYSTALS_CAVE,
-	"metin2_map_mists_of_island" : MAP_MISTS_OF_ISLAND,
-	"metin2_map_privateshop" : MAP_PRIVATE_SHOP_MAP,
-	"metin2_map_smhgate_a1" : MAP_SUNGMAHEE_GATE_A1,
-	"metin2_map_smhgate_b1" : MAP_SUNGMAHEE_GATE_B1,
-	"metin2_map_smhgate_c1" : MAP_SUNGMAHEE_GATE_C1,
-	"metin2_map_smhgate_dawnmist" : MAP_SUNGMAHEE_GATE_DAWNMIST,
-	"metin2_map_smhgate_desert" : MAP_SUNGMAHEE_GATE_DESERT,
-	"metin2_map_smhgate_devils" : MAP_SUNGMAHEE_GATE_DEVILS,
-	"metin2_map_smhgate_flame" : MAP_SUNGMAHEE_GATE_FLAME,
-	"metin2_map_smhgate_snow" : MAP_SUNGMAHEE_GATE_SNOW,
-	"metin2_map_smhgate_threeway" : MAP_SUNGMAHEE_GATE_THREEWAY,
-	"metin2_map_snakevalley" : MAP_SNAKE_VALLEY,
-	"metin2_map_whitdragonvalley" : MAP_WHITE_DRAGON_VALLEY,
-	"metin2_map_whitedragoncave_01" : MAP_WHITE_DRAGON_CAVE_01,
-	"metin2_map_whitedragoncave_02" : MAP_WHITE_DRAGON_CAVE_02,
-	"metin2_map_whitedragoncave_boss" : MAP_WHITE_DRAGON_CAVE_BOSS,
+	"metin2_map_a1" :					MAP_A1,
+	"map_a2" :							MAP_A2,
+	"metin2_map_a3" :					MAP_A3,
+	"metin2_map_b1" :					MAP_B1,
+	"map_b2" :							MAP_B2,
+	"metin2_map_b3" :					MAP_B3,
+	"metin2_map_c1" :					MAP_C1,
+	"map_c2" :							MAP_C2,
+	"metin2_map_c3" :					MAP_C3,
+	"map_n_snowm_01" :					MAP_SNOW,
+	"metin2_map_n_flame_01" :			MAP_FLAME,
+	"metin2_map_n_desert_01" :			MAP_DESERT,
+	"metin2_map_milgyo" :				MAP_TEMPLE,
+	"metin2_map_spiderdungeon" :		MAP_SPIDER,
+	"metin2_map_deviltower1" :			MAP_SKELTOWER,
+	"metin2_map_guild_01" :				MAP_AG,
+	"metin2_map_guild_02" :				MAP_BG,
+	"metin2_map_guild_03" :				MAP_CG,
+	"metin2_map_trent" :				MAP_TREE,
+	"metin2_map_trent02" :				MAP_TREE2,
+	"metin2_map_WL_01" :		MAP_WL,
+	"metin2_map_nusluck01" :	MAP_NUSLUCK,
+	"Metin2_map_CapeDragonHead" :		MAP_CAPE,
+	"metin2_map_Mt_Thunder" :			MAP_THUNDER,
+	"metin2_map_dawnmistwood" :			MAP_DAWN,
+	"metin2_map_BayBlackSand" :			MAP_BAY,
 }
 
 JOBINFO_TITLE = [
-	[ JOB_WARRIOR0, JOB_WARRIOR1, JOB_WARRIOR2, ],
-	[ JOB_ASSASSIN0, JOB_ASSASSIN1, JOB_ASSASSIN2, ],
-	[ JOB_SURA0, JOB_SURA1, JOB_SURA2, ],
-	[ JOB_SHAMAN0, JOB_SHAMAN1, JOB_SHAMAN2, ],
-	[ JOB_WOLFMAN0, JOB_WOLFMAN1, JOB_WOLFMAN1, ],
+	[JOB_WARRIOR0, JOB_WARRIOR1, JOB_WARRIOR2,],
+	[JOB_ASSASSIN0, JOB_ASSASSIN1, JOB_ASSASSIN2,],
+	[JOB_SURA0, JOB_SURA1, JOB_SURA2,],
+	[JOB_SHAMAN0, JOB_SHAMAN1, JOB_SHAMAN2,],
+	[JOB_WOLFMAN0, JOB_WOLFMAN1, JOB_WOLFMAN1,],
 ]
 
 if app.WJ_SHOW_PARTY_ON_MINIMAP:
@@ -1169,17 +687,6 @@
 		401 : MAP_OTHER_WORLD_02,
 		402 : MAP_OTHER_WORLD_03,
 		403 : MAP_OTHER_WORLD_04,
-		404 : MAP_SUNGMAHEE_GATE_A1,
-		405 : MAP_SUNGMAHEE_GATE_B1,
-		406 : MAP_SUNGMAHEE_GATE_C1,
-		407 : MAP_SUNGMAHEE_GATE_THREEWAY,
-		408 : MAP_SUNGMAHEE_GATE_DESERT,
-		409 : MAP_SUNGMAHEE_GATE_FLAME,
-		410 : MAP_SUNGMAHEE_GATE_SNOW,
-		411 : MAP_SUNGMAHEE_GATE_DEVILS,
-		412 : MAP_SUNGMAHEE_GATE_DAWNMIST,
-		416 : MAP_GOLDEN_LAND,
-		417 : MAP_GOLDEN_LAND_STAGE
 	}
 	#if background.IsMapInfoByMapName("metin2_map_dawnmist_dungeon_01"):
 	MINIMAP_ZONE_NAME_DICT_BY_IDX[353] = MAP_DAWNMIST_DUNGEON_01
@@ -1193,146 +700,146 @@
 	MINIMAP_ZONE_NAME_DICT_BY_IDX[355] = MAP_CZ_DUNGEON
 
 # 캐릭터창에서 캐릭터의 얼굴에 마우스 오버 했을 때 나오는 설명.
-JOBINFO_DATA_LIST = [
-	[
-		["타고난 용맹과 굽히지 않는 무사의",
-		"기개를 사람들은 일컬어 [용자]라고",
-		"부른다. 어떠한 위기에서도 그들은 ",
-		"뒤로 물러서지 않으며, 다치고 움직",
-		"이기 힘든 동료를 위해 단신으로",
-		"적들과 마주 싸우기도 한다. 이들은",
-		"잘 단련된 근육과 힘, 강력한 공격력",
-		"으로 전장 최선두에서 공격진으로",
-		"활약한다.                      ",],
-		["가장 일반적인 공격형 무사로, ",
-		"적접전에 따른 직접 공격으로 전장",
-		"에서 활약한다. 군직 특성상 근력을",
-		"메인으로 스텟 포인트를 투자하되, ",
-		"적접전에 따른 생명력 / 방어력",
-		"확보를 위해 체력을 올린다. 또한",
-		"공격의 정확성을 높이기 위해 민첩",
-		"에도 포인트를 투자할 필요가 있다.",],
-		["상당 수준의 정신력을 이용하는",
-		"중/근거리 접전형 무사로, 각 기술",
-		"하나하나의 높은 공격력으로 전장에서",
-		"활약한다. 군직 특성상 근력을 메인",
-		"으로 스탯 포인트를 투자하되, ",
-		"중/근거리 공격의 정확성과 명중률을",
-		"위해 민첩을 올린다. 또한 접전 시 ",
-		"적 공격에 따른 생명력 / 방어력",
-		"확보를 위해 체력에도 포인트를",
-		"투자할 필요가 있다.        ",],
-	],
-	[
-		["자객은 어떠한 상황에서도 자신의",
-		"몸을 숨기고 은밀한 어둠의 임무를",
-		"수행하면서 전장의 후위를 지원하는",
-		"자들이다. 이들은 아주 빠르고 신속",
-		"하며, 비할 데 없이 과감하고 절제된",
-		"행동으로 적의 급소에 치명타를 날리",
-		"되, 전장에선 적진을 향해 무수한",
-		"화살을 내뿜으며 자신의 용맹을",
-		"선보인다.                   "],
-		["두손 단검을 주무기로 다루며, 신속",
-		"하게 치고 빠지는 자객 특유의 움직임",
-		"으로 전장에서 활약한다. 군직 특성상",
-		"민첩을 메인으로 스텟 포인트를 투자",
-		"하되, 근력을 올려 공격력을 높인다.",
-		"또한 근접전에 따른 생명력/방어력 ",
-		"상승을 위해 체력에도 포인트를",
-		"투자할 필요가 있다.          ",],
-		["활을 주무기로 다루며, 긴 시야와",
-		"사정거리에 따른 원거리 공격으로",
-		"전장에서 활약한다. 군직 특성상",
-		"공격 성공률의 증가를 위해 민첩을",
-		"메인으로 올려야 하며, 원거리",
-		"공격의 데미지 증가를 위해 근력을",
-		"올릴 필요가 있다. 또한 적들에게",
-		"포위되었을 시, 적 공격에 버티기",
-		"위한 생명력/방어력 상승을 위해",
-		"체력에도 포인트를 투자할 필요가",
-		"있다.                        ", ],
-	],
-	[
-		["수라는 [독은 독으로]의 속성으로",
-		"창설된 특수 속성의 군직이다. ",
-		"그들은 전장에서 적들의 사기를 저하",
-		"시키고, 악마의 힘을 실은 마탄으로",
-		"적의 영혼과 육신을 짓뭉갠다. 때로",
-		"이들은 자신의 검과 갑옷에 어둠의",
-		"힘을 실어, 전장에서 무사 못지 않은",
-		"공격력을 발휘하기도 하는데, 적들을",
-		"죽여대는그 모습이 워낙에 끔찍해",
-		"사람들은 수라를 일컬어 [마신]이라",
-		"부르기를 주저 앉는다."],
-		["환무군의 수라는 악마의 씨에서",
-		"얻어지는 마력을 무기나 방어구에",
-		"실어 무사 못지 않은 전투력으로",
-		"전장에서 활약한다. 군직 특성상",
-		"지능이 높아질수록 착용 장비에",
-		"실리는 마력의 위력이 증대되므로,",
-		"지능과 근력을 메인으로 스탯",
-		"포인트를 투자하되, 접전에 따른",
-		"생명력/방어력 확보를 위해 체력을",
-		"올린다. 또한 공격의 정확성과",
-		"회피를 위해서 민첩에도 포인트를",
-		"투자할 필요가 있다.           ",],
-		["흑마군의 수라들은 각종 어둠의",
-		"주문과 악마의 마법으로 전장에서",
-		"활약한다. 군직 특성상 마법 공격이",
-		"주이므로 지능을 메인으로 스텟",
-		"포인트를 투자하되, 원거리 마법",
-		"공격의 정확성을 위해 민첩을 올린다.",
-		"또한 포위 되었을시, 적 공격에 따른",
-		"생명력 / 방어력 확보를 위해 체력에도",
-		"포인트를 투자할 필요가 있다.    ",],
-	],
-	[
-		["무당은 용신과 자연, 두 고대의",
-		"힘을 다룰 수 있는 유일한 직종이다.",
-		"그들은 후방에서 아군을 보조하고",
-		"다친 동료의 부상을 회복 시키며",
-		"떨어진 사기를 상승시킨다. 그들은",
-		"아군의 수면과 휴식을 방해하는 자를 ",
-		"절대 용서하지 않으며, 그런 자들",
-		"에게는 한 점 주저 없이 주문을",
-		"터트려 그 비겁함을 엄히 징계한다.",],
-		["천룡군의 무당들은 각종 부적술과",
-		"보조주문에 능하며, 적의 직 / 간접",
-		"공격으로부터 아군을 지킨다. 군직",
-		"특성상 마법 능력이 주이므로 지능을",
-		"메인으로 스텟 포인트를 투자하되,",
-		"포위되었을 시, 적 공격에 따른",
-		"생명력 / 방어력 확보를 위해 체력을",
-		"올린다. 또한 원거리 마법 공격의",
-		"정확성을 위에 민첩에도 포인트를",
-		"투자할 필요가 있다.           ",],
-		["광뢰군의 무당들은 자연의 힘을",
-		"빌려 아군을 회복하고, 뇌신의 ",
-		"힘으로 밀집한 적들에게 큰 충격을",
-		"입힐 수 있는 이들이다. 군직의",
-		"특성상 마법 능력이 주이므로 지능을",
-		"메인으로 스텟 포인트를 투자하되,",
-		"포위되었을시, 적 공격에 따른",
-		"생명력 / 방어력 확보를 위해 체력을",
-		"올린다. 또한 원거리 마법 공격의",
-		"정확성을 위에 민첩에도 포인트를",
-		"투자할 필요가 있다.             "],
-	],
-	[
-		["수인",],
-		["수인은 [빙의와 쾌]의 속성으로",
-		"창설이 된 특수 군직이다.",
-		"그들은 전장에서 선봉에 서며, 마물들의",
-		"사기를 저하시키고 육신을 찢어 발긴다.",
-		"때로는 자신들의 몸에 늑대의 영혼을 이어",
-		"받아, 전장에서 무사를 초월하는 순간적인",
-		"공격력을 발취하기도 하는데, 적들은 그",
-		"모습이 흡사 [대랑]을 닮아 [사신]이라",
-		"부르기도 한다."],
-		["해당없음"],
-	],
-]
+#JOBINFO_DATA_LIST = [
+#	[
+#		["타고난 용맹과 굽히지 않는 무사의",
+#		"기개를 사람들은 일컬어 [용자]라고",
+#		"부른다. 어떠한 위기에서도 그들은 ",
+#		"뒤로 물러서지 않으며, 다치고 움직",
+#		"이기 힘든 동료를 위해 단신으로",
+#		"적들과 마주 싸우기도 한다. 이들은",
+#		"잘 단련된 근육과 힘, 강력한 공격력",
+#		"으로 전장 최선두에서 공격진으로",
+#		"활약한다.                      ",],
+#		["가장 일반적인 공격형 무사로, ",
+#		"적접전에 따른 직접 공격으로 전장",
+#		"에서 활약한다. 군직 특성상 근력을",
+#		"메인으로 스텟 포인트를 투자하되, ",
+#		"적접전에 따른 생명력 / 방어력",
+#		"확보를 위해 체력을 올린다. 또한",
+#		"공격의 정확성을 높이기 위해 민첩",
+#		"에도 포인트를 투자할 필요가 있다.",],
+#		["상당 수준의 정신력을 이용하는",
+#		"중/근거리 접전형 무사로, 각 기술",
+#		"하나하나의 높은 공격력으로 전장에서",
+#		"활약한다. 군직 특성상 근력을 메인",
+#		"으로 스탯 포인트를 투자하되, ",
+#		"중/근거리 공격의 정확성과 명중률을",
+#		"위해 민첩을 올린다. 또한 접전 시 ",
+#		"적 공격에 따른 생명력 / 방어력",
+#		"확보를 위해 체력에도 포인트를",
+#		"투자할 필요가 있다.        ",],
+#	],
+#	[
+#		["자객은 어떠한 상황에서도 자신의",
+#		"몸을 숨기고 은밀한 어둠의 임무를",
+#		"수행하면서 전장의 후위를 지원하는", 
+#		"자들이다. 이들은 아주 빠르고 신속",
+#		"하며, 비할 데 없이 과감하고 절제된",
+#		"행동으로 적의 급소에 치명타를 날리",
+#		"되, 전장에선 적진을 향해 무수한",
+#		"화살을 내뿜으며 자신의 용맹을",
+#		"선보인다.                   "],
+#		["두손 단검을 주무기로 다루며, 신속",
+#		"하게 치고 빠지는 자객 특유의 움직임",
+#		"으로 전장에서 활약한다. 군직 특성상",
+#		"민첩을 메인으로 스텟 포인트를 투자",
+#		"하되, 근력을 올려 공격력을 높인다.",
+#		"또한 근접전에 따른 생명력/방어력 ",
+#		"상승을 위해 체력에도 포인트를",
+#		"투자할 필요가 있다.          ",],
+#		["활을 주무기로 다루며, 긴 시야와",
+#		"사정거리에 따른 원거리 공격으로",
+#		"전장에서 활약한다. 군직 특성상",
+#		"공격 성공률의 증가를 위해 민첩을",
+#		"메인으로 올려야 하며, 원거리",
+#		"공격의 데미지 증가를 위해 근력을",
+#		"올릴 필요가 있다. 또한 적들에게",
+#		"포위되었을 시, 적 공격에 버티기",
+#		"위한 생명력/방어력 상승을 위해",
+#		"체력에도 포인트를 투자할 필요가",
+#		"있다.                        ", ],
+#	],
+#	[
+#		["수라는 [독은 독으로]의 속성으로",
+#		"창설된 특수 속성의 군직이다. ",
+#		"그들은 전장에서 적들의 사기를 저하",
+#		"시키고, 악마의 힘을 실은 마탄으로",
+#		"적의 영혼과 육신을 짓뭉갠다. 때로",
+#		"이들은 자신의 검과 갑옷에 어둠의",
+#		"힘을 실어, 전장에서 무사 못지 않은",
+#		"공격력을 발휘하기도 하는데, 적들을",
+#		"죽여대는그 모습이 워낙에 끔찍해",
+#		"사람들은 수라를 일컬어 [마신]이라",
+#		"부르기를 주저 앉는다."],
+#		["환무군의 수라는 악마의 씨에서",
+#		"얻어지는 마력을 무기나 방어구에",
+#		"실어 무사 못지 않은 전투력으로",
+#		"전장에서 활약한다. 군직 특성상",
+#		"지능이 높아질수록 착용 장비에", 
+#		"실리는 마력의 위력이 증대되므로,",
+#		"지능과 근력을 메인으로 스탯",
+#		"포인트를 투자하되, 접전에 따른",
+#		"생명력/방어력 확보를 위해 체력을",
+#		"올린다. 또한 공격의 정확성과",
+#		"회피를 위해서 민첩에도 포인트를",
+#		"투자할 필요가 있다.           ",],
+#		["흑마군의 수라들은 각종 어둠의",
+#		"주문과 악마의 마법으로 전장에서",
+#		"활약한다. 군직 특성상 마법 공격이",
+#		"주이므로 지능을 메인으로 스텟",
+#		"포인트를 투자하되, 원거리 마법",
+#		"공격의 정확성을 위해 민첩을 올린다.",
+#		"또한 포위 되었을시, 적 공격에 따른",
+#		"생명력 / 방어력 확보를 위해 체력에도",
+#		"포인트를 투자할 필요가 있다.    ",],
+#	],
+#	[
+#		["무당은 용신과 자연, 두 고대의",
+#		"힘을 다룰 수 있는 유일한 직종이다.",
+#		"그들은 후방에서 아군을 보조하고",
+#		"다친 동료의 부상을 회복 시키며",
+#		"떨어진 사기를 상승시킨다. 그들은",
+#		"아군의 수면과 휴식을 방해하는 자를 ",
+#		"절대 용서하지 않으며, 그런 자들",
+#		"에게는 한 점 주저 없이 주문을",
+#		"터트려 그 비겁함을 엄히 징계한다.",],
+#		["천룡군의 무당들은 각종 부적술과",
+#		"보조주문에 능하며, 적의 직 / 간접",
+#		"공격으로부터 아군을 지킨다. 군직",
+#		"특성상 마법 능력이 주이므로 지능을",
+#		"메인으로 스텟 포인트를 투자하되,",
+#		"포위되었을 시, 적 공격에 따른",
+#		"생명력 / 방어력 확보를 위해 체력을",
+#		"올린다. 또한 원거리 마법 공격의",
+#		"정확성을 위에 민첩에도 포인트를",
+#		"투자할 필요가 있다.           ",],
+#		["광뢰군의 무당들은 자연의 힘을",
+#		"빌려 아군을 회복하고, 뇌신의 ",
+#		"힘으로 밀집한 적들에게 큰 충격을",
+#		"입힐 수 있는 이들이다. 군직의",
+#		"특성상 마법 능력이 주이므로 지능을",
+#		"메인으로 스텟 포인트를 투자하되,",
+#		"포위되었을시, 적 공격에 따른",
+#		"생명력 / 방어력 확보를 위해 체력을",
+#		"올린다. 또한 원거리 마법 공격의",
+#		"정확성을 위에 민첩에도 포인트를",
+#		"투자할 필요가 있다.             "],
+#	],
+#	[
+#		["수인",],
+#		["수인은 [빙의와 쾌]의 속성으로",
+#		"창설이 된 특수 군직이다.",
+#		"그들은 전장에서 선봉에 서며, 마물들의",
+#		"사기를 저하시키고 육신을 찢어 발긴다.",
+#		"때로는 자신들의 몸에 늑대의 영혼을 이어",
+#		"받아, 전장에서 무사를 초월하는 순간적인",
+#		"공격력을 발취하기도 하는데, 적들은 그",
+#		"모습이 흡사 [대랑]을 닮아 [사신]이라",
+#		"부르기도 한다."],
+#		["해당없음"],
+#	],
+#]
 
 WHISPER_ERROR = {
 	1 : CANNOT_WHISPER_NOT_LOGON,
@@ -1373,16 +880,11 @@
 	"CANNOT_APPROACH" : CANNOT_SKILL_APPROACH,
 	"CANNOT_ATTACK" : CANNOT_SKILL_ATTACK,
 	"ONLY_FOR_CORPSE" : CANNOT_SKILL_ONLY_FOR_CORPSE,
-	"EQUIP_FISHING_ROD" : CANNOT_SKILL_EQUIP_FISHING_ROD,
+	"EQUIP_FISHING_ROD" : CANNOT_SKILL_EQUIP_FISHING_ROD, 
 	"NOT_HORSE_SKILL" : CANNOT_SKILL_NOT_HORSE_SKILL,
 	"HAVE_TO_RIDE" : CANNOT_SKILL_HAVE_TO_RIDE,
 }
 
-if app.SORF_TAHTASI:
-	USE_SKILL_ERROR_TAIL_DICT.update({
-		"NOT_HORSE_STANDING_SKILL" : CANNOT_SKILL_NOT_STANDING_HORSE_SKILL,
-	})
-
 LEVEL_LIST = ["", HORSE_LEVEL1, HORSE_LEVEL2, HORSE_LEVEL3]
 
 HEALTH_LIST = [
@@ -1406,7 +908,10 @@
 	"NOT_ENOUGH_MONEY_EX" : SHOP_NOT_ENOUGH_MONEY_EX,
 }
 if app.ENABLE_SHOPEX_RENEWAL:
-	SHOP_ERROR_DICT.update({"NOT_ENOUGH_ITEM": SHOP_NOT_ENOUGH_ITEM,})
+	SHOP_ERROR_DICT.update({
+		"NOT_ENOUGH_ITEM": SHOP_NOT_ENOUGH_ITEM,
+		"NOT_ENOUGH_EXP": SHOP_NOT_ENOUGH_EXP,
+	})
 
 STAT_MINUS_DESCRIPTION = {
 	"HTH-" : STAT_MINUS_CON,
@@ -1416,7 +921,13 @@
 }
 
 MODE_NAME_LIST = (PVP_OPTION_NORMAL, PVP_OPTION_REVENGE, PVP_OPTION_KILL, PVP_OPTION_PROTECT,)
-TITLE_NAME_LIST = (PVP_LEVEL0, PVP_LEVEL1, PVP_LEVEL2, PVP_LEVEL3, PVP_LEVEL4, PVP_LEVEL5, PVP_LEVEL6, PVP_LEVEL7, PVP_LEVEL8,)
+if app.ENABLE_GENDER_ALIGNMENT:
+	TITLE_NAME_DICT = {
+		GENDER_FEMALE : (PVP_LEVEL0_F, PVP_LEVEL1_F, PVP_LEVEL2_F, PVP_LEVEL3_F, PVP_LEVEL4_F, PVP_LEVEL5_F, PVP_LEVEL6_F, PVP_LEVEL7_F, PVP_LEVEL8_F,),
+		GENDER_MALE : (PVP_LEVEL0_M, PVP_LEVEL1_M, PVP_LEVEL2_M, PVP_LEVEL3_M, PVP_LEVEL4_M, PVP_LEVEL5_M, PVP_LEVEL6_M, PVP_LEVEL7_M, PVP_LEVEL8_M,),
+	}
+else:
+	TITLE_NAME_LIST = (PVP_LEVEL0, PVP_LEVEL1, PVP_LEVEL2, PVP_LEVEL3, PVP_LEVEL4, PVP_LEVEL5, PVP_LEVEL6, PVP_LEVEL7, PVP_LEVEL8,)
 
 if app.ENABLE_GUILD_LEADER_GRADE_NAME:
 	GUILD_LEADER_GRADE_NAME_LIST = (GUILD_LEADER_GRADE0, GUILD_LEADER_GRADE1)
@@ -1460,12 +971,12 @@
 	if app.ENABLE_CHEQUE_SYSTEM:
 		def DO_YOU_BUY_ITEM(buyItemName, buyItemCount, buyItemPrice, sellItemCheque = 0):
 			if sellItemCheque > 0:
-				if buyItemCount > 1:
+				if buyItemCount > 1 :
 					return DO_YOU_BUY_ITEM4 % (buyItemName, buyItemCount, sellItemCheque, buyItemPrice)
 				else:
 					return DO_YOU_BUY_ITEM3 % (buyItemName, sellItemCheque, buyItemPrice)
 			else:
-				if buyItemCount > 1:
+				if buyItemCount > 1 :
 					return DO_YOU_BUY_ITEM2 % (buyItemName, buyItemCount, buyItemPrice)
 				else:
 					return DO_YOU_BUY_ITEM1 % (buyItemName, buyItemPrice)
@@ -1499,7 +1010,7 @@
 
 	def NumberToMoneyString(n):
 		if app.ENABLE_CHEQUE_SYSTEM:
-			if n <= 0:
+			if n <= 0 :
 				return "0"
 
 			return "%s" % ('.'.join([ i-3<0 and str(n)[:i] or str(n)[i-3:i] for i in range(len(str(n))%3, len(str(n))+1, 3) if i ]))
@@ -1541,13 +1052,13 @@
 
 elif 932 == app.GetDefaultCodePage():
 	def DO_YOU_SELL_ITEM(sellItemName, sellItemCount, sellItemPrice):
-		if sellItemCount > 1:
+		if sellItemCount > 1 :
 			return "%s %s  %sH" % (sellItemName, sellItemCount, NumberToMoneyString(sellItemPrice))
 		else:
 			return "%s  %sH" % (sellItemName, NumberToMoneyString(sellItemPrice))
 
 	def DO_YOU_BUY_ITEM(buyItemName, buyItemCount, buyItemPrice):
-		if buyItemCount > 1:
+		if buyItemCount > 1 :
 			return "%s %s %sH" % (buyItemName, buyItemCount, buyItemPrice)
 		else:
 			return "%s %sH" % (buyItemName, buyItemPrice)
@@ -1562,7 +1073,7 @@
 		return "%s?PbgB" % (attachedItemName)
 
 	def HOW_MANY_ITEM_DO_YOU_DROP(dropItemName, dropItemCount):
-		if dropItemCount > 1:
+		if dropItemCount > 1 :
 			return "%s %d H" % (dropItemName, dropItemCount)
 		else:
 			return "%sH" % (dropItemName)
@@ -1580,7 +1091,7 @@
 			return "%s I" % (fishName)
 
 	def NumberToMoneyString(number):
-		if number <= 0:
+		if number <= 0 :
 			return "0"
 
 		number = str(number)
@@ -1592,7 +1103,7 @@
 		return result
 
 	def NumberToSecondaryCoinString(number):
-		if number <= 0:
+		if number <= 0 :
 			return "0jun"
 
 		number = str(number)
@@ -1605,13 +1116,13 @@
 
 elif IsHONGKONG():
 	def DO_YOU_SELL_ITEM(sellItemName, sellItemCount, sellItemPrice):
-		if sellItemCount > 1:
+		if sellItemCount > 1 :
 			return DO_YOU_SELL_ITEM2 % (sellItemName, sellItemCount, NumberToMoneyString(sellItemPrice))
 		else:
 			return DO_YOU_SELL_ITEM1 % (sellItemName, NumberToMoneyString(sellItemPrice))
 
 	def DO_YOU_BUY_ITEM(buyItemName, buyItemCount, buyItemPrice):
-		if buyItemCount > 1:
+		if buyItemCount > 1 :
 			return DO_YOU_BUY_ITEM2 % (buyItemName, buyItemCount, buyItemPrice)
 		else:
 			return DO_YOU_BUY_ITEM1 % (buyItemName, buyItemPrice)
@@ -1626,7 +1137,7 @@
 		return REFINE_FAILURE_NO_GOLD_SOCKET0 % (attachedItemName)
 
 	def HOW_MANY_ITEM_DO_YOU_DROP(dropItemName, dropItemCount):
-		if dropItemCount > 1:
+		if dropItemCount > 1 :
 			return HOW_MANY_ITEM_DO_YOU_DROP2 % (dropItemName, dropItemCount)
 		else:
 			return HOW_MANY_ITEM_DO_YOU_DROP1 % (dropItemName)
@@ -1644,7 +1155,7 @@
 			return FISHING_SUCCESS2 % (fishName)
 
 	def NumberToMoneyString(number):
-		if number <= 0:
+		if number <= 0 :
 			return "0 %s" % (MONETARY_UNIT0)
 
 		number = str(number)
@@ -1656,7 +1167,7 @@
 		return result
 
 	def NumberToSecondaryCoinString(number):
-		if number <= 0:
+		if number <= 0 :
 			return "0 %s" % (MONETARY_UNIT_JUN)
 
 		number = str(number)
@@ -1757,8 +1268,8 @@
 			else:
 				return DO_YOU_BUY_ITEM1 % (buyItemName, buyItemPrice)
 
-	def REFINE_FAILURE_CAN_NOT_ATTACH(attachedItemName):
-		return REFINE_FAILURE_CAN_NOT_ATTACH0 % (attachedItemName)
+	#def REFINE_FAILURE_CAN_NOT_ATTACH(attachedItemName):
+	#	return REFINE_FAILURE_CAN_NOT_ATTACH0 % (attachedItemName)
 
 	def REFINE_FAILURE_NO_SOCKET(attachedItemName):
 		return REFINE_FAILURE_NO_SOCKET0 % (attachedItemName)
@@ -1804,7 +1315,7 @@
 		return "%s %s" % ('.'.join([ i-3<0 and str(n)[:i] or str(n)[i-3:i] for i in range(len(str(n))%3, len(str(n))+1, 3) if i ]), MONETARY_UNIT_JUN)
 
 	def NumberToDisplayedCount(n):
-		if n <= 0:
+		if n <= 0 :
 			return "0 %s" % (MONETARY_UNIT0)
 
 		return "%s %s" % ('.'.join([ i-3<0 and str(n)[:i] or str(n)[i-3:i] for i in range(len(str(n))%3, len(str(n))+1, 3) if i ]), MONETARY_UNIT0)
@@ -1812,8 +1323,12 @@
 	def NumberToDecimal(n):
 		return "%s" % ('.'.join([ i-3<0 and str(n)[:i] or str(n)[i-3:i] for i in range(len(str(n))%3, len(str(n))+1, 3) if i ]))
 
-	def NumberWithPoint(n) :
-		if n <= 0 :
-			return "0"
+	def FormatVersion(n):
+		return "Ver. %s" % ('.'.join([ i-1<0 and str(n)[:i] or str(n)[i-1:i] for i in range(len(str(n))%1, len(str(n))+1, 1) if i ]))
 
-		return "%s" % ('.'.join([ i-3<0 and str(n)[:i] or str(n)[i-3:i] for i in range(len(str(n))%3, len(str(n))+1, 3) if i ]))
+	if app.ENABLE_SHOPEX_RENEWAL:
+		def NumberToShopEXP(n):
+			if n <= 0 :
+				return "0 %s" % ("EXP")
+			n = str(n)
+			return "%s %s" % ('.'.join([ i-3<0 and str(n)[:i] or str(n)[i-3:i] for i in range(len(str(n))%3, len(str(n))+1, 3) if i ]), "EXP")
diff -ruN client_base/client/client/pack/root/osfinfo.py client_final/client/client/pack/root/osfinfo.py
--- client_base/client/client/pack/root/osfinfo.py	2026-02-13 09:22:34.000000000 +0000
+++ client_final/client/client/pack/root/osfinfo.py	2026-02-20 18:13:16.336391326 +0000
@@ -7,17 +7,16 @@
 
 import app
 
-ENABLE_HYPERLINK_ITEM_ICON = True # Show item icon on hyperlink.
-
-if app.ENABLE_QUEST_RENEWAL:
-	ENABLE_QUEST_LETTER_CATEGORY = False # Show quest letters by category
-
-ENABLE_AUTO_RESIZE_POPUP_DIALOG = True # Auto resize popup dialog
+DEBUG_MODE = False # Debug mode (debug info and console)
 
 USE_NEW_WHISPER_LETTER_CATEGORY = True # Use the new letter category for normal and gm players
 
+WHISPER_ON_CHAT_LINE = True # Show whisper in chat line
+PAST_HEALTH_ON_TARGET = True # Show past health on target (yellow gauge)
 SHOW_LOADING_PROGRESS = True # Show loading progress
 EXTENDED_LOADING_GUAGE = True # Loading guage extended with description
+AFFECT_DISPLAY_IN_THINBOARD = False # Show align affect's using a ThinBoard
+ALIGN_AFFECT_IMG_LIST = True # Align affect image list
 FILTER_EMOJI_NOTICE = True # Filter emojis on tip notice or big notice to chat line
 
 SHOW_EMOJI_IN_CHAT_LINE = True # Show emoji in chat line
@@ -26,17 +25,118 @@
 SHOW_SELL_IMAGE_TEXT_LINE = False # Show sell item image text line in tooltip
 
 SHOW_REFINE_ITEM_DESC = True # Show refine item description
+ENABLE_OLD_QUEST_LETTER_LIST = True # Enable the old quest letter list
+
+EVENT_BANNER = True # Show event banner instead of mini-game rumi button
 
 SHOW_REFINE_PERCENTAGE = True # Show refine success percentage
 
 MOUNT_ITEM_ATTR_TOOLTIP = True # Show quest item attributes on tooltip
 PET_ITEM_ATTR_TOOLTIP = True # Show quest item attributes on tooltip
+SHOW_BELT_SLOTS_TOOLTIP = False # Show maximum slots of belt item on tooltip
 SHOW_ITEM_VNUM_TOOTIP = True # Show the item vnum
 
 LOGIN_UI_MODIFY = False # Login countdown
+NEW_SELECT_UI = True # New select character interface
+NEW_CREATE_UI = True # New create character interface
+SELECT_CHARACTER_ROTATION = True # Enables character rotation in select phase.
+
+if app.ENABLE_SKILL_COLOR_SYSTEM:
+	SKILL_COLOR_BUFF_ONLY = False # Enable skill color button on buffs only
 
 ##################################################################################
 
+if app.ENABLE_EXPRESSING_EMOTION:
+	import emotion
+	EXPRESSING_EMOTIONS = {}
+
+if app.ENABLE_HIDE_COSTUME_SYSTEM:
+	HIDDEN_BODY_COSTUME = 0
+	HIDDEN_HAIR_COSTUME = 0
+	if app.ENABLE_ACCE_COSTUME_SYSTEM:
+		HIDDEN_ACCE_COSTUME = 0
+	if app.ENABLE_WEAPON_COSTUME_SYSTEM:
+		HIDDEN_WEAPON_COSTUME = 0
+
+if app.ENABLE_MESSENGER_BLOCK:
+	MESSENGER_KEY = 0
+
+INPUT_IGNORE = 0
+
+if app.ENABLE_DUNGEON_INFO_SYSTEM:
+	dungeonInfo = []
+	dungeonRanking = {
+		"ranking_type" : 0,
+		"ranking_list" : [],
+		"my_ranking" : [],
+	}
+	dungeonData = {
+		"quest_index" : 0,
+		"quest_cmd" : "",
+	}
+
+# MINI_GAME
+if app.ENABLE_MINI_GAME_OKEY:
+	RUMI_GAME_EVENT = False
+if app.ENABLE_MINI_GAME_CATCH_KING:
+	CATCH_KING_GAME_EVENT = False
+# END_OF_MINI_GAME
+
+if app.ENABLE_AUTO_REFINE:
+	AUTO_REFINE = False
+	IS_AUTO_REFINE = False
+	AUTO_REFINE_TYPE = 0
+	AUTO_REFINE_DATA = {
+		"ITEM" : [-1, -1],
+		"NPC" : [0, -1, -1, 0]
+	}
+
+def IsDebugMode():
+	if DEBUG_MODE == True:
+		return True
+
+	return False
+
+def IS_PET_SEAL(itemVnum):
+	if itemVnum >= 53001 and itemVnum <= 53306:
+		return 1
+
+	return 0
+
+def IS_ANTI_EXP_RING(itemVnum):
+	if itemVnum == 72501:
+		return 1
+
+	return 0
+
+if app.ENABLE_EXTENDED_BLEND_AFFECT:
+	def IS_BLEND_POTION(itemVnum):
+		if itemVnum >= 50821 and itemVnum <= 50826:
+			return 1
+		elif itemVnum == 51002:
+			return 1
+
+		return 0
+
+	def IS_EXTENDED_BLEND_POTION(itemVnum):
+		if itemVnum >= 950821 and itemVnum <= 950826: # Dews
+			return 1
+		elif itemVnum == 951002: # Cristal Energy
+			return 1
+		elif itemVnum >= 939017 and itemVnum <= 939020: # Dragon God Medals
+			return 1
+		elif itemVnum == 939024 or itemVnum == 939025: # Critical & Penetration
+			return 1
+		elif itemVnum == 927209 or itemVnum == 927212: # Attack Speed & Move Speed
+			return 1
+
+		return 0
+
+if app.ENABLE_EXPRESSING_EMOTION:
+	def GET_SPECIAL_EMOTION_NAME(idx):
+		if idx >= app.SPECIAL_ACTION_START_INDEX and idx <= emotion.EMOTION_WHIRL:
+			return emotion.SPECIAL_EMOTION_DICT[idx]["name"]
+
 def StripColor(text):
 	import re
 
@@ -47,7 +147,7 @@
 
 	return text
 
-def IsImageFilter(text):
+def IsEmojiFilter(text):
 	import re
 
 	regex = '\|I.*\|i'
diff -ruN client_base/client/client/pack/root/ui.py client_final/client/client/pack/root/ui.py
--- client_base/client/client/pack/root/ui.py	2026-02-13 09:22:34.000000000 +0000
+++ client_final/client/client/pack/root/ui.py	2026-02-20 18:13:16.382547671 +0000
@@ -13,6 +13,8 @@
 
 from _weakref import proxy
 
+import osfInfo
+
 BACKGROUND_COLOR = grp.GenerateColor(0.0, 0.0, 0.0, 1.0)
 DARK_COLOR = grp.GenerateColor(0.2, 0.2, 0.2, 1.0)
 BRIGHT_COLOR = grp.GenerateColor(0.7, 0.7, 0.7, 1.0)
@@ -20,9 +22,8 @@
 if localeInfo.IsCANADA():
 	SELECT_COLOR = grp.GenerateColor(0.9, 0.03, 0.01, 0.4)
 else:
-	#SELECT_COLOR = grp.GenerateColor(0.0, 0.0, 0.5, 0.3)
-	SELECT_COLOR = grp.GenerateColor(0.2, 0.0, 0.5, 0.8) # ori
-	#SELECT_COLOR = grp.GenerateColor(0.9, 0.03, 0.01, 0.4) # red
+	# SELECT_COLOR = grp.GenerateColor(0.0, 0.0, 0.5, 0.3)
+	SELECT_COLOR = grp.GenerateColor(0.2, 0.0, 0.5, 0.8)
 
 WHITE_COLOR = grp.GenerateColor(1.0, 1.0, 1.0, 0.5)
 HALF_WHITE_COLOR = grp.GenerateColor(1.0, 1.0, 1.0, 0.2)
@@ -64,34 +65,36 @@
 ##############################
 ## Window Manager Event List##
 
+
 class __mem_func__:
 	class __noarg_call__:
 		def __init__(self, cls, obj, func):
-			self.cls = cls
-			self.obj = proxy(obj)
-			self.func = proxy(func)
+			self.cls=cls
+			self.obj=proxy(obj)
+			self.func=proxy(func)
 
 		def __call__(self, *arg):
 			return self.func(self.obj)
 
 	class __arg_call__:
 		def __init__(self, cls, obj, func):
-			self.cls = cls
-			self.obj = proxy(obj)
-			self.func = proxy(func)
+			self.cls=cls
+			self.obj=proxy(obj)
+			self.func=proxy(func)
 
 		def __call__(self, *arg):
 			return self.func(self.obj, *arg)
 
 	def __init__(self, mfunc):
 		if mfunc.im_func.func_code.co_argcount>1:
-			self.call = __mem_func__.__arg_call__(mfunc.im_class, mfunc.im_self, mfunc.im_func)
+			self.call=__mem_func__.__arg_call__(mfunc.im_class, mfunc.im_self, mfunc.im_func)
 		else:
-			self.call = __mem_func__.__noarg_call__(mfunc.im_class, mfunc.im_self, mfunc.im_func)
+			self.call=__mem_func__.__noarg_call__(mfunc.im_class, mfunc.im_self, mfunc.im_func)
 
 	def __call__(self, *arg):
 		return self.call(*arg)
 
+
 class Window(object):
 	def NoneMethod(cls):
 		pass
@@ -102,6 +105,7 @@
 		self.hWnd = None
 		self.parentWindow = 0
 		self.onMouseLeftButtonUpEvent = None
+		self.onRunMouseWheelEvent = None
 		self.RegisterWindow(layer)
 		self.Hide()
 
@@ -112,8 +116,8 @@
 			self.overOutFunc = None
 			self.overOutArgs = None
 
-		if app.ENABLE_MOUSE_WHEEL_TOP_WINDOW:
-			self.onMouseWheelEvent=None
+		if app.ENABLE_QUEST_RENEWAL:
+			self.propertyList = {}
 
 	def __del__(self):
 		wndMgr.Destroy(self.hWnd)
@@ -150,7 +154,7 @@
 		wndMgr.SetParent(self.hWnd, parent.hWnd)
 
 	def SetParentProxy(self, parent):
-		self.parentWindow = proxy(parent)
+		self.parentWindow=proxy(parent)
 		wndMgr.SetParent(self.hWnd, parent.hWnd)
 
 	def GetParentProxy(self):
@@ -215,13 +219,21 @@
 			x, y = self.GetLocalPosition()
 			return x
 
-		def GetRight(self):
-			return self.GetLeft() + self.GetWidth()
+		def GetGlobalLeft(self):
+			x, y = self.GetGlobalPosition()
+			return x
 
 		def GetTop(self):
 			x, y = self.GetLocalPosition()
 			return y
 
+		def GetGlobalTop(self):
+			x, y = self.GetGlobalPosition()
+			return y
+
+		def GetRight(self):
+			return self.GetLeft() + self.GetWidth()
+
 		def GetBottom(self):
 			return self.GetTop() + self.GetHeight()
 
@@ -271,15 +283,6 @@
 			if self.onMouseLeftButtonUpEvent:
 				self.onMouseLeftButtonUpEvent()
 
-	if app.ENABLE_MOUSE_WHEEL_TOP_WINDOW:
-		def SetMouseWheelEvent(self, event):
-			self.onMouseWheelEvent = event
-
-		def OnMouseWheel(self, delta):
-			if self.onMouseWheelEvent:
-				return self.onMouseWheelEvent(delta)
-			return False
-
 	if app.ENABLE_MAILBOX:
 		def OnMouseOverIn(self):
 			if self.overFunc:
@@ -297,15 +300,25 @@
 			self.overOutFunc = func
 			self.overOutArgs = args
 
-	if app.ENABLE_CLIP_MASK:
-		def SetClippingMaskRect(self, left, top, right, bottom):
-			wndMgr.SetClippingMaskRect(self.hWnd, left, top, right, bottom)
-
-		def SetClippingMaskWindow(self, clipping_mask_window):
-			wndMgr.SetClippingMaskWindow(self.hWnd, clipping_mask_window.hWnd)
+	if app.ENABLE_QUEST_RENEWAL:
+		def SetProperty(self, propName, propValue):
+			self.propertyList[propName] = propValue
+
+		def GetProperty(self, propName):
+			if propName in self.propertyList:
+				return self.propertyList[propName]
+
+			return None
+
+	def SetOnRunMouseWheelEvent(self, event):
+		self.onRunMouseWheelEvent = event
+
+	def OnRunMouseWheel(self, nLen):
+		if self.onRunMouseWheelEvent:
+			apply(self.onRunMouseWheelEvent, (bool(nLen < 0), ))
+			return True
 
-	def IsRendering(self):
-		return wndMgr.IsRendering(self.hWnd)
+		return False
 
 class ListBoxEx(Window):
 	class Item(Window):
@@ -317,13 +330,13 @@
 
 		def SetParent(self, parent):
 			Window.SetParent(self, parent)
-			self.parent = proxy(parent)
+			self.parent=proxy(parent)
 
 		def OnMouseLeftButtonDown(self):
 			self.parent.SelectItem(self)
 
 		def OnRender(self):
-			if self.parent.GetSelectedItem() == self:
+			if self.parent.GetSelectedItem()==self:
 				self.OnSelectedRender()
 
 		def OnSelectedRender(self):
@@ -339,7 +352,7 @@
 		self.itemHeight = 16
 		self.itemStep = 20
 		self.selItem = 0
-		self.itemList = []
+		self.itemList=[]
 		self.onSelectItemEvent = lambda *arg: None
 
 		if localeInfo.IsARABIC():
@@ -511,7 +524,7 @@
 		elif self.mode == self.VERTICAL_MODE:
 			return (0, (pos-self.basePos)*self.itemStep)
 
-class TextLine(Window):
+class TextLinePet(Window):
 	def __init__(self):
 		Window.__init__(self)
 		self.max = 0
@@ -565,19 +578,12 @@
 	def SetFontName(self, fontName):
 		wndMgr.SetFontName(self.hWnd, fontName)
 
-	if app.WJ_MULTI_TEXTLINE:
-		def SetEnterToken(self, bool):
-			wndMgr.SetEnterToken(self.hWnd, bool)
-
 	def SetDefaultFontName(self):
 		wndMgr.SetFontName(self.hWnd, localeInfo.UI_DEF_FONT)
 
 	def SetFontColor(self, red, green, blue):
 		wndMgr.SetFontColor(self.hWnd, red, green, blue)
 
-	def SetTextColor(self, color):
-		self.SetPackedFontColor(color)
-
 	def SetPackedFontColor(self, color):
 		wndMgr.SetFontColor(self.hWnd, color)
 
@@ -602,41 +608,110 @@
 	def GetTextSize(self):
 		return wndMgr.GetTextSize(self.hWnd)
 
-#if app.ENABLE_MINI_GAME_YUTNORI:
-class MoveTextLine(TextLine):
+class TextLine(Window):
 	def __init__(self):
-		TextLine.__init__(self)
-		self.end_move_event_func = None
-		self.end_move_event_args = None
+		Window.__init__(self)
+		self.max = 0
+		self.SetFontName(localeInfo.UI_DEF_FONT)
 
 	def __del__(self):
-		TextLine.__del__(self)
-		self.end_move_event_func = None
-		self.end_move_event_args = None
+		Window.__del__(self)
 
 	def RegisterWindow(self, layer):
-		self.hWnd = wndMgr.RegisterMoveTextLine(self, layer)
+		self.hWnd = wndMgr.RegisterTextLine(self, layer)
 
-	def SetMovePosition(self, dst_x, dst_y):
-		wndMgr.SetMovePosition(self.hWnd, dst_x, dst_y)
+	def SetMax(self, max):
+		wndMgr.SetMax(self.hWnd, max)
 
-	def SetMoveSpeed(self, speed):
-		wndMgr.SetMoveSpeed(self.hWnd, speed)
+	def SetLimitWidth(self, width):
+		wndMgr.SetLimitWidth(self.hWnd, width)
 
-	def MoveStart(self):
-		wndMgr.MoveStart(self.hWnd)
-	def MoveStop(self):
-		wndMgr.MoveStop(self.hWnd)
-	def GetMove(self):
-		return wndMgr.GetMove(self.hWnd)
+	def SetMultiLine(self):
+		wndMgr.SetMultiLine(self.hWnd, True)
 
-	def OnEndMove(self):
-		if self.end_move_event_func:
-			apply(self.end_move_event_func, self.end_move_event_args)
+	def SetHorizontalAlignArabic(self):
+		wndMgr.SetHorizontalAlign(self.hWnd, wndMgr.TEXT_HORIZONTAL_ALIGN_ARABIC)
 
-	def SetEndMoveEvent(self, event, *args):
-		self.end_move_event_func = event
-		self.end_move_event_args = args
+	def SetHorizontalAlignLeft(self):
+		wndMgr.SetHorizontalAlign(self.hWnd, wndMgr.TEXT_HORIZONTAL_ALIGN_LEFT)
+
+	def SetHorizontalAlignRight(self):
+		wndMgr.SetHorizontalAlign(self.hWnd, wndMgr.TEXT_HORIZONTAL_ALIGN_RIGHT)
+
+	def SetHorizontalAlignCenter(self):
+		wndMgr.SetHorizontalAlign(self.hWnd, wndMgr.TEXT_HORIZONTAL_ALIGN_CENTER)
+
+	def SetVerticalAlignTop(self):
+		wndMgr.SetVerticalAlign(self.hWnd, wndMgr.TEXT_VERTICAL_ALIGN_TOP)
+
+	def SetVerticalAlignBottom(self):
+		wndMgr.SetVerticalAlign(self.hWnd, wndMgr.TEXT_VERTICAL_ALIGN_BOTTOM)
+
+	def SetVerticalAlignCenter(self):
+		wndMgr.SetVerticalAlign(self.hWnd, wndMgr.TEXT_VERTICAL_ALIGN_CENTER)
+
+	def SetSecret(self, Value=True):
+		wndMgr.SetSecret(self.hWnd, Value)
+
+	def SetOutline(self, Value=True):
+		wndMgr.SetOutline(self.hWnd, Value)
+
+	def SetFeather(self, value=True):
+		wndMgr.SetFeather(self.hWnd, value)
+
+	def SetFontName(self, fontName):
+		wndMgr.SetFontName(self.hWnd, fontName)
+
+	def SetDefaultFontName(self):
+		wndMgr.SetFontName(self.hWnd, localeInfo.UI_DEF_FONT)
+
+	def SetFontColor(self, red, green, blue):
+		wndMgr.SetFontColor(self.hWnd, red, green, blue)
+
+	def SetPackedFontColor(self, color):
+		wndMgr.SetFontColor(self.hWnd, color)
+
+	def SetText(self, text):
+		wndMgr.SetText(self.hWnd, text)
+
+	def GetTextLineCount(self):
+		return wndMgr.GetTextLineCount(self.hWnd)
+
+	def DisableEnterToken(self):
+		wndMgr.DisableEnterToken(self.hWnd)
+
+	def SetLineHeight(self, Height):
+		wndMgr.SetLineHeight(self.hWnd, Height)
+
+	def GetLineHeight(self):
+		return wndMgr.GetLineHeight(self.hWnd)
+
+	def GetText(self):
+		return wndMgr.GetText(self.hWnd)
+
+	def GetTextSize(self):
+		return wndMgr.GetTextSize(self.hWnd)
+
+	def GetTextWidth(self):
+		w, h = self.GetTextSize()
+		return w
+
+	def GetTextHeight(self):
+		w, h = self.GetTextSize()
+		return h
+		
+	def AdjustSize(self):
+		x, y = self.GetTextSize()
+		wndMgr.SetWindowSize(self.hWnd, x, y)
+
+	def GetRight(self):
+		return self.GetLeft() + self.GetTextWidth()
+
+	def GetBottom(self):
+		return self.GetTop() + self.GetTextHeight()
+		
+	def SetCenter(self):
+		wndMgr.SetWindowPosition(self.hWnd, self.GetLeft() - self.GetTextWidth()/2, self.GetTop())
 
 class EmptyCandidateWindow(Window):
 	def __init__(self):
@@ -673,24 +748,11 @@
 			self.DisableEnterToken()
 		self.eventReturn = Window.NoneMethod
 		self.eventEscape = Window.NoneMethod
-#		self.eventTab = None
+		self.eventTab = None
 		self.numberMode = False
-		self.UseCodePage = True # MT-679 개인 상점 타이틀의 CodePage 이슈
+		self.UseCodePage = True #MT-679 개인 상점 타이틀의 CodePage 이슈
 		self.useIME = True
 
-		self.eventUpdate = Window.NoneMethod
-		self.eventTab    = Window.NoneMethod
-		self.eventUpdateArgs = None
-		self.eventReturnArgs = None
-		self.eventEscapeArgs = None
-		self.eventTabArgs	= None
-
-		self.backgroundText = TextLine()
-		self.backgroundText.SetParent(self)
-		self.backgroundText.SetPosition(0, 0)
-		self.backgroundText.SetPackedFontColor(WHITE_COLOR)
-		self.backgroundText.Hide()
-
 		self.bCodePage = False
 
 		self.candidateWindowClass = None
@@ -705,17 +767,10 @@
 
 		self.eventReturn = Window.NoneMethod
 		self.eventEscape = Window.NoneMethod
-#		self.eventTab = None
-		self.eventUpdate = Window.NoneMethod
-		self.eventTab    = Window.NoneMethod
-		self.eventUpdateArgs = None
-		self.eventReturnArgs = None
-		self.eventEscapeArgs = None
-		self.eventTabArgs = None
-		self.backgroundText = None
+		self.eventTab = None
 
 	def SetCodePage(self, codePage):
-		candidateWindowClass = EditLine.candidateWindowClassDict.get(codePage, EmptyCandidateWindow)
+		candidateWindowClass=EditLine.candidateWindowClassDict.get(codePage, EmptyCandidateWindow)
 		self.__SetCandidateClass(candidateWindowClass)
 
 	def __SetCandidateClass(self, candidateWindowClass):
@@ -736,41 +791,12 @@
 	def SetReturnEvent(self, event):
 		self.eventReturn = event
 
-	def SAFE_SetUpdateEvent(self, event, *args):
-		self.eventUpdate = __mem_func__(event)
-		self.eventUpdateArgs = args
-
-	def SetUpdateEvent(self, event, *args):
-		self.eventUpdate = event
-		self.eventUpdateArgs = args
-
 	def SetEscapeEvent(self, event):
 		self.eventEscape = event
 
 	def SetTabEvent(self, event):
 		self.eventTab = event
 
-	def SetBackgroundText(self, text):
-		self.backgroundText.SetPosition(0, 0)
-		self.backgroundText.SetText(text)
-
-		if not self.backgroundText.IsShow():
-			self.backgroundText.Show()
-
-	def SetTipText(self, tipText):
-		input = self.GetText()
-		(widht, height) = self.GetTextSize()
-
-		tip = tipText[len(input):]
-		self.backgroundText.SetPosition(widht, 0)
-		self.backgroundText.SetText(tip)
-
-		if not self.backgroundText.IsShow():
-			self.backgroundText.Show()
-
-	def GetBackgroundText(self):
-		return self.backgroundText.GetText()
-
 	def SetMax(self, max):
 		self.max = max
 		wndMgr.SetMax(self.hWnd, self.max)
@@ -874,21 +900,21 @@
 		self.readingWnd.Hide()
 		return True
 
-	def IsNumber(self, text):
-		try:
+	def IsNumber(self, text) :
+		try :
 			int(text)
 			return True
-		except ValueError:
+		except ValueError :
 			return False
 
-	def IsIncludeCodePage(self, text):
+	def IsIncludeCodePage(self, text) :
 		textLen = len(text)
 		idx = 0
 
-		while(idx < textLen):
+		while(idx < textLen) :
 			n = text.find("@", idx)
 
-			if n == -1:
+			if n == -1 :
 				break
 			elif n+4 < textLen and self.IsNumber(text[n+1:n+4]) == True:
 				return True
@@ -899,7 +925,7 @@
 
 	def OnIMEUpdate(self):
 		# MT-679 개인 상점 타이틀의 CodePage 이슈
-		if self.UseCodePage == False and self.IsIncludeCodePage(ime.GetText(self.bCodePage)) == True:
+		if self.UseCodePage == False and self.IsIncludeCodePage(ime.GetText(self.bCodePage)) == True :
 			ime.SetText("")
 
 		snd.PlaySound("sound/ui/type.wav")
@@ -1031,7 +1057,7 @@
 	def __init__(self, layer = "UI"):
 		Window.__init__(self, layer)
 
-		self.eventDict = {}
+		self.eventDict={}
 		self.eventFunc = {"mouse_click" : None, "mouse_over_in" : None, "mouse_over_out" : None}
 		self.eventArgs = {"mouse_click" : None, "mouse_over_in" : None, "mouse_over_out" : None}
 
@@ -1048,15 +1074,11 @@
 		wndMgr.LoadImage(self.hWnd, imageName)
 
 		if len(self.eventDict)!=0:
-			print("LOAD IMAGE", self, self.eventDict)
+			print "LOAD IMAGE", self, self.eventDict
 
 	def SetAlpha(self, alpha):
 		wndMgr.SetDiffuseColor(self.hWnd, 1.0, 1.0, 1.0, alpha)
 
-	if app.ENABLE_FISHING_GAME:
-		def SetDiffuseColor(self, r, g, b, alpha = 1.0):
-			wndMgr.SetDiffuseColor(self.hWnd, r, g, b, alpha)
-
 	def GetWidth(self):
 		return wndMgr.GetWidth(self.hWnd)
 
@@ -1084,14 +1106,15 @@
 			self.eventFunc[args[0]] = func
 			self.eventArgs[args[0]] = args
 		else:
-			print("[ERROR] ui.py SetEvent, Can`t Find has_key : %s" % args[0])
+			print "[ERROR] ui.py SetEvent, Can`t Find has_key : %s" % args[0]
 
-	def OnMouseLeftButtonUp(self):
-		if self.eventFunc["mouse_click"]:
+	def OnMouseLeftButtonUp(self) :
+		Window.OnMouseLeftButtonUp(self)
+		if self.eventFunc["mouse_click"] :
 			apply(self.eventFunc["mouse_click"], self.eventArgs["mouse_click"])
 
-	def OnMouseOverIn(self):
-		if self.eventFunc["mouse_over_in"]:
+	def OnMouseOverIn(self) :
+		if self.eventFunc["mouse_over_in"] :
 			apply(self.eventFunc["mouse_over_in"], self.eventArgs["mouse_over_in"])
 		else:
 			try:
@@ -1102,103 +1125,21 @@
 	def OnMouseOverOut(self):
 		if self.eventFunc["mouse_over_out"]:
 			apply(self.eventFunc["mouse_over_out"], self.eventArgs["mouse_over_out"])
-		else:
+		else :
 			try:
 				self.eventDict["MOUSE_OVER_OUT"]()
 			except KeyError:
 				pass
 
-	#if app.ENABLE_GROWTH_PET_SYSTEM
 	def LeftRightReverse(self):
 		wndMgr.LeftRightReverseImageBox(self.hWnd)
 
-	#if app.ENABLE_12ZI:
 	def SetCoolTime(self, time):
 		wndMgr.SetCoolTimeImageBox(self.hWnd, time)
 
 	def SetStartCoolTime(self, time):
 		wndMgr.SetStartCoolTimeImageBox(self.hWnd, time)
 
-	def SetScale(self, xScale, yScale):
-		wndMgr.SetScale(self.hWnd, xScale, yScale)
-
-class ImageBox2(Window):
-	def __init__(self, layer = "UI"):
-		Window.__init__(self, layer)
-
-		self.eventDict={}
-		self.eventFunc = {"mouse_click" : None, "mouse_over_in" : None, "mouse_over_out" : None}
-		self.eventArgs = {"mouse_click" : None, "mouse_over_in" : None, "mouse_over_out" : None}
-
-	def __del__(self):
-		Window.__del__(self)
-		self.eventFunc = None
-		self.eventArgs = None
-
-	def RegisterWindow(self, layer):
-		self.hWnd = wndMgr.RegisterImageBox(self, layer)
-
-	def LoadImage(self, imageName):
-		self.name=imageName
-		wndMgr.LoadImage(self.hWnd, imageName)
-
-		if len(self.eventDict)!=0:
-			print("LOAD IMAGE", self, self.eventDict)
-
-	def SetAlpha(self, alpha):
-		wndMgr.SetDiffuseColor(self.hWnd, 1.0, 1.0, 1.0, alpha)
-
-	def GetWidth(self):
-		return wndMgr.GetWidth(self.hWnd)
-
-	def GetHeight(self):
-		return wndMgr.GetHeight(self.hWnd)
-
-	def OnMouseOverIn(self):
-		try:
-			self.eventDict["MOUSE_OVER_IN"]()
-		except KeyError:
-			pass
-
-	def OnMouseOverOut(self):
-		try:
-			self.eventDict["MOUSE_OVER_OUT"]()
-		except KeyError:
-			pass
-
-	def SAFE_SetStringEvent(self, event, func, *args):
-		self.eventDict[event]=__mem_func__(func)
-
-	def SetEvent(self, func, *args) :
-		result = self.eventFunc.has_key(args[0])
-		if result :
-			self.eventFunc[args[0]] = func
-			self.eventArgs[args[0]] = args
-		else :
-			print("[ERROR] ui.py SetEvent, Can`t Find has_key : %s" % args[0])
-
-	def OnMouseLeftButtonUp(self) :
-		if self.eventFunc["mouse_click"] :
-			apply(self.eventFunc["mouse_click"], self.eventArgs["mouse_click"])
-
-	def OnMouseOverIn(self) :
-		if self.eventFunc["mouse_over_in"] :
-			apply(self.eventFunc["mouse_over_in"], self.eventArgs["mouse_over_in"])
-		else:
-			try:
-				self.eventDict["MOUSE_OVER_IN"]()
-			except KeyError:
-				pass
-
-	def OnMouseOverOut(self) :
-		if self.eventFunc["mouse_over_out"] :
-			apply(self.eventFunc["mouse_over_out"], self.eventArgs["mouse_over_out"])
-		else :
-			try:
-				self.eventDict["MOUSE_OVER_OUT"]()
-			except KeyError:
-				pass
-
 class ExpandedImageBox(ImageBox):
 	def __init__(self, layer = "UI"):
 		ImageBox.__init__(self, layer)
@@ -1225,8 +1166,9 @@
 	def SetRenderingRect(self, left, top, right, bottom):
 		wndMgr.SetRenderingRect(self.hWnd, left, top, right, bottom)
 
-	def SetClipRect(self, left, top, right, bottom, isVertical = False):
-		wndMgr.SetClipRect(self.hWnd, left, top, right, bottom, isVertical)
+	if app.ENABLE_IMAGE_CLIP_RECT:
+		def SetClipRect(self, left, top, right, bottom, isVertical = False):
+			wndMgr.SetClipRect(self.hWnd, left, top, right, bottom, isVertical)
 
 	def SetPercentage(self, curValue, maxValue):
 		if maxValue:
@@ -1234,12 +1176,6 @@
 		else:
 			self.SetRenderingRect(0.0, 0.0, 0.0, 0.0)
 
-	def SetPercentageEx(self, minValue, curValue, maxValue):
-		if minValue and maxValue:
-			self.SetRenderingRect(0.0, 0.0, -1.0 + (float(curValue) - float(minValue)) / (float(maxValue) - float(minValue)), 0.0)
-		else:
-			self.SetRenderingRect(0.0, 0.0, 0.0, 0.0)
-
 	def GetWidth(self):
 		return wndMgr.GetWindowWidth(self.hWnd)
 
@@ -1254,10 +1190,6 @@
 			self.end_frame_args = None
 		self.key_frame_event = None
 
-		if app.ENABLE_MINI_GAME_YUTNORI:
-			self.eventFunc = { "mouse_click" : None, "mouse_over_in" : None, "mouse_over_out" : None }
-			self.eventArgs = { "mouse_click" : None, "mouse_over_in" : None, "mouse_over_out" : None }
-
 	def __del__(self):
 		Window.__del__(self)
 		self.end_frame_event = None
@@ -1265,26 +1197,28 @@
 			self.end_frame_args = None
 		self.key_frame_event = None
 
-		if app.ENABLE_MINI_GAME_YUTNORI:
-			self.eventFunc = None
-			self.eventArgs = None
-
 	def RegisterWindow(self, layer):
 		self.hWnd = wndMgr.RegisterAniImageBox(self, layer)
 
 	def SetDelay(self, delay):
 		wndMgr.SetDelay(self.hWnd, delay)
 
-	if app.ENABLE_FISHING_GAME:
-		def SetRotation(self, rotation):
-			wndMgr.SetRotation(self.hWnd, rotation)
-
 	def AppendImage(self, filename):
 		wndMgr.AppendImage(self.hWnd, filename)
 
+	if app.ENABLE_IMAGE_SCALE:
+		def AppendImageScale(self, filename, scale_x, scale_y):
+			wndMgr.AppendImageScale(self.hWnd, filename, scale_x, scale_y)
+
 	def SetPercentage(self, curValue, maxValue):
 		wndMgr.SetRenderingRect(self.hWnd, 0.0, 0.0, -1.0 + float(curValue) / float(maxValue), 0.0)
 
+	def SetPercentageWithScale(self, curValue, maxValue):
+		wndMgr.SetRenderingRectWithScale(self.hWnd, 0.0, 0.0, -1.0 + float(curValue) / float(maxValue), 0.0)
+			
+	def SetScale(self, xScale, yScale):
+		wndMgr.SetAniImgScale(self.hWnd, xScale, yScale)
+
 	if app.ENABLE_MINI_GAME_CATCH_KING:
 		def OnEndFrame(self):
 			if self.end_frame_event:
@@ -1294,16 +1228,8 @@
 			if self.end_frame_event:
 				self.end_frame_event()
 
-	if app.ENABLE_GROWTH_PET_SYSTEM:
-		def AppendImageScale(self, filename, scale_x, scale_y):
-			wndMgr.AppendImageScale(self.hWnd, filename, scale_x, scale_y)
-
-	#if app.ENABLE_GROWTH_PET_SYSTEM:
-	def SetPercentageWithScale(self, curValue, maxValue):
-		wndMgr.SetRenderingRectWithScale(self.hWnd, 0.0, 0.0, -1.0 + float(curValue) / float(maxValue), 0.0)
-
-	def SetScale(self, xScale, yScale):
-		wndMgr.SetAniImgScale(self.hWnd, xScale, yScale)
+	# def SetScale(self, xScale, yScale):
+		# wndMgr.SetAniImgScale(self.hWnd, xScale, yScale)
 
 	if app.ENABLE_MINI_GAME_CATCH_KING:
 		def SetEndFrameEvent(self, event, *args):
@@ -1323,27 +1249,6 @@
 	def SetKeyFrameEvent(self, event):
 		self.key_frame_event = event
 
-	if app.ENABLE_MINI_GAME_YUTNORI:
-		def SetEvent(self, func, *args):
-			result = self.eventFunc.has_key(args[0])
-			if result:
-				self.eventFunc[args[0]] = func
-				self.eventArgs[args[0]] = args
-			else:
-				print("[ERROR] ui.py SetEvent, Can`t Find has_key : %s" % args[0])
-
-		def OnMouseLeftButtonUp(self):
-			if self.eventFunc["mouse_click"]:
-				apply(self.eventFunc["mouse_click"], self.eventArgs["mouse_click"])
-
-		def OnMouseOverIn(self):
-			if self.eventFunc["mouse_over_in"]:
-				apply(self.eventFunc["mouse_over_in"], self.eventArgs["mouse_over_in"])
-
-		def OnMouseOverOut(self):
-			if self.eventFunc["mouse_over_out"]:
-				apply(self.eventFunc["mouse_over_out"], self.eventArgs["mouse_over_out"])
-
 class MoveImageBox(ImageBox):
 	def __init__(self, layer = "UI"):
 		ImageBox.__init__(self, layer)
@@ -1376,26 +1281,6 @@
 	def SetEndMoveEvent(self, event):
 		self.end_move_event = event
 
-if app.ENABLE_MINI_GAME_YUTNORI:
-	class MoveScaleImageBox(MoveImageBox):
-		def __init__(self, layer = "UI"):
-			MoveImageBox.__init__(self, layer)
-
-		def __del__(self):
-			MoveImageBox.__del__(self)
-
-		def RegisterWindow(self, layer):
-			self.hWnd = wndMgr.RegisterMoveScaleImageBox(self, layer)
-
-		def SetMaxScale(self, scale):
-			wndMgr.SetMaxScale(self.hWnd, scale)
-
-		def SetMaxScaleRate(self, pivot):
-			wndMgr.SetMaxScaleRate(self.hWnd, pivot)
-
-		def SetScalePivotCenter(self, flag):
-			wndMgr.SetScalePivotCenter(self.hWnd, flag)
-
 class Button(Window):
 	def __init__(self, layer = "UI"):
 		Window.__init__(self, layer)
@@ -1408,7 +1293,7 @@
 
 		self.TextChild = []
 
-		if app.ENABLE_DETAILS_UI or app.ENABLE_MINI_GAME_YUTNORI:
+		if app.ENABLE_DETAILS_UI:
 			self.overFunc = None
 			self.overArgs = None
 			self.overOutFunc = None
@@ -1428,7 +1313,7 @@
 		self.eventFunc = None
 		self.eventArgs = None
 
-		if app.ENABLE_DETAILS_UI or app.ENABLE_MINI_GAME_YUTNORI:
+		if app.ENABLE_DETAILS_UI:
 			self.overFunc = None
 			self.overArgs = None
 			self.overOutFunc = None
@@ -1490,7 +1375,7 @@
 	def Over(self):
 		wndMgr.Over(self.hWnd)
 
-	def LeftRightReverse(self):
+	def LeftRightReverse(self) :
 		wndMgr.LeftRightReverse(self.hWnd)
 
 	def SetTextColor(self, color):
@@ -1498,8 +1383,23 @@
 			return
 		self.ButtonText.SetPackedFontColor(color)
 
-	def IsLockSlot(self, slot_number):
-		return wndMgr.IsLockSlot(self.hWnd, slot_number)
+	def SetTextPosition(self, x, y):
+		self.ButtonText.SetPosition(x, y)
+		self.ButtonText.SetWindowHorizontalAlignCenter()
+		self.ButtonText.SetWindowVerticalAlignCenter()
+
+	if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+		def SetAlpha(self, alpha):
+			wndMgr.SetButtonDiffuseColor(self.hWnd, 1.0, 1.0, 1.0, alpha)
+
+		def GetText(self):
+			if self.ButtonText:
+				return self.ButtonText.GetText()
+			else:
+				return ""
+
+		def IsDisable(self):
+			return wndMgr.IsDisable(self.hWnd)
 
 	def SetText(self, text, height = 4):
 		if not self.ButtonText:
@@ -1513,41 +1413,6 @@
 
 		self.ButtonText.SetText(text)
 
-	if app.ENABLE_MINI_GAME_YUTNORI:
-		def SetAutoSizeText(self, text):
-			if not self.ButtonText:
-				textLine = TextLine()
-				textLine.SetParent(self)
-				textLine.SetVerticalAlignCenter()
-				textLine.SetHorizontalAlignCenter()
-				textLine.Show()
-				self.ButtonText = textLine
-
-			self.ButtonText.SetText(text)
-
-			imageWidth = self.GetButtonImageWidth()
-			imageHeight = self.GetButtonImageHeight()
-
-			if imageWidth == 0 or imageHeight == 0:
-				return
-
-			(textWidth, textHeight) = self.ButtonText.GetTextSize()
-			textWidth += imageWidth / 5
-			textHeight += imageHeight / 10
-
-			curWidth = self.GetWidth()
-			curHeight = self.GetHeight()
-
-			if curWidth < textWidth:
-				curWidth = textWidth
-
-			if curHeight < textHeight:
-				curHeight = textHeight
-
-			self.SetSize(curWidth, curHeight)
-			self.SetButtonScale(curWidth * 1.0 / imageWidth, curHeight * 1.0 / imageHeight)
-			self.ButtonText.SetPosition(self.GetWidth() / 2, self.GetHeight() / 2)
-
 	def AppendTextLineAllClear(self):
 		self.TextChild = []
 
@@ -1568,7 +1433,7 @@
 		, font_color = grp.GenerateColor(0.7607, 0.7607, 0.7607, 1.0)
 		, text_sort = "center"
 		, pos_x = None
-		, pos_y = None):
+		, pos_y = None) :
 		textLine = TextLine()
 		textLine.SetParent(self)
 		textLine.SetFontName(font_size)
@@ -1576,9 +1441,9 @@
 		textLine.SetText(text)
 		textLine.Show()
 
-		if not pos_x and not pos_y:
-			textLine.SetPosition(self.GetWidth() / 2, self.GetHeight() / 2)
-		else:
+		if not pos_x and not pos_y :
+			textLine.SetPosition(self.GetWidth()/2, self.GetHeight()/2)
+		else :
 			textLine.SetPosition(pos_x, pos_y)
 
 		textLine.SetVerticalAlignCenter()
@@ -1607,10 +1472,10 @@
 		self.ToolTipText.SetText(text)
 
 	def SetToolTipWindow(self, toolTip):
-		self.ToolTipText = toolTip
+		self.ToolTipText=toolTip
 		self.ToolTipText.SetParentProxy(self)
 
-	def SetToolTipText(self, text, x = 0, y = -19):
+	def SetToolTipText(self, text, x=0, y = -19):
 		self.SetFormToolTipText("TEXT", text, x, y)
 
 	def CallEvent(self):
@@ -1644,29 +1509,7 @@
 	def IsDown(self):
 		return wndMgr.IsDown(self.hWnd)
 
-	def SetAlpha(self, alpha):
-		wndMgr.SetButtonDiffuseColor(self.hWnd, 1.0, 1.0, 1.0, alpha)
-
-	def GetText(self):
-		if self.ButtonText:
-			return self.ButtonText.GetText()
-		else:
-			return ""
-
-	def IsDisable(self):
-		return wndMgr.IsDisable(self.hWnd)
-
-	def SetScale(self, scale_x, scale_y):
-		wndMgr.SetButtonScale(self.hWnd, scale_x, scale_y)
-
-	def SetDiffuseColor(self, r, g, b, a):
-		wndMgr.SetButtonDiffuseColor(self.hWnd, r, g, b, a)
-
-	#if app.ENABLE_MONSTER_CARD:
-	def SetAlwaysToolTip(self, bFlag):
-		wndMgr.SetAlwaysToolTip(self.hWnd, bFlag)
-
-	if app.ENABLE_DETAILS_UI or app.ENABLE_MINI_GAME_YUTNORI:
+	if app.ENABLE_DETAILS_UI:
 		def OnMouseOverIn(self):
 			if self.overFunc:
 				apply(self.overFunc, self.overArgs)
@@ -1683,15 +1526,55 @@
 			self.overOutFunc = func
 			self.overOutArgs = args
 
-	if app.ENABLE_MINI_GAME_YUTNORI or app.ENABLE_LUCKY_BOX:
-		def SetButtonScale(self, xScale, yScale):
-			wndMgr.SetButtonScale(self.hWnd, xScale, yScale)
+	if app.ENABLE_QUEST_RENEWAL or app.ENABLE_SKILL_COLOR_SYSTEM:
+		def GetText(self):
+			if not self.ButtonText:
+				return ""
+
+			return self.ButtonText.GetText()
+
+		def SetTextAlignLeft(self, text, x = 27, height = 4):
+			if not self.ButtonText:
+				textLine = TextLine()
+				textLine.SetParent(self)
+				textLine.SetPosition(x, self.GetHeight()/2)
+				textLine.SetVerticalAlignCenter()
+				textLine.SetHorizontalAlignLeft()
+				textLine.Show()
+				self.ButtonText = textLine
+
+			#퀘스트 리스트 UI에 맞춰 위치 잡음
+			self.ButtonText.SetText(text)
+			self.ButtonText.SetPosition(x, self.GetHeight()/2)
+			self.ButtonText.SetVerticalAlignCenter()
+			self.ButtonText.SetHorizontalAlignLeft()
+
+		def SetTextAlignRight(self, text, x = 27, y = 0):
+			if not self.ButtonText:
+				textLine = TextLine()
+				textLine.SetParent(self)
+				textLine.SetPosition(x, y)
+				textLine.SetVerticalAlignCenter()
+				textLine.Show()
+				self.ButtonText = textLine
 
-		def GetButtonImageWidth(self):
-			return wndMgr.GetButtonImageWidth(self.hWnd)
+			#퀘스트 리스트 UI에 맞춰 위치 잡음
+			self.ButtonText.SetText(text)
+			self.ButtonText.SetPosition(x, y)
+			self.ButtonText.SetVerticalAlignCenter()
+
+	if app.ENABLE_SKILL_COLOR_SYSTEM:
+		def SetListText(self, text, x = 8):
+			if not self.ButtonText:
+				textLine = TextLine()
+				textLine.SetParent(self)
+				textLine.SetPosition(x, self.GetHeight()/2)
+				textLine.SetVerticalAlignCenter()
+				textLine.SetHorizontalAlignLeft()
+				textLine.Show()
+				self.ButtonText = textLine
 
-		def GetButtonImageHeight(self):
-			return wndMgr.GetButtonImageHeight(self.hWnd)
+			self.ButtonText.SetText(text)
 
 	def SetTextAddPos(self, text, x_add = 0, y_add = 0, height = 4):
 		if not self.ButtonText:
@@ -1704,88 +1587,6 @@
 			self.ButtonText = textLine
 		self.ButtonText.SetText(text)
 
-class CheckBoxRefine(Window):
-	def __init__(self):
-		Window.__init__(self)
-		
-		self.backgroundImage = None
-		self.checkImage = None
-
-		self.eventFunc = { "ON_CHECK" : None, "ON_UNCKECK" : None, }
-		self.eventArgs = { "ON_CHECK" : None, "ON_UNCKECK" : None, }
-	
-		self.CreateElements()
-		
-	def __del__(self):
-		Window.__del__(self)
-		
-		self.backgroundImage = None
-		self.checkImage = None
-		
-		self.eventFunc = { "ON_CHECK" : None, "ON_UNCKECK" : None, }
-		self.eventArgs = { "ON_CHECK" : None, "ON_UNCKECK" : None, }
-		
-	def CreateElements(self):
-		self.backgroundImage = ImageBox()
-		self.backgroundImage.SetParent(self)
-		self.backgroundImage.AddFlag("not_pick")
-		self.backgroundImage.SetPosition(0, -2)
-		self.backgroundImage.LoadImage("d:/ymir work/ui/game/checkbox/checkbox.tga")
-		self.backgroundImage.Show()
-		
-		self.checkImage = ImageBox()
-		self.checkImage.SetParent(self)
-		self.checkImage.AddFlag("not_pick")
-		self.checkImage.SetPosition(0, -2)
-		self.checkImage.LoadImage("d:/ymir work/ui/game/checkbox/checked.tga")
-		self.checkImage.Hide()
-		
-		self.textInfo = TextLine()
-		self.textInfo.SetParent(self)
-		self.textInfo.SetPosition(20, -2)
-		self.textInfo.Show()
-		
-		self.SetSize(self.backgroundImage.GetWidth() + self.textInfo.GetTextSize()[0], self.backgroundImage.GetHeight() + self.textInfo.GetTextSize()[1])
-		
-	def SetTextInfo(self, info):
-		if self.textInfo:
-			self.textInfo.SetText(info)
-			
-		self.SetSize(self.backgroundImage.GetWidth() + self.textInfo.GetTextSize()[0], self.backgroundImage.GetHeight() + self.textInfo.GetTextSize()[1])
-		
-	def SetCheckStatus(self, flag):
-		if flag:
-			self.checkImage.Show()
-		else:
-			self.checkImage.Hide()
-	
-	def GetCheckStatus(self):
-		if self.checkImage:
-			return self.checkImage.IsShow()
-			
-		return False
-		
-	def SetEvent(self, func, *args) :
-		result = self.eventFunc.has_key(args[0])		
-		if result :
-			self.eventFunc[args[0]] = func
-			self.eventArgs[args[0]] = args
-		else :
-			print "[ERROR] ui.py SetEvent, Can`t Find has_key : %s" % args[0]
-		
-	def OnMouseLeftButtonUp(self):
-		if self.checkImage:
-			if self.checkImage.IsShow():
-				self.checkImage.Hide()
-
-				if self.eventFunc["ON_UNCKECK"]:
-					apply(self.eventFunc["ON_UNCKECK"], self.eventArgs["ON_UNCKECK"])
-			else:
-				self.checkImage.Show()
-
-				if self.eventFunc["ON_CHECK"]:
-					apply(self.eventFunc["ON_CHECK"], self.eventArgs["ON_CHECK"])
-
 class RadioButton(Button):
 	def __init__(self):
 		Button.__init__(self)
@@ -1813,6 +1614,12 @@
 		for (button, selectEvent, unselectEvent) in self.buttonGroup:
 			button.Hide()
 
+	def SetTextPosition(self, idx, x, y):
+		if idx >= len(self.buttonGroup):
+			return
+		(button, selectEvent, unselectEvent) = self.buttonGroup[idx]
+		button.SetTextPosition(x, y)
+
 	def SetText(self, idx, text):
 		if idx >= len(self.buttonGroup):
 			return
@@ -2015,13 +1822,6 @@
 		self.eventOverOutItem = None
 		self.eventPressedSlotButton = None
 
-		if app.ENABLE_EXTEND_INVEN_SYSTEM:
-			self.eventSelectEmptySlotWindow = None
-			self.eventSelectItemSlotWindow = None
-			self.eventUseSlotWindow = None
-			self.eventOverInItemSlotWindow = None
-			self.eventUnselectItemSlotWindow = None
-
 		self.eventSelectItemSlotArgs = None
 		self.eventOverInItemArgs = None
 
@@ -2037,13 +1837,6 @@
 		self.eventOverOutItem = None
 		self.eventPressedSlotButton = None
 
-		if app.ENABLE_EXTEND_INVEN_SYSTEM:
-			self.eventSelectEmptySlotWindow = None
-			self.eventSelectItemSlotWindow = None
-			self.eventUseSlotWindow = None
-			self.eventOverInItemSlotWindow = None
-			self.eventUnselectItemSlotWindow = None
-
 		self.eventSelectItemSlotArgs = None
 		self.eventOverInItemArgs = None
 
@@ -2056,24 +1849,30 @@
 	def HasSlot(self, slotIndex):
 		return wndMgr.HasSlot(self.hWnd, slotIndex)
 
-	if app.ENABLE_GROWTH_PET_SYSTEM:
-		def SetSlotScale(self, xScale, yScale):
-			wndMgr.SetSlotScale(self.hWnd, xScale, yScale)
+	def SetSlotScale(self, xScale, yScale):
+		wndMgr.SetSlotScale(self.hWnd, xScale, yScale)
+
+	def SetSlotCoolTimeColor(self, slotIndex, r, g, b, a):
+		wndMgr.SetSlotCoolTimeColor(self.hWnd, slotIndex, r, g, b, a)
+
+	def SetSlotCoolTimeInverse(self, slotIndex, coolTime, elapsedTime = 0.0):
+		wndMgr.SetSlotCoolTimeInverse(self.hWnd, slotIndex, coolTime, elapsedTime)
 
-	def HideSlotButton(self, slot_number):
-		wndMgr.HideSlotButton(self.hWnd, slot_number)
+	if app.ENABLE_GROWTH_PET_SYSTEM:
+		def SetPetSkillSlotNew(self, renderingSlotNumber, petSkillIndex):
+		
+			petSkillIcon = skill.GetPetSkillIconImage(petSkillIndex)
 
-	if app.ENABLE_SLOT_SCALE:
-		def SetSlotScale(self, xScale, yScale):
-			wndMgr.SetSlotScale(self.hWnd, xScale, yScale)
+			if 0 == petSkillIcon:
+				wndMgr.ClearSlot(self.hWnd, renderingSlotNumber)
+				return
 
-		def SetSlotImage(self, slot_index, filename):
-			wndMgr.SetSlotImage(self.hWnd, slot_index, filename)
+			wndMgr.SetSlot(self.hWnd, renderingSlotNumber, petSkillIndex, 1, 1, petSkillIcon)
 
 	def SetSlotBaseImage(self, imageFileName, r, g, b, a):
 		wndMgr.SetSlotBaseImage(self.hWnd, imageFileName, r, g, b, a)
 
-	if app.ENABLE_GROWTH_PET_SYSTEM:
+	if app.ENABLE_IMAGE_SCALE:
 		def SetSlotBaseImageScale(self, imageFileName, r, g, b, a, sx, sy):
 			wndMgr.SetSlotBaseImageScale(self.hWnd, imageFileName, r, g, b, a, sx, sy)
 
@@ -2120,15 +1919,21 @@
 	def HideRequirementSign(self, slotNumber):
 		wndMgr.HideRequirementSign(self.hWnd, slotNumber)
 
+	if app.ENABLE_ACCE_COSTUME_SYSTEM or app.ENABLE_CHANGE_LOOK_SYSTEM:
+		def ActivateSlotEffect(self, slotNumber, r = 1.0, g = 1.0, b = 1.0, a = 1.0):
+			wndMgr.ActivateSlotEffect(self.hWnd, slotNumber, r, g, b, a)
+
+		def DeactivateSlotEffect(self, slotNumber):
+			wndMgr.DeactivateSlotEffect(self.hWnd, slotNumber)
+
 	def ActivateSlot(self, slotNumber):
 		wndMgr.ActivateSlot(self.hWnd, slotNumber)
 
 	def DeactivateSlot(self, slotNumber):
 		wndMgr.DeactivateSlot(self.hWnd, slotNumber)
 
-	if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
-		def SetSlotDiffuseColor(self, slotindex, colortype):
-			wndMgr.SetSlotDiffuseColor(self.hWnd, slotindex, colortype)
+	def SetSlotDiffuseColor(self, slotindex, colortype):
+		wndMgr.SetSlotDiffuseColor(self.hWnd, slotindex, colortype)
 
 	def SetSlotHighlightedGreeen(self, slotNumber):
 		wndMgr.SetSlotHighlightedGreeen(self.hWnd, slotNumber)
@@ -2142,95 +1947,43 @@
 	def HideSlotBaseImage(self, slotNumber):
 		wndMgr.HideSlotBaseImage(self.hWnd, slotNumber)
 
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		def SAFE_SetButtonEvent(self, button, state, event, window = None):
-			if "LEFT" == button:
-				if "EMPTY" == state:
-					self.eventSelectEmptySlot = __mem_func__(event)
-					self.eventSelectEmptySlotWindow = window
-				elif "EXIST" == state:
-					self.eventSelectItemSlot = __mem_func__(event)
-					self.eventSelectItemSlotWindow = window
-				elif "ALWAYS" == state:
-					self.eventSelectEmptySlot = __mem_func__(event)
-					self.eventSelectEmptySlotWindow = window
-					self.eventSelectItemSlot = __mem_func__(event)
-					self.eventSelectItemSlotWindow = window
-			elif "RIGHT" == button:
-				if "EMPTY" == state:
-					self.eventUnselectEmptySlot = __mem_func__(event)
-				elif "EXIST" == state:
-					self.eventUnselectItemSlot = __mem_func__(event)
-					self.eventUnselectItemSlotWindow = window
-				elif "ALWAYS" == state:
-					self.eventUnselectEmptySlot = __mem_func__(event)
-					self.eventUnselectItemSlot = __mem_func__(event)
-					self.eventUnselectItemSlotWindow = window
-	else:
-		def SAFE_SetButtonEvent(self, button, state, event):
-			if "LEFT" == button:
-				if "EMPTY" == state:
-					self.eventSelectEmptySlot = __mem_func__(event)
-				elif "EXIST" == state:
-					self.eventSelectItemSlot = __mem_func__(event)
-				elif "ALWAYS" == state:
-					self.eventSelectEmptySlot = __mem_func__(event)
-					self.eventSelectItemSlot = __mem_func__(event)
-			elif "RIGHT" == button:
-				if "EMPTY" == state:
-					self.eventUnselectEmptySlot = __mem_func__(event)
-				elif "EXIST" == state:
-					self.eventUnselectItemSlot = __mem_func__(event)
-				elif "ALWAYS" == state:
-					self.eventUnselectEmptySlot = __mem_func__(event)
-					self.eventUnselectItemSlot = __mem_func__(event)
-
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		def SetSelectEmptySlotEvent(self, empty, window = None):
-			self.eventSelectEmptySlot = empty
-			self.eventSelectEmptySlotWindow = window
-	else:
-		def SetSelectEmptySlotEvent(self, empty):
-			self.eventSelectEmptySlot = empty
-
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		def SetSelectItemSlotEvent(self, item, window = None, *args):
-			self.eventSelectItemSlot = item
-			self.eventSelectItemSlotWindow = window
-			self.eventSelectItemSlotArgs = args
-	else:
-		def SetSelectItemSlotEvent(self, item, *args):
-			self.eventSelectItemSlot = item
-			self.eventSelectItemSlotArgs = args
+	def SAFE_SetButtonEvent(self, button, state, event):
+		if "LEFT"==button:
+			if "EMPTY"==state:
+				self.eventSelectEmptySlot=__mem_func__(event)
+			elif "EXIST"==state:
+				self.eventSelectItemSlot=__mem_func__(event)
+			elif "ALWAYS"==state:
+				self.eventSelectEmptySlot=__mem_func__(event)
+				self.eventSelectItemSlot=__mem_func__(event)
+		elif "RIGHT"==button:
+			if "EMPTY"==state:
+				self.eventUnselectEmptySlot=__mem_func__(event)
+			elif "EXIST"==state:
+				self.eventUnselectItemSlot=__mem_func__(event)
+			elif "ALWAYS"==state:
+				self.eventUnselectEmptySlot=__mem_func__(event)
+				self.eventUnselectItemSlot=__mem_func__(event)
+
+	def SetSelectEmptySlotEvent(self, empty):
+		self.eventSelectEmptySlot = empty
+
+	def SetSelectItemSlotEvent(self, item, *args):
+		self.eventSelectItemSlot = item
+		self.eventSelectItemSlotArgs = args
 
 	def SetUnselectEmptySlotEvent(self, empty):
 		self.eventUnselectEmptySlot = empty
 
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		def SetUnselectItemSlotEvent(self, item, window = None):
-			self.eventUnselectItemSlot = item
-			self.eventUnselectItemSlotWindow = window
-	else:
-		def SetUnselectItemSlotEvent(self, item):
-			self.eventUnselectItemSlot = item
+	def SetUnselectItemSlotEvent(self, item):
+		self.eventUnselectItemSlot = item
 
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		def SetUseSlotEvent(self, use, window = None):
-			self.eventUseSlot = use
-			self.eventUseSlotWindow = window
-	else:
-		def SetUseSlotEvent(self, use):
-			self.eventUseSlot = use
+	def SetUseSlotEvent(self, use):
+		self.eventUseSlot = use
 
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		def SetOverInItemEvent(self, event, window = None, *args):
-			self.eventOverInItem = event
-			self.eventOverInItemArgs = args
-			self.eventOverInItemSlotWindow = window
-	else:
-		def SetOverInItemEvent(self, event, *args):
-			self.eventOverInItem = event
-			self.eventOverInItemArgs = args
+	def SetOverInItemEvent(self, event, *args):
+		self.eventOverInItem = event
+		self.eventOverInItemArgs = args
 
 	def SetOverOutItemEvent(self, event):
 		self.eventOverOutItem = event
@@ -2256,18 +2009,13 @@
 	def SetSlotCoolTimeColor(self, slotIndex, r, g, b, a):
 		wndMgr.SetSlotCoolTimeColor(self.hWnd, slotIndex, r, g, b, a)
 
-	if app.ENABLE_SLOT_COOLTIME_REFRESH_FIX:
-		def StoreSlotCoolTime(self, key, slotIndex, coolTime, elapsedTime = 0.0):
-			wndMgr.StoreSlotCoolTime(self.hWnd, key, slotIndex, coolTime, elapsedTime)
+	def StoreSlotCoolTime(self, key, slotIndex, coolTime, elapsedTime = 0.0):
+		wndMgr.StoreSlotCoolTime(self.hWnd, key, slotIndex, coolTime, elapsedTime)
 
-		def RestoreSlotCoolTime(self, key):
-			wndMgr.RestoreSlotCoolTime(self.hWnd, key)
+	def RestoreSlotCoolTime(self, key):
+		wndMgr.RestoreSlotCoolTime(self.hWnd, key)
 
-	#if app.ENABLE_GROWTH_PET_SYSTEM:
-	def SetSlotCoolTimeInverse(self, slotIndex, coolTime, elapsedTime = 0.0):
-		wndMgr.SetSlotCoolTimeInverse(self.hWnd, slotIndex, coolTime, elapsedTime)
-
-	if app.WJ_ENABLE_TRADABLE_ICON or app.ENABLE_MOVE_COSTUME_ATTR or app.ENABLE_MAILBOX:
+	if app.WJ_ENABLE_TRADABLE_ICON:
 		def SetCanMouseEventSlot(self, slotIndex):
 			wndMgr.SetCanMouseEventSlot(self.hWnd, slotIndex)
 
@@ -2280,9 +2028,6 @@
 		def SetUsableSlotOnTopWnd(self, slotIndex):
 			wndMgr.SetUsableSlotOnTopWnd(self.hWnd, slotIndex)
 
-	def IsActiveSlot(self, slot_index):
-		return wndMgr.IsActiveSlot(self.hWnd, slot_index)
-
 	def DisableSlot(self, slotIndex):
 		wndMgr.DisableSlot(self.hWnd, slotIndex)
 
@@ -2310,6 +2055,10 @@
 	def SetSlot(self, slotIndex, itemIndex, width, height, icon, diffuseColor = (1.0, 1.0, 1.0, 1.0)):
 		wndMgr.SetSlot(self.hWnd, slotIndex, itemIndex, width, height, icon, diffuseColor)
 
+	# if app.ENABLE_IMAGE_SCALE:
+		# def SetSlotScale(self, slotIndex, itemIndex, width, height, icon, sx, sy, diffuseColor = (1.0, 1.0, 1.0, 1.0)):
+			# wndMgr.SetSlotScale(self.hWnd, slotIndex, itemIndex, width, height, icon, diffuseColor, sx, sy)
+
 	def SetSlotCount(self, slotNumber, count):
 		wndMgr.SetSlotCount(self.hWnd, slotNumber, count)
 
@@ -2319,19 +2068,51 @@
 	def SetSlotCountNew(self, slotNumber, grade, count):
 		wndMgr.SetSlotCountNew(self.hWnd, slotNumber, grade, count)
 
-	def SetItemSlot(self, renderingSlotNumber, ItemIndex, ItemCount = 0, diffuseColor = (1.0, 1.0, 1.0, 1.0)):
-		if 0 == ItemIndex or None == ItemIndex:
-			wndMgr.ClearSlot(self.hWnd, renderingSlotNumber)
-			return
+	if app.ENABLE_MINI_GAME_OKEY:
+		def SetCardSlot(self, renderingSlotNumber, CardIndex, cardIcon, diffuseColor = (1.0, 1.0, 1.0, 1.0)):
+			if 0 == CardIndex or None == CardIndex:
+				wndMgr.ClearSlot(self.hWnd, renderingSlotNumber)
+				return
+
+			item.SelectItem(CardIndex)
+			(width, height) = item.GetItemSize()
 
-		item.SelectItem(ItemIndex)
-		itemIcon = item.GetIconImage()
+			wndMgr.SetCardSlot(self.hWnd, renderingSlotNumber, CardIndex, width, height, cardIcon, diffuseColor)
 
-		item.SelectItem(ItemIndex)
-		(width, height) = item.GetItemSize()
+	if app.ENABLE_CHANGE_LOOK_SYSTEM:
+		def SetItemSlot(self, renderingSlotNumber, ItemIndex, ItemCount = 0, diffuseColor = (1.0, 1.0, 1.0, 1.0), convertMark = True):
+			if 0 == ItemIndex or None == ItemIndex:
+				wndMgr.ClearSlot(self.hWnd, renderingSlotNumber)
+				return
 
-		wndMgr.SetSlot(self.hWnd, renderingSlotNumber, ItemIndex, width, height, itemIcon, diffuseColor)
-		wndMgr.SetSlotCount(self.hWnd, renderingSlotNumber, ItemCount)
+			item.SelectItem(ItemIndex)
+			itemIcon = item.GetIconImage()
+
+			item.SelectItem(ItemIndex)
+			(width, height) = item.GetItemSize()
+
+			wndMgr.SetSlot(self.hWnd, renderingSlotNumber, ItemIndex, width, height, itemIcon, diffuseColor)
+			wndMgr.SetSlotCount(self.hWnd, renderingSlotNumber, ItemCount)
+			if convertMark:
+				wndMgr.SetCoverButton(self.hWnd, renderingSlotNumber,
+					"d:/ymir work/ui/game/quest/slot_button_00.sub",\
+					"d:/ymir work/ui/game/quest/slot_button_00.sub",\
+					"d:/ymir work/ui/game/quest/slot_button_00.sub",\
+					"icon/item/ingame_convert_mark.tga", False, False)
+	else:
+		def SetItemSlot(self, renderingSlotNumber, ItemIndex, ItemCount = 0, diffuseColor = (1.0, 1.0, 1.0, 1.0)):
+			if 0 == ItemIndex or None == ItemIndex:
+				wndMgr.ClearSlot(self.hWnd, renderingSlotNumber)
+				return
+
+			item.SelectItem(ItemIndex)
+			itemIcon = item.GetIconImage()
+
+			item.SelectItem(ItemIndex)
+			(width, height) = item.GetItemSize()
+
+			wndMgr.SetSlot(self.hWnd, renderingSlotNumber, ItemIndex, width, height, itemIcon, diffuseColor)
+			wndMgr.SetSlotCount(self.hWnd, renderingSlotNumber, ItemCount)
 
 	def SetSkillSlot(self, renderingSlotNumber, skillIndex, skillLevel):
 		skillIcon = skill.GetIconImage(skillIndex)
@@ -2364,87 +2145,35 @@
 		wndMgr.SetSlot(self.hWnd, renderingSlotNumber, emotionIndex, 1, 1, icon)
 
 	## Event
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		def OnSelectEmptySlot(self, slotNumber):
-			if self.eventSelectEmptySlot:
-				if self.eventSelectEmptySlotWindow:
-					self.eventSelectEmptySlot(slotNumber, self.eventSelectEmptySlotWindow)
-				else:
-					self.eventSelectEmptySlot(slotNumber)
-	else:
-		def OnSelectEmptySlot(self, slotNumber):
-			if self.eventSelectEmptySlot:
-				self.eventSelectEmptySlot(slotNumber)
-
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		def OnSelectItemSlot(self, slotNumber):
-			if self.eventSelectItemSlot:
-				if self.eventSelectItemSlotWindow:
-					if self.eventSelectItemSlotArgs:
-						apply(self.eventSelectItemSlot, self.eventSelectItemSlotArgs)
-					else:
-						self.eventSelectItemSlot(slotNumber, self.eventSelectItemSlotWindow)
-				else:
-					if self.eventSelectItemSlotArgs:
-						apply(self.eventSelectItemSlot, self.eventSelectItemSlotArgs)
-					else:
-						self.eventSelectItemSlot(slotNumber)
-	else:
-		def OnSelectItemSlot(self, slotNumber):
-			if self.eventSelectItemSlot:
-				if self.eventSelectItemSlotArgs:
-					apply(self.eventSelectItemSlot, self.eventSelectItemSlotArgs)
-				else:
-					self.eventSelectItemSlot(slotNumber)
+	def OnSelectEmptySlot(self, slotNumber):
+		if self.eventSelectEmptySlot:
+			self.eventSelectEmptySlot(slotNumber)
+
+	def OnSelectItemSlot(self, slotNumber):
+		if self.eventSelectItemSlot:
+			if self.eventSelectItemSlotArgs:
+				apply(self.eventSelectItemSlot, self.eventSelectItemSlotArgs)
+			else:
+				self.eventSelectItemSlot(slotNumber)
 
 	def OnUnselectEmptySlot(self, slotNumber):
 		if self.eventUnselectEmptySlot:
 			self.eventUnselectEmptySlot(slotNumber)
 
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		def OnUnselectItemSlot(self, slotNumber):
-			if self.eventUnselectItemSlot:
-				if self.eventUnselectItemSlotWindow:
-					self.eventUnselectItemSlot(slotNumber, self.eventUnselectItemSlotWindow)
-				else:
-					self.eventUnselectItemSlot(slotNumber)
-	else:
-		def OnUnselectItemSlot(self, slotNumber):
-			if self.eventUnselectItemSlot:
-				self.eventUnselectItemSlot(slotNumber)
-
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		def OnUseSlot(self, slotNumber):
-			if self.eventUseSlot:
-				if self.eventUseSlotWindow:
-					self.eventUseSlot(slotNumber, self.eventUseSlotWindow)
-				else:
-					self.eventUseSlot(slotNumber)
-	else:
-		def OnUseSlot(self, slotNumber):
-			if self.eventUseSlot:
-				self.eventUseSlot(slotNumber)
-
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		def OnOverInItem(self, slotNumber):
-			if self.eventOverInItem:
-				if None == self.eventOverInItemSlotWindow:
-					if self.eventOverInItemArgs:
-						apply(self.eventOverInItem, self.eventOverInItemArgs)
-					else:
-						self.eventOverInItem(slotNumber)
-				else:
-					if self.eventOverInItemArgs:
-						apply(self.eventOverInItem, self.eventOverInItemArgs)
-					else:
-						self.eventOverInItem(slotNumber, self.eventOverInItemSlotWindow)
-	else:
-		def OnOverInItem(self, slotNumber):
-			if self.eventOverInItem:
-				if self.eventOverInItemArgs:
-					apply(self.eventOverInItem, self.eventOverInItemArgs)
-				else:
-					self.eventOverInItem(slotNumber)
+	def OnUnselectItemSlot(self, slotNumber):
+		if self.eventUnselectItemSlot:
+			self.eventUnselectItemSlot(slotNumber)
+
+	def OnUseSlot(self, slotNumber):
+		if self.eventUseSlot:
+			self.eventUseSlot(slotNumber)
+
+	def OnOverInItem(self, slotNumber):
+		if self.eventOverInItem:
+			if self.eventOverInItemArgs:
+				apply(self.eventOverInItem, self.eventOverInItemArgs)
+			else:
+				self.eventOverInItem(slotNumber)
 
 	def OnOverOutItem(self):
 		if self.eventOverOutItem:
@@ -2463,18 +2192,6 @@
 	def GetSlotLocalPosition(self, index):
 		return wndMgr.GetSlotLocalPosition(self.hWnd, index)
 
-	def SetSlotCoverImage(self, slotindex, filename):
-		wndMgr.SetSlotCoverImage(self.hWnd, slotindex, filename)
-
-	def EnableSlotCoverImage(self, slotindex, onoff):
-		wndMgr.EnableSlotCoverImage(self.hWnd, slotindex, onoff)
-
-	def SetSecondSlotCoverImage(self, slot_index, filename):
-		wndMgr.SetSecondSlotCoverImage(self.hWnd, slot_index, filename)
-
-	def EnableSecondSlotCoverImage(self, slot_index, onoff):
-		wndMgr.EnableSecondSlotCoverImage(self.hWnd, slot_index, onoff)
-
 	def SetSlotType(self, flag):
 		wndMgr.SetSlotType(self.hWnd, flag)
 
@@ -2488,20 +2205,6 @@
 		def DisableHighLightImage(self, slotIndex):
 			wndMgr.DisableHighLightImage(self.hWnd, slotIndex)
 
-	if app.ENABLE_GROWTH_PET_SYSTEM:
-		def SetSlotCoolTimeInverse(self, slotIndex, coolTime, elapsedTime = 0.0):
-			wndMgr.SetSlotCoolTimeInverse(self.hWnd, slotIndex, coolTime, elapsedTime)
-
-		def SetPetSkillSlotNew(self, renderingSlotNumber, petSkillIndex):
-		
-			petSkillIcon = skill.GetPetSkillIconImage(petSkillIndex)
-
-			if 0 == petSkillIcon:
-				wndMgr.ClearSlot(self.hWnd, renderingSlotNumber)
-				return
-
-			wndMgr.SetSlot(self.hWnd, renderingSlotNumber, petSkillIndex, 1, 1, petSkillIcon)
-
 class GridSlotWindow(SlotWindow):
 
 	def __init__(self):
@@ -2596,7 +2299,7 @@
 	def SetCloseEvent(self, event):
 		self.btnClose.SetEvent(event)
 
-	if app.ENABLE_CHANGED_ATTR or app.ENABLE_DETAILS_UI or app.ENABLE_LUCKY_BOX:
+	if app.ENABLE_DETAILS_UI:
 		def CloseButtonHide(self):
 			if localeInfo.IsARABIC():
 				self.imgLeft.LoadImage("d:/ymir work/ui/pattern/titlebar_right_02.tga")
@@ -2606,6 +2309,91 @@
 				self.imgRight.LoadImage("d:/ymir work/ui/pattern/titlebar_right_02.tga")
 				self.btnClose.Hide()
 
+if app.ENABLE_QUEST_RENEWAL:
+	class SubTitleBar(Button):
+		def __init__(self):
+			Button.__init__(self)
+
+		def __del__(self):
+			Button.__del__(self)
+
+		def MakeSubTitleBar(self, width):
+			width = max(64, width)
+			self.SetWidth(width)
+			self.SetUpVisual("d:/ymir work/ui/quest_re/quest_tab_01.tga")
+			self.SetOverVisual("d:/ymir work/ui/quest_re/quest_tab_01.tga")
+			self.SetDownVisual("d:/ymir work/ui/quest_re/quest_tab_01.tga")
+			self.Show()
+
+			scrollImage = ImageBox()
+			scrollImage.SetParent(self)
+			scrollImage.LoadImage("d:/ymir work/ui/quest_re/quest_down.tga")
+			scrollImage.SetPosition(5, 2.5)
+			scrollImage.AddFlag("not_pick")
+			scrollImage.Show()
+			self.scrollImage = scrollImage
+
+		def OpenCategory(self, qcount = 0):
+			if qcount > 0:
+				self.scrollImage.LoadImage("d:/ymir work/ui/quest_re/quest_up.tga")
+			else:
+				self.scrollImage.LoadImage("d:/ymir work/ui/quest_re/quest_down.tga")
+
+		def CloseCategory(self, qcount = 0):
+			self.scrollImage.LoadImage("d:/ymir work/ui/quest_re/quest_down.tga")
+
+		def SetQuestLabel(self, filename, qcount):
+			tabColor = ImageBox()
+			tabColor.SetParent(self)
+			tabColor.LoadImage(filename)
+			tabColor.AddFlag("not_pick")
+			tabColor.SetPosition(188, 12)
+			if qcount > 0:
+				tabColor.Show()
+			else:
+				tabColor.Hide()
+			self.tabColor = tabColor
+
+		def SetWidth(self, width):
+			self.SetPosition(32, 0)
+			self.SetSize(width, 23)
+
+	class ListBar(Button):
+		def __init__(self):
+			Button.__init__(self)
+
+		def __del__(self):
+			Button.__del__(self)
+
+		def MakeListBar(self, width, color):
+			width = max(64, width)
+			self.SetWidth(width)
+			self.Show()
+
+			checkbox = ImageBox()
+			checkbox.SetParent(self)
+			checkbox.LoadImage("d:/ymir work/ui/quest_re/quest_new.tga")
+			checkbox.SetPosition(10, 7)
+			checkbox.AddFlag("not_pick")
+			checkbox.Show()
+			self.checkbox = checkbox
+			self.isChecked = False
+
+		def SetWidth(self, width):
+			self.SetPosition(32, 0)
+			self.SetSize(width, 23)
+
+		def CallEvent(self):
+			self.OnClickEvent()
+			super(ListBar, self).CallEvent()
+
+		def OnClickEvent(self):
+			self.checkbox.Hide()
+			self.isChecked = True
+
+		def SetSlot(self, slotIndex, itemIndex, width, height, icon, diffuseColor = (1.0, 1.0, 1.0, 1.0)):
+			wndMgr.SetSlot(self.hWnd, slotIndex, itemIndex, width, height, icon, diffuseColor)
+
 class HorizontalBar(Window):
 	BLOCK_WIDTH = 32
 	BLOCK_HEIGHT = 17
@@ -2684,6 +2472,14 @@
 		imgSlotCenter.SetRenderingRect(0.0, 0.0, float((width - self.SLOT_WIDTH*2) - self.SLOT_WIDTH) / self.SLOT_WIDTH, 0.0)
 		imgSlotCenter.SetPosition(self.SLOT_WIDTH, 0)
 
+		if osfInfo.PAST_HEALTH_ON_TARGET:
+			imgGaugeBack = ExpandedImageBox()
+			imgGaugeBack.SetParent(self)
+			imgGaugeBack.LoadImage("d:/ymir work/ui/pattern/gauge_yellow.tga")
+			imgGaugeBack.Hide()
+			imgGaugeBack.SetRenderingRect(0.0, 0.0, 0.0, 0.0)
+			imgGaugeBack.SetPosition(self.GAUGE_TEMPORARY_PLACE, 0)
+
 		imgGauge = ExpandedImageBox()
 		imgGauge.SetParent(self)
 		imgGauge.LoadImage("d:/ymir work/ui/pattern/gauge_" + color + ".tga")
@@ -2705,6 +2501,8 @@
 		self.imgCenter = imgSlotCenter
 		self.imgRight = imgSlotRight
 		self.imgGauge = imgGauge
+		if osfInfo.PAST_HEALTH_ON_TARGET:
+			self.imgGaugeBack = imgGaugeBack
 
 		self.SetSize(width, self.SLOT_HEIGHT)
 
@@ -2716,6 +2514,10 @@
 			percentage = 0.0
 		# END_OF_PERCENTAGE_MAX_VALUE_ZERO_DIVISION_ERROR
 
+		if osfInfo.PAST_HEALTH_ON_TARGET:
+			self.lastCurValue = curValue
+			self.lastMaxValue = maxValue
+
 		gaugeSize = -1.0 + float(self.width - self.GAUGE_TEMPORARY_PLACE*2) * percentage / self.GAUGE_WIDTH
 		self.imgGauge.SetRenderingRect(0.0, 0.0, gaugeSize, 0.0)
 
@@ -2726,6 +2528,19 @@
 			self.imgRight.AddFlag(flag)
 			self.imgGauge.AddFlag(flag)
 
+	if osfInfo.PAST_HEALTH_ON_TARGET:
+		def SetPercentageBack(self, curValue, maxValue):
+			if not self.imgGaugeBack.IsShow():
+				self.imgGaugeBack.Show()
+
+			if maxValue > 0.0:
+				percentage = min(1.0, float(curValue)/float(maxValue))
+			else:
+				percentage = 0.0
+
+			gaugeSize = -1.0 + float(self.width - self.GAUGE_TEMPORARY_PLACE*2) * percentage / self.GAUGE_WIDTH
+			self.imgGaugeBack.SetRenderingRect(0.0, 0.0, gaugeSize, 0.0)
+
 class Board(Window):
 	CORNER_WIDTH = 32
 	CORNER_HEIGHT = 32
@@ -2743,6 +2558,8 @@
 
 	def __init__(self):
 		Window.__init__(self)
+		if app.ENABLE_IMAGE_CLIP_RECT:
+			self.skipMaxCheck = False
 
 		self.MakeBoard("d:/ymir work/ui/pattern/Board_Corner_", "d:/ymir work/ui/pattern/Board_Line_")
 		self.MakeBase()
@@ -2801,87 +2618,13 @@
 		Window.__del__(self)
 
 	def SetSize(self, width, height):
-		width = max(self.CORNER_WIDTH * 2, width)
-		height = max(self.CORNER_HEIGHT * 2, height)
-		Window.SetSize(self, width, height)
-
-		self.Corners[self.LB].SetPosition(0, height - self.CORNER_HEIGHT)
-		self.Corners[self.RT].SetPosition(width - self.CORNER_WIDTH, 0)
-		self.Corners[self.RB].SetPosition(width - self.CORNER_WIDTH, height - self.CORNER_HEIGHT)
-		self.Lines[self.R].SetPosition(width - self.CORNER_WIDTH, self.CORNER_HEIGHT)
-		self.Lines[self.B].SetPosition(self.CORNER_HEIGHT, height - self.CORNER_HEIGHT)
-
-		verticalShowingPercentage = float((height - self.CORNER_HEIGHT*2) - self.LINE_HEIGHT) / self.LINE_HEIGHT
-		horizontalShowingPercentage = float((width - self.CORNER_WIDTH*2) - self.LINE_WIDTH) / self.LINE_WIDTH
-		self.Lines[self.L].SetRenderingRect(0, 0, 0, verticalShowingPercentage)
-		self.Lines[self.R].SetRenderingRect(0, 0, 0, verticalShowingPercentage)
-		self.Lines[self.T].SetRenderingRect(0, 0, horizontalShowingPercentage, 0)
-		self.Lines[self.B].SetRenderingRect(0, 0, horizontalShowingPercentage, 0)
-
-		if self.Base:
-			self.Base.SetRenderingRect(0, 0, horizontalShowingPercentage, verticalShowingPercentage)
-
-class BorderA(Window):
-	CORNER_WIDTH = 16
-	CORNER_HEIGHT = 16
-	LINE_WIDTH = 16
-	LINE_HEIGHT = 16
-	BOARD_COLOR = grp.GenerateColor(0.17, 0.027, 0.0, 0.70)
-
-
-	LT = 0
-	LB = 1
-	RT = 2
-	RB = 3
-	L = 0
-	R = 1
-	T = 2
-	B = 3
-
-	def __init__(self, layer = "UI"):
-		Window.__init__(self, layer)
-
-		CornerFileNames = [ "d:/ymir work/ui/pattern/border_a/border_a_"+dir+".tga" for dir in ["Left_Top","Left_Bottom","Right_Top","Right_Bottom"] ]
-		LineFileNames = [ "d:/ymir work/ui/pattern/border_a/border_a_"+dir+".tga" for dir in ["Left","Right","Top","Bottom"] ]
-		#BaseFileName = "d:/ymir work/ui/pattern/border_a/border_center.tga"
-		
-		self.Corners = []
-		for fileName in CornerFileNames:
-			Corner = ExpandedImageBox()
-			Corner.AddFlag("not_pick")
-			Corner.LoadImage(fileName)
-			Corner.SetParent(self)
-			Corner.SetPosition(0, 0)
-			Corner.Show()
-			self.Corners.append(Corner)
-
-		self.Lines = []
-		for fileName in LineFileNames:
-			Line = ExpandedImageBox()
-			Line.AddFlag("not_pick")
-			Line.LoadImage(fileName)
-			Line.SetParent(self)
-			Line.SetPosition(0, 0)
-			Line.Show()
-			self.Lines.append(Line)
-
-		self.Base = ExpandedImageBox()
-		self.Base.AddFlag("not_pick")
-		self.Base.LoadImage("d:/ymir work/ui/pattern/border_a/border_a_center.tga")
-		self.Base.SetParent(self)
-		self.Base.SetPosition(self.CORNER_WIDTH, self.CORNER_HEIGHT)
-		self.Base.Show()
-		
-		self.Lines[self.L].SetPosition(0, self.CORNER_HEIGHT)
-		self.Lines[self.T].SetPosition(self.CORNER_WIDTH, 0)
-
-	def __del__(self):
-		Window.__del__(self)
-
-	def SetSize(self, width, height):
-
-		width = max(self.CORNER_WIDTH*2, width)
-		height = max(self.CORNER_HEIGHT*2, height)
+		if app.ENABLE_IMAGE_CLIP_RECT:
+			if not self.skipMaxCheck:
+				width = max(self.CORNER_WIDTH * 2, width)
+				height = max(self.CORNER_HEIGHT * 2, height)
+		else:
+			width = max(self.CORNER_WIDTH * 2, width)
+			height = max(self.CORNER_HEIGHT * 2, height)
 		Window.SetSize(self, width, height)
 
 		self.Corners[self.LB].SetPosition(0, height - self.CORNER_HEIGHT)
@@ -2900,113 +2643,6 @@
 		if self.Base:
 			self.Base.SetRenderingRect(0, 0, horizontalShowingPercentage, verticalShowingPercentage)
 
-	def ShowInternal(self):
-		self.Base.Show()
-		for wnd in self.Lines:
-			wnd.Show()
-		for wnd in self.Corners:
-			wnd.Show()
-
-	def HideInternal(self):
-		self.Base.Hide()
-		for wnd in self.Lines:
-			wnd.Hide()
-		for wnd in self.Corners:
-			wnd.Hide()
-
-class MiddleBoard(Window):
-
-	CORNER_WIDTH = 16
-	CORNER_HEIGHT = 16
-	LINE_WIDTH = 16
-	LINE_HEIGHT = 16
-	BOARD_COLOR = grp.GenerateColor(0.0, 0.0, 0.0, 0.7)
-
-	LT = 0
-	LB = 1
-	RT = 2
-	RB = 3
-	L = 0
-	R = 1
-	T = 2
-	B = 3
-
-	def __init__(self, layer = "UI"):
-		Window.__init__(self, layer)
-
-		CornerFileNames = [ "d:/ymir work/ui/pattern/ThinBoardB_Corner_" + dir + ".tga" for dir in [ "LeftTop", "LeftBottom", "RightTop", "RightBottom" ] ]
-		LineFileNames = [ "d:/ymir work/ui/pattern/ThinBoardB_Line_" + dir + ".tga" for dir in [ "Left", "Right", "Top", "Bottom" ] ]
-
-		self.Corners = []
-		for fileName in CornerFileNames:
-			Corner = ExpandedImageBox()
-			Corner.AddFlag("attach")
-			Corner.AddFlag("not_pick")
-			Corner.LoadImage(fileName)
-			Corner.SetParent(self)
-			Corner.SetPosition(0, 0)
-			Corner.Show()
-			self.Corners.append(Corner)
-
-		self.Lines = []
-		for fileName in LineFileNames:
-			Line = ExpandedImageBox()
-			Line.AddFlag("attach")
-			Line.AddFlag("not_pick")
-			Line.LoadImage(fileName)
-			Line.SetParent(self)
-			Line.SetPosition(0, 0)
-			Line.Show()
-			self.Lines.append(Line)
-
-		Base = Bar()
-		Base.SetParent(self)
-		Base.AddFlag("attach")
-		Base.AddFlag("not_pick")
-		Base.SetPosition(self.CORNER_WIDTH, self.CORNER_HEIGHT)
-		Base.SetColor(self.BOARD_COLOR)
-		Base.Show()
-		self.Base = Base
-
-		self.Lines[self.L].SetPosition(0, self.CORNER_HEIGHT)
-		self.Lines[self.T].SetPosition(self.CORNER_WIDTH, 0)
-
-	def __del__(self):
-		Window.__del__(self)
-
-	def SetSize(self, width, height):
-		width = max(self.CORNER_WIDTH * 2, width)
-		height = max(self.CORNER_HEIGHT * 2, height)
-		Window.SetSize(self, width, height)
-
-		self.Corners[self.LB].SetPosition(0, height - self.CORNER_HEIGHT)
-		self.Corners[self.RT].SetPosition(width - self.CORNER_WIDTH, 0)
-		self.Corners[self.RB].SetPosition(width - self.CORNER_WIDTH, height - self.CORNER_HEIGHT)
-		self.Lines[self.R].SetPosition(width - self.CORNER_WIDTH, self.CORNER_HEIGHT)
-		self.Lines[self.B].SetPosition(self.CORNER_HEIGHT, height - self.CORNER_HEIGHT)
-
-		verticalShowingPercentage = float((height - self.CORNER_HEIGHT * 2) - self.LINE_HEIGHT) / self.LINE_HEIGHT
-		horizontalShowingPercentage = float((width - self.CORNER_WIDTH * 2) - self.LINE_WIDTH) / self.LINE_WIDTH
-		self.Lines[self.L].SetRenderingRect(0, 0, 0, verticalShowingPercentage)
-		self.Lines[self.R].SetRenderingRect(0, 0, 0, verticalShowingPercentage)
-		self.Lines[self.T].SetRenderingRect(0, 0, horizontalShowingPercentage, 0)
-		self.Lines[self.B].SetRenderingRect(0, 0, horizontalShowingPercentage, 0)
-		self.Base.SetSize(width - self.CORNER_WIDTH * 2, height - self.CORNER_HEIGHT * 2)
-
-	def ShowInternal(self):
-		self.Base.Show()
-		for wnd in self.Lines:
-			wnd.Show()
-		for wnd in self.Corners:
-			wnd.Show()
-
-	def HideInternal(self):
-		self.Base.Hide()
-		for wnd in self.Lines:
-			wnd.Hide()
-		for wnd in self.Corners:
-			wnd.Hide()
-
 class BoardWithTitleBar(Board):
 	def __init__(self):
 		Board.__init__(self)
@@ -3376,7 +3012,7 @@
 
 			CornerFileNames, LineFileNames = self.__GetFilePath(type)
 
-			if CornerFileNames == None or LineFileNames == None:
+			if CornerFileNames == None or LineFileNames == None :
 				return
 
 			self.Corners = []
@@ -3504,7 +3140,6 @@
 		self.eventScroll = lambda *arg: None
 		self.lockFlag = False
 		self.scrollStep = 0.20
-		self.scroll_span = 0
 
 		self.UpScrollButtonEvent = lambda *arg: None
 		self.DownScrollButtonEvent = lambda *arg: None
@@ -3555,16 +3190,6 @@
 		self.SCROLLBAR_BUTTON_WIDTH = self.upButton.GetWidth()
 		self.SCROLLBAR_BUTTON_HEIGHT = self.upButton.GetHeight()
 
-	if app.ENABLE_MOUSE_WHEEL_TOP_WINDOW:
-		def OnMouseWheel(self, delta):
-			if delta > 0:
-				self.SetPos(self.curPos - (self.scrollStep/4))
-				return True
-			elif delta < 0:
-				self.SetPos(self.curPos + (self.scrollStep/4))
-				return True
-			return False
-
 	def Destroy(self):
 		self.middleBar = None
 		self.upButton = None
@@ -3629,15 +3254,6 @@
 	def GetScrollStep(self):
 		return self.scrollStep
 
-	def SetSpan(self, span):
-		self.scroll_span = span
-
-	def IncreaseSpan(self, span):
-		self.scroll_span += span
-
-	def GetSpan(self):
-		return self.scroll_span
-
 	def OnUp(self):
 		self.SetPos(self.curPos-self.scrollStep, self.eventFuncCall)
 		self.UpScrollButtonEvent()
@@ -3850,23 +3466,6 @@
 	def Disable(self):
 		self.cursor.Hide()
 
-	if app.ENABLE_FOV_OPTION:
-		def SetBackgroundVisual(self, filename):
-			if self.backGroundImage:
-				self.backGroundImage.LoadImage(filename)
-
-				self.SetSize(self.backGroundImage.GetWidth(), self.backGroundImage.GetHeight())
-				self.pageSize = self.backGroundImage.GetWidth() - self.cursor.GetWidth()
-
-			if self.cursor:
-				self.cursor.SetRestrictMovementArea(0, 0, self.backGroundImage.GetWidth(), 0)
-
-		def SetButtonVisual(self, path, up, over, down):
-			if self.cursor:
-				self.cursor.SetUpVisual(path + up)
-				self.cursor.SetOverVisual(path + over)
-				self.cursor.SetDownVisual(path + down)
-
 class ListBox(Window):
 
 	TEMPORARY_PLACE = 3
@@ -3881,7 +3480,6 @@
 		self.basePos = 0
 		self.showLineCount = 0
 		self.itemCenterAlign = True
-		self.itemIgnoreAlign = False
 		self.itemList = []
 		self.keyDict = {}
 		self.textDict = {}
@@ -3901,9 +3499,6 @@
 	def SetTextCenterAlign(self, flag):
 		self.itemCenterAlign = flag
 
-	def SetTextIgnoreAlign(self, flag):
-		self.itemIgnoreAlign = flag
-
 	def SetBasePos(self, pos):
 		self.basePos = pos
 		self._LocateItem()
@@ -3977,7 +3572,7 @@
 				skipCount -= 1
 				continue
 
-			if self.itemIgnoreAlign:
+			if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
 				textLine.SetPosition(0, yPos + 3)
 			else:
 				if localeInfo.IsARABIC():
@@ -4009,6 +3604,10 @@
 		if not self.keyDict.has_key(line):
 			return
 
+		if not app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+			if line == self.selectedLine:
+				return
+
 		self.selectedLine = line
 		self.event(self.keyDict.get(line, 0), self.textDict.get(line, "None"))
 
@@ -4024,6 +3623,7 @@
 			self.SelectItem(self.overLine+self.basePos)
 
 	def OnUpdate(self):
+
 		self.overLine = -1
 
 		if self.IsIn():
@@ -4043,7 +3643,7 @@
 		xRender, yRender = self.GetGlobalPosition()
 		yRender -= self.TEMPORARY_PLACE
 		widthRender = self.width
-		heightRender = self.height + self.TEMPORARY_PLACE * 2
+		heightRender = self.height + self.TEMPORARY_PLACE*2
 
 		if localeInfo.IsCIBN10:
 			if -1 != self.overLine and self.keyDict[self.overLine] != -1:
@@ -4067,6 +3667,8 @@
 						grp.SetColor(SELECT_COLOR)
 						grp.RenderBar(xRender + 2, yRender + (self.selectedLine-self.basePos)*self.stepSize + 4, self.width - 3, self.stepSize)
 
+
+
 class ListBox2(ListBox):
 	def __init__(self, *args, **kwargs):
 		ListBox.__init__(self, *args, **kwargs)
@@ -4155,176 +3757,164 @@
 		else:
 			self.barWidth = self.width
 
-class ComboBoxImage(Window):
-	class ListBoxWithBoard(ListBox):
-		def __init__(self, layer):
-			ListBox.__init__(self, layer)
-			self.SetTextIgnoreAlign(True)
+if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+	class ComboBoxImage(Window):
+		class ListBoxWithBoard(ListBox):
+			def __init__(self, layer):
+				ListBox.__init__(self, layer)
+
+			def OnRender(self):
+				xRender, yRender = self.GetGlobalPosition()
+				yRender -= self.TEMPORARY_PLACE
+				widthRender = self.width
+				heightRender = self.height + self.TEMPORARY_PLACE*2
+				grp.SetColor(BACKGROUND_COLOR)
+				grp.RenderBar(xRender, yRender, widthRender, heightRender)
+				grp.SetColor(DARK_COLOR)
+				grp.RenderLine(xRender, yRender, widthRender, 0)
+				grp.RenderLine(xRender, yRender, 0, heightRender)
+				ListBox.OnRender(self)
 
-		def OnRender(self):
-			xRender, yRender = self.GetGlobalPosition()
-			yRender -= self.TEMPORARY_PLACE
-
-			widthRender = self.width
-			heightRender = self.height + self.TEMPORARY_PLACE * 2
-
-			grp.SetColor(BACKGROUND_COLOR)
-			grp.RenderBar(xRender, yRender, widthRender, heightRender)
-			grp.SetColor(DARK_COLOR)
-			grp.RenderLine(xRender, yRender, widthRender, 0)
-			grp.RenderLine(xRender, yRender, 0, heightRender)
-
-			ListBox.OnRender(self)
-
-	def __init__(self, parent, name, x ,y):
-		Window.__init__(self)
-		self.isSelected = False
-		self.isOver = False
-		self.isListOpened = False
-		self.event = lambda *arg: None
-		self.enable = True
-		self.imagebox = None
-
-		## imagebox
-		image = ImageBox()
-		image.SetParent(parent)
-		image.LoadImage(name)
-		image.SetPosition(x, y)
-		image.Show()
-		self.imagebox = image
-
-		## BaseSetting
-		self.x = x + 1
-		self.y = y + 1
-		self.width = self.imagebox.GetWidth() - 3
-		self.height = self.imagebox.GetHeight() - 3
-		self.SetParent(parent)
-
-		## TextLine
-		self.textLine = MakeTextLine(self)
-		self.textLine.SetText(localeInfo.UI_ITEM)
-
-		## ListBox
-		self.listBox = self.ListBoxWithBoard("TOP_MOST")
-		self.listBox.SetPickAlways()
-		self.listBox.SetParent(self)
-		self.listBox.SetEvent(__mem_func__(self.OnSelectItem))
-		self.listBox.Hide()
-
-		Window.SetPosition(self, self.x, self.y)
-		Window.SetSize(self, self.width, self.height)
-		self.textLine.UpdateRect()
-		self.__ArrangeListBox()
-
-	def __del__(self):
-		Window.__del__(self)
-
-	def Destroy(self):
-		self.textLine = None
-		self.listBox = None
-		self.imagebox = None
+		def __init__(self, parent, name, x ,y):
+			Window.__init__(self)
+			self.isSelected = False
+			self.isOver = False
+			self.isListOpened = False
+			self.event = lambda *arg: None
+			self.enable = True
+			self.imagebox = None
+
+			## imagebox
+			image = ImageBox()
+			image.SetParent(parent)
+			image.LoadImage(name)
+			image.SetPosition(x, y)
+			image.Show()
+			self.imagebox = image
+
+			## BaseSetting
+			self.x = x + 1
+			self.y = y + 1
+			self.width = self.imagebox.GetWidth() - 3
+			self.height = self.imagebox.GetHeight() - 3
+			self.SetParent(parent)
+
+			## TextLine
+			self.textLine = MakeTextLine(self)
+			self.textLine.SetText(localeInfo.UI_ITEM)
+
+			## ListBox
+			self.listBox = self.ListBoxWithBoard("TOP_MOST")
+			self.listBox.SetPickAlways()
+			self.listBox.SetParent(self)
+			self.listBox.SetEvent(__mem_func__(self.OnSelectItem))
+			self.listBox.Hide()
+
+			Window.SetPosition(self, self.x, self.y)
+			Window.SetSize(self, self.width, self.height)
+			self.textLine.UpdateRect()
+			self.__ArrangeListBox()
 
-	def SetPosition(self, x, y):
-		Window.SetPosition(self, x, y)
-		self.imagebox.SetPosition(x, y)
-		self.x = x
-		self.y = y
-		self.__ArrangeListBox()
+		def __del__(self):
+			Window.__del__(self)
 
-	def SetSize(self, width, height):
-		Window.SetSize(self, width, height)
-		self.width = width
-		self.height = height
-		self.textLine.UpdateRect()
-		self.__ArrangeListBox()
+		def Destroy(self):
+			self.textLine = None
+			self.listBox = None
+			self.imagebox = None
+
+		def SetPosition(self, x, y):
+			Window.SetPosition(self, x, y)
+			self.imagebox.SetPosition(x, y)
+			self.x = x
+			self.y = y
+			self.__ArrangeListBox()
 
-	def __ArrangeListBox(self):
-		self.listBox.SetPosition(0, self.height + 5)
-		self.listBox.SetWidth(self.width)
+		def SetSize(self, width, height):
+			Window.SetSize(self, width, height)
+			self.width = width
+			self.height = height
+			self.textLine.UpdateRect()
+			self.__ArrangeListBox()
+
+		def __ArrangeListBox(self):
+			self.listBox.SetPosition(0, self.height + 5)
+			self.listBox.SetWidth(self.width)
+
+		def Enable(self):
+			self.enable = True
+
+		def Disable(self):
+			self.enable = False
+			self.textLine.SetText("")
+			self.CloseListBox()
 
-	def Enable(self):
-		self.enable = True
+		def SetEvent(self, event):
+			self.event = event
 
-	def Disable(self):
-		self.enable = False
-		self.textLine.SetText("")
-		self.CloseListBox()
+		def ClearItem(self):
+			self.CloseListBox()
+			self.listBox.ClearItem()
 
-	def SetEvent(self, event):
-		self.event = event
+		def InsertItem(self, index, name):
+			self.listBox.InsertItem(index, name)
+			self.listBox.ArrangeItem()
 
-	def ClearItem(self):
-		self.CloseListBox()
-		self.listBox.ClearItem()
+		def SetCurrentItem(self, text):
+			self.textLine.SetText(text)
 
-	def InsertItem(self, index, name):
-		self.listBox.InsertItem(index, name)
-		self.listBox.ArrangeItem()
+		def SelectItem(self, key):
+			self.listBox.SelectItem(key)
 
-	def SetCurrentItem(self, text):
-		self.textLine.SetText(text)
+		def OnSelectItem(self, index, name):
+			self.CloseListBox()
+			self.event(index)
 
-	def SelectItem(self, key):
-		self.listBox.SelectItem(key)
+		def CloseListBox(self):
+			self.isListOpened = False
+			self.listBox.Hide()
 
-	def OnSelectItem(self, index, name):
-		self.CloseListBox()
-		self.event(index)
+		def OnMouseLeftButtonDown(self):
+			if not self.enable:
+				return
 
-	def CloseListBox(self):
-		self.isListOpened = False
-		self.listBox.Hide()
+			self.isSelected = True
 
-	def OnMouseLeftButtonDown(self):
-		if not self.enable:
-			return
+		def OnMouseLeftButtonUp(self):
+			if not self.enable:
+				return
 
-		self.isSelected = True
+			self.isSelected = False
 
-	def OnMouseLeftButtonUp(self):
-		self.ToggleOpenCloseListBox()
+			if self.isListOpened:
+				self.CloseListBox()
+			else:
+				if self.listBox.GetItemCount() > 0:
+					self.isListOpened = True
+					self.listBox.Show()
+					self.__ArrangeListBox()
 
-	def OnUpdate(self):
-		if not self.enable:
-			return
+		def OnUpdate(self):
+			if not self.enable:
+				return
 
-		if self.IsIn():
-			self.isOver = True
-		else:
-			self.isOver = False
+			if self.IsIn():
+				self.isOver = True
+			else:
+				self.isOver = False
 
-	def OnRender(self):
-		self.x, self.y = self.GetGlobalPosition()
-		xRender = self.x
-		yRender = self.y
-		widthRender = self.width
-		heightRender = self.height
-		if self.isOver:
-			grp.SetColor(HALF_WHITE_COLOR)
-			grp.RenderBar(xRender + 2, yRender + 3, self.width - 3, heightRender - 5)
-			if self.isSelected:
-				grp.SetColor(WHITE_COLOR)
+		def OnRender(self):
+			self.x, self.y = self.GetGlobalPosition()
+			xRender = self.x
+			yRender = self.y
+			widthRender = self.width
+			heightRender = self.height
+			if self.isOver:
+				grp.SetColor(HALF_WHITE_COLOR)
 				grp.RenderBar(xRender + 2, yRender + 3, self.width - 3, heightRender - 5)
-
-	def OpenListBox(self):
-		self.isListOpened = True
-		self.listBox.Show()
-
-		self.__ArrangeListBox()
-
-	def ToggleOpenCloseListBox(self):
-		if not self.enable:
-			return
-
-		self.isSelected = False
-
-		if self.isListOpened:
-			self.CloseListBox()
-		else:
-			if self.listBox.GetItemCount() > 0:
-				self.isListOpened = True
-				self.listBox.Show()
-				self.__ArrangeListBox()
+				if self.isSelected:
+					grp.SetColor(WHITE_COLOR)
+					grp.RenderBar(xRender + 2, yRender + 3, self.width - 3, heightRender - 5)
 
 class ComboBox(Window):
 
@@ -4420,6 +4010,7 @@
 		self.listBox.SelectItem(key)
 
 	def OnSelectItem(self, index, name):
+
 		self.CloseListBox()
 		self.event(index)
 
@@ -4479,23 +4070,6 @@
 				grp.SetColor(WHITE_COLOR)
 				grp.RenderBar(xRender + 2, yRender + 3, self.width - 3, heightRender - 5)
 
-class RenderTarget(Window):
-
-	def __init__(self, layer = "UI"):
-		Window.__init__(self, layer)
-		
-		self.number = -1
-
-	def __del__(self):
-		Window.__del__(self)
-
-	def RegisterWindow(self, layer):
-		self.hWnd = wndMgr.RegisterRenderTarget(self, layer)
-		
-	def SetRenderTarget(self, number):
-		self.number = number
-		wndMgr.SetRenderTarget(self.hWnd, self.number)
-
 ###################################################################################################
 ## Python Script Loader
 ###################################################################################################
@@ -4505,26 +4079,24 @@
 		Window.__init__(self, layer)
 		self.Children = []
 		self.ElementDictionary = {}
-
 	def __del__(self):
 		Window.__del__(self)
 
 	def ClearDictionary(self):
 		self.Children = []
 		self.ElementDictionary = {}
-
 	def InsertChild(self, name, child):
 		self.ElementDictionary[name] = child
 
 	def IsChild(self, name):
 		return self.ElementDictionary.has_key(name)
-
 	def GetChild(self, name):
 		return self.ElementDictionary[name]
 
 	def GetChild2(self, name):
 		return self.ElementDictionary.get(name, None)
 
+
 class PythonScriptLoader(object):
 
 	BODY_KEY_LIST = ( "x", "y", "width", "height" )
@@ -4552,10 +4124,13 @@
 	GAUGE_KEY_LIST = ( "width", "color", )
 	SCROLLBAR_KEY_LIST = ( "size", )
 	LIST_BOX_KEY_LIST = ( "width", "height", )
-	OUTLINE_WINDOW_KEY_LIST = ( "width", "height", )
 
-	if app.RENDER_TARGET:
-		RENDER_TARGET_KEY_LIST = ( "index", )
+	# app.ENABLE_MONSTER_CARD or app.ENABLE_MYSHOP_DECO or app.ENABLE_MINI_GAME_YUTNORI
+	RENDER_TARGET_KEY_LIST = ( "index", )
+
+	if app.ENABLE_QUEST_RENEWAL:
+		SUB_TITLE_BAR_KEY_LIST = ( "width", )
+		LIST_BAR_KEY_LIST = ( "width", )
 
 	# app.ENABLE_FISH_EVENT
 	SP_GRID_TABLE_KEY_LIST = ( "start_index", "x_count", "y_count", "x_step", "y_step", )
@@ -4563,8 +4138,6 @@
 	if app.ENABLE_MAILBOX:
 		RENDER_BOX_KEY_LIST = ( "color", )
 
-	CIRCLE_KEY_LIST = ( "radius", "color", )
-
 	def __init__(self):
 		self.Clear()
 
@@ -4592,8 +4165,7 @@
 		import player
 		import app
 		self.ScriptDictionary["PLAYER_NAME_MAX_LEN"] = chr.PLAYER_NAME_MAX_LEN
-		if app.ENABLE_DRAGON_SOUL_SYSTEM:
-			self.ScriptDictionary["DRAGON_SOUL_EQUIPMENT_SLOT_START"] = player.DRAGON_SOUL_EQUIPMENT_SLOT_START
+		self.ScriptDictionary["DRAGON_SOUL_EQUIPMENT_SLOT_START"] = player.DRAGON_SOUL_EQUIPMENT_SLOT_START
 		self.ScriptDictionary["LOCALE_PATH"] = app.GetLocalePath()
 
 		try:
@@ -4680,11 +4252,6 @@
 				parent.Children[Index].SetParent(parent)
 				self.LoadElementWindow(parent.Children[Index], ElementValue, parent)
 
-			elif Type == "outline_window":
-				parent.Children[Index] = OutlineWindow()
-				parent.Children[Index].SetParent(parent)
-				self.LoadOutlineWindow(parent.Children[Index], ElementValue, parent)
-
 			elif Type == "button":
 				parent.Children[Index] = Button()
 				parent.Children[Index].SetParent(parent)
@@ -4760,21 +4327,11 @@
 				parent.Children[Index].SetParent(parent)
 				self.LoadElementBoard(parent.Children[Index], ElementValue, parent)
 
-			elif Type == "middleboard":
-				parent.Children[Index] = MiddleBoard()
-				parent.Children[Index].SetParent(parent)
-				self.LoadElementBoard(parent.Children[Index], ElementValue, parent)
-
 			elif Type == "board_with_titlebar":
 				parent.Children[Index] = BoardWithTitleBar()
 				parent.Children[Index].SetParent(parent)
 				self.LoadElementBoardWithTitleBar(parent.Children[Index], ElementValue, parent)
 
-			elif Type == "border_a":
-				parent.Children[Index] = BorderA()
-				parent.Children[Index].SetParent(parent)
-				self.LoadElementBorderA(parent.Children[Index], ElementValue, parent)
-
 			elif Type == "thinboard":
 				parent.Children[Index] = ThinBoard()
 				parent.Children[Index].SetParent(parent)
@@ -4855,7 +4412,8 @@
 				parent.Children[Index].SetParent(parent)
 				self.LoadElementNumberLine(parent.Children[Index], ElementValue, parent)
 
-			elif app.RENDER_TARGET and Type == "render_target":
+			# app.ENABLE_MONSTER_CARD or app.ENABLE_MYSHOP_DECO or app.ENABLE_MINI_GAME_YUTNORI
+			elif Type == "render_target":
 				parent.Children[Index] = RenderTarget()
 				parent.Children[Index].SetParent(parent)
 				self.LoadElementRenderTarget(parent.Children[Index], ElementValue, parent)
@@ -4865,22 +4423,22 @@
 				parent.Children[Index].SetParent(parent)
 				self.LoadElementThinBoard(parent.Children[Index], ElementValue, parent)
 
+			elif Type == "subtitlebar" and app.ENABLE_QUEST_RENEWAL:
+				parent.Children[Index] = SubTitleBar()
+				parent.Children[Index].SetParent(parent)
+				self.LoadElementSubTitleBar(parent.Children[Index], ElementValue, parent)
+
+			elif Type == "listbar" and app.ENABLE_QUEST_RENEWAL:
+				parent.Children[Index] = ListBar()
+				parent.Children[Index].SetParent(parent)
+				self.LoadElementListBar(parent.Children[Index], ElementValue, parent)
+
 			elif Type == "renderbox":
 				if app.ENABLE_MAILBOX:
 					parent.Children[Index] = RenderBox()
 					parent.Children[Index].SetParent(parent)
 					self.LoadElementRenderBox(parent.Children[Index], ElementValue, parent)
 
-			elif Type == "circle":
-				parent.Children[Index] = Circle()
-				parent.Children[Index].SetParent(parent)
-				self.LoadElementCircle(parent.Children[Index], ElementValue, parent)
-
-			elif Type == "render_target":
-				parent.Children[Index] = RenderTarget()
-				parent.Children[Index].SetParent(parent)
-				self.LoadElementRenderTarget(parent.Children[Index], ElementValue, parent)
-
 			else:
 				Index += 1
 				continue
@@ -4896,7 +4454,7 @@
 
 		for DataKey in key_list:
 			if False == value.has_key(DataKey):
-				print("Failed to find data key", "[" + name + "/" + DataKey + "]")
+				print "Failed to find data key", "[" + name + "/" + DataKey + "]"
 				return False
 
 		return True
@@ -4948,17 +4506,6 @@
 
 		return True
 
-	## Outline Window
-	def LoadOutlineWindow(self, window, value, parentWindow):
-
-		if False == self.CheckKeyList(value["name"], value, self.OUTLINE_WINDOW_KEY_LIST):
-			return False
-
-		window.MakeOutlineWindow(int(value["width"]), int(value["height"]))
-		self.LoadDefaultData(window, value, parentWindow)
-
-		return True
-
 	## Button
 	def LoadElementButton(self, window, value, parentWindow):
 		if value.has_key("width") and value.has_key("height"):
@@ -5020,10 +4567,6 @@
 
 		window.LoadImage(value["image"])
 
-		if value.has_key("arabic_reverse"):
-			if value["arabic_reverse"]:
-				window.LeftRightReverse()
-
 		self.LoadDefaultData(window, value, parentWindow)
 
 		return True
@@ -5036,7 +4579,7 @@
 		if True == value.has_key("delay"):
 			window.SetDelay(value["delay"])
 
-		if app.ENABLE_GROWTH_PET_SYSTEM:
+		if app.ENABLE_IMAGE_SCALE:
 			if True == value.has_key("x_scale") and True == value.has_key("y_scale"):
 				for image in value["images"]:
 					window.AppendImageScale(image, float(value["x_scale"]), float(value["y_scale"]))
@@ -5050,9 +4593,8 @@
 		if value.has_key("width") and value.has_key("height"):
 			window.SetSize(value["width"], value["height"])
 
-		if app.ENABLE_GROWTH_PET_SYSTEM:
-			if True == value.has_key("x_scale") and True == value.has_key("y_scale"):
-				window.SetScale(float(value["x_scale"]), float(value["y_scale"]))
+		if True == value.has_key("x_scale") and True == value.has_key("y_scale"):
+			window.SetScale(float(value["x_scale"]), float(value["y_scale"]))
 
 		self.LoadDefaultData(window, value, parentWindow)
 
@@ -5123,18 +4665,23 @@
 									int(slot["width"]),
 									int(slot["height"]))
 
-		if app.ENABLE_GROWTH_PET_SYSTEM:
-			if True == value.has_key("x_scale") and True == value.has_key("y_scale"):
-				window.SetSlotScale(float(value["x_scale"]), float(value["y_scale"]))
-
-		if app.ENABLE_SLOT_SCALE:
-			if True == value.has_key("x_scale") and True == value.has_key("y_scale"):
-				window.SetSlotScale(float(value["x_scale"]), float(value["y_scale"]))
+		if True == value.has_key("x_scale") and True == value.has_key("y_scale"):
+			window.SetSlotScale(float(value["x_scale"]), float(value["y_scale"]))
 
 		if True == value.has_key("image"):
-			wndMgr.SetSlotBaseImage(window.hWnd,
-									value["image"],
-									r, g, b, a)
+			if app.ENABLE_IMAGE_SCALE:
+				if True == value.has_key("x_scale") and TRUE == value.has_key("y_scale"):
+					wndMgr.SetSlotBaseImageScale(window.hWnd,
+											value["image"],
+											r, g, b, a, float(value["x_scale"]), float(value["y_scale"]))
+				else:
+					wndMgr.SetSlotBaseImage(window.hWnd,
+											value["image"],
+											r, g, b, a)
+			else:
+				wndMgr.SetSlotBaseImage(window.hWnd,
+										value["image"],
+										r, g, b, a)
 
 		return True
 
@@ -5311,6 +4858,10 @@
 		if False == self.CheckKeyList(value["name"], value, self.BOARD_KEY_LIST):
 			return False
 
+		if app.ENABLE_IMAGE_CLIP_RECT:
+			if True == value.has_key("size_skip"):
+				window.skipMaxCheck = True
+
 		window.SetSize(int(value["width"]), int(value["height"]))
 		self.LoadDefaultData(window, value, parentWindow)
 
@@ -5328,8 +4879,8 @@
 
 		return True
 
-	## BorderA
-	def LoadElementBorderA(self, window, value, parentWindow):
+	## ThinBoard
+	def LoadElementThinBoard(self, window, value, parentWindow):
 
 		if False == self.CheckKeyList(value["name"], value, self.BOARD_KEY_LIST):
 			return False
@@ -5339,16 +4890,26 @@
 
 		return True
 
-	## ThinBoard
-	def LoadElementThinBoard(self, window, value, parentWindow):
+	if app.ENABLE_QUEST_RENEWAL:
+		## SubTitleBar
+		def LoadElementSubTitleBar(self, window, value, parentWindow):
+			if False == self.CheckKeyList(value["name"], value, self.SUB_TITLE_BAR_KEY_LIST):
+				return False
 
-		if False == self.CheckKeyList(value["name"], value, self.BOARD_KEY_LIST):
-			return False
+			window.MakeSubTitleBar(int(value["width"]), value.get("color", "red"))
+			self.LoadElementButton(window, value, parentWindow)
+			window.Show()
+			return True
 
-		window.SetSize(int(value["width"]), int(value["height"]))
-		self.LoadDefaultData(window, value, parentWindow)
+		## ListBar
+		def LoadElementListBar(self, window, value, parentWindow):
+			if False == self.CheckKeyList(value["name"], value, self.LIST_BAR_KEY_LIST):
+				return False
 
-		return True
+			window.MakeListBar(int(value["width"]), value.get("color", "red"))
+			self.LoadElementButton(window, value, parentWindow)
+
+			return True
 
 	## Box
 	def LoadElementBox(self, window, value, parentWindow):
@@ -5484,23 +5045,23 @@
 		self.LoadDefaultData(window, value, parentWindow)
 		return True
 
-	if app.RENDER_TARGET:
-		def LoadElementRenderTarget(self, window, value, parentWindow):
-			if False == self.CheckKeyList(value["name"], value, self.RENDER_TARGET_KEY_LIST):
-				return False
+	# app.ENABLE_MONSTER_CARD or app.ENABLE_MYSHOP_DECO or app.ENABLE_MINI_GAME_YUTNORI
+	def LoadElementRenderTarget(self, window, value, parentWindow):
+		if False == self.CheckKeyList(value["name"], value, self.RENDER_TARGET_KEY_LIST):
+			return False
 
-			window.SetSize(value["width"], value["height"])
+		window.SetSize(value["width"], value["height"])
 
-			if True == value.has_key("style"):
-				for style in value["style"]:
-					window.AddFlag(style)
+		if True == value.has_key("style"):
+			for style in value["style"]:
+				window.AddFlag(style)
 
-			self.LoadDefaultData(window, value, parentWindow)
+		self.LoadDefaultData(window, value, parentWindow)
 
-			if value.has_key("index"):
-				window.SetRenderTarget(int(value["index"]))
+		if value.has_key("index"):
+			window.SetRenderTarget(int(value["index"]))
 
-			return True
+		return True
 
 	if app.ENABLE_MAILBOX:
 		def LoadElementRenderBox(self, window, value, parentWindow):
@@ -5515,18 +5076,6 @@
 
 			return True
 
-	def LoadElementCircle(self, window, value, parentWindow):
-		if False == self.CheckKeyList(value["name"], value, self.CIRCLE_KEY_LIST):
-			return False
-
-		window.SetSize(value["width"], value["height"])
-		self.LoadDefaultData(window, value, parentWindow)
-
-		if value.has_key("color"):
-			window.SetColor(value["color"])
-
-		return True
-
 class ReadingWnd(Bar):
 	def __init__(self):
 		Bar.__init__(self,"TOP_MOST")
@@ -5549,12 +5098,94 @@
 
 	def SetReadingPosition(self, x, y):
 		xPos = x + 2
-		yPos = y - self.GetHeight() - 2
+		yPos = y  - self.GetHeight() - 2
 		self.SetPosition(xPos, yPos)
 
 	def SetTextColor(self, color):
 		self.text.SetPackedFontColor(color)
 
+if app.ENABLE_AUTO_REFINE or app.ENABLE_SKILL_COLOR_SYSTEM:
+	class CheckBox(Window):
+		def __init__(self):
+			Window.__init__(self)
+
+			self.backgroundImage = None
+			self.checkImage = None
+
+			self.eventFunc = { "ON_CHECK" : None, "ON_UNCKECK" : None, }
+			self.eventArgs = { "ON_CHECK" : None, "ON_UNCKECK" : None, }
+
+			self.CreateElements()
+
+		def __del__(self):
+			Window.__del__(self)
+
+			self.backgroundImage = None
+			self.checkImage = None
+
+			self.eventFunc = { "ON_CHECK" : None, "ON_UNCKECK" : None, }
+			self.eventArgs = { "ON_CHECK" : None, "ON_UNCKECK" : None, }
+
+		def CreateElements(self):
+			self.backgroundImage = ImageBox()
+			self.backgroundImage.SetParent(self)
+			self.backgroundImage.AddFlag("not_pick")
+			self.backgroundImage.LoadImage("d:/ymir work/ui/game/refine/checkbox.tga")
+			self.backgroundImage.Show()
+
+			self.checkImage = ImageBox()
+			self.checkImage.SetParent(self)
+			self.checkImage.AddFlag("not_pick")
+			self.checkImage.SetPosition(0, -4)
+			self.checkImage.LoadImage("d:/ymir work/ui/game/refine/checked.tga")
+			self.checkImage.Hide()
+
+			self.textInfo = TextLine()
+			self.textInfo.SetParent(self)
+			self.textInfo.SetPosition(20, -2)
+			self.textInfo.Show()
+
+			self.SetSize(self.backgroundImage.GetWidth() + self.textInfo.GetTextSize()[0], self.backgroundImage.GetHeight() + self.textInfo.GetTextSize()[1])
+
+		def SetTextInfo(self, info):
+			if self.textInfo:
+				self.textInfo.SetText(info)
+
+			self.SetSize(self.backgroundImage.GetWidth() + self.textInfo.GetTextSize()[0], self.backgroundImage.GetHeight() + self.textInfo.GetTextSize()[1])
+
+		def SetCheckStatus(self, flag):
+			if flag:
+				self.checkImage.Show()
+			else:
+				self.checkImage.Hide()
+
+		def GetCheckStatus(self):
+			if self.checkImage:
+				return self.checkImage.IsShow()
+
+			return False
+
+		def SetEvent(self, func, *args) :
+			result = self.eventFunc.has_key(args[0])
+			if result:
+				self.eventFunc[args[0]] = func
+				self.eventArgs[args[0]] = args
+			else:
+				print "[ERROR] ui.py SetEvent, Can`t Find has_key : %s" % args[0]
+
+		def OnMouseLeftButtonUp(self):
+			if self.checkImage:
+				if self.checkImage.IsShow():
+					self.checkImage.Hide()
+
+					if self.eventFunc["ON_UNCKECK"]:
+						apply(self.eventFunc["ON_UNCKECK"], self.eventArgs["ON_UNCKECK"])
+				else:
+					self.checkImage.Show()
+
+					if self.eventFunc["ON_CHECK"]:
+						apply(self.eventFunc["ON_CHECK"], self.eventArgs["ON_CHECK"])
+
 def MakeSlotBar(parent, x, y, width, height):
 	slotBar = SlotBar()
 	slotBar.SetParent(parent)
@@ -5583,42 +5214,6 @@
 	textLine.Show()
 	return textLine
 
-def AddTextLine(parent, x, y, text, outline = 0):
-	textLine = TextLine()
-	textLine.SetParent(parent)
-	textLine.SetPosition(x, y)
-	if outline != 0:
-		textLine.SetOutline()
-	textLine.SetText(text)
-	textLine.Show()
-	return textLine
-
-def MakeNewTextLine(parent, horizontalAlign = True, verticalAlgin = True, x = 0, y = 0):
-	textLine = TextLine()
-	textLine.SetParent(parent)
-	if horizontalAlign == True:
-		textLine.SetWindowHorizontalAlignCenter()
-	if verticalAlgin == True:
-		textLine.SetWindowVerticalAlignCenter()
-	textLine.SetHorizontalAlignCenter()
-	textLine.SetVerticalAlignCenter()
-	if app.WJ_MULTI_TEXTLINE:
-		textLine.DisableEnterToken()
-	if x != 0 and y != 0:
-		textLine.SetPosition(x, y)
-	textLine.Show()
-	return textLine
-
-def MakeExpandedImageBox(parent, name, x, y, flag = ""):
-	image = ExpandedImageBox()
-	image.SetParent(parent)
-	image.LoadImage(name)
-	image.SetPosition(x, y)
-	if flag != "":
-		image.AddFlag(flag)
-	image.Show()
-	return image
-
 def MakeButton(parent, x, y, tooltipText, path, up, over, down):
 	button = Button()
 	button.SetParent(parent)
@@ -5655,22 +5250,21 @@
 
 RegisterToolTipWindow("TEXT", TextLine)
 
-if app.RENDER_TARGET:
-	class RenderTarget(Window):
-		def __init__(self, layer = "UI"):
-			Window.__init__(self, layer)
+class RenderTarget(Window):
+	def __init__(self, layer = "UI"):
+		Window.__init__(self, layer)
 
-			self.number = -1
+		self.number = -1
 
-		def __del__(self):
-			Window.__del__(self)
+	def __del__(self):
+		Window.__del__(self)
 
-		def RegisterWindow(self, layer):
-			self.hWnd = wndMgr.RegisterRenderTarget(self, layer)
+	def RegisterWindow(self, layer):
+		self.hWnd = wndMgr.RegisterRenderTarget(self, layer)
 
-		def SetRenderTarget(self, number):
-			self.number = number
-			wndMgr.SetRenderTarget(self.hWnd, self.number)
+	def SetRenderTarget(self, number):
+		self.number = number
+		wndMgr.SetRenderTarget(self.hWnd, self.number)
 
 if app.ENABLE_MAILBOX:
 	class RenderBox(Window):
@@ -5692,200 +5286,3 @@
 			(x, y, width, height) = self.GetRect()
 			grp.SetColor(self.color)
 			grp.RenderBar(x, y, width, height)
-
-class Circle(Window):
-	def __init__(self):
-		Window.__init__(self)
-		self.color = 0xFF000000
-
-	def __del__(self):
-		Window.__del__(self)
-
-	def RegisterWindow(self, layer):
-		self.hWnd = wndMgr.RegisterCircle(self, layer)
-
-	def SetColor(self, color):
-		self.color = color
-		wndMgr.SetColor(self.hWnd, self.color)
-
-class OutlineWindow(Window):
-	PATTERN_PATH = "d:/ymir work/ui/pattern/"
-
-	def __init__(self, layer = "UI"):
-		Window.__init__(self, layer)
-		self.__Initialize()
-
-	def __del__(self):
-		Window.__del__(self)
-		self.__Initialize()
-
-	def __Initialize(self):
-		self.pattern_x_count = 0
-		self.pattern_y_count = 0
-		self.left_top_img = None
-		self.right_top_img = None
-		self.left_bottom_img = None
-		self.right_bottom_img = None
-		self.top_center_img = None
-		self.left_center_img = None
-		self.right_center_img = None
-		self.bottom_center_img = None
-		self.center_img = None
-
-	def MakeOutlineWindow(self, window_width, window_height):
-		self.AddFlag("ltr")
-		self.AddFlag("attach")
-		self.SetWindowName("outline_window")
-		self.SetSize(window_width, window_height)
-
-		self.pattern_x_count = (window_width - 32) / 16
-		self.pattern_y_count = (window_height - 32) / 16
-
-		self.left_top_img = ImageBox()
-		self.left_top_img.SetParent(self)
-		self.left_top_img.LoadImage(OutlineWindow.PATTERN_PATH + "border_A_left_top.tga")
-		self.left_top_img.SetPosition(0, 0)
-		self.left_top_img.Show()
-
-		self.right_top_img = ImageBox()
-		self.right_top_img.SetParent(self)
-		self.right_top_img.LoadImage(OutlineWindow.PATTERN_PATH + "border_A_right_top.tga")
-		self.right_top_img.SetPosition(window_width - 16, 0)
-		self.right_top_img.Show()
-
-		self.left_bottom_img = ImageBox()
-		self.left_bottom_img.SetParent(self)
-		self.left_bottom_img.LoadImage(OutlineWindow.PATTERN_PATH + "border_A_left_bottom.tga")
-		self.left_bottom_img.SetPosition(0, window_height - 16)
-		self.left_bottom_img.Show()
-
-		self.right_bottom_img = ImageBox()
-		self.right_bottom_img.SetParent(self)
-		self.right_bottom_img.LoadImage(OutlineWindow.PATTERN_PATH + "border_A_right_bottom.tga")
-		self.right_bottom_img.SetPosition(window_width - 16, window_height - 16)
-		self.right_bottom_img.Show()
-
-		self.top_center_img = ExpandedImageBox()
-		self.top_center_img.SetParent(self)
-		self.top_center_img.LoadImage(OutlineWindow.PATTERN_PATH + "border_A_top.tga")
-		self.top_center_img.SetPosition(16, 0)
-		self.top_center_img.SetRenderingRect(0.0, 0.0, self.pattern_x_count, 0.0)
-		self.top_center_img.Show()
-
-		self.left_center_img = ExpandedImageBox()
-		self.left_center_img.SetParent(self)
-		self.left_center_img.LoadImage(OutlineWindow.PATTERN_PATH + "border_A_left.tga")
-		self.left_center_img.SetPosition(0, 16)
-		self.left_center_img.SetRenderingRect(0.0, 0.0, 0.0, self.pattern_y_count)
-		self.left_center_img.Show()
-
-		self.right_center_img = ExpandedImageBox()
-		self.right_center_img.SetParent(self)
-		self.right_center_img.LoadImage(OutlineWindow.PATTERN_PATH + "border_A_right.tga")
-		self.right_center_img.SetPosition(window_width - 16, 16)
-		self.right_center_img.SetRenderingRect(0.0, 0.0, 0.0, self.pattern_y_count)
-		self.right_center_img.Show()
-
-		self.bottom_center_img = ExpandedImageBox()
-		self.bottom_center_img.SetParent(self)
-		self.bottom_center_img.LoadImage(OutlineWindow.PATTERN_PATH + "border_A_bottom.tga")
-		self.bottom_center_img.SetPosition(16, window_height - 16)
-		self.bottom_center_img.SetRenderingRect(0.0, 0.0, self.pattern_x_count, 0.0)
-		self.bottom_center_img.Show()
-
-		self.center_img = ExpandedImageBox()
-		self.center_img.SetParent(self)
-		self.center_img.LoadImage(OutlineWindow.PATTERN_PATH + "border_A_center.tga")
-		self.center_img.SetPosition(16, 16)
-		self.center_img.SetRenderingRect(0.0, 0.0, self.pattern_x_count, self.pattern_y_count)
-		self.center_img.Show()
-
-if app.ENABLE_SEND_TARGET_INFO:
-	class CheckBox(Window):
-		def __init__(self):
-			Window.__init__(self)
-
-			self.checkbox_image = None
-			self.check_image = None
-			self.text_line = None
-			self.check = False
-
-			self.event_func = { "check" : None, "uncheck" : None, }
-			self.event_args = { "check" : None, "uncheck" : None, }
-
-			self.__BuildCheckBox()
-
-		def __del__(self):
-			Window.__del__(self)
-
-			self.checkbox_image = None
-			self.check_image = None
-			self.text_line = None
-			self.check = False
-
-			self.event_func = { "check" : None, "uncheck" : None, }
-			self.event_args = { "check" : None, "uncheck" : None, }
-
-		def __BuildCheckBox(self):
-			checkbox_image = ImageBox()
-			checkbox_image.SetParent(self)
-			checkbox_image.AddFlag("not_pick")
-			checkbox_image.LoadImage("d:/ymir work/ui/game/quest/quest_checkbox.tga")
-			checkbox_image.Show()
-			self.checkbox_image = checkbox_image
-
-			check_image = ImageBox()
-			check_image.SetParent(self)
-			check_image.AddFlag("not_pick")
-			check_image.SetPosition(0, -4)
-			check_image.LoadImage("d:/ymir work/ui/game/quest/quest_checked.tga")
-			check_image.Hide()
-			self.check_image = check_image
-
-			text_line = TextLine()
-			text_line.SetParent(self)
-			text_line.SetPosition(17, -2)
-			text_line.Show()
-			self.text_line = text_line
-
-			self.SetSize(self.checkbox_image.GetWidth() + self.text_line.GetTextSize()[0], self.checkbox_image.GetHeight() + self.text_line.GetTextSize()[1])
-
-		def SetText(self, text, color = 0):
-			if self.text_line:
-				self.text_line.SetText(text)
-				if color:
-					self.text_line.SetPackedFontColor(color)
-
-			self.SetSize(self.checkbox_image.GetWidth() + self.text_line.GetTextSize()[0], self.checkbox_image.GetHeight() + self.text_line.GetTextSize()[1])
-
-		def SetCheckBox(self, check):
-			self.check = check
-			if check:
-				self.check_image.Show()
-			else:
-				self.check_image.Hide()
-
-		def IsChecked(self):
-			return self.check
-
-		def SetEvent(self, func, *args):
-			result = self.event_func.has_key(args[0])
-			if result:
-				self.event_func[args[0]] = func
-				self.event_args[args[0]] = args
-			else:
-				print("[ERROR] ui.py SetEvent, Can`t Find has_key : %s" % args[0])
-
-		def OnMouseLeftButtonUp(self):
-			if self.check != True:
-				self.check = True
-				self.check_image.Show()
-
-				if self.event_func["check"]:
-					apply(self.event_func["check"], self.event_args["check"])
-			else:
-				self.check = False
-				self.check_image.Hide()
-
-				if self.event_func["uncheck"]:
-					apply(self.event_func["uncheck"], self.event_args["uncheck"])
diff -ruN client_base/client/client/pack/root/uiaffectshower.py client_final/client/client/pack/root/uiaffectshower.py
--- client_base/client/client/pack/root/uiaffectshower.py	2026-02-13 09:22:34.000000000 +0000
+++ client_final/client/client/pack/root/uiaffectshower.py	2026-02-20 18:13:16.384204995 +0000
@@ -7,12 +7,7 @@
 import player
 import uiToolTip
 import math
-
-if app.ENABLE_SET_ITEM:
-	import uiToolTip
-
-AFFECT_TOOLTIP_POS_X = 0
-AFFECT_TOOLTIP_POS_Y = 40
+import osfInfo
 
 # WEDDING
 class LovePointImage(ui.ExpandedImageBox):
@@ -225,6 +220,83 @@
 
 		self.toolTip.HideToolTip()
 
+# AUTO_POTION
+class AutoPotionImage(ui.ExpandedImageBox):
+
+	FILE_PATH_HP = "d:/ymir work/ui/pattern/auto_hpgauge/"
+	FILE_PATH_SP = "d:/ymir work/ui/pattern/auto_spgauge/"
+
+	def __init__(self):
+		ui.ExpandedImageBox.__init__(self)
+
+		self.loverName = ""
+		self.lovePoint = 0
+		self.potionType = player.AUTO_POTION_TYPE_HP
+		self.filePath = ""
+
+		self.toolTip = uiToolTip.ToolTip(100)
+		self.toolTip.HideToolTip()
+
+	def __del__(self):
+		ui.ExpandedImageBox.__del__(self)
+
+	def SetPotionType(self, type):
+		self.potionType = type
+
+		if player.AUTO_POTION_TYPE_HP == type:
+			self.filePath = self.FILE_PATH_HP
+		elif player.AUTO_POTION_TYPE_SP == type:
+			self.filePath = self.FILE_PATH_SP
+
+	def OnUpdateAutoPotionImage(self):
+		self.__Refresh()
+
+	def __Refresh(self):
+		print "__Refresh"
+
+		isActivated, currentAmount, totalAmount, slotIndex = player.GetAutoPotionInfo(self.potionType)
+
+		amountPercent = (float(currentAmount) / totalAmount) * 100.0
+		grade = math.ceil(amountPercent / 20)
+
+		if 5.0 > amountPercent:
+			grade = 0
+
+		if 80.0 < amountPercent:
+			grade = 4
+			if 90.0 < amountPercent:
+				grade = 5
+
+		fmt = self.filePath + "%.2d.dds"
+		fileName = fmt % grade
+
+		print self.potionType, amountPercent, fileName
+
+		try:
+			self.LoadImage(fileName)
+		except:
+			import dbg
+			dbg.TraceError("AutoPotionImage.__Refresh(potionType=%d) - LoadError %s" % (self.potionType, fileName))
+
+		self.SetScale(0.7, 0.7)
+
+		self.toolTip.ClearToolTip()
+
+		if player.AUTO_POTION_TYPE_HP == type:
+			self.toolTip.SetTitle(localeInfo.TOOLTIP_AUTO_POTION_HP)
+		else:
+			self.toolTip.SetTitle(localeInfo.TOOLTIP_AUTO_POTION_SP)
+
+		self.toolTip.AppendTextLine(localeInfo.TOOLTIP_AUTO_POTION_REST % (amountPercent))
+		self.toolTip.ResizeToolTip()
+
+	def OnMouseOverIn(self):
+		self.toolTip.ShowToolTip()
+
+	def OnMouseOverOut(self):
+		self.toolTip.HideToolTip()
+# END_OF_AUTO_POTION
+
 if app.ENABLE_GROWTH_PET_SYSTEM:
 	class GrowthPetImage(ui.ExpandedImageBox):
 
@@ -232,7 +304,7 @@
 			ui.ExpandedImageBox.__init__(self)
 		
 			self.toolTipText = None
-			self.description = None
+			self.description = None			
 
 		def __del__(self):
 			ui.ExpandedImageBox.__del__(self)
@@ -269,37 +341,12 @@
 	def __init__(self):
 		ui.ExpandedImageBox.__init__(self)
 
-		if app.ENABLE_AFFECT_RENEWAL:
-			self.tool_tip = uiToolTip.ToolTip(100)
-			self.tool_tip.HideToolTip()
-			self.tool_tip_text = ""
-		else:
-			self.toolTipText = None
-
-		self.isSkillAffect = True
+		self.toolTipText = None
+		self.isSkillAffect = TRUE
 		self.description = None
 		self.endTime = 0
 		self.affect = None
-		self.isClocked = True
-
-		if app.ENABLE_SET_ITEM:
-			self.tooltipItem = uiToolTip.ItemToolTip()
-			self.tooltipItem.Hide()
-
-		if app.ENABLE_SET_ITEM or app.ENABLE_SNOWFLAKE_STICK_EVENT:
-			self.affect_dict = {}
-
-	if app.ENABLE_SET_ITEM or app.ENABLE_AFFECT_RENEWAL:
-		def __del__(self):
-			ui.ExpandedImageBox.__del__(self)
-			if app.ENABLE_SET_ITEM:
-				del self.tooltipItem
-
-			if app.ENABLE_AFFECT_RENEWAL:
-				del self.tool_tip
-
-			if app.ENABLE_SET_ITEM or app.ENABLE_SNOWFLAKE_STICK_EVENT:
-				self.affect_dict = {}
+		self.isClocked = TRUE
 
 	def SetAffect(self, affect):
 		self.affect = affect
@@ -307,46 +354,29 @@
 	def GetAffect(self):
 		return self.affect
 
-	if app.ENABLE_AFFECT_RENEWAL:
-		def SetToolTipText(self, text, x = 0, y = -19, adjust_line_height = False, line_height_distance = 20):
-			self.tool_tip_text = text
-
-	elif app.ENABLE_SET_ITEM:
-		def SetToolTipText(self, text, x = 0, y = -19, adjust_line_height = False, line_height_distance = 20):
-			if not self.toolTipText:
-				textLine = ui.TextLine()
-				textLine.SetParent(self)
-				textLine.SetSize(0, 0)
-				textLine.SetOutline()
+	def SetToolTipText(self, text, x = 0, y = -19):
+		if not self.toolTipText:
+			if osfInfo.AFFECT_DISPLAY_IN_THINBOARD:
+				textLine = uiToolTip.ToolTip()
+				textLine.ClearToolTip()
+				textLine.AutoAppendTextLine(text)
+				textLine.AlignHorizonalCenter()
 				textLine.Hide()
-				self.toolTipText = textLine
-
-				if adjust_line_height:
-					line_height = self.toolTipText.GetLineHeight()
-					self.toolTipText.SetLineHeight(line_height + line_height_distance)
-
-			self.toolTipText.SetText(text)
-			w, h = self.toolTipText.GetTextSize()
-			if localeInfo.IsARABIC():
-				self.toolTipText.SetPosition(w + 20, y)
 			else:
-				self.toolTipText.SetPosition(max(0, x + self.GetWidth() / 2 - w / 2), y)
-	else:
-		def SetToolTipText(self, text, x = 0, y = -19):
-			if not self.toolTipText:
 				textLine = ui.TextLine()
 				textLine.SetParent(self)
 				textLine.SetSize(0, 0)
 				textLine.SetOutline()
 				textLine.Hide()
-				self.toolTipText = textLine
+			self.toolTipText = textLine
 
+		if not osfInfo.AFFECT_DISPLAY_IN_THINBOARD:
 			self.toolTipText.SetText(text)
 			w, h = self.toolTipText.GetTextSize()
 			if localeInfo.IsARABIC():
-				self.toolTipText.SetPosition(w + 20, y)
+				self.toolTipText.SetPosition(w+20, y)
 			else:
-				self.toolTipText.SetPosition(max(0, x + self.GetWidth() / 2 - w / 2), y)
+				self.toolTipText.SetPosition(max(0, x + self.GetWidth()/2 - w/2), y)
 
 	def SetDescription(self, description):
 		self.description = description
@@ -363,19 +393,18 @@
 		else:
 			potionType = player.AUTO_POTION_TYPE_SP
 
-		potionWindow, potionSlot = player.GetAutoPotionInfo(potionType)
-		metinSocket = [player.GetItemMetinSocket(potionWindow, potionSlot, j) for j in xrange(player.METIN_SOCKET_MAX_NUM)]
+		isActivated, currentAmount, totalAmount, slotIndex = player.GetAutoPotionInfo(potionType)
 
-		currentAmount = int(metinSocket[1])
-		totalAmount = int(metinSocket[2])
+		#print "UpdateAutoPotionDescription ", isActivated, currentAmount, totalAmount, slotIndex
 
 		amountPercent = 0.0
+
 		try:
-			amountPercent = 100.0 - (float(currentAmount) / totalAmount) * 100.0
+			amountPercent = (float(currentAmount) / totalAmount) * 100.0
 		except:
 			amountPercent = 100.0
 
-		self.SetToolTipText(self.description % amountPercent, AFFECT_TOOLTIP_POS_X, AFFECT_TOOLTIP_POS_Y)
+		self.SetToolTipText(self.description % amountPercent, 0, 40)
 
 	def SetClock(self, isClocked):
 		self.isClocked = isClocked
@@ -390,9 +419,9 @@
 
 		toolTip = self.description
 		if self.endTime > 0:
-			leftTime = localeInfo.SecondToDHM(self.endTime - app.GetGlobalTimeStamp())
+			leftTime = localeInfo.SecondToDHMS(self.endTime - app.GetGlobalTimeStamp())
 			toolTip += " (%s : %s)" % (localeInfo.LEFT_TIME, leftTime)
-		self.SetToolTipText(toolTip, AFFECT_TOOLTIP_POS_X, AFFECT_TOOLTIP_POS_Y)
+		self.SetToolTipText(toolTip, 0, 40)
 
 	# 독일버전에서 시간을 제거하기 위해서 사용
 	def __UpdateDescription2(self):
@@ -400,28 +429,7 @@
 			return
 
 		toolTip = self.description
-		self.SetToolTipText(toolTip, AFFECT_TOOLTIP_POS_X, AFFECT_TOOLTIP_POS_Y)
-
-	if app.ENABLE_SET_ITEM:
-		def UpdateSetItemDescription(self, affect_type = chr.NEW_AFFECT_SET_ITEM):
-			if not self.description:
-				return
-
-			if not self.tooltipItem:
-				toolTip = self.description
-			else:
-				toolTip = self.description
-				toolTip += "\\n"
-
-				self.affect_dict = player.GetSetItemEffect(affect_type)
-
-				if type(self.affect_dict) is dict:
-					if len(self.affect_dict) > 0:
-						for k in self.affect_dict.keys():
-							toolTip += self.tooltipItem.GetAffectString(k, self.affect_dict[k])
-							toolTip += "\\n"
-
-			self.SetToolTipText(toolTip, AFFECT_TOOLTIP_POS_X, AFFECT_TOOLTIP_POS_Y, True, 15)
+		self.SetToolTipText(toolTip, 0, 40)
 
 	def SetSkillAffectFlag(self, flag):
 		self.isSkillAffect = flag
@@ -430,213 +438,117 @@
 		return self.isSkillAffect
 
 	def OnMouseOverIn(self):
-		if app.ENABLE_AFFECT_RENEWAL:
-			if not self.tool_tip:
-				return
-			self.tool_tip.ClearToolTip()
-			farques = self.tool_tip_text
-			if callable(farques):
-				try:
-					farques = farques(self)
-				except Exception as e:
-					farques = "Tooltip hata verdi: " + str(e)
-			if isinstance(farques, str):
-				lines = farques.split("\\n")
-				if not lines:
-					return
-				for line in lines:
-					self.tool_tip.AutoAppendTextLine(line)
-			else:
-				self.tool_tip.AutoAppendTextLine(str(farques))
-			self.tool_tip.AlignHorizonalCenter()
-			self.tool_tip.ShowToolTip()
-		else:
-			if self.toolTipText:
-				self.toolTipText.Show()
+		if self.toolTipText:
+			self.toolTipText.Show()
 
 	def OnMouseOverOut(self):
-		if app.ENABLE_AFFECT_RENEWAL:
-			if self.tool_tip:
-				self.tool_tip.HideToolTip()
-		else:
-			if self.toolTipText:
-				self.toolTipText.Hide()
-
-	if app.ENABLE_SNOWFLAKE_STICK_EVENT:
-		def UpdateSnowflakeStickEventRankBuffDescription(self):
-			return
-
-		def UpdateSnowflakeStickEventSnowflakeBuffDescription(self, update_clock = False):
-			if not self.description:
-				return
-
-			if not self.tooltipItem:
-				toolTip = self.description
-				if self.endTime > 0:
-					leftTime = localeInfo.SecondToDHM(self.endTime - app.GetGlobalTimeStamp())
-					toolTip += " (%s : %s)" % (localeInfo.LEFT_TIME, leftTime)
-			else:
-				toolTip = self.description
-				if self.endTime > 0:
-					leftTime = localeInfo.SecondToDHM(self.endTime - app.GetGlobalTimeStamp())
-					toolTip += " (%s : %s)" % (localeInfo.LEFT_TIME, leftTime)
-
-				toolTip += "\\n"
-				toolTip += localeInfo.TOOLTIP_AFFECT_SNOWFLAKE_STICK_EVENT_SNOWFLAKE_BUFF_2
-				toolTip += "\\n"
-
-				if not update_clock:
-					self.affect_dict = player.GetAffectData(self.affect)
-
-				if type(self.affect_dict) is dict and self.affect_dict:
-					if len(self.affect_dict) > 0:
-						for k in self.affect_dict.keys():
-							toolTip += self.tooltipItem.GetAffectString(k, self.affect_dict[k])
-							toolTip += "\\n"
-
-			self.SetToolTipText(toolTip, AFFECT_TOOLTIP_POS_X, AFFECT_TOOLTIP_POS_Y, True, 15)
+		if self.toolTipText:
+			self.toolTipText.Hide()
 
 class AffectShower(ui.Window):
-
 	MALL_DESC_IDX_START = 1000
 	IMAGE_STEP = 25
 	AFFECT_MAX_NUM = 32
 
 	INFINITE_AFFECT_DURATION = 0x1FFFFFFF
 
-	if app.ENABLE_AFFECT_RENEWAL:
-		BASE_POS_X = 10
-		BASE_POS_Y = 10
+	AFFECT_DATA_DICT = {
+		chr.AFFECT_POISON : (localeInfo.SKILL_TOXICDIE, "d:/ymir work/ui/skill/common/affect/poison.sub"),
+		chr.AFFECT_BLEEDING : (localeInfo.SKILL_BLEEDING, "d:/ymir work/ui/skill/common/affect/poison.sub"),
+		chr.AFFECT_SLOW : (localeInfo.SKILL_SLOW, "d:/ymir work/ui/skill/common/affect/slow.sub"),
+		chr.AFFECT_STUN : (localeInfo.SKILL_STUN, "d:/ymir work/ui/skill/common/affect/stun.sub"),
+
+		chr.AFFECT_ATT_SPEED_POTION : (localeInfo.SKILL_INC_ATKSPD, "d:/ymir work/ui/skill/common/affect/Increase_Attack_Speed.sub"),
+		chr.AFFECT_MOV_SPEED_POTION : (localeInfo.SKILL_INC_MOVSPD, "d:/ymir work/ui/skill/common/affect/Increase_Move_Speed.sub"),
+		chr.AFFECT_FISH_MIND : (localeInfo.SKILL_FISHMIND, "d:/ymir work/ui/skill/common/affect/fishmind.sub"),
+
+		chr.AFFECT_JEONGWI : (localeInfo.SKILL_JEONGWI, "d:/ymir work/ui/skill/warrior/jeongwi_03.sub",),
+		chr.AFFECT_GEOMGYEONG : (localeInfo.SKILL_GEOMGYEONG, "d:/ymir work/ui/skill/warrior/geomgyeong_03.sub",),
+		chr.AFFECT_CHEONGEUN : (localeInfo.SKILL_CHEONGEUN, "d:/ymir work/ui/skill/warrior/cheongeun_03.sub",),
+		chr.AFFECT_GYEONGGONG : (localeInfo.SKILL_GYEONGGONG, "d:/ymir work/ui/skill/assassin/gyeonggong_03.sub",),
+		chr.AFFECT_EUNHYEONG : (localeInfo.SKILL_EUNHYEONG, "d:/ymir work/ui/skill/assassin/eunhyeong_03.sub",),
+		chr.AFFECT_GWIGEOM : (localeInfo.SKILL_GWIGEOM, "d:/ymir work/ui/skill/sura/gwigeom_03.sub",),
+		chr.AFFECT_GONGPO : (localeInfo.SKILL_GONGPO, "d:/ymir work/ui/skill/sura/gongpo_03.sub",),
+		chr.AFFECT_JUMAGAP : (localeInfo.SKILL_JUMAGAP, "d:/ymir work/ui/skill/sura/jumagap_03.sub"),
+		chr.AFFECT_HOSIN : (localeInfo.SKILL_HOSIN, "d:/ymir work/ui/skill/shaman/hosin_03.sub",),
+		chr.AFFECT_BOHO : (localeInfo.SKILL_BOHO, "d:/ymir work/ui/skill/shaman/boho_03.sub",),
+		chr.AFFECT_KWAESOK : (localeInfo.SKILL_KWAESOK, "d:/ymir work/ui/skill/shaman/kwaesok_03.sub",),
+		chr.AFFECT_HEUKSIN : (localeInfo.SKILL_HEUKSIN, "d:/ymir work/ui/skill/sura/heuksin_03.sub",),
+		chr.AFFECT_MUYEONG : (localeInfo.SKILL_MUYEONG, "d:/ymir work/ui/skill/sura/muyeong_03.sub",),
+		chr.AFFECT_GICHEON : (localeInfo.SKILL_GICHEON, "d:/ymir work/ui/skill/shaman/gicheon_03.sub",),
+		chr.AFFECT_JEUNGRYEOK : (localeInfo.SKILL_JEUNGRYEOK, "d:/ymir work/ui/skill/shaman/jeungryeok_03.sub",),
+		chr.AFFECT_PABEOP : (localeInfo.SKILL_PABEOP, "d:/ymir work/ui/skill/sura/pabeop_03.sub",),
+		chr.AFFECT_FALLEN_CHEONGEUN : (localeInfo.SKILL_CHEONGEUN, "d:/ymir work/ui/skill/warrior/cheongeun_03.sub",),
+		28 : (localeInfo.SKILL_FIRE, "d:/ymir work/ui/skill/sura/hwayeom_03.sub",),
+		chr.AFFECT_CHINA_FIREWORK : (localeInfo.SKILL_POWERFUL_STRIKE, "d:/ymir work/ui/skill/common/affect/powerfulstrike.sub",),
+		chr.AFFECT_RED_POSSESSION : (localeInfo.SKILL_GWIGEOM, "d:/ymir work/ui/skill/wolfman/red_possession_03.sub",),
+		chr.AFFECT_BLUE_POSSESSION : (localeInfo.SKILL_CHEONGEUN, "d:/ymir work/ui/skill/wolfman/blue_possession_03.sub",),
+
+		#64 - END
+		chr.NEW_AFFECT_EXP_BONUS : (localeInfo.TOOLTIP_MALL_EXPBONUS_STATIC, "d:/ymir work/ui/skill/common/affect/exp_bonus.sub",),
+
+		chr.NEW_AFFECT_ITEM_BONUS : (localeInfo.TOOLTIP_MALL_ITEMBONUS_STATIC, "d:/ymir work/ui/skill/common/affect/item_bonus.sub",),
+		chr.NEW_AFFECT_SAFEBOX : (localeInfo.TOOLTIP_MALL_SAFEBOX, "d:/ymir work/ui/skill/common/affect/safebox.sub",),
+		chr.NEW_AFFECT_AUTOLOOT : (localeInfo.TOOLTIP_MALL_AUTOLOOT, "d:/ymir work/ui/skill/common/affect/autoloot.sub",),
+		chr.NEW_AFFECT_FISH_MIND : (localeInfo.TOOLTIP_MALL_FISH_MIND, "d:/ymir work/ui/skill/common/affect/fishmind.sub",),
+		chr.NEW_AFFECT_MARRIAGE_FAST : (localeInfo.TOOLTIP_MALL_MARRIAGE_FAST, "d:/ymir work/ui/skill/common/affect/marriage_fast.sub",),
+		chr.NEW_AFFECT_GOLD_BONUS : (localeInfo.TOOLTIP_MALL_GOLDBONUS_STATIC, "d:/ymir work/ui/skill/common/affect/gold_bonus.sub",),
+
+		chr.NEW_AFFECT_NO_DEATH_PENALTY : (localeInfo.TOOLTIP_APPLY_NO_DEATH_PENALTY, "d:/ymir work/ui/skill/common/affect/gold_premium.sub"),
+		chr.NEW_AFFECT_SKILL_BOOK_BONUS : (localeInfo.TOOLTIP_APPLY_SKILL_BOOK_BONUS, "d:/ymir work/ui/skill/common/affect/gold_premium.sub"),
+		chr.NEW_AFFECT_SKILL_BOOK_NO_DELAY : (localeInfo.TOOLTIP_APPLY_SKILL_BOOK_NO_DELAY, "d:/ymir work/ui/skill/common/affect/gold_premium.sub"),
+
+		# 자동물약 hp, sp
+		chr.NEW_AFFECT_AUTO_HP_RECOVERY : (localeInfo.TOOLTIP_AUTO_POTION_REST, "d:/ymir work/ui/pattern/auto_hpgauge/05.dds"),
+		chr.NEW_AFFECT_AUTO_SP_RECOVERY : (localeInfo.TOOLTIP_AUTO_POTION_REST, "d:/ymir work/ui/pattern/auto_spgauge/05.dds"),
+		#chr.NEW_AFFECT_AUTO_HP_RECOVERY : (localeInfo.TOOLTIP_AUTO_POTION_REST, "d:/ymir work/ui/skill/common/affect/gold_premium.sub"),
+		#chr.NEW_AFFECT_AUTO_SP_RECOVERY : (localeInfo.TOOLTIP_AUTO_POTION_REST, "d:/ymir work/ui/skill/common/affect/gold_bonus.sub"),
+
+		MALL_DESC_IDX_START + player.POINT_MALL_ATTBONUS : (localeInfo.TOOLTIP_MALL_ATTBONUS_STATIC, "d:/ymir work/ui/skill/common/affect/att_bonus.sub",),
+		MALL_DESC_IDX_START + player.POINT_MALL_DEFBONUS : (localeInfo.TOOLTIP_MALL_DEFBONUS_STATIC, "d:/ymir work/ui/skill/common/affect/def_bonus.sub",),
+		MALL_DESC_IDX_START + player.POINT_MALL_EXPBONUS : (localeInfo.TOOLTIP_MALL_EXPBONUS, "d:/ymir work/ui/skill/common/affect/exp_bonus.sub",),
+		MALL_DESC_IDX_START + player.POINT_MALL_ITEMBONUS : (localeInfo.TOOLTIP_MALL_ITEMBONUS, "d:/ymir work/ui/skill/common/affect/item_bonus.sub",),
+		MALL_DESC_IDX_START + player.POINT_MALL_GOLDBONUS : (localeInfo.TOOLTIP_MALL_GOLDBONUS, "d:/ymir work/ui/skill/common/affect/gold_bonus.sub",),
+		MALL_DESC_IDX_START + player.POINT_CRITICAL_PCT : (localeInfo.TOOLTIP_APPLY_CRITICAL_PCT,"d:/ymir work/ui/skill/common/affect/critical.sub"),
+		MALL_DESC_IDX_START + player.POINT_PENETRATE_PCT : (localeInfo.TOOLTIP_APPLY_PENETRATE_PCT, "d:/ymir work/ui/skill/common/affect/gold_premium.sub"),
+		MALL_DESC_IDX_START + player.POINT_MAX_HP_PCT : (localeInfo.TOOLTIP_MAX_HP_PCT, "d:/ymir work/ui/skill/common/affect/gold_premium.sub"),
+		MALL_DESC_IDX_START + player.POINT_MAX_SP_PCT : (localeInfo.TOOLTIP_MAX_SP_PCT, "d:/ymir work/ui/skill/common/affect/gold_premium.sub"),
+
+		MALL_DESC_IDX_START + player.POINT_PC_BANG_EXP_BONUS : (localeInfo.TOOLTIP_MALL_EXPBONUS_P_STATIC, "d:/ymir work/ui/skill/common/affect/EXP_Bonus_p_on.sub",),
+		MALL_DESC_IDX_START + player.POINT_PC_BANG_DROP_BONUS: (localeInfo.TOOLTIP_MALL_ITEMBONUS_P_STATIC, "d:/ymir work/ui/skill/common/affect/Item_Bonus_p_on.sub",),
+		#MALL_DESC_IDX_START + player.POINT_MELEE_MAGIC_ATT_BONUS_PER : (localeInfo.TOOLTIP_MALL_ATTBONUS_STATIC, "d:/ymir work/ui/skill/common/affect/att_bonus.sub",),
+	}
+
+	if app.ENABLE_DRAGON_SOUL_SYSTEM:
+		# 용혼석 천, 지 덱.
+		AFFECT_DATA_DICT[chr.NEW_AFFECT_DRAGON_SOUL_DECK1] = (localeInfo.TOOLTIP_DRAGON_SOUL_DECK1, "d:/ymir work/ui/dragonsoul/buff_ds_sky1.tga")
+		AFFECT_DATA_DICT[chr.NEW_AFFECT_DRAGON_SOUL_DECK2] = (localeInfo.TOOLTIP_DRAGON_SOUL_DECK2, "d:/ymir work/ui/dragonsoul/buff_ds_land1.tga")
+
+	if app.ENABLE_DS_SET:
+		AFFECT_DATA_DICT[chr.NEW_AFFECT_DS_SET] = (localeInfo.TOOLTIP_DS_SET, "d:/ymir work/ui/skill/common/affect/ds_set_bonus.sub")
+
+	AFFECT_DATA_DICT[chr.AFFECT_RESEARCHER_ELIXIR] = (localeInfo.TOOLTIP_AFFECT_RESEARCHER_ELIXIR, "d:/ymir work/ui/skill/common/affect/researcher_elixir.sub")
+
+	if app.ENABLE_NEW_BLEND_AFFECT:
+		AFFECT_DATA_DICT[chr.AFFECT_BLEND_POTION_1] = (localeInfo.TOOLTIP_AFFECT_BLEND_POTION_1, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_BLEND_POTION_1) + ".dds")
+		AFFECT_DATA_DICT[chr.AFFECT_BLEND_POTION_2] = (localeInfo.TOOLTIP_AFFECT_BLEND_POTION_2, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_BLEND_POTION_2) + ".dds")
+		AFFECT_DATA_DICT[chr.AFFECT_BLEND_POTION_3] = (localeInfo.TOOLTIP_AFFECT_BLEND_POTION_3, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_BLEND_POTION_3) + ".dds")
+		AFFECT_DATA_DICT[chr.AFFECT_BLEND_POTION_4] = (localeInfo.TOOLTIP_AFFECT_BLEND_POTION_4, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_BLEND_POTION_4) + ".dds")
+		AFFECT_DATA_DICT[chr.AFFECT_BLEND_POTION_5] = (localeInfo.TOOLTIP_AFFECT_BLEND_POTION_5, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_BLEND_POTION_5) + ".dds")
+		AFFECT_DATA_DICT[chr.AFFECT_BLEND_POTION_6] = (localeInfo.TOOLTIP_AFFECT_BLEND_POTION_6, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_BLEND_POTION_6) + ".dds")
+		AFFECT_DATA_DICT[chr.AFFECT_ENERGY] = (localeInfo.TOOLTIP_AFFECT_ENERGY, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_ENERGY) + ".dds")
+		AFFECT_DATA_DICT[chr.AFFECT_DRAGON_GOD_1] = (localeInfo.TOOLTIP_AFFECT_DRAGON_GOD_1, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_DRAGON_GOD_1) + ".dds")
+		AFFECT_DATA_DICT[chr.AFFECT_DRAGON_GOD_2] = (localeInfo.TOOLTIP_AFFECT_DRAGON_GOD_2, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_DRAGON_GOD_2) + ".dds")
+		AFFECT_DATA_DICT[chr.AFFECT_DRAGON_GOD_3] = (localeInfo.TOOLTIP_AFFECT_DRAGON_GOD_3, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_DRAGON_GOD_3) + ".dds")
+		AFFECT_DATA_DICT[chr.AFFECT_DRAGON_GOD_4] = (localeInfo.TOOLTIP_AFFECT_DRAGON_GOD_4, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_DRAGON_GOD_4) + ".dds")
+		AFFECT_DATA_DICT[chr.AFFECT_CRITICAL] = (localeInfo.TOOLTIP_AFFECT_CRITICAL, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_CRITICAL) + ".dds")
+		AFFECT_DATA_DICT[chr.AFFECT_PENETRATE] = (localeInfo.TOOLTIP_AFFECT_PENETRATE, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_PENETRATE) + ".dds")
+		AFFECT_DATA_DICT[chr.AFFECT_ATTACK_SPEED] = (localeInfo.TOOLTIP_AFFECT_ATTACK_SPEED, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_ATTACK_SPEED) + ".dds")
+		AFFECT_DATA_DICT[chr.AFFECT_MOVE_SPEED] = (localeInfo.TOOLTIP_AFFECT_MOVE_SPEED, "d:/ymir work/ui/game/blend_affect/" + str(chr.AFFECT_MOVE_SPEED) + ".dds")
 
 	def __init__(self):
 		ui.Window.__init__(self)
 
-		self.AFFECT_DATA_DICT = {
-			chr.AFFECT_POISON : (localeInfo.SKILL_TOXICDIE, "d:/ymir work/ui/skill/common/affect/poison.sub"),
-			chr.AFFECT_BLEEDING : (localeInfo.SKILL_BLEEDING, "d:/ymir work/ui/skill/common/affect/poison.sub"),
-			chr.AFFECT_SLOW : (localeInfo.SKILL_SLOW, "d:/ymir work/ui/skill/common/affect/slow.sub"),
-			chr.AFFECT_STUN : (localeInfo.SKILL_STUN, "d:/ymir work/ui/skill/common/affect/stun.sub"),
-
-			chr.AFFECT_ATT_SPEED_POTION : (localeInfo.SKILL_INC_ATKSPD, "d:/ymir work/ui/skill/common/affect/Increase_Attack_Speed.sub"),
-			chr.AFFECT_MOV_SPEED_POTION : (localeInfo.SKILL_INC_MOVSPD, "d:/ymir work/ui/skill/common/affect/Increase_Move_Speed.sub"),
-			chr.AFFECT_FISH_MIND : (localeInfo.SKILL_FISHMIND, "d:/ymir work/ui/skill/common/affect/fishmind.sub"),
-
-			chr.AFFECT_JEONGWI : (localeInfo.SKILL_JEONGWI, "d:/ymir work/ui/skill/warrior/jeongwi_03.sub",),
-			chr.AFFECT_GEOMGYEONG : (localeInfo.SKILL_GEOMGYEONG, "d:/ymir work/ui/skill/warrior/geomgyeong_03.sub",),
-			chr.AFFECT_CHEONGEUN : (localeInfo.SKILL_CHEONGEUN, "d:/ymir work/ui/skill/warrior/cheongeun_03.sub",),
-			chr.AFFECT_GYEONGGONG : (localeInfo.SKILL_GYEONGGONG, "d:/ymir work/ui/skill/assassin/gyeonggong_03.sub",),
-			chr.AFFECT_EUNHYEONG : (localeInfo.SKILL_EUNHYEONG, "d:/ymir work/ui/skill/assassin/eunhyeong_03.sub",),
-			chr.AFFECT_GWIGEOM : (localeInfo.SKILL_GWIGEOM, "d:/ymir work/ui/skill/sura/gwigeom_03.sub",),
-			chr.AFFECT_GONGPO : (localeInfo.SKILL_GONGPO, "d:/ymir work/ui/skill/sura/gongpo_03.sub",),
-			chr.AFFECT_JUMAGAP : (localeInfo.SKILL_JUMAGAP, "d:/ymir work/ui/skill/sura/jumagap_03.sub"),
-			chr.AFFECT_HOSIN : (localeInfo.SKILL_HOSIN, "d:/ymir work/ui/skill/shaman/hosin_03.sub",),
-			chr.AFFECT_BOHO : (localeInfo.SKILL_BOHO, "d:/ymir work/ui/skill/shaman/boho_03.sub",),
-			chr.AFFECT_KWAESOK : (localeInfo.SKILL_KWAESOK, "d:/ymir work/ui/skill/shaman/kwaesok_03.sub",),
-			chr.AFFECT_HEUKSIN : (localeInfo.SKILL_HEUKSIN, "d:/ymir work/ui/skill/sura/heuksin_03.sub",),
-			chr.AFFECT_MUYEONG : (localeInfo.SKILL_MUYEONG, "d:/ymir work/ui/skill/sura/muyeong_03.sub",),
-			chr.AFFECT_GICHEON : (localeInfo.SKILL_GICHEON, "d:/ymir work/ui/skill/shaman/gicheon_03.sub",),
-			chr.AFFECT_JEUNGRYEOK : (localeInfo.SKILL_JEUNGRYEOK, "d:/ymir work/ui/skill/shaman/jeungryeok_03.sub",),
-			chr.AFFECT_PABEOP : (localeInfo.SKILL_PABEOP, "d:/ymir work/ui/skill/sura/pabeop_03.sub",),
-			chr.AFFECT_FALLEN_CHEONGEUN : (localeInfo.SKILL_CHEONGEUN, "d:/ymir work/ui/skill/warrior/cheongeun_03.sub",),
-			28 : (localeInfo.SKILL_FIRE, "d:/ymir work/ui/skill/sura/hwayeom_03.sub",),
-			chr.AFFECT_CHINA_FIREWORK : (localeInfo.SKILL_POWERFUL_STRIKE, "d:/ymir work/ui/skill/common/affect/powerfulstrike.sub",),
-			chr.AFFECT_RED_POSSESSION : (localeInfo.SKILL_GWIGEOM, "d:/ymir work/ui/skill/wolfman/red_possession_03.sub",),
-			chr.AFFECT_BLUE_POSSESSION : (localeInfo.SKILL_CHEONGEUN, "d:/ymir work/ui/skill/wolfman/blue_possession_03.sub",),
-
-			#64 - END
-			chr.NEW_AFFECT_EXP_BONUS : (localeInfo.TOOLTIP_MALL_EXPBONUS_STATIC, "d:/ymir work/ui/skill/common/affect/exp_bonus.sub",),
-
-			chr.NEW_AFFECT_ITEM_BONUS : (localeInfo.TOOLTIP_MALL_ITEMBONUS_STATIC, "d:/ymir work/ui/skill/common/affect/item_bonus.sub",),
-			chr.NEW_AFFECT_SAFEBOX : (localeInfo.TOOLTIP_MALL_SAFEBOX, "d:/ymir work/ui/skill/common/affect/safebox.sub",),
-			chr.NEW_AFFECT_AUTOLOOT : (localeInfo.TOOLTIP_MALL_AUTOLOOT, "d:/ymir work/ui/skill/common/affect/autoloot.sub",),
-			chr.NEW_AFFECT_FISH_MIND : (localeInfo.TOOLTIP_MALL_FISH_MIND, "d:/ymir work/ui/skill/common/affect/fishmind.sub",),
-			chr.NEW_AFFECT_MARRIAGE_FAST : (localeInfo.TOOLTIP_MALL_MARRIAGE_FAST, "d:/ymir work/ui/skill/common/affect/marriage_fast.sub",),
-			chr.NEW_AFFECT_GOLD_BONUS : (localeInfo.TOOLTIP_MALL_GOLDBONUS_STATIC, "d:/ymir work/ui/skill/common/affect/gold_bonus.sub",),
-
-			chr.NEW_AFFECT_NO_DEATH_PENALTY : (localeInfo.TOOLTIP_APPLY_NO_DEATH_PENALTY, "d:/ymir work/ui/skill/common/affect/gold_premium.sub"),
-			chr.NEW_AFFECT_SKILL_BOOK_BONUS : (localeInfo.TOOLTIP_APPLY_SKILL_BOOK_BONUS, "d:/ymir work/ui/skill/common/affect/gold_premium.sub"),
-			chr.NEW_AFFECT_SKILL_BOOK_NO_DELAY : (localeInfo.TOOLTIP_APPLY_SKILL_BOOK_NO_DELAY, "d:/ymir work/ui/skill/common/affect/gold_premium.sub"),
-
-			# 자동물약 hp, sp
-			chr.NEW_AFFECT_AUTO_HP_RECOVERY : (localeInfo.TOOLTIP_AUTO_POTION_REST, "d:/ymir work/ui/pattern/auto_hpgauge/05.dds"),
-			chr.NEW_AFFECT_AUTO_SP_RECOVERY : (localeInfo.TOOLTIP_AUTO_POTION_REST, "d:/ymir work/ui/pattern/auto_spgauge/05.dds"),
-			#chr.NEW_AFFECT_AUTO_HP_RECOVERY : (localeInfo.TOOLTIP_AUTO_POTION_REST, "d:/ymir work/ui/skill/common/affect/gold_premium.sub"),
-			#chr.NEW_AFFECT_AUTO_SP_RECOVERY : (localeInfo.TOOLTIP_AUTO_POTION_REST, "d:/ymir work/ui/skill/common/affect/gold_bonus.sub"),
-
-			self.MALL_DESC_IDX_START + player.POINT_MALL_ATTBONUS : (localeInfo.TOOLTIP_MALL_ATTBONUS_STATIC, "d:/ymir work/ui/skill/common/affect/att_bonus.sub",),
-			self.MALL_DESC_IDX_START + player.POINT_MALL_DEFBONUS : (localeInfo.TOOLTIP_MALL_DEFBONUS_STATIC, "d:/ymir work/ui/skill/common/affect/def_bonus.sub",),
-			self.MALL_DESC_IDX_START + player.POINT_MALL_EXPBONUS : (localeInfo.TOOLTIP_MALL_EXPBONUS, "d:/ymir work/ui/skill/common/affect/exp_bonus.sub",),
-			self.MALL_DESC_IDX_START + player.POINT_MALL_ITEMBONUS : (localeInfo.TOOLTIP_MALL_ITEMBONUS, "d:/ymir work/ui/skill/common/affect/item_bonus.sub",),
-			self.MALL_DESC_IDX_START + player.POINT_MALL_GOLDBONUS : (localeInfo.TOOLTIP_MALL_GOLDBONUS, "d:/ymir work/ui/skill/common/affect/gold_bonus.sub",),
-			self.MALL_DESC_IDX_START + player.POINT_CRITICAL_PCT : (localeInfo.TOOLTIP_APPLY_CRITICAL_PCT,"d:/ymir work/ui/skill/common/affect/critical.sub"),
-			self.MALL_DESC_IDX_START + player.POINT_PENETRATE_PCT : (localeInfo.TOOLTIP_APPLY_PENETRATE_PCT, "d:/ymir work/ui/skill/common/affect/gold_premium.sub"),
-			self.MALL_DESC_IDX_START + player.POINT_MAX_HP_PCT : (localeInfo.TOOLTIP_MAX_HP_PCT, "d:/ymir work/ui/skill/common/affect/gold_premium.sub"),
-			self.MALL_DESC_IDX_START + player.POINT_MAX_SP_PCT : (localeInfo.TOOLTIP_MAX_SP_PCT, "d:/ymir work/ui/skill/common/affect/gold_premium.sub"),
-
-			self.MALL_DESC_IDX_START + player.POINT_PC_BANG_EXP_BONUS : (localeInfo.TOOLTIP_MALL_EXPBONUS_P_STATIC, "d:/ymir work/ui/skill/common/affect/EXP_Bonus_p_on.sub",),
-			self.MALL_DESC_IDX_START + player.POINT_PC_BANG_DROP_BONUS: (localeInfo.TOOLTIP_MALL_ITEMBONUS_P_STATIC, "d:/ymir work/ui/skill/common/affect/Item_Bonus_p_on.sub",),
-			self.MALL_DESC_IDX_START + player.POINT_MELEE_MAGIC_ATT_BONUS_PER : (localeInfo.TOOLTIP_MALL_ATTBONUS_STATIC, "d:/ymir work/ui/skill/common/affect/att_bonus.sub",),
-		}
-
-		if app.ENABLE_DRAGON_SOUL_SYSTEM:
-			# 용혼석 천, 지 덱.
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_DRAGON_SOUL_DECK1] = (localeInfo.TOOLTIP_DRAGON_SOUL_DECK1, "d:/ymir work/ui/dragonsoul/buff_ds_sky1.tga")
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_DRAGON_SOUL_DECK2] = (localeInfo.TOOLTIP_DRAGON_SOUL_DECK2, "d:/ymir work/ui/dragonsoul/buff_ds_land1.tga")
-
-		self.AFFECT_DATA_DICT[chr.NEW_AFFECT_POLYMORPH] = (localeInfo.TOOLTIP_AFFECT_POLYMORPH, "d:/ymir work/ui/game/monster_card/poly_affect.sub")
-
-		if app.ENABLE_SET_ITEM:
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_SET_ITEM] = (localeInfo.TOOLTIP_SET_ITEM, "d:/ymir work/ui/skill/common/affect/set_bonus.sub")
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_SET_ITEM_SET_VALUE_1] = (localeInfo.TOOLTIP_AFFECT_SET_ITEM_1, "d:/ymir work/ui/skill/common/affect/set_bonus.sub")
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_SET_ITEM_SET_VALUE_2] = (localeInfo.TOOLTIP_AFFECT_SET_ITEM_2, "d:/ymir work/ui/skill/common/affect/set_bonus.sub")
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_SET_ITEM_SET_VALUE_3] = (localeInfo.TOOLTIP_AFFECT_SET_ITEM_3, "d:/ymir work/ui/skill/common/affect/set_bonus.sub")
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_SET_ITEM_SET_VALUE_4] = (localeInfo.TOOLTIP_AFFECT_SET_ITEM_4, "d:/ymir work/ui/skill/common/affect/set_bonus.sub")
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_SET_ITEM_SET_VALUE_5] = (localeInfo.TOOLTIP_AFFECT_SET_ITEM_5, "d:/ymir work/ui/skill/common/affect/set_bonus.sub")
-
-		self.AFFECT_DATA_DICT[chr.NEW_AFFECT_MOUNT_FALL] = (localeInfo.TOOLTIP_AFFECT_MOUNT_FALL, "d:/ymir work/ui/skill/common/affect/mount_fall.sub")
-
-		if app.ENABLE_FLOWER_EVENT:
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_FLOWER_EVENT] = ("", "d:/ymir work/ui/skill/common/affect/flower_event.sub")
-
-		if app.ENABLE_DS_SET:
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_DS_SET] = (localeInfo.TOOLTIP_DS_SET, "d:/ymir work/ui/skill/common/affect/ds_set_bonus.sub")
-
-		self.AFFECT_DATA_DICT[chr.NEW_AFFECT_RESEARCHER_ELIXIR] = (localeInfo.TOOLTIP_AFFECT_RESEARCHER_ELIXIR, "d:/ymir work/ui/skill/common/affect/researcher_elixir.sub")
-		self.AFFECT_DATA_DICT[chr.NEW_AFFECT_SAFE_BOX_BUFF] = (localeInfo.TOOLTIP_AFFECT_SAFEBOX_BUFF_01, "d:/ymir work/ui/skill/common/affect/safebox_buff.sub")
-
-		if app.ENABLE_FISHING_GAME:
-			self.AFFECT_DATA_DICT[chr.AFFECT_FISHING_GOLD_TUNA] = (localeInfo.TOOLTIP_AFFECT_FISHING_GOLD_TUNA, "d:/ymir work/ui/skill/common/affect/fishing_gold_tuna_buff.sub")
-			self.AFFECT_DATA_DICT[chr.AFFECT_FISHING_MOVE_SPEED_DOWN] = (localeInfo.TOOLTIP_AFFECT_FISHING_MOVE_SPEED_DOWN, "d:/ymir work/ui/skill/common/affect/fishing_move_speed_down.sub")
-
-		if app.ENABLE_LOOTING_SYSTEM and app.ENABLE_PREMIUM_LOOTING:
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_LOOTING_SYSTEM] = (localeInfo.TOOLTIP_AFFECT_LOOTING_SYSTEM, "d:/ymir work/ui/skill/common/affect/looting_system.sub")
-
-		if app.ENABLE_CONQUEROR_LEVEL:
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_SKILL_9_CHEONUN] = (localeInfo.TOOLTIP_AFFECT_CHEONUN, "d:/ymir work/ui/skill/shaman/cheonun_03.sub")
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_SUNGMA_BONUS] = (localeInfo.TOOLTIP_SUNGMA_ATTR_PRIMIUM, "d:/ymir work/ui/skill/common/affect/sungma_premium_buff.sub")
-
-		if app.ENABLE_YUTNORI_EVENT_FLAG_RENEWAL:
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_HALLOWEEN_EVENT] = (localeInfo.TOOLTIP_HALLOWEEN_EVENT_BUFF, "d:/ymir work/ui/skill/common/affect/halloween_bonus.sub")
-
-		if app.ENABLE_SNOWFLAKE_STICK_EVENT:
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_SNOWFLAKE_STICK_EVENT_RANK_BUFF] = (localeInfo.TOOLTIP_AFFECT_SNOWFLAKE_STICK_EVENT_RANK_BUFF, "d:/ymir work/ui/skill/common/affect/snowflake_stick_event_rank_buff.sub")
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_SNOWFLAKE_STICK_EVENT_SNOWFLAKE_BUFF] = (localeInfo.TOOLTIP_AFFECT_SNOWFLAKE_STICK_EVENT_SNOWFLAKE_BUFF_1, "d:/ymir work/ui/skill/common/affect/snowflake_stick_event_snowflake_buff.sub")
-
-		if app.ENABLE_ELEMENTAL_DUNGEON:
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_CURSE_OF_ELEMENTAL] = (localeInfo.TOOLTIP_CURSE_OF_ELEMENTAL, "d:/ymir work/ui/skill/common/affect/curse_of_elemental.sub")
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_PROTECTION_OF_ELEMENTAL] = (localeInfo.TOOLTIP_PROTECTION_OF_ELEMENTAL, "d:/ymir work/ui/skill/common/affect/protection_of_elemental.sub")
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_POTION_OF_ELEMENTAL] = (localeInfo.TOOLTIP_POTION_OF_ELEMENTAL, "d:/ymir work/ui/skill/common/affect/potion_of_elemental.sub")
-
-		if app.ENABLE_GUILD_DRAGONLAIR_SYSTEM:
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_RED_DRAGONLAIR_BUFF] = (localeInfo.TOOLTIP_AFFECT_RED_DRAGONLAIR_BUFF, "d:/ymir work/ui/skill/common/affect/def_grade_down.sub")
-
-		if app.ENABLE_SUMMER_EVENT_ROULETTE:
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_LATE_SUMMER_EVENT_BUFF] = (localeInfo.TOOLTIP_AFFECT_LATE_SUMMER_EVENT_BUFF, "d:/ymir work/ui/skill/common/affect/late_summber_buff_affect.sub")
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_LATE_SUMMER_EVENT_PRIMIUM_BUFF] = (localeInfo.TOOLTIP_AFFECT_LATE_SUMMER_EVENT_PRIMIUM_BUFF, "d:/ymir work/ui/skill/common/affect/late_summber_primium_buff_affect.sub")
-
-		if app.ENABLE_DEFENSE_WAVE:
-			self.AFFECT_DATA_DICT[chr.NEW_AFFECT_DEFENSEWAVE_LASER] = (localeInfo.TOOLTIP_AFFECT_DEFENSEWAVE_LASER, "d:/ymir work/ui/skill/common/affect/laser.sub")
-
 		self.serverPlayTime = 0
 		self.clientPlayTime = 0
 
@@ -644,37 +556,18 @@
 		self.affectImageDict = {}
 		self.horseImage = None
 		self.lovePointImage = None
-
 		if app.ENABLE_CONQUEROR_LEVEL:
 			self.sungmaImage = None
-
-		self.SetPosition(10, 10)
-		self.Show()
-
-		if app.ENABLE_SET_ITEM:
-			self.SetItemAffectCheck()
-
 		if app.ENABLE_GROWTH_PET_SYSTEM:
 			self.petSkillaffectImageDict = {}
+		self.autoPotionImageHP = AutoPotionImage()
+		self.autoPotionImageSP = AutoPotionImage()
+		self.SetPosition(10, 10)
+		self.Show()
 
 	def __del__(self):
 		ui.Window.__del__(self)
 
-	if app.ENABLE_SET_ITEM:
-		def SetItemAffectCheck(self):
-			if player.EmptySetItemEffect(chr.NEW_AFFECT_SET_ITEM):
-				self.BINARY_NEW_RemoveAffect(chr.NEW_AFFECT_SET_ITEM, 0)
-			else:
-				self.BINARY_NEW_RemoveAffect(chr.NEW_AFFECT_SET_ITEM, 0)
-				self.BINARY_NEW_AddAffect(chr.NEW_AFFECT_SET_ITEM, 0, 0, self.INFINITE_AFFECT_DURATION)
-
-			for affect in xrange(chr.NEW_AFFECT_SET_ITEM_SET_VALUE_1, chr.NEW_AFFECT_SET_ITEM_SET_VALUE_5 + 1):
-				if player.EmptySetItemEffect(affect):
-					self.BINARY_NEW_RemoveAffect(affect, 0)
-				else:
-					self.BINARY_NEW_RemoveAffect(affect, 0)
-					self.BINARY_NEW_AddAffect(affect, 0, 0, self.INFINITE_AFFECT_DURATION)
-
 	def ClearAllAffects(self):
 		self.horseImage = None
 		self.lovePointImage = None
@@ -696,13 +589,27 @@
 	def BINARY_NEW_AddAffect(self, type, pointIdx, value, duration):
 		print "BINARY_NEW_AddAffect", type, pointIdx, value, duration
 
-		if type < 500:
-			pass_affect_list = []
-			pass_affect_list.append(chr.NEW_AFFECT_POLYMORPH)
-			if app.ENABLE_CONQUEROR_LEVEL:
-				pass_affect_list.append(chr.NEW_AFFECT_SKILL_9_CHEONUN)
-
-			if not type in pass_affect_list:
+		if app.ENABLE_NEW_BLEND_AFFECT:
+			if type < 500 and\
+				not type == chr.AFFECT_BLEND_POTION_1 and\
+				not type == chr.AFFECT_BLEND_POTION_2 and\
+				not type == chr.AFFECT_BLEND_POTION_3 and\
+				not type == chr.AFFECT_BLEND_POTION_4 and\
+				not type == chr.AFFECT_BLEND_POTION_5 and\
+				not type == chr.AFFECT_BLEND_POTION_6 and\
+				not type == chr.AFFECT_ENERGY and\
+				not type == chr.AFFECT_DRAGON_GOD_1 and\
+				not type == chr.AFFECT_DRAGON_GOD_2 and\
+				not type == chr.AFFECT_DRAGON_GOD_3 and\
+				not type == chr.AFFECT_DRAGON_GOD_4 and\
+				not type == chr.AFFECT_CRITICAL and\
+				not type == chr.AFFECT_PENETRATE and\
+				not type == chr.AFFECT_ATTACK_SPEED and\
+				not type == chr.AFFECT_MOVE_SPEED and\
+				not type == chr.AFFECT_RESEARCHER_ELIXIR:
+				return
+		else:
+			if type < 500:
 				return
 
 		if type == chr.NEW_AFFECT_MALL:
@@ -711,12 +618,6 @@
 			affect = type
 
 		if self.affectImageDict.has_key(affect):
-			if app.ENABLE_SET_ITEM and affect == chr.NEW_AFFECT_SET_ITEM or affect >= chr.NEW_AFFECT_SET_ITEM_SET_VALUE_1 and affect <= chr.NEW_AFFECT_SET_ITEM_SET_VALUE_5:
-				self.affectImageDict[affect].UpdateSetItemDescription(affect)
-
-			if app.ENABLE_SNOWFLAKE_STICK_EVENT and affect == chr.NEW_AFFECT_SNOWFLAKE_STICK_EVENT_SNOWFLAKE_BUFF:
-				self.affectImageDict[affect].UpdateSnowflakeStickEventSnowflakeBuffDescription()
-
 			return
 
 		if not self.AFFECT_DATA_DICT.has_key(affect):
@@ -738,81 +639,73 @@
 			pointIdx == player.POINT_MALL_GOLDBONUS:
 			value = float(value) * 100.0 / 100.0 # 1 + float(value) / 100.0
 
-		if affect == chr.NEW_AFFECT_SAFE_BOX_BUFF:
-			if pointIdx == player.POINT_MALL_EXPBONUS:
-				description = localeInfo.TOOLTIP_AFFECT_SAFEBOX_BUFF_01
-
-			elif pointIdx == player.POINT_MALL_DEFBONUS:
-				description = localeInfo.TOOLTIP_AFFECT_SAFEBOX_BUFF_02
-
-			elif pointIdx == player.POINT_MAX_HP_PCT:
-				description = localeInfo.TOOLTIP_AFFECT_SAFEBOX_BUFF_03
-
-			elif pointIdx == player.POINT_ATTBONUS_MONSTER:
-				description = localeInfo.TOOLTIP_AFFECT_SAFEBOX_BUFF_04
+		trashValue = 123
+		#if affect == chr.NEW_AFFECT_AUTO_SP_RECOVERY or affect == chr.NEW_AFFECT_AUTO_HP_RECOVERY:
+		if trashValue == 1:
+			try:
+				#image = AutoPotionImage()
+				#image.SetParent(self)
+				image = None
+
+				if affect == chr.NEW_AFFECT_AUTO_SP_RECOVERY:
+					image.SetPotionType(player.AUTO_POTION_TYPE_SP)
+					image = self.autoPotionImageSP
+					#self.autoPotionImageSP = image;
+				else:
+					image.SetPotionType(player.AUTO_POTION_TYPE_HP)
+					image = self.autoPotionImageHP
+					#self.autoPotionImageHP = image;
+
+				image.SetParent(self)
+				image.Show()
+				image.OnUpdateAutoPotionImage()
 
-			else:
-				description = affectData[0]
+				self.affectImageDict[affect] = image
+				self.__ArrangeImageList()
 
-		if affect != chr.NEW_AFFECT_AUTO_SP_RECOVERY and affect != chr.NEW_AFFECT_AUTO_HP_RECOVERY:
-			if app.ENABLE_FLOWER_EVENT:
-				if affect == chr.NEW_AFFECT_FLOWER_EVENT:
-					description = uiToolTip.ItemToolTip().GetAffectString(item.GetPointApply(pointIdx), float(value))
-				elif value != 0:
-					description = description(float(value))
-			else:
+			except Exception, e:
+				print "except Aff auto potion affect ", e
+				pass
+		else:
+			if affect != chr.NEW_AFFECT_AUTO_SP_RECOVERY and affect != chr.NEW_AFFECT_AUTO_HP_RECOVERY:
 				description = description(float(value))
 
-		try:
-			print "Add affect %s" % affect
-			image = AffectImage()
-			image.SetParent(self)
-			image.LoadImage(filename)
-			image.SetDescription(description)
-			image.SetDuration(duration)
-			image.SetAffect(affect)
-
-			if app.ENABLE_SET_ITEM and affect == chr.NEW_AFFECT_SET_ITEM or affect >= chr.NEW_AFFECT_SET_ITEM_SET_VALUE_1 and affect <= chr.NEW_AFFECT_SET_ITEM_SET_VALUE_5:
-				image.SetClock(False)
-				image.UpdateSetItemDescription(affect)
-
-			elif app.ENABLE_SNOWFLAKE_STICK_EVENT and affect == chr.NEW_AFFECT_SNOWFLAKE_STICK_EVENT_SNOWFLAKE_BUFF:
-				image.SetClock(False)
-				image.UpdateSnowflakeStickEventSnowflakeBuffDescription()
-
-			elif affect == chr.NEW_AFFECT_EXP_BONUS_EURO_FREE or\
-				affect == chr.NEW_AFFECT_EXP_BONUS_EURO_FREE_UNDER_15 or\
-				self.INFINITE_AFFECT_DURATION < duration:
-				image.SetClock(False)
-				image.UpdateDescription()
-
-			elif affect == chr.NEW_AFFECT_AUTO_SP_RECOVERY or affect == chr.NEW_AFFECT_AUTO_HP_RECOVERY:
-				image.UpdateAutoPotionDescription()
-
-			elif affect == chr.NEW_AFFECT_MOUNT_FALL:
-				image.SetClock(False)
-				image.UpdateDescription()
-
-			elif affect == chr.NEW_AFFECT_RESEARCHER_ELIXIR:
-				image.SetClock(False)
-				image.UpdateDescription()
-
-			else:
-				image.UpdateDescription()
+			try:
+				print "Add affect %s" % affect
+				image = AffectImage()
+				image.SetParent(self)
+				image.LoadImage(filename)
+				image.SetDescription(description)
+				image.SetDuration(duration)
+				image.SetAffect(affect)
+
+				if affect == chr.NEW_AFFECT_EXP_BONUS_EURO_FREE or\
+					affect == chr.NEW_AFFECT_EXP_BONUS_EURO_FREE_UNDER_15 or\
+					self.INFINITE_AFFECT_DURATION < duration:
+					image.SetClock(False)
+					image.UpdateDescription()
+				elif affect == chr.NEW_AFFECT_AUTO_SP_RECOVERY or affect == chr.NEW_AFFECT_AUTO_HP_RECOVERY:
+					image.UpdateAutoPotionDescription()
+				#elif app.ENABLE_RESEARCHER_ELIXIR_FIX and affect == chr.NEW_AFFECT_RESEARCHER_ELIXIR:
+				elif affect == chr.AFFECT_RESEARCHER_ELIXIR:
+					image.SetClock(False)
+					image.UpdateDescription()
+				else:
+					image.UpdateDescription()
 
-			if affect == chr.NEW_AFFECT_DRAGON_SOUL_DECK1 or affect == chr.NEW_AFFECT_DRAGON_SOUL_DECK2:
-				image.SetScale(1, 1)
-			else:
-				image.SetScale(0.7, 0.7)
+				if affect == chr.NEW_AFFECT_DRAGON_SOUL_DECK1 or affect == chr.NEW_AFFECT_DRAGON_SOUL_DECK2:
+					image.SetScale(1, 1)
+				else:
+					image.SetScale(0.7, 0.7)
 
-			image.SetSkillAffectFlag(False)
-			image.Show()
-			self.affectImageDict[affect] = image
-			self.__ArrangeImageList()
+				image.SetSkillAffectFlag(FALSE)
+				image.Show()
+				self.affectImageDict[affect] = image
+				self.__ArrangeImageList()
 
-		except Exception, e:
-			print "except Aff affect ", e
-			pass
+			except Exception, e:
+				print "except Aff affect ", e
+				pass
 
 	def BINARY_NEW_RemoveAffect(self, type, pointIdx):
 		if type == chr.NEW_AFFECT_MALL:
@@ -824,53 +717,6 @@
 		self.__RemoveAffect(affect)
 		self.__ArrangeImageList()
 
-	def BINARY_NEW_UpdateAffect(self, type, point_type, value, duration):
-		if type == chr.NEW_AFFECT_MALL:
-			affect = self.MALL_DESC_IDX_START + pointIdx
-		else:
-			affect = type
-
-		if not self.AFFECT_DATA_DICT.has_key(affect):
-			print("BINARY_NEW_UpdateAffect type not found %d" % affect)
-			return
-
-		affectData = self.AFFECT_DATA_DICT[affect]
-		description = affectData[0]
-
-		if point_type == player.POINT_MALL_ITEMBONUS or\
-			point_type == player.POINT_MALL_GOLDBONUS:
-			value = float(value) * 100.0 / 100.0 # 1 + float(value) / 100.0
-
-		if affect == chr.NEW_AFFECT_SAFE_BOX_BUFF:
-			if point_type == player.POINT_MALL_EXPBONUS:
-				description = localeInfo.TOOLTIP_AFFECT_SAFEBOX_BUFF_01
-			elif point_type == player.POINT_MALL_DEFBONUS:
-				description = localeInfo.TOOLTIP_AFFECT_SAFEBOX_BUFF_02
-			elif point_type == player.POINT_MAX_HP_PCT:
-				description = localeInfo.TOOLTIP_AFFECT_SAFEBOX_BUFF_03
-			elif point_type == player.POINT_ATTBONUS_MONSTER:
-				description = localeInfo.TOOLTIP_AFFECT_SAFEBOX_BUFF_04
-			else:
-				description = affectData[0]
-
-		if self.affectImageDict.has_key(affect):
-			image = self.affectImageDict[affect]
-
-			if affect != chr.NEW_AFFECT_AUTO_SP_RECOVERY and affect != chr.NEW_AFFECT_AUTO_HP_RECOVERY:
-				if app.ENABLE_FLOWER_EVENT:
-					if affect == chr.NEW_AFFECT_FLOWER_EVENT:
-						description = uiToolTip.ItemToolTip().GetAffectString(item.GetPointApply(point_type), float(value))
-					else:
-						description = description(float(value))
-				else:
-					description = description(float(value))
-
-			image.SetDescription(description)
-			image.SetDuration(duration)
-			image.UpdateDescription()
-		else:
-			print("BINARY_NEW_UpdateAffect affectImageDict not found %d" % affect)
-
 	def SetAffect(self, affect):
 		self.__AppendAffect(affect)
 		self.__ArrangeImageList()
@@ -905,7 +751,7 @@
 			self.lovePointImage.OnUpdateLovePoint(lovePoint)
 
 	def SetHorseState(self, level, health, battery):
-		if level == 0:
+		if level==0:
 			self.horseImage = None
 		else:
 			image = HorseImage()
@@ -913,9 +759,8 @@
 			image.SetState(level, health, battery)
 			image.Show()
 
-			self.horseImage = image
-
-		self.__ArrangeImageList()
+			self.horseImage=image
+			self.__ArrangeImageList()
 
 	def SetPlayTime(self, playTime):
 		self.serverPlayTime = playTime
@@ -958,19 +803,27 @@
 
 		image = AffectImage()
 		image.SetParent(self)
-		image.SetSkillAffectFlag(True)
+		image.SetSkillAffectFlag(TRUE)
 
 		try:
 			image.LoadImage(filename)
 		except:
 			pass
 
-		image.SetToolTipText(name, AFFECT_TOOLTIP_POS_X, AFFECT_TOOLTIP_POS_Y)
+		image.SetToolTipText(name, 0, 40)
 		image.SetScale(0.7, 0.7)
 		image.Show()
 		self.affectImageDict[affect] = image
 
 	def __RemoveAffect(self, affect):
+		"""
+		if affect == chr.NEW_AFFECT_AUTO_SP_RECOVERY:
+			self.autoPotionImageSP.Hide()
+
+		if affect == chr.NEW_AFFECT_AUTO_HP_RECOVERY:
+			self.autoPotionImageHP.Hide()
+		"""
+
 		if not self.affectImageDict.has_key(affect):
 			#print "__RemoveAffect %s ( No Affect )" % affect
 			return
@@ -988,62 +841,64 @@
 
 		if self.horseImage:
 			width += self.IMAGE_STEP
-
 		if app.ENABLE_CONQUEROR_LEVEL:
 			if self.sungmaImage:
 				width += self.IMAGE_STEP
+		if app.ENABLE_GROWTH_PET_SYSTEM:
+			width += len(self.petSkillaffectImageDict) * self.IMAGE_STEP
 
 		self.SetSize(width, 26)
 
 		xPos = 0
 
+		if app.ENABLE_GROWTH_PET_SYSTEM:
+			tempDict = {}
+			for value in self.petSkillaffectImageDict.values():
+				tempDict[value[0]] = value[1]
+			
+			for value in range(1,4):
+				if tempDict.has_key(value):
+					tempDict[value].SetPosition(xPos, 0)
+					xPos += self.IMAGE_STEP
+
+		if osfInfo.ALIGN_AFFECT_IMG_LIST:
+			yPos = 0
+			AffectCount = 0
+
 		if self.lovePointImage:
 			if self.lovePointImage.IsShow():
 				self.lovePointImage.SetPosition(xPos, 0)
 				xPos += self.IMAGE_STEP
+				if osfInfo.ALIGN_AFFECT_IMG_LIST:
+					AffectCount += 1
 
 		if self.horseImage:
 			self.horseImage.SetPosition(xPos, 0)
 			xPos += self.IMAGE_STEP
+			if osfInfo.ALIGN_AFFECT_IMG_LIST:
+				AffectCount += 1
 
 		if app.ENABLE_CONQUEROR_LEVEL:
 			if self.sungmaImage:
 				self.sungmaImage.SetPosition(xPos, 0)
 				xPos += self.IMAGE_STEP
+				if osfInfo.ALIGN_AFFECT_IMG_LIST:
+					AffectCount += 1
 
 		for image in self.affectImageDict.values():
-			image.SetPosition(xPos, 0)
+			if osfInfo.ALIGN_AFFECT_IMG_LIST:
+				image.SetPosition(xPos, yPos)
+				AffectCount += 1
+			else:
+				image.SetPosition(xPos, 0)
 			xPos += self.IMAGE_STEP
 
-	def OnUpdate(self):
-		try:
-			# MT-342 둔갑시 시간 표시 버그
-			if app.GetGlobalTimeStamp() > self.lastUpdateTime:
-			#if app.GetGlobalTime() - self.lastUpdateTime > 500:
-			#if 0 < app.GetGlobalTime():
-				# MT-342 둔갑시 시간 표시 버그
-				#self.lastUpdateTime = app.GetGlobalTime()
-				self.lastUpdateTime = app.GetGlobalTimeStamp()
-
-				for image in self.affectImageDict.values():
-					if image.GetAffect() == chr.NEW_AFFECT_AUTO_HP_RECOVERY or image.GetAffect() == chr.NEW_AFFECT_AUTO_SP_RECOVERY:
-						image.UpdateAutoPotionDescription()
-						continue
+			if osfInfo.ALIGN_AFFECT_IMG_LIST:
+				if AffectCount % 10 == 0:
+					yPos += self.IMAGE_STEP
+					xPos = 0
 
-					if app.ENABLE_SET_ITEM:
-						if image.GetAffect() == chr.NEW_AFFECT_SET_ITEM or image.GetAffect() >= chr.NEW_AFFECT_SET_ITEM_SET_VALUE_1 and image.GetAffect() <= chr.NEW_AFFECT_SET_ITEM_SET_VALUE_5:
-							continue
-
-					if app.ENABLE_SNOWFLAKE_STICK_EVENT:
-						if image.GetAffect() == chr.NEW_AFFECT_SNOWFLAKE_STICK_EVENT_SNOWFLAKE_BUFF:
-							image.UpdateSnowflakeStickEventSnowflakeBuffDescription(True)
-							continue
-
-					if not image.IsSkillAffect():
-						image.UpdateDescription()
-
-		except Exception, e:
-			print "AffectShower::OnUpdate error : ", e
+				self.SetSize(10 * self.IMAGE_STEP, yPos + self.IMAGE_STEP)
 
 	if app.ENABLE_GROWTH_PET_SYSTEM:
 		def SetPetSkillAffect(self, index, affect):
@@ -1086,3 +941,24 @@
 			self.petSkillaffectImageDict[affect] = [index, image]
 			
 			return True
+
+	def OnUpdate(self):
+		try:
+			# MT-342 둔갑시 시간 표시 버그
+			if app.GetGlobalTimeStamp() > self.lastUpdateTime:
+			#if app.GetGlobalTime() - self.lastUpdateTime > 500:
+			#if 0 < app.GetGlobalTime():
+				# MT-342 둔갑시 시간 표시 버그
+				#self.lastUpdateTime = app.GetGlobalTime()
+				self.lastUpdateTime = app.GetGlobalTimeStamp()
+
+				for image in self.affectImageDict.values():
+					if image.GetAffect() == chr.NEW_AFFECT_AUTO_HP_RECOVERY or image.GetAffect() == chr.NEW_AFFECT_AUTO_SP_RECOVERY:
+						image.UpdateAutoPotionDescription()
+						continue
+
+					if not image.IsSkillAffect():
+						image.UpdateDescription()
+
+		except Exception, e:
+			print "AffectShower::OnUpdate error : ", e
diff -ruN client_base/client/client/pack/root/uicommon.py client_final/client/client/pack/root/uicommon.py
--- client_base/client/client/pack/root/uicommon.py	2026-02-13 09:22:34.000000000 +0000
+++ client_final/client/client/pack/root/uicommon.py	2026-02-20 18:13:16.385236415 +0000
@@ -11,9 +11,6 @@
 if app.ENABLE_NEW_DROP_DIALOG:
 	import item, uiToolTip
 
-if app.ENABLE_MOUSE_WHEEL_TOP_WINDOW:
-	import wndMgr
-
 class PopupDialog(ui.ScriptWindow):
 	def __init__(self):
 		ui.ScriptWindow.__init__(self)
@@ -63,6 +60,9 @@
 
 	def SetText(self, text):
 		self.message.SetText(text)
+		
+		if text:
+			self.message.SetPosition(0, 38 - (self.message.GetTextLineCount() - 1) * 12)
 
 	def SetAcceptEvent(self, event):
 		self.acceptEvent = event
@@ -82,7 +82,7 @@
 		if self.message:
 			return self.message.GetTextSize()
 
-		return (0, 0)
+		return (0,0)
 
 	def GetLineHeight(self):
 		if self.message:
@@ -96,109 +96,6 @@
 	def GetTextLineCount(self):
 		return self.message.GetTextLineCount()
 
-	if app.ENABLE_MINI_GAME_YUTNORI:
-		def SetButtonNameAutoSize(self, name):
-			self.accceptButton.SetAutoSizeText(name)
-
-		def SetButtonHorizontalAlignCenter(self):
-			self.accceptButton.SetWindowHorizontalAlignCenter()
-
-		def SetButtonUpVisual(self, filename):
-			self.accceptButton.SetUpVisual(filename)
-
-		def SetButtonOverVisual(self, filename):
-			self.accceptButton.SetOverVisual(filename)
-
-		def SetButtonDownVisual(self, filename):
-			self.accceptButton.SetDownVisual(filename)
-
-if app.ENABLE_MINI_GAME_YUTNORI:
-	class PopupDialog2(ui.ScriptWindow):
-
-		def __init__(self):
-			ui.ScriptWindow.__init__(self)
-			self.__LoadDialog()
-			self.acceptEvent = lambda *arg: None
-
-		def __del__(self):
-			ui.ScriptWindow.__del__(self)
-
-		def __LoadDialog(self):
-			try:
-				PythonScriptLoader = ui.PythonScriptLoader()
-				PythonScriptLoader.LoadScriptFile(self, "UIScript/PopupDialog2.py")
-
-				self.board = self.GetChild("board")
-				self.message1 = self.GetChild("message1")
-				self.message2 = self.GetChild("message2")
-				self.accceptButton = self.GetChild("accept")
-				self.accceptButton.SetEvent(ui.__mem_func__(self.Close))
-
-			except:
-				import exception
-				exception.Abort("PopupDialog2.LoadDialog.BindObject")
-
-		def Open(self):
-			self.SetCenterPosition()
-			self.SetTop()
-			self.Show()
-
-		def Close(self):
-			self.Hide()
-			self.acceptEvent()
-
-		def Destroy(self):
-			self.Close()
-			self.ClearDictionary()
-
-		def SetWidth(self, width):
-			height = self.GetHeight()
-			self.SetSize(width, height)
-
-			if self.board.IsRTL():
-				self.board.SetPosition(width, 0)
-
-			self.board.SetSize(width, height)
-			self.SetCenterPosition()
-			self.UpdateRect()
-
-		def SetText1(self, text):
-			self.message1.SetText(text)
-		def SetText2(self, text):
-			self.message2.SetText(text)
-
-		def SetAcceptEvent(self, event):
-			self.acceptEvent = event
-
-		def SetButtonName(self, name):
-			self.accceptButton.SetText(name)
-
-		def OnPressEscapeKey(self):
-			self.Close()
-			return True
-
-		def OnIMEReturn(self):
-			self.Close()
-			return True
-
-		def GetTextSize(self):
-			if self.message1:
-				return self.message1.GetTextSize()
-
-			return (0,0)
-
-		def GetLineHeight(self):
-			if self.message1:
-				return self.message1.GetLineHeight()
-
-			return 0
-
-		def SetLineHeight(self, Height):
-			self.message1.SetLineHeight(Height)
-
-		def GetTextLineCount(self):
-			return self.message1.GetTextLineCount()
-
 class InputDialog(ui.ScriptWindow):
 	def __init__(self):
 		ui.ScriptWindow.__init__(self)
@@ -292,7 +189,7 @@
 
 	def __CreateDialog(self):
 		pyScrLoader = ui.PythonScriptLoader()
-		if localeInfo.IsARABIC():
+		if localeInfo.IsARABIC() :
 			pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "inputdialogwithdescription.py")
 		else:
 			pyScrLoader.LoadScriptFile(self, "uiscript/inputdialogwithdescription.py")
@@ -351,17 +248,9 @@
 		ui.ScriptWindow.__init__(self)
 		self.__CreateDialog()
 
-		if app.ENABLE_GAME_OPTION_ESCAPE:
-			self.accept_event_func = None
-			self.cancel_event_func = None
-
 	def __del__(self):
 		ui.ScriptWindow.__del__(self)
 
-		if app.ENABLE_GAME_OPTION_ESCAPE:
-			self.accept_event_func = None
-			self.cancel_event_func = None
-
 	def __CreateDialog(self):
 		pyScrLoader = ui.PythonScriptLoader()
 		pyScrLoader.LoadScriptFile(self, "uiscript/questiondialog.py")
@@ -391,28 +280,23 @@
 		self.UpdateRect()
 
 	def SAFE_SetAcceptEvent(self, event):
-		if app.ENABLE_GAME_OPTION_ESCAPE:
-			self.accept_event_func = ui.__mem_func__(event)
 		self.acceptButton.SAFE_SetEvent(event)
 
 	def SAFE_SetCancelEvent(self, event):
-		if app.ENABLE_GAME_OPTION_ESCAPE:
-			self.cancel_event_func = ui.__mem_func__(event)
 		self.cancelButton.SAFE_SetEvent(event)
 
 	def SetAcceptEvent(self, event):
-		if app.ENABLE_GAME_OPTION_ESCAPE:
-			self.accept_event_func = event
 		self.acceptButton.SetEvent(event)
 
 	def SetCancelEvent(self, event):
-		if app.ENABLE_GAME_OPTION_ESCAPE:
-			self.cancel_event_func = event
 		self.cancelButton.SetEvent(event)
 
 	def SetText(self, text):
 		self.textLine.SetText(text)
 
+		if text:
+			self.textLine.SetPosition(0, 38 - (self.textLine.GetTextLineCount() - 1) * 10)
+
 	def SetAcceptText(self, text):
 		self.acceptButton.SetText(text)
 
@@ -420,11 +304,8 @@
 		self.cancelButton.SetText(text)
 
 	def OnPressEscapeKey(self):
-		if app.ENABLE_GAME_OPTION_ESCAPE:
-			if self.cancel_event_func:
-				apply(self.cancel_event_func)
-
 		self.Close()
+		self.cancelButton.CallEvent()
 		return True
 
 	def GetTextSize(self):
@@ -439,29 +320,31 @@
 
 		return 0
 
-	if app.WJ_MULTI_TEXTLINE:
-		def SetLineHeight(self, height):
-			self.textLine.SetLineHeight(height)
+	def SetLineHeight(self, Height):
+		self.textLine.SetLineHeight(Height)
 
-			x_accept, y_accept = self.acceptButton.GetLocalPosition()
-			self.acceptButton.SetPosition(x_accept, y_accept + height)
+	def GetTextLineCount(self):
+		return self.textLine.GetTextLineCount()
 
-			x_cancel, y_cancel = self.cancelButton.GetLocalPosition()
-			self.cancelButton.SetPosition(x_cancel, y_cancel + height)
+		return True
 
-			height_board = self.GetHeight() + height
-			width_board = self.GetWidth()
-			self.SetSize(width_board, height_board)
+	def GetTextSize(self):
+		if self.textLine:
+			return self.textLine.GetTextSize()
 
-			if self.board.IsRTL():
-				self.board.SetPosition(width_board, 0)
+		return (0,0)
 
-			self.board.SetSize(width_board, height_board)
-			self.SetCenterPosition()
-			self.UpdateRect()
+	def GetLineHeight(self):
+		if self.textLine:
+			return self.textLine.GetLineHeight()
+
+		return 0
 
-		def GetTextLineCount(self):
-			return self.textLine.GetTextLineCount()
+	def SetLineHeight(self, Height):
+		self.textLine.SetLineHeight(Height)
+
+	def GetTextLineCount(self):
+		return self.textLine.GetTextLineCount()
 
 class QuestionDialog2(QuestionDialog):
 	def __init__(self):
@@ -500,47 +383,6 @@
 				
 			return (0,0)
 
-class QuestionDialog3(QuestionDialog):
-	def __init__(self):
-		QuestionDialog.__init__(self)
-		self.__CreateDialog()
-
-	def __del__(self):
-		QuestionDialog.__del__(self)
-
-	def __CreateDialog(self):
-		pyScrLoader = ui.PythonScriptLoader()
-		pyScrLoader.LoadScriptFile(self, "uiscript/questiondialog3.py")
-
-		self.board = self.GetChild("board")
-		self.textLine1 = self.GetChild("message1")
-		self.textLine2 = self.GetChild("message2")
-		self.textLine3 = self.GetChild("message3")
-		self.acceptButton = self.GetChild("accept")
-		self.cancelButton = self.GetChild("cancel")
-
-	def SetText1(self, text):
-		self.textLine1.SetText(text)
-
-	def SetText2(self, text):
-		self.textLine2.SetText(text)
-		
-	def SetText3(self, text):
-		self.textLine3.SetText(text)
-		
-	if app.ENABLE_GROWTH_PET_SYSTEM:
-		def GetTextSize1(self):
-			if self.textLine1:
-				return self.textLine1.GetTextSize()
-				
-			return (0,0)
-			
-		def GetTextSize2(self):
-			if self.textLine2:
-				return self.textLine2.GetTextSize()
-				
-			return (0,0)
-
 class QuestionDialogWithTimeLimit(QuestionDialog2):
 	def __init__(self):
 		ui.ScriptWindow.__init__(self)
@@ -574,7 +416,7 @@
 	def OnUpdate(self):
 		leftTime = max(0, self.endTime - app.GetTime())
 		self.SetText2(localeInfo.UI_LEFT_TIME % (leftTime))
-		if leftTime < 0.5:
+		if leftTime<0.5:
 			if self.timeoverMsg:
 				chat.AppendChat(chat.CHAT_TYPE_INFO, self.timeoverMsg)
 			if self.isCancelOnTimeover:
@@ -586,25 +428,16 @@
 	def SetCancelOnTimeOver(self):
 		self.isCancelOnTimeover = True
 
-	def OnPressEscapeKey(self):
-		if self.cancelButton:
-			self.cancelButton.CallEvent()
-
-		self.Close()
-		return True
-
 if app.ENABLE_NEW_DROP_DIALOG:
 	class QuestionDropDialog(ui.ScriptWindow):
 		def __init__(self):
 			ui.ScriptWindow.__init__(self)
-			self.__LoadWindow()
+			self.__CreateDialog()
 
 		def __del__(self):
 			ui.ScriptWindow.__del__(self)
-			del self.itemSlot
-			del self.itemToolTip
 
-		def __LoadWindow(self):
+		def __CreateDialog(self):
 			pyScrLoader = ui.PythonScriptLoader()
 			pyScrLoader.LoadScriptFile(self, "uiscript/questiondropdialog.py")
 
@@ -613,24 +446,25 @@
 			self.acceptButton = self.GetChild("accept")
 			self.destroyButton = self.GetChild("destroy")
 			self.cancelButton = self.GetChild("cancel")
-
 			self.itemSlot = self.GetChild("ItemSlot")
-			self.itemSlot.SetOverInItemEvent(ui.__mem_func__(self.__OnOverInItem))
-			self.itemSlot.SetOverOutItemEvent(ui.__mem_func__(self.__OnOverOutItem))
-
-		def SetItemSlot(self, wndType, slotIndex):
-			itemIndex = player.GetItemIndex(wndType, slotIndex)
-			itemCount = player.GetItemCount(wndType, slotIndex)
+			self.itemSlot.SetOverInItemEvent(ui.__mem_func__(self.OverInItem))
+			self.itemSlot.SetOverOutItemEvent(ui.__mem_func__(self.OverOutItem))
 
+		def SetItemSlot(self, slotIndex):
+			itemIndex = player.GetItemIndex(slotIndex)
+			itemCount = player.GetItemCount(slotIndex)
 			self.itemSlot.SetItemSlot(0, itemIndex, itemCount)
-
 			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				if not player.GetChangeLookVnum(wndType, slotIndex) == 0:
-					self.itemSlot.SetSlotCoverImage(slotIndex, "icon/item/ingame_convert_Mark.tga")
+				changelookvnum = player.GetItemTransmutation(slotIndex)
+				if changelookvnum:
+					self.itemSlot.DisableCoverButton(0)
 				else:
-					self.itemSlot.EnableSlotCoverImage(slotIndex, False)
+					self.itemSlot.EnableCoverButton(0)
+
+			item.SelectItem(player.GetItemIndex(slotIndex))
 
-			item.SelectItem(itemIndex)
+			metinSlot = [player.GetItemMetinSocket(slotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
+			attrSlot = [player.GetItemAttribute(slotIndex, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
 
 			if item.IsAntiFlag(item.ITEM_ANTIFLAG_DROP):
 				self.acceptButton.Down()
@@ -640,28 +474,18 @@
 				self.destroyButton.Down()
 				self.destroyButton.Disable()
 
-			if app.ENABLE_SOULBIND_SYSTEM:
-				if player.GetItemSealDate(wndType, slotIndex) != item.E_SEAL_DATE_DEFAULT_TIMESTAMP:
-
+			if app.ENABLE_SOUL_BIND_SYSTEM:
+				if player.GetItemSealDate(player.INVENTORY, slotIndex) == -1 or player.GetItemSealDate(player.INVENTORY, slotIndex) > 0:
 					self.acceptButton.Down()
 					self.acceptButton.Disable()
-
 					self.destroyButton.Down()
 					self.destroyButton.Disable()
 
 			self.itemToolTip = uiToolTip.ItemToolTip()
-			self.itemToolTip.SetInventoryItem(slotIndex, wndType)
-
-		def __OnOverInItem(self, slotIndex):
-			if self.itemToolTip:
-				self.itemToolTip.ShowToolTip()
-
-		def __OnOverOutItem(self):
-			if self.itemToolTip:
-				self.itemToolTip.HideToolTip()
+			self.itemToolTip.SetInventoryItem(slotIndex) # 2019.02.11.owsap
 
 		def Open(self):
-			if self.itemToolTip:
+			if 0 != self.itemToolTip:
 				self.itemToolTip.HideToolTip()
 
 			self.SetCenterPosition()
@@ -669,27 +493,54 @@
 			self.Show()
 
 		def Close(self):
-			if self.itemToolTip:
+			if 0 != self.itemToolTip:
 				self.itemToolTip.HideToolTip()
 
 			self.Hide()
 
-		def OnPressEscapeKey(self):
-			self.Close()
-			return True
+		def SetDlgSize(self, width, height):
+			self.SetSize(width, height)
+			self.board.SetSize(width, height)
+			self.SetCenterPosition()
+			self.UpdateRect()
 
-		def SetText(self, text):
-			self.textLine.SetText(text)
+		def OverInItem(self, slotNumber):
+			if 0 != self.itemToolTip:
+				self.itemToolTip.ShowToolTip()
 
-		def SetAcceptEvent(self, event):
-			self.acceptButton.SetEvent(event)
+		def OverOutItem(self):
+			if 0 != self.itemToolTip:
+				self.itemToolTip.HideToolTip()
+
+		def SAFE_SetAcceptEvent(self, event):
+			self.acceptButton.SAFE_SetEvent(event)
+
+		def SAFE_SetCancelEvent(self, event):
+			self.cancelButton.SAFE_SetEvent(event)
 
 		def SetDestroyEvent(self, event):
 			self.destroyButton.SetEvent(event)
 
+		def SetAcceptEvent(self, event):
+			self.acceptButton.SetEvent(event)
+
 		def SetCancelEvent(self, event):
 			self.cancelButton.SetEvent(event)
 
+		def SetText(self, text):
+			self.textLine.SetText(text)
+			# self.textLine.SetFontColor(0.72, 1.0, 0.0)
+
+		def SetAcceptText(self, text):
+			self.acceptButton.SetText(text)
+
+		def SetCancelText(self, text):
+			self.cancelButton.SetText(text)
+
+		def OnPressEscapeKey(self):
+			self.Close()
+			return True
+
 class MoneyInputDialog(ui.ScriptWindow):
 	def __init__(self):
 		ui.ScriptWindow.__init__(self)
@@ -697,14 +548,14 @@
 		self.moneyHeaderText = localeInfo.MONEY_INPUT_DIALOG_SELLPRICE
 		self.__CreateDialog()
 
-		self.SetMaxLength(10)
+		self.SetMaxLength(9)
 
 	def __del__(self):
 		ui.ScriptWindow.__del__(self)
 
 	def __CreateDialog(self):
 		pyScrLoader = ui.PythonScriptLoader()
-		pyScrLoader.LoadScriptFile(self, "UIScript/MoneyInputDialog.py")
+		pyScrLoader.LoadScriptFile(self, "uiscript/moneyinputdialog.py")
 
 		getObject = self.GetChild
 		self.board = self.GetChild("board")
@@ -748,7 +599,7 @@
 		self.inputValue.SetFocus()
 
 	def SetMaxLength(self, length):
-		length = min(10, length)
+		length = min(9, length)
 
 		self.inputValue.SetMax(length)
 
@@ -765,20 +616,20 @@
 		self.inputValue.OnPressEscapeKey = event
 
 	def SetValue(self, value):
-		value = str(value)
+		value=str(value)
 		self.inputValue.SetText(value)
 		self.__OnValueUpdate()
-		ime.SetCursorPosition(len(value) + 1)
+		ime.SetCursorPosition(len(value)+1)
 
 	def GetText(self):
 		return self.inputValue.GetText()
 
 	if app.ENABLE_CHEQUE_SYSTEM:
 		def SetCheque(self, cheque):
-			cheque = str(cheque)
+			cheque=str(cheque)
 			self.inputChequeValue.SetText(cheque)
 			self.__OnValueUpdate()
-			ime.SetCursorPosition(len(cheque) + 1)
+			ime.SetCursorPosition(len(cheque)+1)
 
 		def __ClickChequeEditLine(self):
 			self.inputChequeValue.SetFocus()
@@ -811,8 +662,8 @@
 				try:
 					money = int(text)
 
-					if money >= player.GOLD_MAX:
-						money = player.GOLD_MAX - 1
+					if money >= 2000000000:
+						money = 2000000000 - 1
 						self.inputValue.SetText(str(money))
 				except ValueError:
 					money = 0
@@ -821,8 +672,8 @@
 				try:
 					cheque = int(cheque_text)
 
-					if cheque > player.CHEQUE_MAX:
-						cheque = player.CHEQUE_MAX
+					if cheque >= 100:
+						cheque = 100 - 1
 						self.inputChequeValue.SetText(str(cheque))
 				except ValueError:
 					cheque = 0
@@ -845,159 +696,175 @@
 
 			self.moneyText.SetText(self.moneyHeaderText + localeInfo.NumberToMoneyString(money))
 
-if app.ENABLE_EVENT_BANNER:
-	class RewardListDialog(ui.ScriptWindow):
+class InputPinCodeDialog(ui.ScriptWindow):
+	PIN_CODE_TOOLTIP = [
+		localeInfo.PIN_CODE_TOOLTIP_LINE1,
+		localeInfo.PIN_CODE_TOOLTIP_LINE2,
+		localeInfo.PIN_CODE_TOOLTIP_LINE3,
+		localeInfo.PIN_CODE_TOOLTIP_LINE4,
+		localeInfo.PIN_CODE_TOOLTIP_LINE5
+	]
 
-		REWARD_LIST_WIDTH_COUNT = 5
-		SHOW_REWARD_LIMIT_COUNT = 25
+	def __init__(self):
+		ui.ScriptWindow.__init__(self)
+		self.__CreateDialog()
 
-		def __init__(self):
-			ui.ScriptWindow.__init__(self)
+	def __del__(self):
+		ui.ScriptWindow.__del__(self)
 
-			self.called_window = None
-			self.reward_slot_window = None
-			self.reward_tooltip = None
-			self.scroll_bar = None
-			self.cur_scroll_bar_index = 0
-			self.item_data_dict = {}
+	def __CreateDialog(self):
+		pyScrLoader = ui.PythonScriptLoader()
+		pyScrLoader.LoadScriptFile(self, "UIScript/InputPinCodeDialog.py")
 
-			self.__LoadWindow()
+		getObject = self.GetChild
+		self.board = getObject("Board")
+		self.pinCodeSlot = getObject("PinCodeSlot")
+		self.pinCodeValue = getObject("PinCodeValue")
+		self.acceptButton = getObject("AcceptButton")
+		self.cancelButton = getObject("CancelButton")
+		self.toolTipButton = getObject("ToolTipButton")
+		self.toolTip = self.CreateToolTip(localeInfo.INPUT_PIN_CODE_DIALOG_TITLE, self.PIN_CODE_TOOLTIP)
+		self.toolTip.SetTop()
+		self.toolTipButton.SetToolTipWindow(self.toolTip)
+
+	def CreateToolTip(self, title, descList):
+		toolTip = uiToolTip.ToolTip()
+		toolTip.SetTitle(title)
+		toolTip.AppendSpace(7)
+
+		for desc in descList:
+			toolTip.AutoAppendTextLine(desc)
+
+		toolTip.AlignHorizonalCenter()
+		toolTip.SetTop()
+		return toolTip
 
-		def __del__(self):
-			ui.ScriptWindow.__del__(self)
+	def Open(self):
+		self.pinCodeValue.SetFocus()
+		self.SetCenterPosition()
+		self.SetTop()
+		self.Show()
 
-		def __LoadWindow(self):
-			try:
-				pyScrLoader = ui.PythonScriptLoader()
-				pyScrLoader.LoadScriptFile(self, "UIScript/RewardListWindow.py")
-			except:
-				import exception
-				exception.Abort("RewardListDialog.LoadWindow.LoadObject")
-
-			try:
-				self.GetChild("title_bar").SetCloseEvent(ui.__mem_func__(self.Close))
-
-				self.reward_slot_window = self.GetChild("reward_item_slot")
-				self.reward_slot_window.SetOverInItemEvent(ui.__mem_func__(self.__SlotOverInItem))
-				self.reward_slot_window.SetOverOutItemEvent(ui.__mem_func__(self.__SlotOverOutItem))
-
-				self.scroll_bar = self.GetChild("reward_list_scroll_bar")
-				self.scroll_bar.SetScrollEvent(ui.__mem_func__(self.__OnScrollBarRewardListEvent))
-			except:
-				import exception
-				exception.Abort("RewardListDialog.LoadWindow.BindObject")
-
-		def __SlotOverInItem(self, slot_index):
-			if self.reward_tooltip == None:
-				return
-
-			scroll_slot_idx = self.cur_scroll_bar_index + slot_index
-			(item_vnum, item_count) = self.item_data_dict[scroll_slot_idx]
-
-			if item_vnum != 0 and item_count != 0:
-				item_socket_list = [0 for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-				item_attr_list = [(0, 0) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
-
-				self.reward_tooltip.ClearToolTip()
-				self.reward_tooltip.AddItemData(item_vnum, item_socket_list, item_attr_list)
-
-		def __SlotOverOutItem(self):
-			if self.reward_tooltip != None:
-				self.reward_tooltip.HideToolTip()
-
-		def __SetScrollBar(self):
-			reward_item_count = len(self.item_data_dict)
-			if reward_item_count > self.reward_slot_window.GetSlotCount():
-				scroll_diff = reward_item_count - self.reward_slot_window.GetSlotCount()
-
-				if scroll_diff > 0:
-					scroll_step_size = 1.0 / scroll_diff
-					self.scroll_bar.SetScrollStep(scroll_step_size)
-					self.cur_scroll_bar_index = int(self.scroll_bar.GetPos() * scroll_diff)
-				else:
-					self.cur_scroll_bar_index = 0
+	def Close(self):
+		self.ClearDictionary()
+		self.board = None
+		self.toolTipButton = None
+		self.toolTip = None
+		self.acceptButton = None
+		self.cancelButton = None
+		self.pinCodeSlot = None
+		self.pinCodeValue = None
+		self.Hide()
 
-				self.scroll_bar.Show()
-			else:
-				self.cur_scroll_bar_index = 0
-				self.scroll_bar.Hide()
+	def SetTitle(self, name):
+		self.board.SetTitleName(name)
 
-		def __OnScrollBarRewardListEvent(self):
-			self.RefreshRewardList()
+	def SetNumberMode(self):
+		self.pinCodeValue.SetNumberMode()
 
-		def Show(self):
-			ui.ScriptWindow.Show(self)
+	def SetUseCodePage(self, bUse = True):
+		self.pinCodeValue.SetUseCodePage(bUse)
 
-			if app.ENABLE_MOUSE_WHEEL_TOP_WINDOW:
-				self.SetTop()
-				wndMgr.SetWheelTopWindow(self.hWnd)
+	def SetSecretMode(self):
+		self.pinCodeValue.SetSecret()
 
-		def Close(self):
-			self.ClearRewardData()
+	def SetFocus(self):
+		self.pinCodeValue.SetFocus()
 
-			if app.ENABLE_MOUSE_WHEEL_TOP_WINDOW:
-				wndMgr.ClearWheelTopWindow(self.hWnd)
+	def SetAcceptEvent(self, event):
+		self.acceptButton.SetEvent(event)
+		self.pinCodeValue.OnIMEReturn = event
 
-			self.Hide()
+	def SetCancelEvent(self, event):
+		self.board.SetCloseEvent(event)
+		self.cancelButton.SetEvent(event)
+		self.pinCodeValue.OnPressEscapeKey = event
 
-		def Hide(self):
-			ui.ScriptWindow.Hide(self)
+	def GetText(self):
+		return self.pinCodeValue.GetText()
 
-		def Destroy(self):
-			self.called_window = None
-			self.reward_slot_window = None
-			self.reward_tooltip = None
-			self.scroll_bar = None
-			self.cur_scroll_bar_index = 0
-			self.item_data_dict = {}
+class InputNewPinCodeDialog(ui.ScriptWindow):
+	def __init__(self):
+		ui.ScriptWindow.__init__(self)
+		self.__CreateDialog()
 
-		def ScrollShow(self):
-			if self.scroll_bar:
-				self.scroll_bar.Show()
+	def __del__(self):
+		ui.ScriptWindow.__del__(self)
 
-		def ClearRewardData(self):
-			if self.scroll_bar:
-				self.scroll_bar.SetPos(0.0)
+	def __CreateDialog(self):
+		pyScrLoader = ui.PythonScriptLoader()
+		pyScrLoader.LoadScriptFile(self, "UIScript/InputNewPinCodeDialog.py")
 
-			self.cur_scroll_bar_index = 0
-			self.item_data_dict = {}
+		getObject = self.GetChild
+		self.board = getObject("Board")
+		self.acceptButton = getObject("AcceptButton")
+		self.cancelButton = getObject("CancelButton")
+		self.pinCodeSlot = getObject("PinCodeSlot")
+		self.pinCodeSlotCheck = getObject("PinCodeSlotCheck")
+		self.pinCodeValue = getObject("PinCodeValue")
+		self.pinCodeValueCheck = getObject("PinCodeValueCheck")
+
+		self.pinCodeValue.SetTabEvent(lambda arg = 1: self.OnNextFocus(arg))
+		self.pinCodeValueCheck.SetTabEvent(lambda arg = 2: self.OnNextFocus(arg))
+
+	def OnNextFocus(self, arg):
+		if 1 == arg:
+			self.pinCodeValue.KillFocus()
+			self.pinCodeValueCheck.SetFocus()
+		elif 2 == arg:
+			self.pinCodeValueCheck.KillFocus()
+			self.pinCodeValue.SetFocus()
 
-			for slot_idx in range(self.reward_slot_window.GetSlotCount()):
-				self.reward_slot_window.ClearSlot(slot_idx)
+	def Open(self):
+		self.pinCodeValue.SetFocus()
+		self.SetCenterPosition()
+		self.SetTop()
+		self.Show()
 
-		def RefreshRewardList(self):
-			if not self.reward_slot_window:
-				return
+	def Destroy(self):
+		self.Close()
 
-			self.__SetScrollBar()
+	def Close(self):
+		self.ClearDictionary()
+		self.board = None
+		self.acceptButton = None
+		self.cancelButton = None
+		self.pinCodeSlot = None
+		self.pinCodeSlotCheck = None
+		self.pinCodeValue = None
+		self.pinCodeValueCheck = None
+		self.Hide()
 
-			for slot_idx in range(self.reward_slot_window.GetSlotCount()):
-				scroll_slot_idx = self.cur_scroll_bar_index + slot_idx
+	def SetTitle(self, name):
+		self.board.SetTitleName(name)
 
-				if scroll_slot_idx in self.item_data_dict:
-					(item_vnum, item_count) = self.item_data_dict[scroll_slot_idx]
-					self.reward_slot_window.SetItemSlot(slot_idx, item_vnum, item_count)
+	def SetNumberMode(self):
+		self.pinCodeValue.SetNumberMode()
+		self.pinCodeValueCheck.SetNumberMode()
 
-		def SetCalledWindow(self, window):
-			self.called_window = window
+	def SetUseCodePage(self, bUse = True):
+		self.pinCodeValue.SetUseCodePage(bUse)
+		self.pinCodeValueCheck.SetUseCodePage(bUse)
 
-		def SetItemToolTip(self, tooltip):
-			self.reward_tooltip = tooltip
+	def SetSecretMode(self):
+		self.pinCodeValue.SetSecret()
+		self.pinCodeValueCheck.SetSecret()
 
-		def SetRewardInfo(self, reward_info):
-			self.item_data_dict = reward_info
+	def SetFocus(self):
+		self.pinCodeValue.SetFocus()
 
-		def SetRewardInfoFromCommonRewardList(self, common_reward_vnum):
-			#self.item_data_dict = item.GetCommonRewardData(common_reward_vnum)
-			return
+	def SetAcceptEvent(self, event):
+		self.acceptButton.SetEvent(event)
+		self.pinCodeValueCheck.OnIMEReturn = event
 
-		def OnPressEscapeKey(self):
-			self.Close()
-			return True
+	def SetCancelEvent(self, event):
+		self.board.SetCloseEvent(event)
+		self.cancelButton.SetEvent(event)
+		self.pinCodeValue.OnPressEscapeKey = event
+		self.pinCodeValueCheck.OnPressEscapeKey = event
 
-		if app.ENABLE_MOUSE_WHEEL_TOP_WINDOW:
-			def OnMouseWheelButtonUp(self):
-				return self.scroll_bar.OnUp() if self.scroll_bar else False
+	def GetText(self):
+		return self.pinCodeValue.GetText()
 
-			def OnMouseWheelButtonDown(self):
-				return self.scroll_bar.OnDown() if self.scroll_bar else False
+	def GetTextCheck(self):
+		return self.pinCodeValueCheck.GetText()
diff -ruN client_base/client/client/pack/root/uiexchange.py client_final/client/client/pack/root/uiexchange.py
--- client_base/client/client/pack/root/uiexchange.py	2026-02-13 09:22:34.000000000 +0000
+++ client_final/client/client/pack/root/uiexchange.py	2026-02-20 18:13:16.386343302 +0000
@@ -15,6 +15,8 @@
 ## Exchange
 if app.WJ_ENABLE_TRADABLE_ICON:
 	INVENTORY_PAGE_SIZE = player.INVENTORY_PAGE_SIZE
+	if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+		SPECIAL_INVENTORY_PAGE_SIZE = player.SPECIAL_INVENTORY_PAGE_SIZE
 
 class ExchangeDialog(ui.ScriptWindow):
 	def __init__(self):
@@ -26,11 +28,15 @@
 		self.interface = None
 		if app.WJ_ENABLE_TRADABLE_ICON:
 			self.inven = None
+			if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+				self.invenSpecial = None
 
 	def __del__(self):
 		ui.ScriptWindow.__del__(self)
 		if app.WJ_ENABLE_TRADABLE_ICON:
 			self.inven = None
+			if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+				self.invenSpecial = None
 
 	def LoadDialog(self):
 		PythonScriptLoader = ui.PythonScriptLoader()
@@ -69,7 +75,7 @@
 		dlgPickMoney.LoadDialog()
 		dlgPickMoney.SetAcceptEvent(ui.__mem_func__(self.OnPickMoney))
 		dlgPickMoney.SetTitleName(localeInfo.EXCHANGE_MONEY)
-		dlgPickMoney.SetMax(app.YANG_PICKUP_INPUT_DIGIT_LIMIT)
+		dlgPickMoney.SetMax(7)
 		dlgPickMoney.Hide()
 		self.dlgPickMoney = dlgPickMoney
 
@@ -141,7 +147,6 @@
 				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.EXCHANGE_CANT_EDIT_MONEY)
 				return
 
-			self.dlgPickMoney.SetChequeDigitMax(app.EXCHANGE_CHEQUE_DIGIT_LIMIT)
 			self.dlgPickMoney.Open(player.GetElk(), player.GetCheque())
 			self.dlgPickMoney.SetFocus(focus_idx)
 
@@ -228,13 +233,12 @@
 			if 1 == itemCount:
 				itemCount = 0
 			self.OwnerSlot.SetItemSlot(i, itemIndex, itemCount)
-
 			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				changelookvnum = exchange.GetChangeLookVnumFromSelf(i)
-				if not changelookvnum == 0:
-					self.OwnerSlot.SetSlotCoverImage(i, "icon/item/ingame_convert_Mark.tga")
+				itemTransmutedVnum = exchange.GetItemTransmutation(i, True)
+				if itemTransmutedVnum:
+					self.OwnerSlot.DisableCoverButton(i)
 				else:
-					self.OwnerSlot.EnableSlotCoverImage(i, False)
+					self.OwnerSlot.EnableCoverButton(i)
 
 		self.OwnerSlot.RefreshSlot()
 
@@ -245,13 +249,12 @@
 			if 1 == itemCount:
 				itemCount = 0
 			self.TargetSlot.SetItemSlot(i, itemIndex, itemCount)
-
 			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				changelookvnum = exchange.GetChangeLookVnumFromTarget(i)
-				if not changelookvnum == 0:
-					self.TargetSlot.SetSlotCoverImage(i, "icon/item/ingame_convert_Mark.tga")
+				itemTransmutedVnum = exchange.GetItemTransmutation(i, False)
+				if itemTransmutedVnum:
+					self.TargetSlot.DisableCoverButton(i)
 				else:
-					self.TargetSlot.EnableSlotCoverImage(i, False)
+					self.TargetSlot.EnableCoverButton(i)
 
 		self.TargetSlot.RefreshSlot()
 
@@ -305,22 +308,50 @@
 			net.SendExchangeExitPacket()
 
 		if app.WJ_ENABLE_TRADABLE_ICON:
-			if not self.inven:
-				return
+			if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+				if not self.inven or not self.invenSpecial:
+					return
+			else:
+				if not self.inven:
+					return
 
 			page = self.inven.GetInventoryPageIndex() # range 0 ~ 1
+			if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+				special_page = self.invenSpecial.GetInventoryPageIndex()
+
 			for i in self.ItemListIdx:
 				if (page * INVENTORY_PAGE_SIZE) <= i < ((page + 1) * INVENTORY_PAGE_SIZE): # range 0 ~ 44, 45 ~ 89
 					lock_idx = i - (page * INVENTORY_PAGE_SIZE)
 					self.inven.wndItem.SetCantMouseEventSlot(lock_idx)
 
+				if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+					if self.invenSpecial.GetInventoryType() == 0:
+						if (item.SKILL_BOOK_INVENTORY_SLOT_START + (special_page * SPECIAL_INVENTORY_PAGE_SIZE)) <= i < (item.SKILL_BOOK_INVENTORY_SLOT_START + (((special_page + 1) * SPECIAL_INVENTORY_PAGE_SIZE))):
+							lock_idx = i - (item.SKILL_BOOK_INVENTORY_SLOT_START + (special_page * SPECIAL_INVENTORY_PAGE_SIZE))
+							self.invenSpecial.wndItem.SetCantMouseEventSlot(lock_idx)
+
+					if self.invenSpecial.GetInventoryType() == 1:
+						if (item.UPGRADE_ITEMS_INVENTORY_SLOT_START + (special_page * SPECIAL_INVENTORY_PAGE_SIZE)) <= i < (item.UPGRADE_ITEMS_INVENTORY_SLOT_START + (((special_page + 1) * SPECIAL_INVENTORY_PAGE_SIZE))):
+							lock_idx = i - (item.UPGRADE_ITEMS_INVENTORY_SLOT_START + (special_page * SPECIAL_INVENTORY_PAGE_SIZE))
+							self.invenSpecial.wndItem.SetCantMouseEventSlot(lock_idx)
+
+					if self.invenSpecial.GetInventoryType() == 2:
+						if (item.STONE_INVENTORY_SLOT_START + (special_page * SPECIAL_INVENTORY_PAGE_SIZE)) <= i < (item.STONE_INVENTORY_SLOT_START + (((special_page + 1) * SPECIAL_INVENTORY_PAGE_SIZE))):
+							lock_idx = i - (item.STONE_INVENTORY_SLOT_START + (special_page * SPECIAL_INVENTORY_PAGE_SIZE))
+							self.invenSpecial.wndItem.SetCantMouseEventSlot(lock_idx)
+
+					if self.invenSpecial.GetInventoryType() == 3:
+						if (item.GIFT_BOX_INVENTORY_SLOT_START + (special_page * SPECIAL_INVENTORY_PAGE_SIZE)) <= i < (item.GIFT_BOX_INVENTORY_SLOT_START + (((special_page + 1) * SPECIAL_INVENTORY_PAGE_SIZE))):
+							lock_idx = i - (item.GIFT_BOX_INVENTORY_SLOT_START + (special_page * SPECIAL_INVENTORY_PAGE_SIZE))
+							self.invenSpecial.wndItem.SetCantMouseEventSlot(lock_idx)
+
 	if app.WJ_ENABLE_TRADABLE_ICON:
 		def CantTradableItem(self, slotIndex):
 			itemIndex = player.GetItemIndex(slotIndex)
 
 			if itemIndex:
-				if app.ENABLE_SOULBIND_SYSTEM:
-					if player.GetItemSealDate(player.INVENTORY, slotIndex) != item.E_SEAL_DATE_DEFAULT_TIMESTAMP:
+				if app.ENABLE_SOUL_BIND_SYSTEM:
+					if player.GetItemSealDate(player.INVENTORY, slotIndex) == -1 or player.GetItemSealDate(player.INVENTORY, slotIndex) > 0: #봉인아이템 걸러냄.
 						return True
 
 				return player.IsAntiFlagBySlot(slotIndex, item.ANTIFLAG_GIVE)
@@ -342,5 +373,9 @@
 		def SetInven(self, inven):
 			self.inven = inven
 
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			def SetSpecialInven(self, invenSpecial):
+				self.invenSpecial = invenSpecial
+
 		def AddExchangeItemSlotIndex(self, idx):
-			self.ItemListIdx.append(idx)
+			self.ItemListIdx.append(idx)
\ No newline at end of file
diff -ruN client_base/client/client/pack/root/uiinventory.py client_final/client/client/pack/root/uiinventory.py
--- client_base/client/client/pack/root/uiinventory.py	2026-02-19 21:41:52.000000000 +0000
+++ client_final/client/client/pack/root/uiinventory.py	2026-02-20 18:13:16.392948454 +0000
@@ -16,6 +16,7 @@
 import uiPrivateShopBuilder # 개인상점 열동안 ItemMove 방지
 import localeInfo
 import constInfo
+import osfInfo
 import ime
 import wndMgr
 
@@ -23,263 +24,19 @@
 	import uiToolTip
 	import uiPickETC
 
+if app.ENABLE_ACCE_COSTUME_SYSTEM:
+	import acce
+
+if app.ENABLE_CHANGE_LOOK_SYSTEM:
+	import changelook
+
+ITEM_MALL_BUTTON_ENABLE = True
 ITEM_FLAG_APPLICABLE = 1 << 14
 
 if app.ENABLE_EXTEND_INVEN_SYSTEM:
 	EX_INVEN_COVER_IMG_OPEN = "d:/ymir work/ui/game/windows/ex_inven_cover_button_open.sub"
 	EX_INVEN_COVER_IMG_CLOSE = "d:/ymir work/ui/game/windows/ex_inven_cover_button_close.sub"
 
-if app.ENABLE_HIDE_COSTUME_SYSTEM:
-	import chr
-
-def ReprGetItemIndex(window):
-	return lambda pos : player.GetItemIndex(window, pos)
-
-def ReprGetItemCount(window):
-	return lambda pos : player.GetItemCount(window, pos)
-
-if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-	class EquipmentWindow(ui.ScriptWindow):
-		EQUIPMENT_CHANGE_COOLTIME = 3
-		EXPANSION_CHANGE_HEIGHT_SIZE = 20
-
-		def __init__(self):
-			self.wnd_costume = None
-			self.wnd_inventory = None
-			self.wnd_belt = None
-
-			ui.ScriptWindow.__init__(self)
-
-			self.__Initialize()
-			self.__LoadWindow()
-
-		def __del__(self):
-			ui.ScriptWindow.__del__(self)
-
-		def __Initialize(self):
-			self.is_loaded = 0
-
-			self.interface = None
-
-			self.current_page = 0
-			self.tab_btn = []
-			self.tab_img = []
-
-		def __LoadWindow(self):
-			if self.is_loaded == 1:
-				return
-
-			self.is_loaded = 1
-
-			try:
-				pyScrLoader = ui.PythonScriptLoader()
-				pyScrLoader.LoadScriptFile(self, "UIScript/EquipmentDialog.py")
-			except:
-				import exception
-				exception.Abort("CostumeWindow.LoadWindow.LoadObject")
-
-			try:
-				self.GetChild("board").SetTitleName(localeInfo.EQUIPMENT_TITLE_NAME)
-				self.GetChild("board").SetCloseEvent(ui.__mem_func__(self.Close))
-
-				self.equipment_slot = self.GetChild("equipment_slot")
-				self.unique_slot = self.GetChild("unique_slot")
-
-				self.dragon_soul_button = self.GetChild("dragon_soul_button")
-				self.mall_button = self.GetChild("mall_button")
-				self.premium_private_shop_button = self.GetChild("premium_private_shop_button")
-				self.costume_button = self.GetChild("costume_button")
-
-				self.tab_btn = []
-				self.tab_btn.append(self.GetChild("tab_btn_01"))
-				self.tab_btn.append(self.GetChild("tab_btn_02"))
-
-				self.tab_img = []
-				self.tab_img.append(self.GetChild("tab_img_01"))
-				self.tab_img.append(self.GetChild("tab_img_02"))
-
-				for btn in self.tab_btn:
-					btn.Hide()
-
-				for img in self.tab_img:
-					img.Hide()
-			except:
-				import exception
-				exception.Abort("EquipmentWindow.LoadWindow.BindObject")
-
-			self.equipment_slot.SetSlotType(player.SLOT_TYPE_EQUIPMENT)
-			self.unique_slot.SetSlotType(player.SLOT_TYPE_EQUIPMENT)
-
-			self.dragon_soul_button.SetEvent(ui.__mem_func__(self.__ClickDSSButton))
-			self.mall_button.SetEvent(ui.__mem_func__(self.__ClickMallButton))
-			self.premium_private_shop_button.SetEvent(ui.__mem_func__(self.__ClickPremiumPrivateShopButton))
-			self.costume_button.SetEvent(ui.__mem_func__(self.__ClickCostumeButton))
-
-		def __CreateCostumeWindow(self):
-			pass
-
-		def BindInterface(self, interface):
-			from _weakref import proxy
-			self.interface = proxy(interface)
-
-		def BindInventoryWindow(self, inventory_window):
-			from _weakref import proxy
-			self.wnd_inventory = proxy(inventory_window)
-
-			x, y = self.wnd_inventory.GetGlobalPosition()
-			self.SetPosition(x, y - self.GetHeight())
-
-			self.equipment_slot.SetOverInItemEvent(ui.__mem_func__(self.wnd_inventory.OverInItem), player.EQUIPMENT)
-			self.equipment_slot.SetOverOutItemEvent(ui.__mem_func__(self.wnd_inventory.OverOutItem))
-			self.equipment_slot.SetUnselectItemSlotEvent(ui.__mem_func__(self.wnd_inventory.UseItemSlot), player.EQUIPMENT)
-			self.equipment_slot.SetUseSlotEvent(ui.__mem_func__(self.wnd_inventory.UseItemSlot), player.EQUIPMENT)
-			self.equipment_slot.SetSelectEmptySlotEvent(ui.__mem_func__(self.wnd_inventory.SelectEmptySlot), player.EQUIPMENT)
-			self.equipment_slot.SetSelectItemSlotEvent(ui.__mem_func__(self.wnd_inventory.SelectItemSlot), player.EQUIPMENT)
-
-			self.unique_slot.SetOverInItemEvent(ui.__mem_func__(self.wnd_inventory.OverInItem), player.EQUIPMENT)
-			self.unique_slot.SetOverOutItemEvent(ui.__mem_func__(self.wnd_inventory.OverOutItem))
-			self.unique_slot.SetUnselectItemSlotEvent(ui.__mem_func__(self.wnd_inventory.UseItemSlot), player.EQUIPMENT)
-			self.unique_slot.SetUseSlotEvent(ui.__mem_func__(self.wnd_inventory.UseItemSlot), player.EQUIPMENT)
-			self.unique_slot.SetSelectEmptySlotEvent(ui.__mem_func__(self.wnd_inventory.SelectEmptySlot), player.EQUIPMENT)
-			self.unique_slot.SetSelectItemSlotEvent(ui.__mem_func__(self.wnd_inventory.SelectItemSlot), player.EQUIPMENT)
-
-			self.wnd_costume = CostumeWindow(self.wnd_inventory)
-			self.wnd_belt = BeltInventoryWindow(self.wnd_inventory)
-			self.wnd_belt.SetMoveParentWindow(self)
-
-		def __ClickDSSButton(self):
-			self.interface.ToggleDragonSoulWindow()
-
-		def __ClickMallButton(self):
-			net.SendCommandPacket("/click_mall")
-
-		def __ClickPremiumPrivateShopButton(self):
-			self.interface.TogglePrivateShopPanelWindow()
-
-		def __ClickCostumeButton(self):
-			if not self.wnd_costume:
-				return
-
-			if not self.wnd_costume.IsShow():
-				self.wnd_costume.Show()
-			else:
-				self.wnd_costume.Close()
-
-		def ShowCostumeInventory(self):
-			if self.wnd_costume:
-				self.wnd_costume.Show()
-
-		def Show(self):
-			self.__LoadWindow()
-
-			if self.wnd_costume and self.wnd_costume.IsOpen():
-				self.wnd_costume.Show()
-
-			if self.wnd_belt:
-				self.wnd_belt.Show()
-
-			ui.ScriptWindow.Show(self)
-			self.SetTop()
-
-		def Hide(self):
-			if self.wnd_costume:
-				self.wnd_costume.Hide()
-
-			if self.wnd_belt:
-				self.wnd_belt.Hide()
-
-			ui.ScriptWindow.Hide(self)
-
-		def OnTop(self):
-			(x, y) = self.GetLocalPosition()
-			if y < 0:
-				self.SetPosition(x, 0)
-
-		def Close(self):
-			self.Hide()
-
-		def OnPressEscapeKey(self):
-			self.Close()
-			return True
-
-		def Destroy(self):
-			if self.wnd_costume:
-				del self.wnd_costume
-				self.wnd_costume = None
-
-			if self.wnd_belt:
-				del self.wnd_belt
-				self.wnd_belt = None
-
-		def RefreshSlot(self):
-			self.__RefreshEquipmentSlot()
-			self.__RefreshUniqueSlot()
-
-			if self.wnd_belt:
-				self.wnd_belt.RefreshSlot()
-
-		def __RefreshEquipmentSlot(self):
-			if not self.equipment_slot:
-				return
-
-			getItemVNum = ReprGetItemIndex(player.EQUIPMENT)
-			getItemCount = ReprGetItemCount(player.EQUIPMENT)
-			setItemVNum = self.equipment_slot.SetItemSlot
-
-			for i in xrange(player.WEAR_MAX): ## 32 ( 0 ~ 31 )
-				itemCount = getItemCount(i)
-				if itemCount <= 1:
-					itemCount = 0
-
-				setItemVNum(i, getItemVNum(i), itemCount)
-
-				if app.ENABLE_CHANGE_LOOK_SYSTEM:
-					if not player.GetChangeLookVnum(player.EQUIPMENT, i) == 0:
-						self.equipment_slot.SetSlotCoverImage(i, "icon/item/ingame_convert_Mark.tga")
-					else:
-						self.equipment_slot.EnableSlotCoverImage(i,False)
-
-			self.equipment_slot.RefreshSlot()
-
-			if self.wnd_costume:
-				self.wnd_costume.RefreshCostumeSlot()
-
-		def __RefreshUniqueSlot(self):
-			if not self.unique_slot:
-				return
-
-			getItemVNum = ReprGetItemIndex(player.EQUIPMENT)
-			getItemCount = ReprGetItemCount(player.EQUIPMENT)
-			setItemVNum = self.unique_slot.SetItemSlot
-
-			for i in xrange(player.WEAR_MAX):
-				itemCount = getItemCount(i)
-				if itemCount <= 1:
-					itemCount = 0
-
-				setItemVNum(i, getItemVNum(i), itemCount)
-
-			self.unique_slot.RefreshSlot()
-
-		def OnMoveWindow(self, x, y):
-			if self.wnd_belt:
-				self.wnd_belt.SetMoveParentWindow(self)
-
-		def GetBeltWnd(self):
-			return self.wnd_belt
-
-		def __RequestChangeEquipmentpage(self, page_index): pass
-		def __UseChangeEquipmentPageSkill(self, page_index): pass
-		def AdditionalEquipmentPageSetting(self, page_index): pass
-		def EquipmentPageTabSetting(self, page_index): pass
-		def IsActiveAdditionalEquipmentPage(self): pass
-		def ToggleEquipmentPage(self): pass
-
-		if app.ENABLE_HIDE_COSTUME_SYSTEM:
-			def SetHiddenCostumePart(self, part, hidden):
-				if self.wnd_costume:
-					self.wnd_costume.SetHiddenCostumePart(part, hidden)
-
 class CostumeWindow(ui.ScriptWindow):
 	def __init__(self, wndInventory):
 		import exception
@@ -291,22 +48,11 @@
 		ui.ScriptWindow.__init__(self)
 
 		self.isLoaded = 0
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.isOpen = 0
+		self.wndInventory = wndInventory;
 
 		if app.ENABLE_HIDE_COSTUME_SYSTEM:
-			self.slot_image_dict = {}
-			self.slot_btn_dict = {}
-
-			self.visible_wnd_dict = { item.COSTUME_TYPE_BODY : (62, 45), item.COSTUME_TYPE_HAIR : (62, 9), }
-			if app.ENABLE_ACCE_COSTUME_SYSTEM:
-				self.visible_wnd_dict.update({ item.COSTUME_TYPE_ACCE : (70, 126) })
-			if app.ENABLE_WEAPON_COSTUME_SYSTEM:
-				self.visible_wnd_dict.update({ item.COSTUME_TYPE_WEAPON : (13, 13) })
-			if app.ENABLE_AURA_COSTUME_SYSTEM:
-				self.visible_wnd_dict.update({ item.COSTUME_TYPE_AURA : (37, 126) })
-
-		self.wndInventory = wndInventory;
+			self.visibleBtnList = []
+			self.visibleSlotList = []
 
 		self.__LoadWindow()
 
@@ -318,18 +64,8 @@
 		self.RefreshCostumeSlot()
 
 		ui.ScriptWindow.Show(self)
-		self.SetTop()
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.isOpen = 1
-
-	if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-		def IsOpen(self):
-			return self.isOpen
 
 	def Close(self):
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.isOpen = 0
-
 		self.Hide()
 
 	def __LoadWindow(self):
@@ -347,111 +83,102 @@
 
 		try:
 			wndEquip = self.GetChild("CostumeSlot")
-			if app.ENABLE_HIDE_COSTUME_SYSTEM:
-				self.base_image = self.GetChild("Costume_Base")
-
 			self.GetChild("TitleBar").SetCloseEvent(ui.__mem_func__(self.Close))
 
+			if app.ENABLE_HIDE_COSTUME_SYSTEM:
+				self.visibleBtnList.append(self.GetChild("BodyToolTipButton")) ## 0
+				self.visibleBtnList.append(self.GetChild("HairToolTipButton")) ## 1
+				self.visibleBtnList.append(self.GetChild("AcceToolTipButton")) ## 2
+				self.visibleBtnList.append(self.GetChild("WeaponToolTipButton")) ## 3
+
+				self.visibleSlotList.append(self.GetChild("VisibleBodySlotImg")) ## 0
+				self.visibleSlotList.append(self.GetChild("VisibleHairSlotImg")) ## 1
+				self.visibleSlotList.append(self.GetChild("VisibleAcceSlotImg")) ## 2
+				self.visibleSlotList.append(self.GetChild("VisibleWeaponSlotImg")) ## 3
+
 		except:
 			import exception
 			exception.Abort("CostumeWindow.LoadWindow.BindObject")
 
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			x, y = self.wndInventory.GetGlobalPosition()
-			self.SetPosition(x - 150, y - self.wndInventory.GetHeight() + 65)
-			(x, y) = self.GetLocalPosition()
-			if y < 0:
-				self.SetPosition(x, 0)
-
-		if app.ENABLE_HIDE_COSTUME_SYSTEM:
-			## Slot Image List
-			self.slot_image_dict = {}
-			for key, (x, y) in self.visible_wnd_dict.items():
-				slot_image = ui.ImageBox()
-				slot_image.SetParent(self.base_image)
-				slot_image.AddFlag("not_pick")
-				slot_image.SetPosition(x + 4, y + 4)
-				if key == item.COSTUME_TYPE_BODY:
-					slot_image.LoadImage("d:/ymir work/ui/game/costume/hideslot_02.tga")
-				elif app.ENABLE_WEAPON_COSTUME_SYSTEM and key == item.COSTUME_TYPE_WEAPON:
-					slot_image.LoadImage("d:/ymir work/ui/game/costume/hideslot_03.tga")
-				else:
-					slot_image.LoadImage("d:/ymir work/ui/game/costume/hideslot_01.tga")
-				slot_image.Hide()
-				self.slot_image_dict[key] = slot_image
-
-			## Slot Button List
-			self.slot_btn_dict = {}
-			for key, (x, y) in self.visible_wnd_dict.items():
-				btn = ui.Button()
-				btn.SetParent(self.base_image)
-				btn.SetPosition(x, y)
-				btn.SetUpVisual("d:/ymir work/ui/game/costume/eye_normal_01.tga")
-				btn.SetOverVisual("d:/ymir work/ui/game/costume/eye_normal_02.tga")
-				btn.SetDownVisual("d:/ymir work/ui/game/costume/eye_normal_01.tga")
-				btn.SetToolTipText(localeInfo.HIDE_COSTUME_TOOLTIP)
-				btn.SetEvent(ui.__mem_func__(self.__ClickVisibleButton), key, 1)
-				btn.Show()
-				self.slot_btn_dict[key] = btn
-
 		## Equipment
-		wndEquip.SetOverInItemEvent(ui.__mem_func__(self.wndInventory.OverInItem), player.EQUIPMENT)
+		wndEquip.SetOverInItemEvent(ui.__mem_func__(self.wndInventory.OverInItem))
 		wndEquip.SetOverOutItemEvent(ui.__mem_func__(self.wndInventory.OverOutItem))
-		wndEquip.SetUnselectItemSlotEvent(ui.__mem_func__(self.wndInventory.UseItemSlot), player.EQUIPMENT)
-		wndEquip.SetUseSlotEvent(ui.__mem_func__(self.wndInventory.UseItemSlot), player.EQUIPMENT)
-		wndEquip.SetSelectEmptySlotEvent(ui.__mem_func__(self.wndInventory.SelectEmptySlot), player.EQUIPMENT)
-		wndEquip.SetSelectItemSlotEvent(ui.__mem_func__(self.wndInventory.SelectItemSlot), player.EQUIPMENT)
+		wndEquip.SetUnselectItemSlotEvent(ui.__mem_func__(self.wndInventory.UseItemSlot))
+		wndEquip.SetUseSlotEvent(ui.__mem_func__(self.wndInventory.UseItemSlot))
+		wndEquip.SetSelectEmptySlotEvent(ui.__mem_func__(self.wndInventory.SelectEmptySlot))
+		wndEquip.SetSelectItemSlotEvent(ui.__mem_func__(self.wndInventory.SelectItemSlot))
 
 		self.wndEquip = wndEquip
 
+		if app.ENABLE_HIDE_COSTUME_SYSTEM:
+			self.visibleBtnList[0].SetToggleUpEvent(ui.__mem_func__(self.VisibleCostume), 1, 0)
+			self.visibleBtnList[0].SetToggleDownEvent(ui.__mem_func__(self.VisibleCostume), 1, 1)
+
+			self.visibleBtnList[1].SetToggleUpEvent(ui.__mem_func__(self.VisibleCostume), 2, 0)
+			self.visibleBtnList[1].SetToggleDownEvent(ui.__mem_func__(self.VisibleCostume), 2, 1)
+
+			if app.ENABLE_ACCE_COSTUME_SYSTEM:
+				self.visibleBtnList[2].SetToggleUpEvent(ui.__mem_func__(self.VisibleCostume), 3, 0)
+				self.visibleBtnList[2].SetToggleDownEvent(ui.__mem_func__(self.VisibleCostume), 3, 1)
+
+			if app.ENABLE_WEAPON_COSTUME_SYSTEM:
+				self.visibleBtnList[3].SetToggleUpEvent(ui.__mem_func__(self.VisibleCostume), 4, 0)
+				self.visibleBtnList[3].SetToggleDownEvent(ui.__mem_func__(self.VisibleCostume), 4, 1)
+
+			for slot in xrange(4):
+				self.visibleSlotList[slot].Hide()
+
 	def RefreshCostumeSlot(self):
-		getItemVNum = ReprGetItemIndex(player.EQUIPMENT)
+		getItemVNum = player.GetItemIndex
 
 		for i in xrange(item.COSTUME_SLOT_COUNT):
 			slotNumber = item.COSTUME_SLOT_START + i
 			self.wndEquip.SetItemSlot(slotNumber, getItemVNum(slotNumber), 0)
 
 			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				if not player.GetChangeLookVnum(player.EQUIPMENT, slotNumber) == 0:
-					self.wndEquip.SetSlotCoverImage(slotNumber, "icon/item/ingame_convert_Mark.tga")
+				changelookvnum = player.GetItemTransmutation(slotNumber)
+				if changelookvnum:
+					self.wndEquip.DisableCoverButton(slotNumber)
 				else:
-					self.wndEquip.EnableSlotCoverImage(slotNumber, False)
-
-		if app.ENABLE_WEAPON_COSTUME_SYSTEM:
-			self.wndEquip.SetItemSlot(item.COSTUME_SLOT_WEAPON, getItemVNum(item.COSTUME_SLOT_WEAPON), 0)
+					self.wndEquip.EnableCoverButton(slotNumber)
 
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				if not player.GetChangeLookVnum(player.EQUIPMENT, item.COSTUME_SLOT_WEAPON) == 0:
-					self.wndEquip.SetSlotCoverImage(item.COSTUME_SLOT_WEAPON, "icon/item/ingame_convert_Mark.tga")
-				else:
-					self.wndEquip.EnableSlotCoverImage(item.COSTUME_SLOT_WEAPON, False)
+		#if app.ENABLE_WEAPON_COSTUME_SYSTEM:
+		#	self.wndEquip.SetItemSlot(item.COSTUME_SLOT_WEAPON, getItemVNum(item.COSTUME_SLOT_WEAPON), 0)
 
 		self.wndEquip.RefreshSlot()
 
 	if app.ENABLE_HIDE_COSTUME_SYSTEM:
-		def __ClickVisibleButton(self, part, hidden):
-			if part in self.visible_wnd_dict:
-				net.SendCommandPacket("/hide_costume_part %d %d" % (part, hidden))
+		def RefreshVisibleCostume(self):
+			body = osfInfo.HIDDEN_BODY_COSTUME
+			self.SetHideEvent(0, body)
 
-		def SetHiddenCostumePart(self, part, hidden):
-			if not part in self.visible_wnd_dict:
-				return
+			hair = osfInfo.HIDDEN_HAIR_COSTUME
+			self.SetHideEvent(1, hair)
+
+			if app.ENABLE_ACCE_COSTUME_SYSTEM:
+				acce = osfInfo.HIDDEN_ACCE_COSTUME
+				self.SetHideEvent(2, acce)
+
+			if app.ENABLE_WEAPON_COSTUME_SYSTEM:
+				weapon = osfInfo.HIDDEN_WEAPON_COSTUME
+				self.SetHideEvent(3, weapon)
 
-			btn = self.slot_btn_dict[part]
-			if hidden:
-				btn.SetUpVisual("d:/ymir work/ui/game/costume/eye_closed_01.tga")
-				btn.SetOverVisual("d:/ymir work/ui/game/costume/eye_closed_02.tga")
-				btn.SetDownVisual("d:/ymir work/ui/game/costume/eye_closed_01.tga")
-				btn.SetToolTipText(localeInfo.SHOW_COSTUME_TOOLTIP)
-				btn.SetEvent(ui.__mem_func__(self.__ClickVisibleButton), part, 0)
-				self.slot_image_dict[part].Show()
+		def SetHideEvent(self, slot, hide = False):
+			if hide:
+				self.visibleBtnList[slot].SetToolTipText(localeInfo.SHOW_COSTUME)
+				self.visibleBtnList[slot].SetUpVisual("d:/ymir work/ui/game/costume/eye_closed_01.tga")
+				self.visibleBtnList[slot].SetOverVisual("d:/ymir work/ui/game/costume/eye_closed_02.tga")
+				self.visibleBtnList[slot].SetDownVisual("d:/ymir work/ui/game/costume/eye_closed_02.tga")
+				self.visibleSlotList[slot].Show()
 			else:
-				btn.SetUpVisual("d:/ymir work/ui/game/costume/eye_normal_01.tga")
-				btn.SetOverVisual("d:/ymir work/ui/game/costume/eye_normal_02.tga")
-				btn.SetDownVisual("d:/ymir work/ui/game/costume/eye_normal_01.tga")
-				btn.SetToolTipText(localeInfo.HIDE_COSTUME_TOOLTIP)
-				btn.SetEvent(ui.__mem_func__(self.__ClickVisibleButton), part, 1)
-				self.slot_image_dict[part].Hide()
+				self.visibleBtnList[slot].SetToolTipText(localeInfo.HIDE_COSTUME)
+				self.visibleBtnList[slot].SetUpVisual("d:/ymir work/ui/game/costume/eye_normal_01.tga")
+				self.visibleBtnList[slot].SetOverVisual("d:/ymir work/ui/game/costume/eye_normal_02.tga")
+				self.visibleBtnList[slot].SetDownVisual("d:/ymir work/ui/game/costume/eye_normal_02.tga")
+				self.visibleSlotList[slot].Hide()
+
+		def VisibleCostume(self, part, hidden):
+			net.SendChatPacket("/hide_costume %d %d" % (part, hidden))
 
 class BeltInventoryWindow(ui.ScriptWindow):
 	def __init__(self, wndInventory):
@@ -471,9 +198,6 @@
 		self.expandBtn = None
 		self.minBtn = None
 
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.parent = None
-
 		self.__LoadWindow()
 
 	def __del__(self):
@@ -502,43 +226,46 @@
 		self.wndBeltInventoryLayer.Show()
 		self.expandBtn.Hide()
 
-		self.AdjustPosition()
+		if localeInfo.IsARABIC() == 0:
+			self.AdjustPositionAndSize()
+		else:
+			self.AdjustPositionAndSizeAE()
 
 	def CloseInventory(self):
 		self.wndBeltInventoryLayer.Hide()
 		self.expandBtn.Show()
 
-		self.AdjustPosition()
+		if localeInfo.IsARABIC() == 0:
+			self.AdjustPositionAndSize()
+		else:
+			self.AdjustPositionAndSizeAE()
 
 	## 현재 인벤토리 위치를 기준으로 BASE 위치를 계산, 리턴.. 숫자 하드코딩하기 정말 싫지만 방법이 없다..
 	def GetBasePosition(self):
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			x, y = self.parent.GetGlobalPosition()
-			return x - 148, y + 65
-		else:
-			x, y = self.wndInventory.GetGlobalPosition()
-			return x - 148, y + 241
+		x, y = self.wndInventory.GetGlobalPosition()
+		return x - 148, y + 241
+
+	if localeInfo.IsARABIC():
+		def AdjustPositionAndSizeAE(self):
+			bx, by = self.GetBasePosition()
+
+			if self.IsOpeningInventory():
+				self.SetPosition(bx, by);
+				self.wndBeltInventoryLayer.SetPosition(self.ORIGINAL_WIDTH-5, 0)
+			else:
+				self.SetPosition(bx + 140, by);
+				self.wndBeltInventoryLayer.SetPosition(self.ORIGINAL_WIDTH - 10, 0)
+				self.expandBtn.SetPosition(self.ORIGINAL_WIDTH + 1, 15);
 
-	def AdjustPosition(self):
+	def AdjustPositionAndSize(self):
 		bx, by = self.GetBasePosition()
 
 		if self.IsOpeningInventory():
 			self.SetPosition(bx, by)
-
-			if localeInfo.IsARABIC():
-				self.SetPosition(bx, by)
-				self.wndBeltInventoryLayer.SetPosition(self.ORIGINAL_WIDTH - 5, 0)
-			else:
-				self.SetPosition(bx, by)
-				self.SetSize(self.ORIGINAL_WIDTH, self.GetHeight())
+			self.SetSize(self.ORIGINAL_WIDTH, self.GetHeight())
 		else:
-			if localeInfo.IsARABIC():
-				self.SetPosition(bx + 140 , by)
-				self.wndBeltInventoryLayer.SetPosition(self.ORIGINAL_WIDTH - 10, 0)
-				self.expandBtn.SetPosition(self.ORIGINAL_WIDTH + 1 , 15)
-			else:
-				self.SetPosition(bx + 138, by);
-				self.SetSize(10, self.GetHeight())
+			self.SetPosition(bx + 138, by);
+			self.SetSize(10, self.GetHeight())
 
 	def __LoadWindow(self):
 		if self.isLoaded == 1:
@@ -551,7 +278,7 @@
 			pyScrLoader.LoadScriptFile(self, "UIScript/BeltInventoryWindow.py")
 		except:
 			import exception
-			exception.Abort("BeltInventoryWindow.LoadWindow.LoadObject")
+			exception.Abort("CostumeWindow.LoadWindow.LoadObject")
 
 		try:
 			self.ORIGINAL_WIDTH = self.GetWidth()
@@ -563,7 +290,7 @@
 			self.expandBtn.SetEvent(ui.__mem_func__(self.OpenInventory))
 			self.minBtn.SetEvent(ui.__mem_func__(self.CloseInventory))
 
-			if localeInfo.IsARABIC() :
+			if localeInfo.IsARABIC():
 				self.minBtn.SetPosition(self.minBtn.GetWidth() + 3, 15)
 
 			for i in xrange(item.BELT_INVENTORY_SLOT_COUNT):
@@ -573,31 +300,36 @@
 					"d:/ymir work/ui/game/quest/slot_button_01.sub",\
 					"d:/ymir work/ui/game/quest/slot_button_01.sub",\
 					"d:/ymir work/ui/game/belt_inventory/slot_disabled.tga", False, False)
+
 		except:
 			import exception
 			exception.Abort("CostumeWindow.LoadWindow.BindObject")
 
 		## Equipment
-		wndBeltInventorySlot.SetOverInItemEvent(ui.__mem_func__(self.wndInventory.OverInItem), player.BELT_INVENTORY)
+		wndBeltInventorySlot.SetOverInItemEvent(ui.__mem_func__(self.wndInventory.OverInItem))
 		wndBeltInventorySlot.SetOverOutItemEvent(ui.__mem_func__(self.wndInventory.OverOutItem))
-		wndBeltInventorySlot.SetUnselectItemSlotEvent(ui.__mem_func__(self.wndInventory.UseItemSlot), player.BELT_INVENTORY)
-		wndBeltInventorySlot.SetUseSlotEvent(ui.__mem_func__(self.wndInventory.UseItemSlot), player.BELT_INVENTORY)
-		wndBeltInventorySlot.SetSelectEmptySlotEvent(ui.__mem_func__(self.wndInventory.SelectEmptySlot), player.BELT_INVENTORY)
-		wndBeltInventorySlot.SetSelectItemSlotEvent(ui.__mem_func__(self.wndInventory.SelectItemSlot), player.BELT_INVENTORY)
+		wndBeltInventorySlot.SetUnselectItemSlotEvent(ui.__mem_func__(self.wndInventory.UseItemSlot))
+		wndBeltInventorySlot.SetUseSlotEvent(ui.__mem_func__(self.wndInventory.UseItemSlot))
+		wndBeltInventorySlot.SetSelectEmptySlotEvent(ui.__mem_func__(self.wndInventory.SelectEmptySlot))
+		wndBeltInventorySlot.SetSelectItemSlotEvent(ui.__mem_func__(self.wndInventory.SelectItemSlot))
 
 		## MT-436 slot bug fix
-		wndBeltInventorySlot.SetSlotType(player.SLOT_TYPE_BELT_INVENTORY)
+		#wndBeltInventorySlot.SetSlotType(player.SLOT_TYPE_BELT_INVENTORY)
 		self.wndBeltInventorySlot = wndBeltInventorySlot
 
 	def RefreshSlot(self):
-		getItemVNum = ReprGetItemIndex(player.BELT_INVENTORY)
-		getItemCount = ReprGetItemCount(player.BELT_INVENTORY)
+		getItemVNum = player.GetItemIndex
 
 		for i in xrange(item.BELT_INVENTORY_SLOT_COUNT):
 			slotNumber = item.BELT_INVENTORY_SLOT_START + i
-			self.wndBeltInventorySlot.SetItemSlot(slotNumber, getItemVNum(slotNumber), getItemCount(slotNumber))
+			if app.ENABLE_CHANGE_LOOK_SYSTEM:
+				self.wndBeltInventorySlot.SetItemSlot(slotNumber, getItemVNum(slotNumber), player.GetItemCount(slotNumber), (1.0, 1.0, 1.0, 1.0), False)
+			else:
+				self.wndBeltInventorySlot.SetItemSlot(slotNumber, getItemVNum(slotNumber), player.GetItemCount(slotNumber))
 			self.wndBeltInventorySlot.SetAlwaysRenderCoverButton(slotNumber, True)
 
+			avail = "0"
+
 			if player.IsAvailableBeltInventoryCell(slotNumber):
 				self.wndBeltInventorySlot.EnableCoverButton(slotNumber)
 			else:
@@ -606,18 +338,9 @@
 		self.wndBeltInventorySlot.RefreshSlot()
 
 	def OnTop(self):
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			pass
-		else:
-			if self.wndInventory:
-				self.wndInventory.SetClickBeltInventory(True)
-				self.wndInventory.SetTop()
-
-	if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-		def SetMoveParentWindow(self, move_window):
-			from _weakref import proxy
-			self.parent = proxy(move_window)
-			self.AdjustPosition()
+		if self.wndInventory:
+			self.wndInventory.SetClickBeltInventory(True)
+			self.wndInventory.SetTop()
 
 class InventoryWindow(ui.ScriptWindow):
 	USE_TYPE_TUPLE = (
@@ -628,59 +351,41 @@
 		"USE_ADD_ACCESSORY_SOCKET",
 		"USE_PUT_INTO_ACCESSORY_SOCKET",
 		"USE_PUT_INTO_BELT_SOCKET",
-		"USE_PUT_INTO_RING_SOCKET"
+		"USE_PUT_INTO_RING_SOCKET",
+		"USE_CHANGE_COSTUME_ATTR",
+		"USE_RESET_COSTUME_ATTR"
 	)
-
-	if app.ENABLE_MOVE_COSTUME_ATTR:
-		USE_TYPE_TUPLE += ("USE_CHANGE_COSTUME_ATTR", "USE_RESET_COSTUME_ATTR",)
-
-	if app.ENABLE_CHANGED_ATTR:
-		USE_TYPE_TUPLE += ("USE_SELECT_ATTRIBUTE",)
-
-	if app.ENABLE_ATTR_6TH_7TH:
-		USE_TYPE_TUPLE += ("USE_CHANGE_ATTRIBUTE2",)
-
-	if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-		USE_TYPE_TUPLE += ("USE_ELEMENT_UPGRADE", "USE_ELEMENT_DOWNGRADE", "USE_ELEMENT_CHANGE",)
+	if app.ENABLE_COSTUME_EXTENDED_RECHARGE:
+		USE_TYPE_LIST = list(USE_TYPE_TUPLE)
+		USE_TYPE_LIST.append("USE_TIME_CHARGE_PER")
+		USE_TYPE_LIST.append("USE_TIME_CHARGE_FIX")
+		USE_TYPE_TUPLE = tuple(USE_TYPE_LIST)
 
 	questionDialog = None
 	tooltipItem = None
-
-	if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-		wndCostume = None
-		wndBelt = None
-
+	wndCostume = None
+	wndBelt = None
 	dlgPickMoney = None
 	if app.ENABLE_CHEQUE_SYSTEM:
 		dlgPickETC = None
 
-	if app.WJ_ENABLE_TRADABLE_ICON:
-		bindWnds = []
-
 	sellingSlotNumber = -1
-	sellingSlotWindow = player.INVENTORY
-
-	if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-		isOpenedCostumeWindowWhenClosingInventory = 0 # 인벤토리 닫을 때 코스츔이 열려있었는지 여부-_-; 네이밍 ㅈㅅ
-		isOpenedBeltWindowWhenClosingInventory = 0 # 인벤토리 닫을 때 벨트 인벤토리가 열려있었는지 여부-_-; 네이밍 ㅈㅅ
+	isLoaded = 0
+	isOpenedCostumeWindowWhenClosingInventory = 0 # 인벤토리 닫을 때 코스츔이 열려있었는지 여부-_-; 네이밍 ㅈㅅ
+	isOpenedBeltWindowWhenClosingInventory = 0 # 인벤토리 닫을 때 벨트 인벤토리가 열려있었는지 여부-_-; 네이밍 ㅈㅅ
 
 	if app.ENABLE_GROWTH_PET_SYSTEM:
 		petHatchingWindow	= None
 		petFeedWindow		= None
 		petNameChangeWindow = None
 
-	isLoaded = 0
 	interface = None
-	pop = None
 
 	def __init__(self):
 		if app.ENABLE_GEM_SYSTEM:
 			self.wndExpandedMoneyBar = None
 			self.wndGem = None
 
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.wndEquipment = None
-
 		ui.ScriptWindow.__init__(self)
 
 		self.isOpenedBeltWindowWhenClosingInventory = 0 # 인벤토리 닫을 때 벨트 인벤토리가 열려있었는지 여부-_-; 네이밍 ㅈㅅ
@@ -695,9 +400,6 @@
 			self.wndExpandedMoneyBar = None
 			self.wndGem = None
 
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.wndEquipment = None
-
 	def SetClickBeltInventory(self, isclick):
 		self.IsClickBeltInventory = isclick
 
@@ -709,31 +411,22 @@
 		self.RefreshItemSlot()
 		self.RefreshStatus()
 
-		if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			# 인벤토리를 닫을 때 코스츔이 열려있었다면 인벤토리를 열 때 코스츔도 같이 열도록 함.
-			if self.isOpenedCostumeWindowWhenClosingInventory and self.wndCostume:
-				self.wndCostume.Show()
-
-			# 인벤토리를 닫을 때 벨트 인벤토리가 열려있었다면 같이 열도록 함.
-			if self.wndBelt:
-				self.wndBelt.Show(self.isOpenedBeltWindowWhenClosingInventory)
+		# 인벤토리를 닫을 때 코스츔이 열려있었다면 인벤토리를 열 때 코스츔도 같이 열도록 함.
+		if self.isOpenedCostumeWindowWhenClosingInventory and self.wndCostume:
+			self.wndCostume.Show()
+
+		# 인벤토리를 닫을 때 벨트 인벤토리가 열려있었다면 같이 열도록 함.
+		if self.wndBelt:
+			self.wndBelt.Show(self.isOpenedBeltWindowWhenClosingInventory)
 
 		if app.ENABLE_GEM_SYSTEM:
 			if self.wndExpandedMoneyBar:
 				self.wndExpandedMoneyBar.Show()
 
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			if self.wndEquipment:
-				self.wndEquipment.Show()
-
 	def BindInterfaceClass(self, interface):
 		from _weakref import proxy
 		self.interface = proxy(interface)
 
-	if app.WJ_ENABLE_TRADABLE_ICON:
-		def BindWindow(self, wnd):
-			self.bindWnds.append(wnd)
-
 	def __LoadWindow(self):
 		if self.isLoaded == 1:
 			return
@@ -742,22 +435,26 @@
 
 		try:
 			pyScrLoader = ui.PythonScriptLoader()
-			pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_COMMON_UISCRIPT_PATH + "InventoryWindow.py")
+
+			if ITEM_MALL_BUTTON_ENABLE:
+				pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "InventoryWindow.py")
+			else:
+				pyScrLoader.LoadScriptFile(self, "UIScript/InventoryWindow.py")
 		except:
 			import exception
 			exception.Abort("InventoryWindow.LoadWindow.LoadObject")
 
 		try:
 			wndItem = self.GetChild("ItemSlot")
-			if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-				wndEquip = self.GetChild("EquipmentSlot")
+			wndEquip = self.GetChild("EquipmentSlot")
 			self.GetChild("TitleBar").SetCloseEvent(ui.__mem_func__(self.Close))
 			self.wndMoney = self.GetChild("Money")
 			self.wndMoneySlot = self.GetChild("Money_Slot")
-			if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-				self.mallButton = self.GetChild2("MallButton")
-				self.DSSButton = self.GetChild2("DSSButton")
-				self.costumeButton = self.GetChild2("CostumeButton")
+			self.mallButton = self.GetChild2("MallButton")
+			self.DSSButton = self.GetChild2("DSSButton")
+			self.costumeButton = self.GetChild2("CostumeButton")
+			if app.ENABLE_SORT_INVENTORY:
+				self.sortInventoryButton = self.GetChild2("SortInventoryButton")
 
 			if app.ENABLE_CHEQUE_SYSTEM:
 				self.wndCheque = self.GetChild("Cheque")
@@ -776,7 +473,6 @@
 					width = self.GetWidth()
 					self.SetSize(width, height - 22)
 					self.GetChild("board").SetSize(width, height - 22)
-
 				else:
 					self.wndMoneyIcon = self.GetChild("Money_Icon")
 					self.wndChequeIcon = self.GetChild("Cheque_Icon")
@@ -793,49 +489,26 @@
 			self.inventoryTab = []
 			self.inventoryTab.append(self.GetChild("Inventory_Tab_01"))
 			self.inventoryTab.append(self.GetChild("Inventory_Tab_02"))
-			self.inventoryTab.append(self.GetChild("Inventory_Tab_03"))
-			self.inventoryTab.append(self.GetChild("Inventory_Tab_04"))
+			if app.ENABLE_EXTEND_INVEN_SYSTEM:
+				self.inventoryTab.append(self.GetChild("Inventory_Tab_03"))
+				self.inventoryTab.append(self.GetChild("Inventory_Tab_04"))
 
-			if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-				self.equipmentTab = []
-				self.equipmentTab.append(self.GetChild("Equipment_Tab_01"))
-				self.equipmentTab.append(self.GetChild("Equipment_Tab_02"))
+			self.equipmentTab = []
+			self.equipmentTab.append(self.GetChild("Equipment_Tab_01"))
+			self.equipmentTab.append(self.GetChild("Equipment_Tab_02"))
 
-				# Belt Inventory Window
-				self.wndBelt = None
+			# Belt Inventory Window
+			self.wndBelt = None
 
 			self.dlgQuestion = uiCommon.QuestionDialog2()
 			self.dlgQuestion.Close()
 
-			if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
+			if app.ENABLE_NEW_EQUIPMENT_SYSTEM:
 				self.wndBelt = BeltInventoryWindow(self)
 
-			if app.ENABLE_ACCE_COSTUME_SYSTEM:
-				self.listHighlightedAcceSlot = []
-
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				self.listHighlightedChangeLookSlot = []
-
-			if app.ENABLE_AURA_COSTUME_SYSTEM:
-				self.listHighlightedAuraSlot = []
-
-			if app.ENABLE_CUBE_RENEWAL:
-				self.listHighlightedCubeSlot = []
-
 			if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
 				self.listHighlightedSlot = []
 
-			if app.ENABLE_EXTEND_INVEN_SYSTEM:
-				self.ExInvenQuestionDlg = uiCommon.QuestionDialog()
-				self.ExInvenQuestionDlg.Close()
-
-			if app.ENABLE_AURA_COSTUME_SYSTEM:
-				self.clear_aura_item_question_dialog = None
-
-			if app.ENABLE_GEM_CONVERTER:
-				self.gem_converter_question_dialog = None
-				self.gem_converter_item_pos = (-1, -1)
-
 			if app.ENABLE_GROWTH_PET_SYSTEM:
 				self.PetItemQuestionDlg = uiCommon.QuestionDialog()
 				self.PetItemQuestionDlg.Close()
@@ -843,26 +516,26 @@
 				self.PetSkillDelDlg = uiCommon.QuestionDialog2()
 				self.PetSkillDelDlg.Close()
 				self.PetSkillAllDelBookIndex = -1
+
 		except:
 			import exception
 			exception.Abort("InventoryWindow.LoadWindow.BindObject")
 
 		## Item
-		wndItem.SetSelectEmptySlotEvent(ui.__mem_func__(self.SelectEmptySlot), player.INVENTORY)
-		wndItem.SetSelectItemSlotEvent(ui.__mem_func__(self.SelectItemSlot), player.INVENTORY)
-		wndItem.SetUnselectItemSlotEvent(ui.__mem_func__(self.UseItemSlot), player.INVENTORY)
-		wndItem.SetUseSlotEvent(ui.__mem_func__(self.UseItemSlot), player.INVENTORY)
-		wndItem.SetOverInItemEvent(ui.__mem_func__(self.OverInItem), player.INVENTORY)
+		wndItem.SetSelectEmptySlotEvent(ui.__mem_func__(self.SelectEmptySlot))
+		wndItem.SetSelectItemSlotEvent(ui.__mem_func__(self.SelectItemSlot))
+		wndItem.SetUnselectItemSlotEvent(ui.__mem_func__(self.UseItemSlot))
+		wndItem.SetUseSlotEvent(ui.__mem_func__(self.UseItemSlot))
+		wndItem.SetOverInItemEvent(ui.__mem_func__(self.OverInItem))
 		wndItem.SetOverOutItemEvent(ui.__mem_func__(self.OverOutItem))
 
-		if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			## Equipment
-			wndEquip.SetSelectEmptySlotEvent(ui.__mem_func__(self.SelectEmptySlot), player.EQUIPMENT)
-			wndEquip.SetSelectItemSlotEvent(ui.__mem_func__(self.SelectItemSlot), player.EQUIPMENT)
-			wndEquip.SetUnselectItemSlotEvent(ui.__mem_func__(self.UseItemSlot), player.EQUIPMENT)
-			wndEquip.SetUseSlotEvent(ui.__mem_func__(self.UseItemSlot), player.EQUIPMENT)
-			wndEquip.SetOverInItemEvent(ui.__mem_func__(self.OverInItem), player.EQUIPMENT)
-			wndEquip.SetOverOutItemEvent(ui.__mem_func__(self.OverOutItem))
+		## Equipment
+		wndEquip.SetSelectEmptySlotEvent(ui.__mem_func__(self.SelectEmptySlot))
+		wndEquip.SetSelectItemSlotEvent(ui.__mem_func__(self.SelectItemSlot))
+		wndEquip.SetUnselectItemSlotEvent(ui.__mem_func__(self.UseItemSlot))
+		wndEquip.SetUseSlotEvent(ui.__mem_func__(self.UseItemSlot))
+		wndEquip.SetOverInItemEvent(ui.__mem_func__(self.OverInItem))
+		wndEquip.SetOverOutItemEvent(ui.__mem_func__(self.OverOutItem))
 
 		## PickMoneyDialog
 		dlgPickMoney = uiPickMoney.PickMoneyDialog()
@@ -891,49 +564,52 @@
 		else:
 			self.wndMoneySlot.SetEvent(ui.__mem_func__(self.OpenPickMoneyDialog))
 
-		for inven_index in range(player.INVENTORY_PAGE_COUNT): ## 0, 1, 2, 3
-			self.inventoryTab[inven_index].SetEvent(lambda arg = inven_index : self.SetInventoryPage(arg))
+		if app.ENABLE_EXTEND_INVEN_SYSTEM:
+			for inven_index in range(player.INVENTORY_PAGE_COUNT): ## 0, 1, 2, 3
+				self.inventoryTab[inven_index].SetEvent(lambda arg=inven_index: self.SetInventoryPage(arg))
+		else:
+			self.inventoryTab[0].SetEvent(lambda arg = 0: self.SetInventoryPage(arg))
+			self.inventoryTab[1].SetEvent(lambda arg = 1: self.SetInventoryPage(arg))
 		self.inventoryTab[0].Down()
 
-		if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.equipmentTab[0].SetEvent(lambda arg = 0: self.SetEquipmentPage(arg))
-			self.equipmentTab[1].SetEvent(lambda arg = 1: self.SetEquipmentPage(arg))
-			self.equipmentTab[0].Down()
-			self.equipmentTab[0].Hide()
-			self.equipmentTab[1].Hide()
-
-		## MT-436 slot bug fix
-		wndItem.SetSlotType(player.SLOT_TYPE_INVENTORY)
-		if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			wndEquip.SetSlotType(player.SLOT_TYPE_EQUIPMENT)
+		self.equipmentTab[0].SetEvent(lambda arg = 0: self.SetEquipmentPage(arg))
+		self.equipmentTab[1].SetEvent(lambda arg = 1: self.SetEquipmentPage(arg))
+		self.equipmentTab[0].Down()
+		self.equipmentTab[0].Hide()
+		self.equipmentTab[1].Hide()
 
 		self.wndItem = wndItem
-		if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.wndEquip = wndEquip
+		self.wndEquip = wndEquip
 		self.dlgPickMoney = dlgPickMoney
 
-		if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			# MallButton
-			if self.mallButton:
-				self.mallButton.SetEvent(ui.__mem_func__(self.ClickMallButton))
-
-			if self.DSSButton:
-				self.DSSButton.SetEvent(ui.__mem_func__(self.ClickDSSButton))
-
-			# Costume Button
-			if self.costumeButton:
-				self.costumeButton.SetEvent(ui.__mem_func__(self.ClickCostumeButton))
+		# MallButton
+		if self.mallButton:
+			self.mallButton.SetEvent(ui.__mem_func__(self.ClickMallButton))
 
-			self.wndCostume = None
+		if self.DSSButton:
+			self.DSSButton.SetEvent(ui.__mem_func__(self.ClickDSSButton))
 
-		if app.ENABLE_EXTEND_INVEN_SYSTEM:
-			## Extend Inven Button
-			self.__CreateExtendInvenButton()
+		# Costume Button
+		if self.costumeButton:
+			self.costumeButton.SetEvent(ui.__mem_func__(self.ClickCostumeButton))
+
+		self.wndCostume = None
+
+		#####
+
+		if app.ENABLE_SORT_INVENTORY:
+			if self.sortInventoryButton:
+				self.sortInventoryButton.SetEvent(ui.__mem_func__(self.SortInventoryButton))
+
+		if app.ENABLE_ACCE_COSTUME_SYSTEM:
+			self.listAttachedAcceSlot = []
+
+		if app.ENABLE_CHANGE_LOOK_SYSTEM:
+			self.listAttachedClSlot = []
 
 		## Refresh
 		self.SetInventoryPage(0)
-		if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.SetEquipmentPage(0)
+		self.SetEquipmentPage(0)
 		self.RefreshItemSlot()
 		self.RefreshStatus()
 
@@ -955,69 +631,54 @@
 
 		self.tooltipItem = None
 		self.wndItem = 0
-		if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.wndEquip = 0
+		self.wndEquip = 0
 		self.dlgPickMoney = 0
 		self.wndMoney = 0
 		self.wndMoneySlot = 0
 		self.questionDialog = None
 		self.mallButton = None
 		self.DSSButton = None
+		self.costumeButton = None
 		self.interface = None
-		if app.WJ_ENABLE_TRADABLE_ICON:
-			self.bindWnds = []
 
 		if app.ENABLE_CHEQUE_SYSTEM:
 			self.wndCheque = 0
 			self.wndChequeSlot = 0
 			self.dlgPickETC = 0
 
-		if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			if self.wndCostume:
-				self.wndCostume.Destroy()
-				self.wndCostume = 0
+		if self.wndCostume:
+			self.wndCostume.Destroy()
+			self.wndCostume = 0
+
+		if self.wndBelt:
+			self.wndBelt.Destroy()
+			self.wndBelt = None
 
-			if self.wndBelt:
-				self.wndBelt.Destroy()
-				self.wndBelt = None
+		if app.ENABLE_GROWTH_PET_SYSTEM:
+			if self.petHatchingWindow:
+				self.petHatchingWindow = None
+				
+			if self.petFeedWindow:
+				self.petFeedWindow = None
+				
+			if self.petNameChangeWindow:
+				self.petNameChangeWindow = None 
 
 		self.inventoryTab = []
-		if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.equipmentTab = []
-
-		if app.ENABLE_EXTEND_INVEN_SYSTEM:
-			self.ExInvenButton = []
+		self.equipmentTab = []
 
-			if self.ExInvenQuestionDlg:
-				self.ExInvenQuestionDlg.Close()
+		if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
+			self.listHighlightedSlot = []
 
-		if app.ENABLE_AURA_COSTUME_SYSTEM:
-			if self.clear_aura_item_question_dialog:
-				self.clear_aura_item_question_dialog.Close()
-			self.clear_aura_item_question_dialog = None
-
-		if app.ENABLE_GEM_CONVERTER:
-			if self.gem_converter_question_dialog:
-				self.gem_converter_question_dialog.Close()
-			self.gem_converter_question_dialog = None
+		if app.ENABLE_ACCE_COSTUME_SYSTEM:
+			self.listAttachedAcceSlot = []
 
-		if self.pop:
-			self.pop.Destroy()
-			self.pop = None
+		if app.ENABLE_CHANGE_LOOK_SYSTEM:
+			self.listAttachedClSlot = []
 
 		if app.ENABLE_GEM_SYSTEM:
 			self.wndExpandedMoneyBar = None
 
-		if app.ENABLE_GROWTH_PET_SYSTEM:
-			if self.petHatchingWindow:
-				self.petHatchingWindow = None
-
-			if self.petFeedWindow:
-				self.petFeedWindow = None
-
-			if self.petNameChangeWindow:
-				self.petNameChangeWindow = None
-
 	def Hide(self):
 		if constInfo.GET_ITEM_QUESTION_DIALOG_STATUS():
 			self.OnCloseQuestionDialog()
@@ -1026,15 +687,14 @@
 		if None != self.tooltipItem:
 			self.tooltipItem.HideToolTip()
 
-		if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			if self.wndCostume:
-				self.isOpenedCostumeWindowWhenClosingInventory = self.wndCostume.IsShow() # 인벤토리 창이 닫힐 때 코스츔이 열려 있었는가?
-				self.wndCostume.Close()
-
-			if self.wndBelt:
-				self.isOpenedBeltWindowWhenClosingInventory = self.wndBelt.IsOpeningInventory() # 인벤토리 창이 닫힐 때 벨트 인벤토리도 열려 있었는가?
-				#print "Is Opening Belt Inven?? ", self.isOpenedBeltWindowWhenClosingInventory
-				self.wndBelt.Close()
+		if self.wndCostume:
+			self.isOpenedCostumeWindowWhenClosingInventory = self.wndCostume.IsShow() # 인벤토리 창이 닫힐 때 코스츔이 열려 있었는가?
+			self.wndCostume.Close()
+
+		if self.wndBelt:
+			self.isOpenedBeltWindowWhenClosingInventory = self.wndBelt.IsOpeningInventory() # 인벤토리 창이 닫힐 때 벨트 인벤토리도 열려 있었는가?
+			print "Is Opening Belt Inven?? ", self.isOpenedBeltWindowWhenClosingInventory
+			self.wndBelt.Close()
 
 		if self.dlgPickMoney:
 			self.dlgPickMoney.Close()
@@ -1055,11 +715,9 @@
 	if app.ENABLE_GEM_SYSTEM:
 		def SetExpandedMoneyBar(self, wndBar):
 			self.wndExpandedMoneyBar = wndBar
-
 			if self.wndExpandedMoneyBar:
 				self.wndMoneySlot = self.wndExpandedMoneyBar.GetMoneySlot()
 				self.wndMoney = self.wndExpandedMoneyBar.GetMoney()
-
 				if app.ENABLE_CHEQUE_SYSTEM:
 					## 양 관련
 					self.wndMoneyIcon = self.wndExpandedMoneyBar.GetMoneyIcon()
@@ -1068,7 +726,6 @@
 						self.wndMoneyIcon.SetEvent(ui.__mem_func__(self.EventProgress), "mouse_over_out", 0)
 					if self.wndMoneySlot:
 						self.wndMoneySlot.SetEvent(ui.__mem_func__(self.OpenPickMoneyDialog), 0)
-
 					## 2차화폐 관련
 					self.wndChequeIcon = self.wndExpandedMoneyBar.GetChequeIcon()
 					if self.wndChequeIcon:
@@ -1078,205 +735,133 @@
 					if self.wndChequeSlot:
 						self.wndChequeSlot.SetEvent(ui.__mem_func__(self.OpenPickMoneyDialog), 1)
 					self.wndCheque = self.wndExpandedMoneyBar.GetCheque()
-
 					## 보석 관련
 					self.wndGemIcon = self.wndExpandedMoneyBar.GetGemIcon()
 					if self.wndGemIcon:
 						self.wndGemIcon.SetEvent(ui.__mem_func__(self.EventProgress), "mouse_over_in", 2)
 						self.wndGemIcon.SetEvent(ui.__mem_func__(self.EventProgress), "mouse_over_out", 2)
 					self.wndGem = self.wndExpandedMoneyBar.GetGem()
-
 					self.toolTip = uiToolTip.ToolTip()
 					self.toolTip.ClearToolTip()
 				else:
 					if self.wndMoneySlot:
 						self.wndMoneySlot.SetEvent(ui.__mem_func__(self.OpenPickMoneyDialog))
 
-	def SetInventoryPage(self, page):
-		self.inventoryPageIndex = page
-
-		for index in range(len(self.inventoryTab)):
-			if index == page:
-				continue
+	if app.ENABLE_EXTEND_INVEN_SYSTEM:
+		def SetInventoryPage(self, page):
+			self.inventoryPageIndex = page
 
-			self.inventoryTab[index].SetUp()
+			for index in range(len(self.inventoryTab)):
+				if index == page:
+					continue
+				self.inventoryTab[index].SetUp()
 
-		self.RefreshBagSlotWindow()
+			self.RefreshBagSlotWindow()
+	else:
+		def SetInventoryPage(self, page):
+			self.inventoryPageIndex = page
+			self.inventoryTab[1-page].SetUp()
+			self.RefreshBagSlotWindow()
+
+	def SetEquipmentPage(self, page):
+		self.equipmentPageIndex = page
+		self.equipmentTab[1-page].SetUp()
+		self.RefreshEquipSlotWindow()
+
+	def ClickMallButton(self):
+		if self.interface.dlgPassword.IsShow():
+			self.interface.dlgPassword.CloseDialog()
+		else:
+			net.SendChatPacket("/click_mall")
 
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		## Extend Inven Button
-		def __CreateExtendInvenButton(self):
-			parent = self.GetChild("board")
-
-			self.ExInvenButton = []
-			start_x = 8
-			start_y = 246
-			if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-				start_y = 55
-			img_height = 32
-
-			for button_index in range(player.EX_INVENTORY_STAGE_MAX): ## 18
-				ex_inven_button = ui.Button()
-
-				increase_y = img_height * (button_index % (player.EX_INVENTORY_STAGE_MAX / player.EX_INVENTORY_PAGE_COUNT))
-
-				ex_inven_button.SetParent(parent)
-				ex_inven_button.SetPosition(start_x, start_y + increase_y)
-				ex_inven_button.SetUpVisual(EX_INVEN_COVER_IMG_CLOSE)
-				ex_inven_button.SetOverVisual(EX_INVEN_COVER_IMG_CLOSE)
-				ex_inven_button.SetDownVisual(EX_INVEN_COVER_IMG_CLOSE)
-				ex_inven_button.SetDisableVisual(EX_INVEN_COVER_IMG_CLOSE)
-				ex_inven_button.SetEvent(ui.__mem_func__(self.__ClickExtendInvenButton), button_index + 1)
-				ex_inven_button.Hide()
-				self.ExInvenButton.append(ex_inven_button)
-
-		def __ClickExtendInvenButton(self, index):
-			net.SendExtendInvenButtonClick(index)
-
-		def __HideAllExtendInvenButton(self):
-			for index in range(len(self.ExInvenButton)):
-				self.ExInvenButton[index].Hide()
-
-		def __ShowExtendInvenButton(self, cur_stage):
-			## self.inventoryPageIndex 는 0,1,2,3 라서 EX_INVENTORY_PAGE_START -1 을 사용한다.
-			if self.inventoryPageIndex < player.EX_INVENTORY_PAGE_START - 1:
-				return
+	# DSSButton
+	def ClickDSSButton(self):
+		self.interface.ToggleDragonSoulWindow()
+
+	def ClickCostumeButton(self):
+		if self.wndCostume:
+			if self.wndCostume.IsShow():
+				self.wndCostume.Hide()
+			else:
+				self.wndCostume.Show()
+		else:
+			self.wndCostume = CostumeWindow(self)
+			self.wndCostume.Show()
 
-			## 한 페이지 당 보여줄 단계수
-			count = player.EX_INVENTORY_STAGE_MAX / player.EX_INVENTORY_PAGE_COUNT
+	def ShowCostumeInventory(self):
+		if self.wndCostume:
+			if not self.wndCostume.IsShow():
+				self.wndCostume.Show()
+		else:
+			self.wndCostume = CostumeWindow(self)
+			self.wndCostume.Show()
 
-			## 최소, 최대
-			min_range = (self.inventoryPageIndex - player.EX_INVENTORY_PAGE_START + 1) * count
-			max_range = min_range + count
-
-			for button_index in range(min_range, max_range):
-				if button_index == cur_stage:
-					self.ExInvenButton[button_index].SetUpVisual(EX_INVEN_COVER_IMG_OPEN)
-					self.ExInvenButton[button_index].SetOverVisual(EX_INVEN_COVER_IMG_OPEN)
-					self.ExInvenButton[button_index].SetDownVisual(EX_INVEN_COVER_IMG_OPEN)
-					self.ExInvenButton[button_index].SetDisableVisual(EX_INVEN_COVER_IMG_OPEN)
+	if app.ENABLE_SORT_INVENTORY:
+		def SortInventoryButton(self):
+			self.questionDialog = uiCommon.QuestionDialog()
+			self.questionDialog.SetText(localeInfo.INVENTORY_DO_YOU_SORT)
+			self.questionDialog.SetAcceptEvent(ui.__mem_func__(self.OnSortInventoryItems))
+			self.questionDialog.SetCancelEvent(ui.__mem_func__(self.OnCloseQuestionDialog))
+			self.questionDialog.Open()
 
-				if button_index < cur_stage:
-					self.ExInvenButton[button_index].Hide()
-				else:
-					self.ExInvenButton[button_index].Show()
+			constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(1)
 
-		def ExInvenItemUseMsg(self, item_vnum, msg, enough_count):
-			## 개수 부족
-			if player.EX_INVEN_FAIL_FALL_SHORT == msg:
-				self.__OpenExInvenFallShortCountMsgDlg(enough_count)
-
-			## 개수가 충분함
-			elif player.EX_INVEN_SUCCESS == msg:
-				self.__OpenExInvenQuestionDlg(enough_count)
-
-			## 4번페이지 마지막임
-			elif player.EX_INVEN_FAIL_FOURTH_PAGE_STAGE_MAX == msg:
-				self.__OpenExInvenMsgDlg(localeInfo.EXINVEN_USE_ITEM_FAIL_FOURTH_PAGE_STAGE_MAX)
+		def OnSortInventoryItems(self):
+			if None == self.questionDialog:
 				return
 
-			else:
-				return
+			net.SendChatPacket("/sort_inventory")
+			snd.PlaySound("sound/ui/pickup_item_in_inventory.wav")
 
-		def __OpenExInvenMsgDlg(self, msg):
-			popup = uiCommon.PopupDialog()
-			popup.SetText(msg)
-			popup.SetAcceptEvent(self.__OnClosePopupDialog)
-			w, h = popup.GetTextSize()
-			popup.SetWidth(w + 40)
-			line_count = popup.GetTextLineCount()
-
-			if line_count > 1:
-				height = popup.GetLineHeight()
-				popup.SetLineHeight(height + 3)
-
-			popup.Open()
-
-			if self.pop:
-				self.pop.Destroy()
-
-			self.pop = popup
-
-		def __OpenExInvenFallShortCountMsgDlg(self, enough_count):
-			popup = uiCommon.PopupDialog()
-			popup.SetText(localeInfo.EXINVEN_USE_ITEM_FAIL_FALL_SHORT % (enough_count))
-			popup.SetAcceptEvent(self.__OnClosePopupDialog)
-			popup.Open()
-
-			if self.pop:
-				self.pop.Destroy()
-
-			self.pop = popup
-
-		def __OpenExInvenQuestionDlg(self, enough_count):
-			if self.ExInvenQuestionDlg:
-				self.ExInvenQuestionDlg.SetText(localeInfo.EXINVEN_USE_ITEM_QUESTION % enough_count)
-				self.ExInvenQuestionDlg.SetAcceptEvent(ui.__mem_func__(self.__AcceptExInvenItemUse))
-				self.ExInvenQuestionDlg.SetCancelEvent(ui.__mem_func__(self.__CancelExInvenItemUse))
-				w, h = self.ExInvenQuestionDlg.GetTextSize()
-				self.ExInvenQuestionDlg.SetWidth(w + 40)
-				self.ExInvenQuestionDlg.Open()
-
-		def __AcceptExInvenItemUse(self):
-			net.SendExtendInvenUpgrade()
-			self.ExInvenQuestionDlg.Close()
-
-		def __CancelExInvenItemUse(self):
-			self.ExInvenQuestionDlg.Close()
-
-	if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-		def SetEquipmentPage(self, page):
-			self.equipmentPageIndex = page
-			self.equipmentTab[1 - page].SetUp()
-			self.RefreshEquipSlotWindow()
-
-		def ClickMallButton(self):
-			net.SendCommandPacket("/click_mall")
-
-		# DSSButton
-		def ClickDSSButton(self):
-			self.interface.ToggleDragonSoulWindow()
+			self.OnCloseQuestionDialog()
 
-		def ClickCostumeButton(self):
-			if self.wndCostume:
-				if self.wndCostume.IsShow():
-					self.wndCostume.Hide()
-				else:
-					self.wndCostume.Show()
-			else:
-				self.wndCostume = CostumeWindow(self)
-				self.wndCostume.Show()
+	if app.ENABLE_CHEQUE_SYSTEM:
+		def OpenPickMoneyDialog(self, focus_idx = 0):
+			if mouseModule.mouseController.isAttached():
 
-		def ShowCostumeInventory(self):
-			if self.wndCostume:
-				if not self.wndCostume.IsShow():
-					self.wndCostume.Show()
+				attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
+				if player.SLOT_TYPE_SAFEBOX == mouseModule.mouseController.GetAttachedType():
+					if player.ITEM_MONEY == mouseModule.mouseController.GetAttachedItemIndex():
+						net.SendSafeboxWithdrawMoneyPacket(mouseModule.mouseController.GetAttachedItemCount())
+						snd.PlaySound("sound/ui/money.wav")
+					elif player.ITEM_CHEQUE == mouseModule.mouseController.GetAttachedItemIndex() and app.ENABLE_CHEQUE_SYSTEM:
+						net.SendSafeboxWithdrawMoneyPacket(mouseModule.mouseController.GetAttachedItemCount())
+						snd.PlaySound("sound/ui/money.wav")
+
+				mouseModule.mouseController.DeattachObject()
 			else:
-				self.wndCostume = CostumeWindow(self)
-				self.wndCostume.Show()
+				curMoney = player.GetElk()
+				curCheque = player.GetCheque()
 
-	def OpenPickMoneyDialog(self, focus_idx = 0):
-		if mouseModule.mouseController.isAttached():
-			attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
-			if player.SLOT_TYPE_SAFEBOX == mouseModule.mouseController.GetAttachedType():
-				if player.ITEM_MONEY == mouseModule.mouseController.GetAttachedItemIndex():
-					net.SendSafeboxWithdrawMoneyPacket(mouseModule.mouseController.GetAttachedItemCount())
-					snd.PlaySound("sound/ui/money.wav")
+				if curMoney <= 0:
+					return
 
-			mouseModule.mouseController.DeattachObject()
-		else:
-			curMoney = player.GetElk()
-			curCheque = player.GetCheque()
+				self.dlgPickMoney.SetTitleName(localeInfo.PICK_MONEY_TITLE)
+				self.dlgPickMoney.SetAcceptEvent(ui.__mem_func__(self.OnPickMoney))
+				self.dlgPickMoney.Open(curMoney, curCheque)
+				self.dlgPickMoney.SetMax(7) # 인벤토리 990000 제한 버그 수정
+				self.dlgPickMoney.SetFocus(focus_idx)
+	else:
+		def OpenPickMoneyDialog(self):
+			if mouseModule.mouseController.isAttached():
 
-			if curMoney <= 0 and curCheque <= 0:
-				return
+				attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
+				if player.SLOT_TYPE_SAFEBOX == mouseModule.mouseController.GetAttachedType():
+					if player.ITEM_MONEY == mouseModule.mouseController.GetAttachedItemIndex():
+						net.SendSafeboxWithdrawMoneyPacket(mouseModule.mouseController.GetAttachedItemCount())
+						snd.PlaySound("sound/ui/money.wav")
 
-			self.dlgPickMoney.SetTitleName(localeInfo.PICK_MONEY_TITLE)
-			self.dlgPickMoney.SetAcceptEvent(ui.__mem_func__(self.OnPickMoney))
-			self.dlgPickMoney.Open(curMoney, curCheque)
-			self.dlgPickMoney.SetMax(7) # 인벤토리 990000 제한 버그 수정
-			if app.ENABLE_CHEQUE_SYSTEM:
-				self.dlgPickMoney.SetFocus(focus_idx)
+				mouseModule.mouseController.DeattachObject()
+			else:
+				curMoney = player.GetElk()
+
+				if curMoney <= 0:
+					return
+
+				self.dlgPickMoney.SetTitleName(localeInfo.PICK_MONEY_TITLE)
+				self.dlgPickMoney.SetAcceptEvent(ui.__mem_func__(self.OnPickMoney))
+				self.dlgPickMoney.Open(curMoney)
+				self.dlgPickMoney.SetMax(7) # 인벤토리 990000 제한 버그 수정
 
 	if app.ENABLE_CHEQUE_SYSTEM:
 		def OnPickMoney(self, money, cheque):
@@ -1287,22 +872,23 @@
 
 	def OnPickItem(self, count):
 		if app.ENABLE_CHEQUE_SYSTEM:
-			itemSlotWindow = self.dlgPickETC.itemGlobalSlotWindow
 			itemSlotIndex = self.dlgPickETC.itemGlobalSlotIndex
 		else:
-			itemSlotWindow = self.dlgPickMoney.itemGlobalSlotWindow
 			itemSlotIndex = self.dlgPickMoney.itemGlobalSlotIndex
 
-		selectedItemVNum = player.GetItemIndex(itemSlotWindow, itemSlotIndex)
-		slotType = player.WindowTypeToSlotType(itemSlotWindow)
-		mouseModule.mouseController.AttachObject(self, slotType, itemSlotIndex, selectedItemVNum, count)
-
-	def __InventoryLocalSlotPosToGlobalSlotPos(self, local, window_type = player.INVENTORY):
-		if player.INVENTORY == window_type:
-			return self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE + local
-		else:
+		selectedItemVNum = player.GetItemIndex(itemSlotIndex)
+		mouseModule.mouseController.AttachObject(self, player.SLOT_TYPE_INVENTORY, itemSlotIndex, selectedItemVNum, count)
+
+	def __InventoryLocalSlotPosToGlobalSlotPos(self, local):
+		if player.IsEquipmentSlot(local) or player.IsCostumeSlot(local) or (player.IsBeltInventorySlot(local)):
 			return local
 
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			if player.IsSkillBookInventorySlot(local) or player.IsUpgradeItemsInventorySlot(local) or player.IsStoneInventorySlot(local) or player.IsGiftBoxInventorySlot(local):
+				return local
+
+		return self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE + local
+
 	def RefreshBagSlotWindow(self):
 		if not self.wndItem:
 			return
@@ -1315,12 +901,13 @@
 		for i in xrange(self.wndItem.GetSlotCount()):
 			self.wndItem.DeactivateSlot(i)
 
-		if app.WJ_ENABLE_TRADABLE_ICON or app.ENABLE_MOVE_COSTUME_ATTR or app.ENABLE_MAILBOX:
+		if app.WJ_ENABLE_TRADABLE_ICON:
 			if self.interface:
 				onTopWindow = self.interface.GetOnTopWindow()
 
 		for i in xrange(player.INVENTORY_PAGE_SIZE):
 			slotNumber = self.__InventoryLocalSlotPosToGlobalSlotPos(i)
+			#self.wndItem.SetRealSlotNumber(i, slotNumber)
 
 			itemCount = getItemCount(slotNumber)
 			# itemCount == 0이면 소켓을 비운다.
@@ -1333,9 +920,24 @@
 			itemVnum = getItemVNum(slotNumber)
 			setItemVNum(i, itemVnum, itemCount)
 
+			if app.ENABLE_CHANGE_LOOK_SYSTEM:
+				changelookvnum = player.GetItemTransmutation(slotNumber)
+				if changelookvnum:
+					self.wndItem.DisableCoverButton(i)
+				else:
+					self.wndItem.EnableCoverButton(i)
+
+			if app.ENABLE_GROWTH_PET_SYSTEM:
+				if constInfo.IS_PET_ITEM(itemVnum):
+					self.__ActivePetHighlightSlot(slotNumber)
+					self.__SetCoolTimePetItemSlot(slotNumber, itemVnum)
+
+			#item.SelectItem(itemVnum)
+			#(width, height) = item.GetItemSize()
+
 			## 자동물약 (HP: #72723 ~ #72726, SP: #72727 ~ #72730) 특수처리 - 아이템인데도 슬롯에 활성화/비활성화 표시를 위한 작업임 - [hyo]
 			if constInfo.IS_AUTO_POTION(itemVnum):
-				# metinSocket - [0] : 활성화 여부, [1] : 사용한 양, [2] : 최대 용량
+				#metinSocket - [0] : 활성화 여부, [1] : 사용한 양, [2] : 최대 용량
 				metinSocket = [player.GetItemMetinSocket(slotNumber, j) for j in xrange(player.METIN_SOCKET_MAX_NUM)]
 				tempSlotNum = slotNumber
 				if tempSlotNum >= player.INVENTORY_PAGE_SIZE:
@@ -1345,40 +947,49 @@
 
 				if isActivated:
 					self.wndItem.ActivateSlot(tempSlotNum)
+				else:
+					self.wndItem.DeactivateSlot(tempSlotNum)
+
+			if osfInfo.IS_ANTI_EXP_RING(itemVnum):
+				metinSocket = [player.GetItemMetinSocket(slotNumber, j) for j in xrange(player.METIN_SOCKET_MAX_NUM)]
+				tempSlotNum = slotNumber
+				if tempSlotNum >= player.INVENTORY_PAGE_SIZE:
+					tempSlotNum -= (self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE)
 
-					potionType = 0
-					if constInfo.IS_AUTO_POTION_HP(itemVnum):
-						potionType = player.AUTO_POTION_TYPE_HP
-					elif constInfo.IS_AUTO_POTION_SP(itemVnum):
-						potionType = player.AUTO_POTION_TYPE_SP
+				isActivated = 0 != metinSocket[1]
 
-					player.SetAutoPotionInfo(potionType, player.INVENTORY, slotNumber)
+				if isActivated:
+					self.wndItem.ActivateSlot(tempSlotNum)
 				else:
 					self.wndItem.DeactivateSlot(tempSlotNum)
+			#ITEM_TYPE_QUEST 
+			#if item.ITEM_TYPE_QUEST == itemType:
+			#if itemVnum >= 53001 and itemVnum <= 53306:
+			if osfInfo.IS_PET_SEAL(itemVnum):
+				metinSocket = [player.GetItemMetinSocket(slotNumber, j) for j in xrange(player.METIN_SOCKET_MAX_NUM)]
 
-			if app.ENABLE_GROWTH_PET_SYSTEM:
-				if constInfo.IS_PET_ITEM(itemVnum):
-					self.__ActivePetHighlightSlot(slotNumber)
-					self.__SetCoolTimePetItemSlot(slotNumber, itemVnum)
+				if slotNumber >= player.INVENTORY_PAGE_SIZE*self.inventoryPageIndex:
+					slotNumber -= player.INVENTORY_PAGE_SIZE*self.inventoryPageIndex
 
-			if app.WJ_ENABLE_TRADABLE_ICON or app.ENABLE_MOVE_COSTUME_ATTR or app.ENABLE_MAILBOX:
-				if itemVnum and self.interface and onTopWindow:
-					if self.interface.MarkUnusableInvenSlotOnTopWnd(onTopWindow, slotNumber):
-						self.wndItem.SetUnusableSlotOnTopWnd(i)
-					else:
-						self.wndItem.SetUsableSlotOnTopWnd(i)
+				isActivated = 0 != metinSocket[1]
+				if isActivated:
+					self.wndItem.ActivateSlot(slotNumber)
 				else:
-					self.wndItem.SetUsableSlotOnTopWnd(i)
+					self.wndItem.DeactivateSlot(slotNumber)
 
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				if not player.GetChangeLookVnum(player.INVENTORY, slotNumber) == 0:
-					self.wndItem.SetSlotCoverImage(i, "icon/item/ingame_convert_Mark.tga")
-				else:
-					self.wndItem.EnableSlotCoverImage(i, False)
 
-			if app.ENABLE_GEM_CONVERTER:
-				if slotNumber in self.gem_converter_item_pos:
-					self.wndItem.SetCantMouseEventSlot(i)
+			if item.IsPetPay(itemVnum):
+				metinSocket = [player.GetItemMetinSocket(slotNumber, j) for j in xrange(player.METIN_SOCKET_MAX_NUM)]
+				tempSlotNum = slotNumber
+				if tempSlotNum >= player.INVENTORY_PAGE_SIZE:
+					tempSlotNum -= (self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE)
+
+				isActivated = 0 != metinSocket[1]
+
+				if isActivated:
+					self.wndItem.ActivateSlot(tempSlotNum)
+				else:
+					self.wndItem.DeactivateSlot(tempSlotNum)
 
 			if app.ENABLE_SOUL_SYSTEM:
 				if item.IsSoulItem(itemVnum):
@@ -1392,78 +1003,143 @@
 					else:
 						self.wndItem.DeactivateSlot(tempSlotNum)
 
-			## [MT-662] 일반펫 소환표시 마크
-			if (item.ITEM_TYPE_QUEST == item.GetItemType() and item.QUEST_PET_PAY == item.GetItemSubType()) or\
-				(item.ITEM_TYPE_PET == item.GetItemType() and item.PET_PAY == item.GetItemSubType()):
-				metinSocket = [player.GetItemMetinSocket(slotNumber, j) for j in xrange(player.METIN_SOCKET_MAX_NUM)]
-				tempSlotNum = slotNumber
-				if tempSlotNum >= player.INVENTORY_PAGE_SIZE:
-					tempSlotNum -= (self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE)
-				if 0 != metinSocket[1]:
-					self.wndItem.ActivateSlot(tempSlotNum)
+			if app.ENABLE_EXTENDED_BLEND_AFFECT:
+				if osfInfo.IS_BLEND_POTION(itemVnum) or osfInfo.IS_EXTENDED_BLEND_POTION(itemVnum):
+					metinSocket = [player.GetItemMetinSocket(slotNumber, j) for j in xrange(player.METIN_SOCKET_MAX_NUM)]
+					tempSlotNum = slotNumber
+					if tempSlotNum >= player.INVENTORY_PAGE_SIZE:
+						tempSlotNum -= (self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE)
+
+					isActivated = 0 != metinSocket[3]
+
+					if osfInfo.IS_EXTENDED_BLEND_POTION(itemVnum):
+						r, g, b = (150.00 / 255.0), (80.00 / 255.0), (255.00 / 255.0) # rgb(150, 80, 255)
+					else:
+						r, g, b = (255.00 / 255.0), (255.00 / 255.0), (0.00 / 255.0) # rgb(255, 255, 0)
+
+					if isActivated:
+						self.wndItem.ActivateSlotEffect(tempSlotNum, r, g, b, 1.0)
+					else:
+						self.wndItem.DeactivateSlotEffect(tempSlotNum)
+
+				if osfInfo.IS_EXTENDED_BLEND_POTION(itemVnum):
+					self.wndItem.SetCoverButton(i,
+						"d:/ymir work/ui/game/quest/slot_button_00.sub",\
+						"d:/ymir work/ui/game/quest/slot_button_00.sub",\
+						"d:/ymir work/ui/game/quest/slot_button_00.sub",\
+						"d:/ymir work/ui/acce/ingame_convert_mark_02.tga", False, False)
+					self.wndItem.DisableCoverButton(i)
+				elif osfInfo.IS_BLEND_POTION(itemVnum):
+					self.wndItem.SetCoverButton(i,
+						"d:/ymir work/ui/game/quest/slot_button_00.sub",\
+						"d:/ymir work/ui/game/quest/slot_button_00.sub",\
+						"d:/ymir work/ui/game/quest/slot_button_00.sub",\
+						"icon/item/trade.tga", False, False)
+					self.wndItem.DisableCoverButton(i)
+
+			if app.ENABLE_ACCE_COSTUME_SYSTEM or app.ENABLE_CHANGE_LOOK_SYSTEM:
+				if app.ENABLE_EXTENDED_BLEND_AFFECT:
+					if not osfInfo.IS_BLEND_POTION(itemVnum) and not osfInfo.IS_EXTENDED_BLEND_POTION(itemVnum):
+						self.wndItem.DeactivateSlotEffect(i)
 				else:
-					self.wndItem.DeactivateSlot(tempSlotNum)
+					self.wndItem.DeactivateSlotEffect(i)
 
-		self.__HighlightSlot_Refresh()
+			if app.ENABLE_ACCE_COSTUME_SYSTEM:
+				AcceSlotNumberChecked = 0
+				for j in xrange(acce.WINDOW_MAX_MATERIALS):
+					(isHere, iCell) = acce.GetAttachedItem(j)
+
+					if isHere:
+						if iCell == slotNumber:
+							self.wndItem.ActivateSlotEffect(i, (36.00 / 255.0), (222.00 / 255.0), (3.00 / 255.0), 1.0)
+							if not slotNumber in self.listAttachedAcceSlot:
+								self.listAttachedAcceSlot.append(slotNumber)
 
-		if app.ENABLE_EXTEND_INVEN_SYSTEM:
-			self.__RefreshExinvenCoverSlot()
-			self.__RefreshExinvenSlotState()
+							AcceSlotNumberChecked = 1
+					else:
+						if slotNumber in self.listAttachedAcceSlot and not AcceSlotNumberChecked:
+							self.wndItem.DeactivateSlotEffect(i)
+							self.listAttachedAcceSlot.remove(slotNumber)
+
+			if app.ENABLE_CHANGE_LOOK_SYSTEM:
+				ClSlotNumberChecked = 0
+				for q in xrange(changelook.WINDOW_MAX_MATERIALS):
+					(isHere, iCell) = changelook.GetAttachedItem(q)
+
+					if isHere:
+						if iCell == slotNumber:
+							self.wndItem.ActivateSlotEffect(i, (238.00 / 255.0), (11.00 / 255.0), (11.00 / 255.0), 1.0)
+							if not slotNumber in self.listAttachedClSlot:
+								self.listAttachedClSlot.append(slotNumber)
+
+							ClSlotNumberChecked = 1
+					else:
+						if slotNumber in self.listAttachedClSlot and not ClSlotNumberChecked:
+							self.wndItem.DeactivateSlotEffect(i)
+							self.listAttachedClSlot.remove(slotNumber)
+
+			if app.WJ_ENABLE_TRADABLE_ICON:
+				if itemVnum and self.interface and onTopWindow:
+					if self.interface.MarkUnusableInvenSlotOnTopWnd(onTopWindow, slotNumber):
+						if itemVnum == 50200 and uiPrivateShopBuilder.IsBuildingPrivateShop():
+							self.wndItem.SetCantMouseEventSlot(i)
+						else:
+							self.wndItem.SetUnusableSlotOnTopWnd(i)
+					else:
+						self.wndItem.SetUsableSlotOnTopWnd(i)
+				else:
+					self.wndItem.SetUsableSlotOnTopWnd(i)
+
+		if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
+			self.__HighlightSlot_Refresh()
 
 		self.wndItem.RefreshSlot()
 
-		if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			if self.wndBelt:
-				self.wndBelt.RefreshSlot()
+		if self.wndBelt:
+			self.wndBelt.RefreshSlot()
 
-		if app.WJ_ENABLE_TRADABLE_ICON:
-			map(lambda wnd:wnd.RefreshLockedSlot(), self.bindWnds)
+	def RefreshEquipSlotWindow(self):
+		getItemVNum=player.GetItemIndex
+		getItemCount=player.GetItemCount
+		setItemVNum=self.wndEquip.SetItemSlot
 
-	if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-		def RefreshEquipSlotWindow(self):
-			getItemVNum = ReprGetItemIndex(player.EQUIPMENT)
-			getItemCount = ReprGetItemCount(player.EQUIPMENT)
-			setItemVNum = self.wndEquip.SetItemSlot
+		for i in xrange(player.EQUIPMENT_PAGE_COUNT):
+			slotNumber = player.EQUIPMENT_SLOT_START + i
+			itemCount = getItemCount(slotNumber)
+			if itemCount <= 1:
+				itemCount = 0
+			setItemVNum(slotNumber, getItemVNum(slotNumber), itemCount)
 
-			for i in xrange(player.WEAR_MAX): ## 32 ( 0 ~ 31 )
-				itemCount = getItemCount(i)
+			if app.ENABLE_CHANGE_LOOK_SYSTEM:
+				changelookvnum = player.GetItemTransmutation(slotNumber)
+				if changelookvnum:
+					self.wndEquip.DisableCoverButton(slotNumber)
+				else:
+					self.wndEquip.EnableCoverButton(slotNumber)
+
+		if app.ENABLE_NEW_EQUIPMENT_SYSTEM:
+			for i in xrange(player.NEW_EQUIPMENT_SLOT_COUNT):
+				slotNumber = player.NEW_EQUIPMENT_SLOT_START + i
+				itemCount = getItemCount(slotNumber)
 				if itemCount <= 1:
 					itemCount = 0
-				setItemVNum(i, getItemVNum(i), itemCount)
+				setItemVNum(slotNumber, getItemVNum(slotNumber), itemCount)
 
 				if app.ENABLE_CHANGE_LOOK_SYSTEM:
-					if not player.GetChangeLookVnum(player.EQUIPMENT, i) == 0:
-						self.wndEquip.SetSlotCoverImage(i, "icon/item/ingame_convert_Mark.tga")
+					changelookvnum = player.GetItemTransmutation(slotNumber)
+					if changelookvnum:
+						self.wndEquip.DisableCoverButton(slotNumber)
 					else:
-						self.wndEquip.EnableSlotCoverImage(i,False)
+						self.wndEquip.EnableCoverButton(slotNumber)
 
-			self.wndEquip.RefreshSlot()
+		self.wndEquip.RefreshSlot()
 
-			if self.wndCostume:
-				self.wndCostume.RefreshCostumeSlot()
+		if self.wndCostume:
+			self.wndCostume.RefreshCostumeSlot()
 
 	def RefreshItemSlot(self):
 		self.RefreshBagSlotWindow()
-		if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			self.RefreshEquipSlotWindow()
-
-	if app.ENABLE_EXTEND_INVEN_SYSTEM:
-		def __RefreshExinvenCoverSlot(self):
-			cur_stage = player.GetExtendInvenStage()
-
-			self.__HideAllExtendInvenButton()
-			self.__ShowExtendInvenButton(cur_stage)
-
-		def __RefreshExinvenSlotState(self):
-			inventory_max = player.GetExtendInvenMax()
-
-			for i in xrange(player.INVENTORY_PAGE_SIZE):
-				slotNumber = self.__InventoryLocalSlotPosToGlobalSlotPos(i)
-
-				if slotNumber >= inventory_max:
-					self.wndItem.LockSlot(i)
-				else:
-					self.wndItem.UnlockSlot(i)
+		self.RefreshEquipSlotWindow()
 
 	def RefreshStatus(self):
 		money = player.GetElk()
@@ -1478,23 +1154,24 @@
 				gem = player.GetGem()
 				self.wndGem.SetText(localeInfo.NumberToMoneyString(gem))
 
-	def SetItemToolTip(self, tooltipItemvalue):
-		from _weakref import proxy
-		self.tooltipItem = proxy(tooltipItemvalue)
+	def SetItemToolTip(self, tooltipItem):
+		self.tooltipItem = tooltipItem
 
 	def SellItem(self):
-		if self.sellingSlotitemIndex == player.GetItemIndex(self.sellingSlotWindow, self.sellingSlotNumber):
-			if self.sellingSlotitemCount == player.GetItemCount(self.sellingSlotWindow, self.sellingSlotNumber):
+		if self.sellingSlotitemIndex == player.GetItemIndex(self.sellingSlotNumber):
+			if self.sellingSlotitemCount == player.GetItemCount(self.sellingSlotNumber):
 				## 용혼석도 팔리게 하는 기능 추가하면서 인자 type 추가
-				net.SendShopSellPacketNew(self.sellingSlotNumber, self.questionDialog.count, self.sellingSlotWindow)
+				net.SendShopSellPacketNew(self.sellingSlotNumber, self.questionDialog.count, player.INVENTORY)
 				snd.PlaySound("sound/ui/money.wav")
+
 		self.OnCloseQuestionDialog()
 
 	def OnDetachMetinFromItem(self):
 		if None == self.questionDialog:
 			return
 
-		self.__SendUseItemToItemPacket(self.questionDialog.sourceWindow, self.questionDialog.sourcePos, self.questionDialog.targetWindow, self.questionDialog.targetPos)
+		#net.SendItemUseToItemPacket(self.questionDialog.sourcePos, self.questionDialog.targetPos)
+		self.__SendUseItemToItemPacket(self.questionDialog.sourcePos, self.questionDialog.targetPos)
 		self.OnCloseQuestionDialog()
 
 	def OnCloseQuestionDialog(self):
@@ -1506,29 +1183,21 @@
 		constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(0)
 
 	## Slot Event
-	def SelectEmptySlot(self, selectedSlotPos, selectedSlotWindow):
+	def SelectEmptySlot(self, selectedSlotPos):
 		if constInfo.GET_ITEM_QUESTION_DIALOG_STATUS() == 1:
 			return
 
 		## 악세서리 창이 열려있으면
 		## 아이템 이동 금지.
-		if app.ENABLE_ACCE_COSTUME_SYSTEM:
-			if player.GetAcceRefineWindowOpen():
-				return
+		#if app.ENABLE_ACCE_COSTUME_SYSTEM:
+		#	if player.GetAcceRefineWindowOpen() == 1:
+		#		return
 
 		if app.ENABLE_CHANGE_LOOK_SYSTEM:
-			if player.GetChangeLookWindowOpen():
-				return
-
-		if app.ENABLE_AURA_COSTUME_SYSTEM:
-			if player.IsAuraWindowOpen():
+			if player.GetChangeLookWindowOpen() == 1:
 				return
 
-		if app.ENABLE_ATTR_6TH_7TH:
-			if self.interface.wndAttr67Add.IsShow():
-				return
-
-		selectedSlotPos = self.__InventoryLocalSlotPosToGlobalSlotPos(selectedSlotPos, selectedSlotWindow)
+		selectedSlotPos = self.__InventoryLocalSlotPosToGlobalSlotPos(selectedSlotPos)
 
 		if mouseModule.mouseController.isAttached():
 			attachedSlotType = mouseModule.mouseController.GetAttachedType()
@@ -1536,99 +1205,107 @@
 			attachedItemCount = mouseModule.mouseController.GetAttachedItemCount()
 			attachedItemIndex = mouseModule.mouseController.GetAttachedItemIndex()
 
-			if player.SLOT_TYPE_INVENTORY == attachedSlotType:
-				if attachedSlotPos >= player.ITEM_SLOT_COUNT:
-					mouseModule.mouseController.DeattachObject()
-					return
-
-				self.__SendMoveItemPacket(player.INVENTORY, attachedSlotPos, selectedSlotWindow, selectedSlotPos, attachedItemCount)
-
-				if item.IsRefineScroll(attachedItemIndex):
-					self.interface.SetUseItemMode(False)
-
-			elif player.SLOT_TYPE_EQUIPMENT == attachedSlotType:
-				if attachedSlotPos >= player.WEAR_MAX:
-					mouseModule.mouseController.DeattachObject()
-					return
-
-				self.__SendMoveItemPacket(player.EQUIPMENT, attachedSlotPos, selectedSlotWindow, selectedSlotPos, attachedItemCount)
-
-			elif player.SLOT_TYPE_BELT_INVENTORY == attachedSlotType:
-				if attachedSlotPos >= item.BELT_INVENTORY_SLOT_COUNT:
-					mouseModule.mouseController.DeattachObject()
-					return
+			if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+				if player.SLOT_TYPE_INVENTORY == attachedSlotType or\
+					player.SLOT_TYPE_SKILL_BOOK_INVENTORY == attachedSlotType or\
+					player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == attachedSlotType or\
+					player.SLOT_TYPE_STONE_INVENTORY == attachedSlotType or\
+					player.SLOT_TYPE_GIFT_BOX_INVENTORY == attachedSlotType:
+
+					itemCount = player.GetItemCount(attachedSlotPos)
+					attachedCount = mouseModule.mouseController.GetAttachedItemCount()
+
+					self.__SendMoveItemPacket(attachedSlotPos, selectedSlotPos, attachedCount)
+
+					if item.IsRefineScroll(attachedItemIndex):
+						self.interface.SetUseItemMode(False)
+
+				elif player.SLOT_TYPE_PRIVATE_SHOP == attachedSlotType:
+					mouseModule.mouseController.RunCallBack("INVENTORY")
+
+				elif player.SLOT_TYPE_SHOP == attachedSlotType:
+					net.SendShopBuyPacket(attachedSlotPos)
+
+				elif player.SLOT_TYPE_SAFEBOX == attachedSlotType:
+					if player.ITEM_MONEY == attachedItemIndex:
+						net.SendSafeboxWithdrawMoneyPacket(mouseModule.mouseController.GetAttachedItemCount())
+						snd.PlaySound("sound/ui/money.wav")
+					else:
+						net.SendSafeboxCheckoutPacket(attachedSlotPos, selectedSlotPos)
 
-				self.__SendMoveItemPacket(player.BELT_INVENTORY, attachedSlotPos, selectedSlotWindow, selectedSlotPos, attachedItemCount)
+				elif player.SLOT_TYPE_MALL == attachedSlotType:
+					net.SendMallCheckoutPacket(attachedSlotPos, selectedSlotPos)
+			else:
+				if player.SLOT_TYPE_INVENTORY == attachedSlotType:
+					itemCount = player.GetItemCount(attachedSlotPos)
+					attachedCount = mouseModule.mouseController.GetAttachedItemCount()
 
-			elif player.SLOT_TYPE_PRIVATE_SHOP == attachedSlotType:
-				mouseModule.mouseController.RunCallBack("INVENTORY")
+					self.__SendMoveItemPacket(attachedSlotPos, selectedSlotPos, attachedCount)
 
-			elif player.SLOT_TYPE_SHOP == attachedSlotType:
-				net.SendShopBuyPacket(attachedSlotPos)
+					if item.IsRefineScroll(attachedItemIndex):
+						self.interface.SetUseItemMode(False)
 
-			elif player.SLOT_TYPE_SAFEBOX == attachedSlotType:
-				if player.ITEM_MONEY == attachedItemIndex:
-					net.SendSafeboxWithdrawMoneyPacket(mouseModule.mouseController.GetAttachedItemCount())
-					snd.PlaySound("sound/ui/money.wav")
-				else:
-					net.SendSafeboxCheckoutPacket(attachedSlotPos, selectedSlotWindow, selectedSlotPos)
+				elif player.SLOT_TYPE_PRIVATE_SHOP == attachedSlotType:
+					mouseModule.mouseController.RunCallBack("INVENTORY")
 
-			elif player.SLOT_TYPE_MALL == attachedSlotType:
-				net.SendMallCheckoutPacket(attachedSlotPos, selectedSlotWindow, selectedSlotPos)
+				elif player.SLOT_TYPE_SHOP == attachedSlotType:
+					net.SendShopBuyPacket(attachedSlotPos)
 
-			if app.ENABLE_ACCE_COSTUME_SYSTEM:
-				if player.SLOT_TYPE_ACCE == attachedSlotType:
-					#net.SendAcceRefineCheckOut(attachedSlotPos)
-					pass
+				elif player.SLOT_TYPE_SAFEBOX == attachedSlotType:
+					if player.ITEM_MONEY == attachedItemIndex:
+						net.SendSafeboxWithdrawMoneyPacket(mouseModule.mouseController.GetAttachedItemCount())
+						snd.PlaySound("sound/ui/money.wav")
+					else:
+						net.SendSafeboxCheckoutPacket(attachedSlotPos, selectedSlotPos)
 
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				if player.SLOT_TYPE_CHANGE_LOOK == attachedSlotType:
-					#net.SendChangeLookCheckOut(attachedSlotPos)
-					pass
-
-			if app.ENABLE_AURA_COSTUME_SYSTEM:
-				if player.SLOT_TYPE_AURA == attachedSlotType:
-					#net.SendAuraRefineCheckOut(attachedSlotPos)
-					pass
+				elif player.SLOT_TYPE_MALL == attachedSlotType:
+					net.SendMallCheckoutPacket(attachedSlotPos, selectedSlotPos)
 
 			mouseModule.mouseController.DeattachObject()
 
-	def SelectItemSlot(self, itemSlotIndex, window_type):
+	def SelectItemSlot(self, itemSlotIndex):
 		if constInfo.GET_ITEM_QUESTION_DIALOG_STATUS() == 1:
 			return
 
-		itemSlotIndex = self.__InventoryLocalSlotPosToGlobalSlotPos(itemSlotIndex, window_type)
+		## 2021.02.01.Owsap - Prevent unequipping an item while acting emotion.
+		if player.IsActingEmotion():
+			return
+
+		itemSlotIndex = self.__InventoryLocalSlotPosToGlobalSlotPos(itemSlotIndex)
 
 		if mouseModule.mouseController.isAttached():
 			attachedSlotType = mouseModule.mouseController.GetAttachedType()
 			attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
 			attachedItemVID = mouseModule.mouseController.GetAttachedItemIndex()
 
-			if player.SLOT_TYPE_INVENTORY == attachedSlotType or\
-				player.SLOT_TYPE_BELT_INVENTORY == attachedSlotType or\
-				player.SLOT_TYPE_EQUIPMENT == attachedSlotType:
-				if attachedSlotPos >= player.ITEM_SLOT_COUNT:
-					mouseModule.mouseController.DeattachObject()
-					return
+			if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+				if player.SLOT_TYPE_INVENTORY == attachedSlotType or\
+					player.SLOT_TYPE_SKILL_BOOK_INVENTORY == attachedSlotType or\
+					player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == attachedSlotType or\
+					player.SLOT_TYPE_STONE_INVENTORY == attachedSlotType or\
+					player.SLOT_TYPE_GIFT_BOX_INVENTORY == attachedSlotType:
 
-				attachedWindow = player.SlotTypeToInvenType(attachedSlotType)
-				self.__DropSrcItemToDestItemInInventory(attachedItemVID, attachedWindow, attachedSlotPos, window_type, itemSlotIndex)
+					self.__DropSrcItemToDestItemInInventory(attachedItemVID, attachedSlotPos, itemSlotIndex)
+			else:
+				if player.SLOT_TYPE_INVENTORY == attachedSlotType:
+					self.__DropSrcItemToDestItemInInventory(attachedItemVID, attachedSlotPos, itemSlotIndex)
 
 			mouseModule.mouseController.DeattachObject()
 		else:
 			curCursorNum = app.GetCursor()
+
 			if app.SELL == curCursorNum:
-				self.__SellItem(window_type, itemSlotIndex)
+				self.__SellItem(itemSlotIndex)
 
 			elif app.BUY == curCursorNum:
 				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.SHOP_BUY_INFO)
 
 			elif app.IsPressed(app.DIK_LALT):
-				link = player.GetItemLink(window_type, itemSlotIndex)
+				link = player.GetItemLink(itemSlotIndex)
 				ime.PasteString(link)
 
 			elif app.IsPressed(app.DIK_LSHIFT):
-				itemCount = player.GetItemCount(window_type, itemSlotIndex)
+				itemCount = player.GetItemCount(itemSlotIndex)
 
 				if itemCount > 1:
 					if app.ENABLE_CHEQUE_SYSTEM:
@@ -1636,45 +1313,31 @@
 						self.dlgPickETC.SetAcceptEvent(ui.__mem_func__(self.OnPickItem))
 						self.dlgPickETC.Open(itemCount)
 						self.dlgPickETC.itemGlobalSlotIndex = itemSlotIndex
-						self.dlgPickETC.itemGlobalSlotWindow = window_type
 					else:
 						self.dlgPickMoney.SetTitleName(localeInfo.PICK_ITEM_TITLE)
 						self.dlgPickMoney.SetAcceptEvent(ui.__mem_func__(self.OnPickItem))
 						self.dlgPickMoney.Open(itemCount)
 						self.dlgPickMoney.itemGlobalSlotIndex = itemSlotIndex
-						self.dlgPickMoney.itemGlobalSlotWindow = window_type
-
-				if app.ENABLE_GROWTH_PET_SYSTEM:
-					if item.GetItemType() == item.ITEM_TYPE_PET and item.GetItemSubType() == item.PET_UPBRINGING:
-						self.interface.TogglePetInformationWindow()
-						return
+				#else:
+				#	selectedItemVNum = player.GetItemIndex(itemSlotIndex)
+				#	mouseModule.mouseController.AttachObject(self, player.SLOT_TYPE_INVENTORY, itemSlotIndex, selectedItemVNum)
 
 			elif app.IsPressed(app.DIK_LCONTROL):
-				itemIndex = player.GetItemIndex(window_type, itemSlotIndex)
+				itemIndex = player.GetItemIndex(itemSlotIndex)
 
 				if True == item.CanAddToQuickSlotItem(itemIndex):
-					if window_type == player.INVENTORY:
-						player.RequestAddToEmptyLocalQuickSlot(player.SLOT_TYPE_INVENTORY, itemSlotIndex)
-					elif window_type == player.BELT_INVENTORY:
-						player.RequestAddToEmptyLocalQuickSlot(player.SLOT_TYPE_BELT_INVENTORY, itemSlotIndex)
+					player.RequestAddToEmptyLocalQuickSlot(player.SLOT_TYPE_INVENTORY, itemSlotIndex)
 				else:
 					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.QUICKSLOT_REGISTER_DISABLE_ITEM)
 			else:
-				selectedItemVNum = player.GetItemIndex(window_type, itemSlotIndex)
-				itemCount = player.GetItemCount(window_type, itemSlotIndex)
-
-				# Garante que o tipo de slot para equipamentos e corretamente identificado
-				if window_type == player.EQUIPMENT:
-					attachSlotType = player.SLOT_TYPE_EQUIPMENT
-				else:
-					attachSlotType = player.WindowTypeToSlotType(window_type)
+				selectedItemVNum = player.GetItemIndex(itemSlotIndex)
+				itemCount = player.GetItemCount(itemSlotIndex)
 
 				if app.ENABLE_GROWTH_PET_SYSTEM:
 					if self.__CanAttachGrowthPetItem(selectedItemVNum, itemSlotIndex):
-						# Substituido o 'player.SLOT_TYPE_INVENTORY' fixo por 'attachSlotType'
-						mouseModule.mouseController.AttachObject(self, attachSlotType, itemSlotIndex, selectedItemVNum, itemCount)
+						mouseModule.mouseController.AttachObject(self, player.SLOT_TYPE_INVENTORY, itemSlotIndex, selectedItemVNum, itemCount)
 				else:
-					mouseModule.mouseController.AttachObject(self, attachSlotType, itemSlotIndex, selectedItemVNum, itemCount)
+					mouseModule.mouseController.AttachObject(self, player.SLOT_TYPE_INVENTORY, itemSlotIndex, selectedItemVNum, itemCount)
 
 				if self.__IsUsableItemToItem(selectedItemVNum, itemSlotIndex):
 					self.interface.SetUseItemMode(True)
@@ -1683,200 +1346,98 @@
 
 				snd.PlaySound("sound/ui/pick.wav")
 
-	def __DropSrcItemToDestItemInInventory(self, srcItemVID, srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos):
-		if srcItemSlotWindow == dstItemSlotWindow:
-			if srcItemSlotPos == dstItemSlotPos:
+	def __DropSrcItemToDestItemInInventory(self, srcItemVID, srcItemSlotPos, dstItemSlotPos):
+		if srcItemSlotPos == dstItemSlotPos:
+			return
+
+		if app.ENABLE_CHANGE_LOOK_SYSTEM:
+			if player.GetChangeLookWindowOpen() == 1:
 				return
 
 		## 악세서리 창이 열려있으면
 		## 아이템 이동 금지.
 		if app.ENABLE_ACCE_COSTUME_SYSTEM:
-			if player.GetAcceRefineWindowOpen():
-				return
-
-		if app.ENABLE_CHANGE_LOOK_SYSTEM:
-			if player.GetChangeLookWindowOpen():
-				return
-
-		if app.ENABLE_AURA_COSTUME_SYSTEM:
-			if player.IsAuraWindowOpen():
-				return
-
-		if app.ENABLE_ATTR_6TH_7TH:
-			if self.interface.wndAttr67Add.IsShow():
+			if player.GetAcceRefineWindowOpen() == 1:
 				return
 
-		## [MT-462]
-		if player.GetItemIndex(srcItemSlotWindow, srcItemSlotPos) == player.GetItemIndex(dstItemSlotWindow, dstItemSlotPos) \
-			and (player.GetItemFlags(srcItemSlotWindow, srcItemSlotPos) & item.ITEM_FLAG_STACKABLE) \
-			and player.IsEquipmentSlot(dstItemSlotWindow, dstItemSlotPos) == False:
-			self.__SendMoveItemPacket(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos, 0)
-			return
-
-		if app.ENABLE_SOULBIND_SYSTEM:
+		if app.ENABLE_SOUL_BIND_SYSTEM:
 			# cyh itemseal 2013 11 08
 			if item.IsSealScroll(srcItemVID):
-				if player.CanSealItem(srcItemVID, dstItemSlotWindow, dstItemSlotPos):
-					self.__OpenQuestionDialog(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos)
-
-		useType = item.GetUseType(srcItemVID)
+				if player.CanSealItem(srcItemVID, player.INVENTORY, dstItemSlotPos):
+					self.__OpenQuestionDialog(srcItemSlotPos, dstItemSlotPos)
 
 		if item.IsRefineScroll(srcItemVID):
-			self.RefineItem(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos)
+			self.RefineItem(srcItemSlotPos, dstItemSlotPos)
 			self.interface.SetUseItemMode(False)
 
 		elif item.IsMetin(srcItemVID):
-			self.AttachMetinToItem(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos)
+			self.AttachMetinToItem(srcItemSlotPos, dstItemSlotPos)
 
 		elif item.IsDetachScroll(srcItemVID):
-			self.DetachMetinFromItem(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos)
+			self.DetachMetinFromItem(srcItemSlotPos, dstItemSlotPos)
 
 		elif item.IsKey(srcItemVID):
-			self.__SendUseItemToItemPacket(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos)
+			self.__SendUseItemToItemPacket(srcItemSlotPos, dstItemSlotPos)
 
 		elif (player.GetItemFlags(srcItemSlotPos) & ITEM_FLAG_APPLICABLE) == ITEM_FLAG_APPLICABLE:
-			self.__SendUseItemToItemPacket(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos)
+			self.__SendUseItemToItemPacket(srcItemSlotPos, dstItemSlotPos)
 
-		elif useType in self.USE_TYPE_TUPLE:
-			if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-				if "USE_ELEMENT_UPGRADE" == useType:
-					if not uiRefine.RefineElementDialog.CanRefineElementUpgrade(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos, True, False):
-						return
-
-				elif "USE_ELEMENT_DOWNGRADE" == useType:
-					if not uiRefine.RefineElementDialog.CanRefineElementDowngrade(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos, True, False):
-						return
+		elif item.GetUseType(srcItemVID) in self.USE_TYPE_TUPLE:
+			self.__SendUseItemToItemPacket(srcItemSlotPos, dstItemSlotPos)
 
-				elif "USE_ELEMENT_CHANGE" == useType:
-					if not uiRefine.RefineElementChangeDialog.CanRefineElementChange(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos, True, False):
-						return
-
-			self.__SendUseItemToItemPacket(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos)
+		elif app.ENABLE_67TH_BONUS and (srcItemVID == item.ADD_RARE_ATTRIBUTE_VNUM or srcItemVID == item.CHANGE_RARE_ATTRIBUTE_VNUM):
+			self.__SendUseItemToItemPacket(srcItemSlotPos, dstItemSlotPos)
 
 		else:
-			if app.ENABLE_ACCE_COSTUME_SYSTEM:
-				if item.IsAcceScroll(srcItemVID):
-					if player.CanAcceClearItem(srcItemVID, dstItemSlotWindow, dstItemSlotPos):
-						self.__OpenQuestionDialog(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos)
-						return
-
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				if item.IsChangeLookClearScroll(srcItemVID):
-					if dstItemSlotWindow != player.INVENTORY:
-						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.CHANGE_LOOK_DO_NOT_EQUIP_ITEM)
-						return
-
-					if player.CanChangeLookClearItem(srcItemVID, dstItemSlotWindow, dstItemSlotPos):
-						self.__OpenQuestionDialog(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos)
-						return
-
 			if app.ENABLE_GROWTH_PET_SYSTEM:
 				if self.__IsPetItem(srcItemVID):
 					if self.__SendUsePetItemToItemPacket(srcItemVID, srcItemSlotPos, dstItemSlotPos):
 						return
 
-			if app.ENABLE_AURA_COSTUME_SYSTEM:
-				if srcItemVID == item.ITEM_VNUM_AURA_CLEAR:
-					if player.CanAuraClearItem(srcItemVID, dstItemSlotWindow, dstItemSlotPos):
-						self.__UseAuraClearItem(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos)
-						return
-
-			if app.ENABLE_SET_ITEM:
-				if item.IsSetClearScroll(srcItemVID):
-					if player.CanSetItemClear(srcItemVID, dstItemSlotWindow, dstItemSlotPos):
-						self.__OpenSetClearItemQuestionDialog(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos)
-						return
-
-			if app.ENABLE_GEM_CONVERTER:
-				if srcItemVID == item.ITEM_VNUM_GEM_CONVERTER:
-					if self.__CanUseGemConverter(srcItemVID, srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos):
-						self.__UseGemConverter(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos)
-						return
-
 			## 이동시킨 곳이 장착 슬롯일 경우 아이템을 사용해서 장착 시킨다 - [levites]
-			if player.IsEquipmentSlot(dstItemSlotWindow, dstItemSlotPos):
+			if player.IsEquipmentSlot(dstItemSlotPos):
+
 				## 들고 있는 아이템이 장비일때만
 				if item.IsEquipmentVID(srcItemVID):
-					self.__UseItem(srcItemSlotPos, srcItemSlotWindow)
+					self.__UseItem(srcItemSlotPos)
 			else:
-				self.__SendMoveItemPacket(srcItemSlotWindow, srcItemSlotPos, dstItemSlotWindow, dstItemSlotPos, 0)
+				self.__SendMoveItemPacket(srcItemSlotPos, dstItemSlotPos, 0)
+				# net.SendItemMovePacket(srcItemSlotPos, dstItemSlotPos, 0)
 
-	def __OpenQuestionDialog(self, srcItemWindow, srcItemPos, dstItemWindow, dstItemPos):
+	def __OpenQuestionDialog(self, srcItemPos, dstItemPos):
 		if self.interface.IsShowDlgQuestionWindow():
 			self.interface.CloseDlgQuestionWindow()
 
-		getItemVNum = player.GetItemIndex
+		getItemVNum = player.GetItemIndex(dstItemPos)
+
 		self.srcItemPos = srcItemPos
 		self.dstItemPos = dstItemPos
 
-		self.srcItemWindow = srcItemWindow
-		self.dstItemWindow = dstItemWindow
-
 		self.dlgQuestion.SetAcceptEvent(ui.__mem_func__(self.__Accept))
 		self.dlgQuestion.SetCancelEvent(ui.__mem_func__(self.__Cancel))
 
-		self.dlgQuestion.SetText1("%s" % item.GetItemName(getItemVNum(srcItemPos)) )
+		self.dlgQuestion.SetText1("%s" % item.GetItemNameByVnum(getItemVNum))
 		self.dlgQuestion.SetText2(localeInfo.INVENTORY_REALLY_USE_ITEM)
 
 		self.dlgQuestion.Open()
 
-		constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(1)
-
 	def __Accept(self):
 		self.dlgQuestion.Close()
-		self.__SendUseItemToItemPacket(self.srcItemWindow, self.srcItemPos, self.dstItemWindow, self.dstItemPos)
+		self.__SendUseItemToItemPacket(self.srcItemPos, self.dstItemPos)
 		self.srcItemPos = (0, 0)
 		self.dstItemPos = (0, 0)
 
-		self.srcItemWindow = None
-		self.dstItemWindow = None
-
-		constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(0)
-
 	def __Cancel(self):
 		self.srcItemPos = (0, 0)
 		self.dstItemPos = (0, 0)
 		self.dlgQuestion.Close()
 
-		self.srcItemWindow = None
-		self.dstItemWindow = None
-
-		constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(0)
-
-	if app.ENABLE_SET_ITEM:
-		def __OpenSetClearItemQuestionDialog(self, srcItemWindow, srcItemPos, dstItemWindow, dstItemPos):
-			if self.interface.IsShowDlgQuestionWindow():
-				self.interface.CloseDlgQuestionWindow()
-
-			getItemVNum = player.GetItemIndex
-			self.srcItemPos = srcItemPos
-			self.dstItemPos = dstItemPos
-
-			self.srcItemWindow = srcItemWindow
-			self.dstItemWindow = dstItemWindow
-
-			self.dlgQuestion.SetAcceptEvent(ui.__mem_func__(self.__SetClearItemAccept))
-			self.dlgQuestion.SetCancelEvent(ui.__mem_func__(self.__SetClearItemCancel))
-
-			self.dlgQuestion.SetText1(localeInfo.SET_ITEM_CLEAR_CONFIRM_QUESTION)
-			self.dlgQuestion.SetText2(localeInfo.SET_ITEM_CLEAR_CONFIRM_QUESTION_2)
-			self.dlgQuestion.Open()
-
-			constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(1)
-
-		def __SetClearItemAccept(self):
-			self.__Accept()
-
-		def __SetClearItemCancel(self):
-			self.__Cancel()
-
-	def __SellItem(self, window_type, itemSlotPos):
-		if not player.IsEquipmentSlot(window_type, itemSlotPos):
-			itemIndex = player.GetItemIndex(window_type, itemSlotPos)
-			itemCount = player.GetItemCount(window_type, itemSlotPos)
-
-			self.sellingSlotWindow = window_type
+	def __SellItem(self, itemSlotPos):
+		if not player.IsEquipmentSlot(itemSlotPos):
 			self.sellingSlotNumber = itemSlotPos
+			itemIndex = player.GetItemIndex(itemSlotPos)
+			itemCount = player.GetItemCount(itemSlotPos)
+
 			self.sellingSlotitemIndex = itemIndex
 			self.sellingSlotitemCount = itemCount
 
@@ -1900,8 +1461,6 @@
 
 			item.GetItemName(itemIndex)
 			itemName = item.GetItemName()
-			if app.ENABLE_SET_ITEM:
-				itemName = item.GetItemNameBySetValue(player.GetItemSetValue(window_type, itemSlotPos))
 
 			self.questionDialog = uiCommon.QuestionDialog()
 			self.questionDialog.SetText(localeInfo.DO_YOU_SELL_ITEM(itemName, itemCount, itemPrice))
@@ -1915,20 +1474,20 @@
 	def __OnClosePopupDialog(self):
 		self.pop = None
 
-	def RefineItem(self, scrollSlotWindow, scrollSlotPos, targetSlotWindow, targetSlotPos):
-		scrollIndex = player.GetItemIndex(scrollSlotWindow, scrollSlotPos)
-		targetIndex = player.GetItemIndex(targetSlotWindow, targetSlotPos)
+	def RefineItem(self, scrollSlotPos, targetSlotPos):
+		scrollIndex = player.GetItemIndex(scrollSlotPos)
+		targetIndex = player.GetItemIndex(targetSlotPos)
 
-		if player.REFINE_OK != player.CanRefine(scrollIndex, targetSlotWindow, targetSlotPos):
+		if player.REFINE_OK != player.CanRefine(scrollIndex, targetSlotPos):
 			return
 
-		if app.ENABLE_REFINE_RENEWAL:
-			constInfo.AUTO_REFINE_TYPE = 1
-			constInfo.AUTO_REFINE_DATA["ITEM"][0] = scrollSlotPos
-			constInfo.AUTO_REFINE_DATA["ITEM"][1] = targetSlotPos
+		if app.ENABLE_AUTO_REFINE:
+			osfInfo.AUTO_REFINE_TYPE = 1
+			osfInfo.AUTO_REFINE_DATA["ITEM"][0] = scrollSlotPos
+			osfInfo.AUTO_REFINE_DATA["ITEM"][1] = targetSlotPos
 
 		###########################################################
-		self.__SendUseItemToItemPacket(scrollSlotWindow, scrollSlotPos, targetSlotWindow, targetSlotPos)
+		self.__SendUseItemToItemPacket(scrollSlotPos, targetSlotPos)
 		#net.SendItemUseToItemPacket(scrollSlotPos, targetSlotPos)
 		return
 		###########################################################
@@ -1964,46 +1523,82 @@
 
 		self.refineDialog.Open(scrollSlotPos, targetSlotPos)
 
-	def DetachMetinFromItem(self, scrollSlotWindow, scrollSlotPos, targetSlotWindow, targetSlotPos):
-		scrollIndex = player.GetItemIndex(scrollSlotWindow, scrollSlotPos)
-		targetIndex = player.GetItemIndex(targetSlotWindow, targetSlotPos)
+	def DetachMetinFromItem(self, scrollSlotPos, targetSlotPos):
+		scrollIndex = player.GetItemIndex(scrollSlotPos)
+		targetIndex = player.GetItemIndex(targetSlotPos)
+
+		if scrollIndex == 71109:
+			if player.CanDetach(scrollIndex, targetSlotPos):
+				self.__OpenQuestionDialog(scrollSlotPos, targetSlotPos)
+			return
+
+		if app.ENABLE_ACCE_COSTUME_SYSTEM:
+			if not player.CanDetach(scrollIndex, targetSlotPos):
+				item.SelectItem(scrollIndex)
+				if acce.IsCleanScroll(scrollIndex):
+					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_FAILURE_CLEAN)
+				else:
+					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.REFINE_FAILURE_METIN_INSEPARABLE_ITEM)
 
-		if not player.CanDetach(scrollIndex, targetSlotWindow, targetSlotPos):
-			if app.ENABLE_ACCE_COSTUME_SYSTEM and item.IsAcceScroll(scrollIndex):
 				return
 
-			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.REFINE_FAILURE_METIN_INSEPARABLE_ITEM)
-			return
+			if app.ENABLE_CHANGE_LOOK_SYSTEM:
+				if not player.CanDetach(scrollIndex, targetSlotPos):
+					item.SelectItem(scrollIndex)
+					if changelook.IsCleanScroll(scrollIndex):
+						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.CHANGE_LOOK_FAILURE_CLEAN)
+					else:
+						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.REFINE_FAILURE_METIN_INSEPARABLE_ITEM)
 
-		self.questionDialog = uiCommon.QuestionDialog()
-		if (app.ENABLE_ACCE_COSTUME_SYSTEM or app.ENABLE_AURA_COSTUME_SYSTEM) and item.IsAcceScroll(scrollIndex):
-			self.questionDialog.SetText(localeInfo.AURA_CLEAR_QUESTION_WHEN_USE)
-		elif app.ENABLE_CHANGE_LOOK_SYSTEM and item.IsChangeLookClearScroll(scrollIndex):
-			self.questionDialog.SetText(localeInfo.CHANGE_LOOK_CHANGE_ITEM)
+					return
 		else:
-			self.questionDialog.SetText(localeInfo.REFINE_DO_YOU_SEPARATE_METIN)
+			if not player.CanDetach(scrollIndex, targetSlotPos):
+				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.REFINE_FAILURE_METIN_INSEPARABLE_ITEM)
+				return
+
+			if app.ENABLE_CHANGE_LOOK_SYSTEM:
+				if not player.CanDetach(scrollIndex, targetSlotPos):
+					item.SelectItem(scrollIndex)
+					if changelook.IsCleanScroll(scrollIndex):
+						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.CHANGE_LOOK_FAILURE_CLEAN)
+					else:
+						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.REFINE_FAILURE_METIN_INSEPARABLE_ITEM)
+
+					return
+
+		self.questionDialog = uiCommon.QuestionDialog()
+		self.questionDialog.SetText(localeInfo.REFINE_DO_YOU_SEPARATE_METIN)
+		if app.ENABLE_ACCE_COSTUME_SYSTEM:
+			item.SelectItem(targetIndex)
+			if item.GetItemType() == item.ITEM_TYPE_COSTUME and item.GetItemSubType() == item.COSTUME_TYPE_ACCE:
+				item.SelectItem(scrollIndex)
+				if acce.IsCleanScroll(scrollIndex):
+					self.questionDialog.SetText(localeInfo.ACCE_DO_YOU_CLEAN)
+
+		if app.ENABLE_CHANGE_LOOK_SYSTEM:
+			item.SelectItem(targetIndex)
+			if item.GetItemType() == item.ITEM_TYPE_WEAPON or item.GetItemType() == item.ITEM_TYPE_ARMOR or item.GetItemType() == item.ITEM_TYPE_COSTUME:
+				item.SelectItem(scrollIndex)
+				if changelook.IsCleanScroll(scrollIndex):
+					self.questionDialog.SetText(localeInfo.CHANGE_LOOK_DO_YOU_CLEAN)
+
 		self.questionDialog.SetAcceptEvent(ui.__mem_func__(self.OnDetachMetinFromItem))
 		self.questionDialog.SetCancelEvent(ui.__mem_func__(self.OnCloseQuestionDialog))
 		self.questionDialog.Open()
 		self.questionDialog.sourcePos = scrollSlotPos
 		self.questionDialog.targetPos = targetSlotPos
 
-		self.questionDialog.sourceWindow = scrollSlotWindow
-		self.questionDialog.targetWindow = targetSlotWindow
-
-	def AttachMetinToItem(self, metinSlotWindow, metinSlotPos, targetSlotWindow, targetSlotPos):
-		metinIndex = player.GetItemIndex(metinSlotWindow, metinSlotPos)
-		targetIndex = player.GetItemIndex(targetSlotWindow, targetSlotPos)
+	def AttachMetinToItem(self, metinSlotPos, targetSlotPos):
+		metinIndex = player.GetItemIndex(metinSlotPos)
+		targetIndex = player.GetItemIndex(targetSlotPos)
 
 		item.SelectItem(metinIndex)
 		itemName = item.GetItemName()
-		if app.ENABLE_SET_ITEM:
-			itemName = item.GetItemNameBySetValue(player.GetItemSetValue(metinSlotWindow, metinSlotPos))
 
-		result = player.CanAttachMetin(metinIndex, targetSlotWindow, targetSlotPos)
+		result = player.CanAttachMetin(metinIndex, targetSlotPos)
 
 		if player.ATTACH_METIN_NOT_MATCHABLE_ITEM == result:
-			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.REFINE_FAILURE_CAN_NOT_ATTACH(itemName))
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.REFINE_FAILURE_CAN_NOT_ATTACH % (itemName))
 
 		if player.ATTACH_METIN_NO_MATCHABLE_SOCKET == result:
 			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.REFINE_FAILURE_NO_SOCKET(itemName))
@@ -2017,44 +1612,91 @@
 		if player.ATTACH_METIN_OK != result:
 			return
 
-		self.attachMetinDialog.Open(metinSlotWindow, metinSlotPos, targetSlotWindow, targetSlotPos)
+		self.attachMetinDialog.Open(metinSlotPos, targetSlotPos)
 
 	def OverOutItem(self):
 		self.wndItem.SetUsableItem(False)
 		if None != self.tooltipItem:
 			self.tooltipItem.HideToolTip()
 
-	def OverInItem(self, overSlotPos, window_type):
-		overInvenSlotPos = self.__InventoryLocalSlotPosToGlobalSlotPos(overSlotPos, window_type)
-		self.wndItem.SetUsableItem(False)
+	def OverInItem(self, overSlotPos):
+		if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
+			overInvenSlotPos = self.__InventoryLocalSlotPosToGlobalSlotPos(overSlotPos)
+			self.wndItem.SetUsableItem(False)
 
-		getItemVNum = ReprGetItemIndex(window_type)
-		itemVnum = getItemVNum(overInvenSlotPos)
+			getItemVNum = player.GetItemIndex
+			itemVnum = getItemVNum(overInvenSlotPos)
+			self.DelHighlightSlot(overInvenSlotPos)
 
-		if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
-			if window_type == player.INVENTORY:
-				self.DelHighlightSlot(overInvenSlotPos)
+			if mouseModule.mouseController.isAttached():
+				attachedItemType = mouseModule.mouseController.GetAttachedType()
 
-		if mouseModule.mouseController.isAttached():
-			attachedItemType = mouseModule.mouseController.GetAttachedType()
+				if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+					if player.SLOT_TYPE_INVENTORY == attachedItemType or\
+						player.SLOT_TYPE_SKILL_BOOK_INVENTORY == attachedItemType or\
+						player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == attachedItemType or\
+						player.SLOT_TYPE_STONE_INVENTORY == attachedItemType or\
+						player.SLOT_TYPE_GIFT_BOX_INVENTORY == attachedItemType:
+
+						attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
+						attachedItemVNum = mouseModule.mouseController.GetAttachedItemIndex()
+
+						if self.__CanUseSrcItemToDstItem(attachedItemVNum, attachedSlotPos, overInvenSlotPos):
+							self.wndItem.SetUsableItem(True)
+							self.ShowToolTip(overInvenSlotPos)
+							return
+				else:
+					if player.SLOT_TYPE_INVENTORY == attachedItemType:
+						attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
+						attachedItemVNum = mouseModule.mouseController.GetAttachedItemIndex()
+
+						if self.__CanUseSrcItemToDstItem(attachedItemVNum, attachedSlotPos, overInvenSlotPos):
+							self.wndItem.SetUsableItem(True)
+							self.ShowToolTip(overInvenSlotPos)
+							return
 
-			if player.SLOT_TYPE_INVENTORY == attachedItemType:
-				attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
-				attachedItemVNum = mouseModule.mouseController.GetAttachedItemIndex()
+			self.ShowToolTip(overInvenSlotPos)
+		else:
+			overSlotPos = self.__InventoryLocalSlotPosToGlobalSlotPos(overSlotPos)
+			self.wndItem.SetUsableItem(False)
 
-				if self.__CanUseSrcItemToDstItem(attachedItemVNum, player.INVENTORY, attachedSlotPos, window_type, overInvenSlotPos):
-					self.wndItem.SetUsableItem(True)
-					self.ShowToolTip(overInvenSlotPos, window_type)
-					return
+			if mouseModule.mouseController.isAttached():
+				attachedItemType = mouseModule.mouseController.GetAttachedType()
+
+				if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+					if player.SLOT_TYPE_INVENTORY == attachedItemType or\
+						player.SLOT_TYPE_SKILL_BOOK_INVENTORY == attachedItemType or\
+						player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == attachedItemType or\
+						player.SLOT_TYPE_STONE_INVENTORY == attachedItemType or\
+						player.SLOT_TYPE_GIFT_BOX_INVENTORY == attachedItemType:
+
+						attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
+						attachedItemVNum = mouseModule.mouseController.GetAttachedItemIndex()
+
+						if self.__CanUseSrcItemToDstItem(attachedItemVNum, attachedSlotPos, overSlotPos):
+							self.wndItem.SetUsableItem(True)
+							self.ShowToolTip(overSlotPos)
+							return
+				else:
+					if player.SLOT_TYPE_INVENTORY == attachedItemType:
+						attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
+						attachedItemVNum = mouseModule.mouseController.GetAttachedItemIndex()
+
+						if self.__CanUseSrcItemToDstItem(attachedItemVNum, attachedSlotPos, overSlotPos):
+							self.wndItem.SetUsableItem(True)
+							self.ShowToolTip(overSlotPos)
+							return
 
-		self.ShowToolTip(overInvenSlotPos, window_type)
+			self.ShowToolTip(overSlotPos)
 
 	def __IsUsableItemToItem(self, srcItemVNum, srcSlotPos):
 		"다른 아이템에 사용할 수 있는 아이템인가?"
 
 		if item.IsRefineScroll(srcItemVNum):
 			return True
-		elif app.ENABLE_SOULBIND_SYSTEM and item.IsSealScroll(srcItemVNum):
+		elif app.ENABLE_SOUL_BIND_SYSTEM and item.IsSealScroll(srcItemVNum):
+			return True
+		elif app.ENABLE_67TH_BONUS and (srcItemVNum == item.ADD_RARE_ATTRIBUTE_VNUM or srcItemVNum == item.CHANGE_RARE_ATTRIBUTE_VNUM):
 			return True
 		elif item.IsMetin(srcItemVNum):
 			return True
@@ -2067,182 +1709,152 @@
 		elif (player.GetItemFlags(srcSlotPos) & ITEM_FLAG_APPLICABLE) == ITEM_FLAG_APPLICABLE:
 			return True
 		else:
-			if app.ENABLE_ACCE_COSTUME_SYSTEM:
-				if item.IsAcceScroll(srcItemVNum):
-					return True
-
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				if item.IsChangeLookClearScroll(srcItemVNum):
-					return True
-
 			if app.ENABLE_GROWTH_PET_SYSTEM:
 				if self.__IsUsablePetItem(srcItemVNum):
 					return True
 
-			if app.ENABLE_AURA_COSTUME_SYSTEM:
-				if item.ITEM_VNUM_AURA_CLEAR == srcItemVNum:
-					return True
-
-			if app.ENABLE_SET_ITEM:
-				if item.IsSetClearScroll(srcItemVNum):
-					return True
-
-			if app.ENABLE_GEM_CONVERTER:
-				if srcItemVNum == item.ITEM_VNUM_GEM_CONVERTER:
-					return True
-
 			if item.GetUseType(srcItemVNum) in self.USE_TYPE_TUPLE:
 				return True
 
 		return False
 
-	def __CanUseSrcItemToDstItem(self, srcItemVNum, srcSlotWindow, srcSlotPos, dstSlotWindow, dstSlotPos):
-		## 대상 아이템에 사용할 수 있는가?
-		if srcSlotWindow == dstSlotWindow:
-			if srcSlotPos == dstSlotPos:
-				return False
-
-		## [MT-462]: Stackable UseMode 이고..
-		#if srcItemVNum == player.GetItemIndex(dstSlotWindow, dstSlotPos) and \
-		#	(player.GetItemFlags(dstSlotWindow, dstSlotPos) & item.ITEM_FLAG_STACKABLE):
-		#	return True
+	def __CanUseSrcItemToDstItem(self, srcItemVNum, srcSlotPos, dstSlotPos):
+		"대상 아이템에 사용할 수 있는가?"
+		if srcSlotPos == dstSlotPos:
+			return False
 
 		if item.IsRefineScroll(srcItemVNum):
-			if player.REFINE_OK == player.CanRefine(srcItemVNum, dstSlotWindow, dstSlotPos):
+			if player.REFINE_OK == player.CanRefine(srcItemVNum, dstSlotPos):
 				return True
-
-		elif app.ENABLE_SOULBIND_SYSTEM and item.IsSealScroll(srcItemVNum):
-			if player.CanSealItem(srcItemVNum, dstSlotWindow, dstSlotPos):
+		elif app.ENABLE_SOUL_BIND_SYSTEM and item.IsSealScroll(srcItemVNum):
+			if player.CanSealItem(srcItemVNum, player.INVENTORY, dstSlotPos):
 				return True
-
 		elif item.IsMetin(srcItemVNum):
-			if player.ATTACH_METIN_OK == player.CanAttachMetin(srcItemVNum, dstSlotWindow, dstSlotPos):
+			if player.ATTACH_METIN_OK == player.CanAttachMetin(srcItemVNum, dstSlotPos):
 				return True
-
 		elif item.IsDetachScroll(srcItemVNum):
-			if player.DETACH_METIN_OK == player.CanDetach(srcItemVNum, dstSlotWindow, dstSlotPos):
+			if player.DETACH_METIN_OK == player.CanDetach(srcItemVNum, dstSlotPos):
 				return True
-
 		elif item.IsKey(srcItemVNum):
-			if player.CanUnlock(srcItemVNum, dstSlotWindow, dstSlotPos):
+			if player.CanUnlock(srcItemVNum, dstSlotPos):
 				return True
-
-		elif (player.GetItemFlags(srcSlotWindow, srcSlotPos) & ITEM_FLAG_APPLICABLE) == ITEM_FLAG_APPLICABLE:
+		elif (player.GetItemFlags(srcSlotPos) & ITEM_FLAG_APPLICABLE) == ITEM_FLAG_APPLICABLE:
 			return True
-
+		elif app.ENABLE_67TH_BONUS and srcItemVNum == item.ADD_RARE_ATTRIBUTE_VNUM:
+			if self.__CanAddRareItemAttr(dstSlotPos):
+				return True
+		elif app.ENABLE_67TH_BONUS and srcItemVNum == item.CHANGE_RARE_ATTRIBUTE_VNUM:
+			if self.__CanChangeRareItemAttrList(dstSlotPos):
+				return True
 		else:
-			if app.ENABLE_ACCE_COSTUME_SYSTEM:
-				if item.IsAcceScroll(srcItemVNum):
-					if player.CanAcceClearItem(srcItemVNum, dstSlotWindow, dstSlotPos):
-						return True
-
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				if item.IsChangeLookClearScroll(srcItemVNum):
-					if player.CanChangeLookClearItem(srcItemVNum, dstSlotWindow, dstSlotPos):
-						return True
-
-			if app.ENABLE_AURA_COSTUME_SYSTEM:
-				if item.ITEM_VNUM_AURA_CLEAR == srcItemVNum:
-					if player.CanAuraClearItem(srcItemVNum, dstSlotWindow, dstSlotPos):
-						return True
-
-			if app.ENABLE_SET_ITEM:
-				if item.IsSetClearScroll(srcItemVNum):
-					if player.CanSetItemClear(srcItemVNum, dstSlotWindow, dstSlotPos):
-						return True
-
-			if app.ENABLE_GEM_CONVERTER:
-				if srcItemVNum == item.ITEM_VNUM_GEM_CONVERTER:
-					if self.__CanUseGemConverter(srcItemVNum, dstSlotWindow, srcSlotPos, dstSlotWindow, dstSlotPos):
-						return True
-
 			if app.ENABLE_GROWTH_PET_SYSTEM:
 				if self.__CanUseSrcPetItemToDstPetItem(srcItemVNum, srcSlotPos, dstSlotPos):
 					return True
 
 			useType = item.GetUseType(srcItemVNum)
 
-			if app.ENABLE_ATTR_6TH_7TH:
-				if "USE_CHANGE_ATTRIBUTE2" == useType:
-					if self.__CanChangeItemAttr67List(player.INVENTORY, dstSlotPos):
-						return True
-
 			if "USE_CLEAN_SOCKET" == useType:
-				if self.__CanCleanBrokenMetinStone(dstSlotWindow, dstSlotPos):
+				if self.__CanCleanBrokenMetinStone(dstSlotPos):
 					return True
-
 			elif "USE_CHANGE_ATTRIBUTE" == useType:
-				if self.__CanChangeItemAttrList(dstSlotWindow, dstSlotPos):
+				if self.__CanChangeItemAttrList(dstSlotPos):
 					return True
-
 			elif "USE_ADD_ATTRIBUTE" == useType:
-				if self.__CanAddItemAttr(dstSlotWindow, dstSlotPos):
+				if self.__CanAddItemAttr(dstSlotPos):
 					return True
-
 			elif "USE_ADD_ATTRIBUTE2" == useType:
-				if self.__CanAddItemAttr2(dstSlotWindow, dstSlotPos):
+				if self.__CanAddItemAttr2(dstSlotPos):
 					return True
-
 			elif "USE_ADD_ACCESSORY_SOCKET" == useType:
-				if self.__CanAddAccessorySocket(dstSlotWindow, dstSlotPos):
+				if self.__CanAddAccessorySocket(dstSlotPos):
 					return True
-
 			elif "USE_PUT_INTO_ACCESSORY_SOCKET" == useType:
-				if self.__CanPutAccessorySocket(dstSlotWindow, dstSlotPos, srcItemVNum):
-					return True
-
+				if self.__CanPutAccessorySocket(dstSlotPos, srcItemVNum):
+					return True;
 			elif "USE_PUT_INTO_BELT_SOCKET" == useType:
-				dstItemVNum = player.GetItemIndex(dstSlotWindow, dstSlotPos)
+				dstItemVNum = player.GetItemIndex(dstSlotPos)
+
 				item.SelectItem(dstItemVNum)
+
 				if item.ITEM_TYPE_BELT == item.GetItemType():
 					return True
-
-			elif app.ENABLE_MOVE_COSTUME_ATTR and "USE_CHANGE_COSTUME_ATTR" == useType:
-				if self.__CanChangeCostumeAttrList(dstSlotWindow, dstSlotPos):
+			elif "USE_CHANGE_COSTUME_ATTR" == useType:
+				if self.__CanChangeCostumeAttrList(dstSlotPos):
 					return True
-
-			elif app.ENABLE_MOVE_COSTUME_ATTR and "USE_RESET_COSTUME_ATTR" == useType:
-				if self.__CanResetCostumeAttr(dstSlotWindow, dstSlotPos):
+			elif "USE_RESET_COSTUME_ATTR" == useType:
+				if self.__CanResetCostumeAttr(dstSlotPos):
+					return True
+			elif "USE_TIME_CHARGE_PER" == useType:
+				if self.__CanExtendTime(dstSlotPos):
+					return True
+			elif "USE_TIME_CHARGE_FIX" == useType:
+				if self.__CanExtendTime(dstSlotPos):
 					return True
-
 			else:
-				if app.ENABLE_CHANGED_ATTR and "USE_SELECT_ATTRIBUTE" == useType:
-					if self.__CanChangeItemAttrList(dstSlotWindow, dstSlotPos):
-						return True
-
-				if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-					if "USE_ELEMENT_UPGRADE" == useType:
-						if uiRefine.RefineElementDialog.CanRefineElementUpgrade(srcSlotWindow, srcSlotPos, dstSlotWindow, dstSlotPos, False, False):
-							return True
-
-					if "USE_ELEMENT_DOWNGRADE" == useType:
-						if uiRefine.RefineElementDialog.CanRefineElementDowngrade(srcSlotWindow, srcSlotPos, dstSlotWindow, dstSlotPos, False, False):
-							return True
-
-					if "USE_ELEMENT_CHANGE" == useType:
-						if uiRefine.RefineElementChangeDialog.CanRefineElementChange(srcSlotWindow, srcSlotPos, dstSlotWindow, dstSlotPos, False, False):
-							return True
+				pass
 
 		return False
 
-	def __CanCleanBrokenMetinStone(self, dstSlotWindow, dstSlotPos):
-		dstItemVNum = player.GetItemIndex(dstSlotWindow, dstSlotPos)
+	if app.ENABLE_67TH_BONUS:
+		def __CanAddRareItemAttr(self, dstSlotPos):
+			dstItemVNum = player.GetItemIndex(dstSlotPos)
+			if dstItemVNum == 0:
+				return False
+
+			item.SelectItem(dstItemVNum)
+
+			if not item.GetItemType() in (item.ITEM_TYPE_WEAPON, item.ITEM_TYPE_ARMOR):
+				return False
+
+			attrCount = 0
+			for i in xrange(player.METIN_SOCKET_MAX_NUM):
+				if player.GetItemAttribute(dstSlotPos, i)[0] != 0:
+					attrCount += 1
+
+			if attrCount < player.ATTRIBUTE_SLOT_MAX_NUM and attrCount >= (player.ATTRIBUTE_SLOT_MAX_NUM - 2):
+				return True
+
+			return False
+
+		def __CanChangeRareItemAttrList(self, dstSlotPos):
+			dstItemVNum = player.GetItemIndex(dstSlotPos)
+			if dstItemVNum == 0:
+				return False
+
+			item.SelectItem(dstItemVNum)
+
+			if not item.GetItemType() in (item.ITEM_TYPE_WEAPON, item.ITEM_TYPE_ARMOR):
+				return False
+
+			attrCount = 0
+			for i in xrange(player.METIN_SOCKET_MAX_NUM):
+				if player.GetItemAttribute(dstSlotPos, i)[0] != 0:
+					attrCount += 1
+
+			if attrCount < player.ATTRIBUTE_SLOT_MAX_NUM and attrCount >= (player.ATTRIBUTE_SLOT_MAX_NUM - 2):
+				return True
+
+			return False
+
+	def __CanCleanBrokenMetinStone(self, dstSlotPos):
+		dstItemVNum = player.GetItemIndex(dstSlotPos)
 		if dstItemVNum == 0:
 			return False
 
 		item.SelectItem(dstItemVNum)
 
+		# if item.ITEM_TYPE_WEAPON != item.GetItemType():
 		if item.ITEM_TYPE_WEAPON != item.GetItemType() and item.ITEM_TYPE_ARMOR != item.GetItemType():
 			return False
 
 		for i in xrange(player.METIN_SOCKET_MAX_NUM):
-			if player.GetItemMetinSocket(dstSlotWindow, dstSlotPos, i) == constInfo.ERROR_METIN_STONE:
+			if player.GetItemMetinSocket(dstSlotPos, i) == constInfo.ERROR_METIN_STONE:
 				return True
 
 		return False
 
-	def __CanChangeItemAttrList(self, dstSlotWindow, dstSlotPos):
-		dstItemVNum = player.GetItemIndex(dstSlotWindow, dstSlotPos)
+	def __CanChangeItemAttrList(self, dstSlotPos):
+		dstItemVNum = player.GetItemIndex(dstSlotPos)
 		if dstItemVNum == 0:
 			return False
 
@@ -2251,24 +1863,18 @@
 		if not item.GetItemType() in (item.ITEM_TYPE_WEAPON, item.ITEM_TYPE_ARMOR):
 			return False
 
-		# 재경비서
-		if app.ENABLE_NEW_USER_CARE:
-			if item.IsAntiFlag(item.ITEM_ANTIFLAG_ENCHANT):
-				return False
-
-		if app.ENABLE_SOULBIND_SYSTEM:
-			if player.GetItemSealDate(dstSlotWindow, dstSlotPos) != item.E_SEAL_DATE_DEFAULT_TIMESTAMP:
-				return False
+		attrCount = 0
+		for i in xrange(player.METIN_SOCKET_MAX_NUM):
+			if player.GetItemAttribute(dstSlotPos, i)[0] != 0:
+				attrCount += 1
 
-		for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
-			type, value = player.GetItemAttribute(dstSlotWindow, dstSlotPos, i)
-			if type != 0:
-				return True
+		if attrCount > 0:
+			return True
 
 		return False
 
-	def __CanPutAccessorySocket(self, dstSlotWindow, dstSlotPos, mtrlVnum):
-		dstItemVNum = player.GetItemIndex(dstSlotWindow, dstSlotPos)
+	def __CanPutAccessorySocket(self, dstSlotPos, mtrlVnum):
+		dstItemVNum = player.GetItemIndex(dstSlotPos)
 		if dstItemVNum == 0:
 			return False
 
@@ -2280,8 +1886,8 @@
 		if not item.GetItemSubType() in (item.ARMOR_WRIST, item.ARMOR_NECK, item.ARMOR_EAR):
 			return False
 
-		curCount = player.GetItemMetinSocket(dstSlotWindow, dstSlotPos, 0)
-		maxCount = player.GetItemMetinSocket(dstSlotWindow, dstSlotPos, 1)
+		curCount = player.GetItemMetinSocket(dstSlotPos, 0)
+		maxCount = player.GetItemMetinSocket(dstSlotPos, 1)
 
 		if mtrlVnum != constInfo.GET_ACCESSORY_MATERIAL_VNUM(dstItemVNum, item.GetItemSubType()):
 			return False
@@ -2291,21 +1897,24 @@
 
 		return True
 
-	def __CanAddAccessorySocket(self, dstSlotWindow, dstSlotPos):
-		dstItemVNum = player.GetItemIndex(dstSlotWindow, dstSlotPos)
+	def __CanAddAccessorySocket(self, dstSlotPos):
+		dstItemVNum = player.GetItemIndex(dstSlotPos)
 		if dstItemVNum == 0:
 			return False
 
 		item.SelectItem(dstItemVNum)
 
+		#if item.GetItemType() != item.ITEM_TYPE_ARMOR:
 		if not item.GetItemType() in (item.ITEM_TYPE_ARMOR, item.ITEM_TYPE_BELT):
 			return False
 
-		if not item.GetItemSubType() in (item.ARMOR_WRIST, item.ARMOR_NECK, item.ARMOR_EAR) and not item.GetItemType() == item.ITEM_TYPE_BELT:
-			return False
+		#if not item.GetItemSubType() in (item.ARMOR_WRIST, item.ARMOR_NECK, item.ARMOR_EAR):
+		if not item.GetItemType() == item.ITEM_TYPE_BELT:
+			if not item.GetItemSubType() in (item.ARMOR_WRIST, item.ARMOR_NECK, item.ARMOR_EAR):
+				return False
 
-		curCount = player.GetItemMetinSocket(dstSlotWindow, dstSlotPos, 0)
-		maxCount = player.GetItemMetinSocket(dstSlotWindow, dstSlotPos, 1)
+		curCount = player.GetItemMetinSocket(dstSlotPos, 0)
+		maxCount = player.GetItemMetinSocket(dstSlotPos, 1)
 
 		ACCESSORY_SOCKET_MAX_SIZE = 3
 		if maxCount >= ACCESSORY_SOCKET_MAX_SIZE:
@@ -2313,46 +1922,30 @@
 
 		return True
 
-	if app.ENABLE_ATTR_6TH_7TH:
-		def __CanChangeItemAttr67List(self, dstSlotWindow, dstSlotPos):
-			dstItemVNum = player.GetItemIndex(dstSlotWindow, dstSlotPos)
-			if dstItemVNum == 0:
-				return False
-
-			item.SelectItem(dstItemVNum)
-
-			if not item.GetItemType() in (item.ITEM_TYPE_WEAPON, item.ITEM_TYPE_ARMOR):
-				return False
-
-			if app.ENABLE_QUIVER_SYSTEM:
-				if (item.GetItemType() == item.ITEM_TYPE_WEAPON and item.GetItemSubType() in (item.WEAPON_ARROW, item.WEAPON_QUIVER)):
-					return False
-			else:
-				if (item.GetItemType() == item.ITEM_TYPE_WEAPON and item.GetItemSubType() == item.WEAPON_ARROW):
-					return False
+	def __CanAddItemAttr(self, dstSlotPos):
+		dstItemVNum = player.GetItemIndex(dstSlotPos)
+		if dstItemVNum == 0:
+			return False
 
-			# 재경비서
-			if app.ENABLE_NEW_USER_CARE:
-				if item.IsAntiFlag(item.ITEM_ANTIFLAG_ENCHANT):
-					return False
+		item.SelectItem(dstItemVNum)
 
-			if app.ENABLE_SOULBIND_SYSTEM:
-				if player.GetItemSealDate(dstSlotWindow, dstSlotPos) != item.E_SEAL_DATE_DEFAULT_TIMESTAMP:
-					return False
+		if not item.GetItemType() in (item.ITEM_TYPE_WEAPON, item.ITEM_TYPE_ARMOR):
+			return False
 
-			attrCount = 0
-			for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
-				type, value = player.GetItemAttribute(dstSlotWindow, dstSlotPos, i)
-				if type != 0:
-					attrCount += 1
+		attrCount = 0
+		for i in xrange(player.METIN_SOCKET_MAX_NUM):
+			# 2020.02.13.Owsap - Fix Attribute Count
+			if player.GetItemAttribute(dstSlotPos, i)[0] != 0:
+				attrCount += 1
 
-			if attrCount > player.ATTRIBUTE_SLOT_MAX_NUM - 2 and attrCount <= player.ATTRIBUTE_SLOT_MAX_NUM:
-				return True
+		if attrCount < 4:
+			return True
 
-			return False
+		return False
 
-	def __CanAddItemAttr(self, dstSlotWindow, dstSlotPos):
-		dstItemVNum = player.GetItemIndex(dstSlotWindow, dstSlotPos)
+	# 2020.02.13.Owsap - Fix Attribute Count
+	def __CanAddItemAttr2(self, dstSlotPos):
+		dstItemVNum = player.GetItemIndex(dstSlotPos)
 		if dstItemVNum == 0:
 			return False
 
@@ -2361,141 +1954,114 @@
 		if not item.GetItemType() in (item.ITEM_TYPE_WEAPON, item.ITEM_TYPE_ARMOR):
 			return False
 
-		# 재가비서
-		if app.ENABLE_NEW_USER_CARE:
-			if item.IsAntiFlag(item.ITEM_ANTIFLAG_REINFORCE):
-				return False
-
-		if app.ENABLE_SOULBIND_SYSTEM:
-			if player.GetItemSealDate(dstSlotWindow, dstSlotPos) != item.E_SEAL_DATE_DEFAULT_TIMESTAMP:
-				return False
-
 		attrCount = 0
-		for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
-			type, value = player.GetItemAttribute(dstSlotWindow, dstSlotPos, i)
-			if type != 0:
+		for i in xrange(player.METIN_SOCKET_MAX_NUM):
+			if player.GetItemAttribute(dstSlotPos, i)[0] != 0:
 				attrCount += 1
 
-		if attrCount < 4:
+		if attrCount == 4:
 			return True
 
 		return False
 
-	def __CanAddItemAttr2(self, dstSlotWindow, dstSlotPos):
-		dstItemVNum = player.GetItemIndex(dstSlotWindow, dstSlotPos)
+	def __CanChangeCostumeAttrList(self, dstSlotPos):
+		dstItemVNum = player.GetItemIndex(dstSlotPos)
 		if dstItemVNum == 0:
 			return False
 
 		item.SelectItem(dstItemVNum)
 
-		if not item.GetItemType() in (item.ITEM_TYPE_WEAPON, item.ITEM_TYPE_ARMOR):
+		if item.GetItemType() != item.ITEM_TYPE_COSTUME:
 			return False
 
-		# 재가비서
-		if app.ENABLE_NEW_USER_CARE:
-			if item.IsAntiFlag(item.ITEM_ANTIFLAG_REINFORCE):
+		if app.ENABLE_ACCE_COSTUME_SYSTEM:
+			if item.GetItemSubType() == item.COSTUME_TYPE_ACCE:
 				return False
 
-		if app.ENABLE_SOULBIND_SYSTEM:
-			if player.GetItemSealDate(dstSlotWindow, dstSlotPos) != item.E_SEAL_DATE_DEFAULT_TIMESTAMP:
+		if app.ENABLE_MOUNT_COSTUME_SYSTEM:
+			if item.GetItemSubType() == item.COSTUME_TYPE_MOUNT:
 				return False
 
-		attrCount = 0
-		for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
-			type, value = player.GetItemAttribute(dstSlotWindow, dstSlotPos, i)
+		for i in xrange(player.METIN_SOCKET_MAX_NUM):
+			type, value = player.GetItemAttribute(dstSlotPos, i)
 			if type != 0:
-				attrCount += 1
-
-		if attrCount == 4:
-			return True
+				return True
 
 		return False
 
-	if app.ENABLE_MOVE_COSTUME_ATTR:
-		def __CanChangeCostumeAttrList(self, dstSlotWindow, dstSlotPos):
-			dstItemVNum = player.GetItemIndex(dstSlotWindow, dstSlotPos)
-			if dstItemVNum == 0:
-				return False
+	def __CanResetCostumeAttr(self, dstSlotPos):
+		dstItemVNum = player.GetItemIndex(dstSlotPos)
+		if dstItemVNum == 0:
+			return False
 
-			item.SelectItem(dstItemVNum)
+		item.SelectItem(dstItemVNum)
 
-			if item.GetItemType() != item.ITEM_TYPE_COSTUME:
-				return False
+		if item.GetItemType() != item.ITEM_TYPE_COSTUME:
+			return False
 
-			if app.ENABLE_MOUNT_COSTUME_SYSTEM:
-				if item.GetItemSubType() == item.COSTUME_TYPE_MOUNT:
-					return False
+		if app.ENABLE_ACCE_COSTUME_SYSTEM:
+			if item.GetItemSubType() == item.COSTUME_TYPE_ACCE:
+				return False
 
-			if app.ENABLE_ACCE_COSTUME_SYSTEM:
-				if item.GetItemSubType() == item.COSTUME_TYPE_ACCE:
-					return False
+		if app.ENABLE_MOUNT_COSTUME_SYSTEM:
+			if item.GetItemSubType() == item.COSTUME_TYPE_MOUNT:
+				return False
 
-			if app.ENABLE_AURA_COSTUME_SYSTEM:
-				if item.GetItemSubType() == item.COSTUME_TYPE_AURA:
-					return False
+		for i in xrange(player.METIN_SOCKET_MAX_NUM):
+			type, value = player.GetItemAttribute(dstSlotPos, i)
+			if type != 0:
+				return True
 
-			for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
-				type, value = player.GetItemAttribute(dstSlotWindow, dstSlotPos, i)
-				if type != 0:
-					return True
+		return False
 
+	def __CanExtendTime(self, dstSlotPos):
+		dstItemVNum = player.GetItemIndex(dstSlotPos)
+		if dstItemVNum == 0:
 			return False
 
-		def __CanResetCostumeAttr(self, dstSlotWindow, dstSlotPos):
-			dstItemVNum = player.GetItemIndex(dstSlotWindow, dstSlotPos)
-			if dstItemVNum == 0:
-				return False
-
-			item.SelectItem(dstItemVNum)
+		item.SelectItem(dstItemVNum)
 
-			if item.GetItemType() != item.ITEM_TYPE_COSTUME:
+		if app.ENABLE_COSTUME_EXTENDED_RECHARGE:
+			if item.GetItemType() != item.ITEM_TYPE_COSTUME and item.GetItemType() != item.ITEM_TYPE_DS:
 				return False
 
-			if app.ENABLE_MOUNT_COSTUME_SYSTEM:
-				if item.GetItemSubType() == item.COSTUME_TYPE_MOUNT:
-					return False
-
 			if app.ENABLE_ACCE_COSTUME_SYSTEM:
 				if item.GetItemSubType() == item.COSTUME_TYPE_ACCE:
 					return False
 
-			if app.ENABLE_AURA_COSTUME_SYSTEM:
-				if item.GetItemSubType() == item.COSTUME_TYPE_AURA:
-					return False
+			metinSlot = [player.GetItemMetinSocket(dstSlotPos, j) for j in xrange(player.METIN_SOCKET_MAX_NUM)]
+			leftSec = max(0, metinSlot[0] - app.GetGlobalTimeStamp())
 
-			for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
-				type, value = player.GetItemAttribute(dstSlotWindow, dstSlotPos, i)
-				if type != 0:
-					return True
+			if leftSec >= item.MIN_INFINITE_DURATION:
+				return False
+		else:
+			if item.GetItemType() != item.ITEM_TYPE_DS:
+				return False
 
-			return False
+		return True
 
-	def ShowToolTip(self, slotIndex, window_type):
+	def ShowToolTip(self, slotIndex):
 		if None != self.tooltipItem:
-			self.tooltipItem.SetInventoryItem(slotIndex, window_type)
+			self.tooltipItem.SetInventoryItem(slotIndex)
 
 	def OnTop(self):
 		if None != self.tooltipItem:
 			self.tooltipItem.SetTop()
 
-		if not app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			if self.wndBelt:
-				if self.IsClickBeltInventory == False:
-					self.wndBelt.SetTop()
-				else:
-					self.IsClickBeltInventory = False
+		if self.wndBelt:
+			if self.IsClickBeltInventory == False:
+				self.wndBelt.SetTop()
+			else:
+				self.IsClickBeltInventory = False
 
-			if self.wndCostume:
-				self.wndCostume.SetTop()
-
-		if app.WJ_ENABLE_TRADABLE_ICON:
-			map(lambda wnd:wnd.RefreshLockedSlot(), self.bindWnds)
+		if self.wndCostume:
+			self.wndCostume.SetTop()
 
 	def OnPressEscapeKey(self):
 		self.Close()
 		return True
 
-	def UseItemSlot(self, slotIndex, window):
+	def UseItemSlot(self, slotIndex):
 		curCursorNum = app.GetCursor()
 		if app.SELL == curCursorNum:
 			return
@@ -2503,32 +2069,48 @@
 		if constInfo.GET_ITEM_QUESTION_DIALOG_STATUS():
 			return
 
-		slotIndex = self.__InventoryLocalSlotPosToGlobalSlotPos(slotIndex, window)
+		## 2021.02.01.Owsap - Prevent unequipping an item while acting emotion.
+		if player.IsActingEmotion():
+			return
+
+		slotIndex = self.__InventoryLocalSlotPosToGlobalSlotPos(slotIndex)
 
-		if app.ENABLE_DRAGON_SOUL_SYSTEM:
-			if self.wndDragonSoulRefine.IsShow():
-				self.wndDragonSoulRefine.AutoSetItem((window, slotIndex), 1)
+		if self.wndDragonSoulRefine.IsShow():
+			self.wndDragonSoulRefine.AutoSetItem((player.INVENTORY, slotIndex), 1)
+			return
+
+		if app.ENABLE_ACCE_COSTUME_SYSTEM:
+			if self.isShowAcceWindow():
+				if app.ENABLE_SOUL_BIND_SYSTEM:
+					if player.GetItemSealDate(player.INVENTORY, slotIndex) == -1 or player.GetItemSealDate(player.INVENTORY, slotIndex) > 0:
+						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_NOT_SEALITEM)
+						return
+
+				acce.Add(player.INVENTORY, slotIndex, 255)
 				return
 
-		self.__UseItem(slotIndex, window)
+		if app.ENABLE_CHANGE_LOOK_SYSTEM:
+			if self.isShowChangeLookWindow():
+				if app.ENABLE_SOUL_BIND_SYSTEM:
+					if player.GetItemSealDate(player.INVENTORY, slotIndex) == -1 or player.GetItemSealDate(player.INVENTORY, slotIndex) > 0:
+						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.CHANGE_LOOK_DO_NOT_SEAL_ITEM)
+						return
+
+				changelook.Add(player.INVENTORY, slotIndex, 255)
+				return
+
+		self.__UseItem(slotIndex)
 		mouseModule.mouseController.DeattachObject()
 		self.OverOutItem()
 
-	def __UseItem(self, slotIndex, slotWindow):
-		ItemVNum = player.GetItemIndex(slotWindow, slotIndex)
+	def __UseItem(self, slotIndex):
+		ItemVNum = player.GetItemIndex(slotIndex)
 		item.SelectItem(ItemVNum)
 
-		## 악세서리 창이 열려있으면
-		## 악세서리 아이템, 무기, 갑옷 외엔 아무 사용 안됨.
-		if app.ENABLE_ACCE_COSTUME_SYSTEM:
-			if player.GetAcceRefineWindowOpen():
-				self.__UseItemAcce(slotIndex, slotWindow)
-				return
-
 		if app.ENABLE_GROWTH_PET_SYSTEM:
 			itemType = item.GetItemType()
 			
-			if self.interface.wndPetInfoWindow.AttachItemToPetWindow(player.INVENTORY, player.SLOT_TYPE_INVENTORY, slotIndex):
+			if self.interface.wndPetInfoWindow.AttachItemToPetWindow(player.INVENTORY, slotIndex):
 				return
 				
 			if self.PetSkillDelDlg and self.PetSkillDelDlg.IsShow():
@@ -2539,42 +2121,22 @@
 				return
 
 		if app.ENABLE_CHANGE_LOOK_SYSTEM:
-			if player.GetChangeLookWindowOpen():
+			if player.GetChangeLookWindowOpen() == 1:
 				return
 
-		if app.ENABLE_AURA_COSTUME_SYSTEM:
-			if player.IsAuraWindowOpen():
-				self.__UseItemAura(slotIndex, slotWindow)
+		if app.WJ_ENABLE_TRADABLE_ICON:
+			if self.interface.AttachInvenItemToOtherWindowSlot(slotIndex):
 				return
 
-		if app.WJ_ENABLE_TRADABLE_ICON or app.ENABLE_MOVE_COSTUME_ATTR:
-			if self.interface.AttachInvenItemToOtherWindowSlot(slotIndex, slotWindow):
+		if app.ENABLE_MOUNT_COSTUME_SYSTEM:
+			if item.GetItemType() == item.ITEM_TYPE_COSTUME and item.GetItemSubType() == item.COSTUME_TYPE_MOUNT:
+				self.__SendUseItemPacket(slotIndex)
 				return
 
-		if app.ENABLE_FLOWER_EVENT:
-			if 25121 == ItemVNum or 25122 == ItemVNum or 25123 == ItemVNum or 25124 == ItemVNum or 25125 == ItemVNum:
-				value1 = item.GetValue(0)
-				value2 = item.GetValue(1)
-				value3 = item.GetApplyPoint(value2)
-
-				if item.CheckAffect(value1, value3):
-					pass
-				else:
-					if item.CheckAffect(value1, 0):
-						self.questionDialog = uiCommon.QuestionDialog2()
-						self.questionDialog.SetText1(localeInfo.FLOWER_EVENT_USE_ITEM_TEXT1)
-						self.questionDialog.SetText2(localeInfo.FLOWER_EVENT_USE_ITEM_TEXT2)
-						self.questionDialog.SetAcceptEvent(ui.__mem_func__(self.__UseItemQuestionDialog_OnAccept))
-						self.questionDialog.SetCancelEvent(ui.__mem_func__(self.__UseItemQuestionDialog_OnCancel))
-						self.questionDialog.Open()
-						self.questionDialog.slotIndex = slotIndex
-						self.questionDialog.slotWindow = slotWindow
-						constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(1)
-						return
-
 		if item.IsFlag(item.ITEM_FLAG_CONFIRM_WHEN_USE):
 			self.questionDialog = uiCommon.QuestionDialog()
 			self.questionDialog.SetText(localeInfo.INVENTORY_REALLY_USE_ITEM2)
+
 			self.questionDialog.SetAcceptEvent(ui.__mem_func__(self.__UseItemQuestionDialog_OnAccept))
 			self.questionDialog.SetCancelEvent(ui.__mem_func__(self.__UseItemQuestionDialog_OnCancel))
 			self.questionDialog.Open()
@@ -2582,463 +2144,8 @@
 
 			constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(1)
 		else:
-			self.__SendUseItemPacket(slotIndex, slotWindow)
-
-	def SetCanMouseEventSlot(self, inven_slot_index):
-		if inven_slot_index >= player.INVENTORY_PAGE_SIZE:
-			page = self.GetInventoryPageIndex() # range 0, 1, 2, 3
-			inven_slot_index -= (page * player.INVENTORY_PAGE_SIZE)
-		self.wndItem.SetCanMouseEventSlot(inven_slot_index)
-
-	def SetCantMouseEventSlot(self, inven_slot_index):
-		if inven_slot_index >= player.INVENTORY_PAGE_SIZE:
-			page = self.GetInventoryPageIndex() # range 0, 1, 2, 3
-			inven_slot_index -= (page * player.INVENTORY_PAGE_SIZE)
-		self.wndItem.SetCantMouseEventSlot(inven_slot_index)
-
-	if app.ENABLE_ACCE_COSTUME_SYSTEM:
-		def __UseItemAcce(self, slotIndex, slotWindow):
-			AcceSlot = player.FindMoveAcceItemSlot()
-
-			if slotWindow != player.INVENTORY:
-				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_NOT_USINGITEM)
-				return
-
-			UsingAcceSlot = player.FindActivatedAcceSlot(slotWindow, slotIndex)
-
-			if app.ENABLE_SOULBIND_SYSTEM:
-				## 봉인아이템 걸러냄
-				if player.GetItemSealDate(player.INVENTORY, slotIndex) != item.E_SEAL_DATE_DEFAULT_TIMESTAMP:
-					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_NOT_SEALITEM)
-					return
-
-			## 조합창
-			if player.GetAcceRefineWindowType() == player.ACCE_SLOT_TYPE_COMBINE:
-				if item.GetItemType() == item.ITEM_TYPE_COSTUME:
-					if item.GetItemSubType() == item.COSTUME_TYPE_ACCE:
-						if app.ENABLE_ACCE_SECOND_COSTUME_SYSTEM:
-							## 전설등급 최고 흡수율 25%
-							socketInDrainValue = player.GetItemMetinSocket(slotIndex, 1)
-							if socketInDrainValue >= player.ACCE_MAX_DRAINRATE:
-								chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_MAX_DRAINRATE)
-								return
-						else:
-							if item.GetRefinedVnum() == 0: ## 전선등급 아이템은 걸러냄.
-								chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_MAXGRADE)
-								return
-
-						if UsingAcceSlot == player.ACCE_SLOT_MAX:
-							if AcceSlot != player.ACCE_SLOT_MAX:
-								if not player.FindUsingAcceSlot(AcceSlot) == player.NPOS():
-									return
-
-								if player.FindUsingAcceSlot(player.ACCE_SLOT_LEFT) == player.NPOS():
-									if AcceSlot == player.ACCE_SLOT_RIGHT:
-										return
-
-							player.SetAcceActivatedItemSlot(AcceSlot, slotIndex)
-							net.SendAcceRefineCheckIn(player.INVENTORY, slotIndex, AcceSlot, player.GetAcceRefineWindowType())
-					else:
-						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_POSSIBLE_ACCE)
-						return
-				else:
-					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_POSSIBLE_ACCE)
-					return
-
-			## 흡수창
-			elif player.GetAcceRefineWindowType() == player.ACCE_SLOT_TYPE_ABSORB:
-				isAbsorbItem = False
-				if item.GetItemType() == item.ITEM_TYPE_COSTUME:
-					if item.GetItemSubType() == item.COSTUME_TYPE_ACCE:
-						if not player.GetItemMetinSocket(slotIndex, 0) == 0:
-							chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_NOTABSORBITEM)
-							return
-
-						if UsingAcceSlot == player.ACCE_SLOT_MAX:
-							if not AcceSlot == player.ACCE_SLOT_LEFT: ## 악세서리아이템은 왼쪽 슬롯에만
-								return
-
-							player.SetAcceActivatedItemSlot(AcceSlot, slotIndex)
-							net.SendAcceRefineCheckIn(player.INVENTORY, slotIndex, AcceSlot, player.GetAcceRefineWindowType())
-					else:
-						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_POSSIBLE_ACCEITEM)
-						return
-
-				elif item.GetItemType() == item.ITEM_TYPE_WEAPON: ## 무기류.
-					isAbsorbItem = True
-
-				elif item.GetItemType() == item.ITEM_TYPE_ARMOR: ## 갑옷류
-					if item.GetItemSubType() == item.ARMOR_BODY:
-						isAbsorbItem = True
-					else:
-						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_POSSIBLE_ACCEITEM)
-						return
-				else:
-					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_POSSIBLE_ACCEITEM)
-					return
-
-				if localeInfo.IsBRAZIL():
-					## 브라질에서 아래 나열된 아이템은 능력치가 상당히 강해서 흡수 안되게 해달라고 조름.
-					## 어쩔수 없이 하드코딩함. 
-					itemvnum = item.GetVnum()
-					if itemvnum == 11979 or itemvnum == 11980 or itemvnum == 11981 or itemvnum == 11982 or itemvnum == 11971 or itemvnum == 11972 or itemvnum == 11973 or itemvnum == 11974:
-						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_DONOT_ABSORDITEM)
-						return
-
-				if app.ENABLE_ACCE_SECOND_COSTUME_SYSTEM:
-					itemvnum = item.GetVnum()
-					if item.IsWeddingItem(itemvnum) == 1:
-						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_POSSIBLE_ACCEITEM)
-						return
-
-				if isAbsorbItem:
-					if UsingAcceSlot == player.ACCE_SLOT_MAX:
-						if not AcceSlot == player.ACCE_SLOT_RIGHT: ## 흡수될 아이템은 오른쪽 슬롯에만
-							if player.FindUsingAcceSlot(player.ACCE_SLOT_RIGHT) == player.NPOS():
-								AcceSlot = player.ACCE_SLOT_RIGHT
-							else:
-								return
-
-						popup = uiCommon.QuestionDialog()
-						popup.SetText(localeInfo.ACCE_DEL_ABSORDITEM)
-						popup.SetAcceptEvent(lambda arg1 = slotIndex, arg2 = AcceSlot: self.OnAcceAcceptEvent(arg1, arg2))
-						popup.SetCancelEvent(self.OnAcceCloseEvent)
-						popup.Open()
-						self.pop = popup
-
-			## 경고 메시지 띄우기.
-			if not player.FindUsingAcceSlot(player.ACCE_SLOT_RIGHT) == player.NPOS() and not player.FindUsingAcceSlot(player.ACCE_SLOT_LEFT) == player.NPOS():
-				if AcceSlot != player.ACCE_SLOT_MAX:
-					popup = uiCommon.PopupDialog()
-					if player.GetAcceRefineWindowType() == player.ACCE_SLOT_TYPE_COMBINE:
-
-						if app.ENABLE_ACCE_SECOND_COSTUME_SYSTEM:
-							socketInDrainValue = player.GetAcceItemMetinSocket(0, 1)
-							socketInDrainValue2 = player.GetAcceItemMetinSocket(1, 1)
-							socketInDrainValue3 = player.GetItemMetinSocket(slotIndex, 1)
-							## 메인 서버 중. 등록된 아이템이 전설일때 경고 메시지 변경.
-							if socketInDrainValue > 0 or socketInDrainValue2 > 0 or socketInDrainValue3 > 0:
-								popup.SetText(localeInfo.ACCE_DEL_SERVEITEM2)
-							else:
-								popup.SetText(localeInfo.ACCE_DEL_SERVEITEM)
-						else:
-							popup.SetText(localeInfo.ACCE_DEL_SERVEITEM)
-
-						popup.SetAcceptEvent(self.__OnClosePopupDialog)
-						popup.Open()
-						self.pop = popup
-
-		## 아이템 흡수시 흡수될 아이템 할지 안할지 선택 팝업
-		def OnAcceAcceptEvent(self, slotIndex, AcceSlot):
-			self.pop.Close()
-			self.pop = None
-
-			player.SetAcceActivatedItemSlot(AcceSlot, slotIndex)
-			net.SendAcceRefineCheckIn(player.INVENTORY, slotIndex, AcceSlot, player.GetAcceRefineWindowType())
-
-		def OnAcceCloseEvent(self):
-			self.pop.Close()
-			self.pop = None
-
-	if app.ENABLE_AURA_COSTUME_SYSTEM:
-		def __UseItemAura(self, slotIndex, slotWindow):
-			AuraSlot = player.FindMoveAuraItemSlot()
-
-			if slotWindow != player.INVENTORY:
-				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.ACCE_NOT_USINGITEM)
-				return
-
-			UsingAuraSlot = player.FindActivatedAuraSlot(player.INVENTORY, slotIndex)
-
-			if player.GetAuraCurrentItemSlotCount() >= player.AURA_SLOT_MAX <= UsingAuraSlot:
-				return
-
-			if app.ENABLE_SOULBIND_SYSTEM:
-				## 봉인아이템 걸러냄
-				if player.GetItemSealDate(player.INVENTORY, slotIndex) != item.E_SEAL_DATE_DEFAULT_TIMESTAMP:
-					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_IMPOSSIBLE_SEALITEM)
-					return
-
-			if player.GetAuraWindowType() == player.AURA_WINDOW_TYPE_ABSORB:
-				isAbsorbItem = False
-				if item.GetItemType() == item.ITEM_TYPE_COSTUME:
-					if item.GetItemSubType() == item.COSTUME_TYPE_AURA:
-						if not player.GetItemMetinSocket(slotIndex, item.ITEM_SOCKET_AURA_DRAIN_ITEM_VNUM) == 0:
-							chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_IMPOSSIBLE_ABSORBITEM)
-							return
-
-						if UsingAuraSlot == player.AURA_SLOT_MAX:
-							if AuraSlot != player.AURA_SLOT_MAIN:
-								return
-
-							net.SendAuraRefineCheckIn(player.INVENTORY, slotIndex, AuraSlot, player.GetAuraWindowType())
-					else:
-						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_IMPOSSIBLE_REFINEITEM)
-						return
-
-				elif item.GetItemType() == item.ITEM_TYPE_ARMOR:
-					if item.GetItemSubType() in [item.ARMOR_SHIELD, item.ARMOR_WRIST, item.ARMOR_NECK, item.ARMOR_EAR]:
-						if player.FindUsingAuraSlot(player.AURA_SLOT_MAIN) == player.NPOS():
-							chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_POSSIBLE_REGISTER_AURAITEM)
-							return
-
-						isAbsorbItem = True
-					else:
-						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_IMPOSSIBLE_REFINEITEM)
-						return
-				else:
-					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_IMPOSSIBLE_REFINEITEM)
-					return
-
-				if isAbsorbItem:
-					if UsingAuraSlot == player.AURA_SLOT_MAX:
-						if AuraSlot != player.AURA_SLOT_SUB:
-							if player.FindUsingAuraSlot(player.AURA_SLOT_SUB) == player.NPOS():
-								AuraSlot = player.AURA_SLOT_SUB
-							else:
-								return
-
-						popup = uiCommon.QuestionDialog()
-						popup.SetText(localeInfo.AURA_NOTICE_DEL_ABSORDITEM)
-						popup.SetAcceptEvent(lambda arg1 = slotIndex, arg2 = AuraSlot: self.OnAuraAcceptEvent(arg1, arg2))
-						popup.SetCancelEvent(self.OnAuraCloseEvent)
-						popup.Open()
-						self.pop = popup
-
-			elif player.GetAuraWindowType() == player.AURA_WINDOW_TYPE_GROWTH:
-				if UsingAuraSlot == player.AURA_SLOT_MAX:
-					if AuraSlot == player.AURA_SLOT_MAIN:
-						if item.GetItemType() == item.ITEM_TYPE_COSTUME and item.GetItemSubType() == item.COSTUME_TYPE_AURA:
-							socketLevelValue = player.GetItemMetinSocket(slotIndex, item.ITEM_SOCKET_AURA_LEVEL_VALUE)
-							curLevel = (socketLevelValue / 100000) - 1000
-							curExp = socketLevelValue % 100000;
-							if curLevel >= player.AURA_MAX_LEVEL:
-								chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_MAX_LEVEL)
-								return
-
-							#if curExp >= player.GetAuraRefineInfo(curLevel, item.AURA_REFINE_INFO_NEED_EXP):
-							#	chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_IMPOSSIBLE_GROWTHITEM)
-							#	return
-
-							net.SendAuraRefineCheckIn(player.INVENTORY, slotIndex, AuraSlot, player.GetAuraWindowType())
-						else:
-							chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_POSSIBLE_AURAITEM)
-							return
-
-					elif AuraSlot == player.AURA_SLOT_SUB:
-						if player.FindUsingAuraSlot(player.AURA_SLOT_MAIN) != player.NPOS():
-							if item.GetItemType() == item.ITEM_TYPE_RESOURCE and item.GetItemSubType() == item.RESOURCE_AURA:
-								if UsingAuraSlot == player.AURA_SLOT_MAX:
-									if AuraSlot != player.AURA_SLOT_SUB:
-										return
-
-								net.SendAuraRefineCheckIn(player.INVENTORY, slotIndex, AuraSlot, player.GetAuraWindowType())
-							#else:
-							#	chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_POSSIBLE_AURARESOURCE)
-							#	return
-						else:
-							chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_POSSIBLE_REGISTER_AURAITEM)
-							return
-
-			elif player.GetAuraWindowType() == player.AURA_WINDOW_TYPE_EVOLVE:
-				if UsingAuraSlot == player.AURA_SLOT_MAX:
-					if AuraSlot == player.AURA_SLOT_MAIN:
-						if item.GetItemType() == item.ITEM_TYPE_COSTUME and item.GetItemSubType() == item.COSTUME_TYPE_AURA:
-							socketLevelValue = player.GetItemMetinSocket(slotIndex, item.ITEM_SOCKET_AURA_LEVEL_VALUE)
-							curLevel = (socketLevelValue / 100000) - 1000
-							curExp = socketLevelValue % 100000;
-							if curLevel >= player.AURA_MAX_LEVEL:
-								chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_MAX_LEVEL)
-								return
-
-							if curLevel != player.GetAuraRefineInfo(curLevel, item.AURA_REFINE_INFO_LEVEL_MAX) or curExp < player.GetAuraRefineInfo(curLevel, item.AURA_REFINE_INFO_NEED_EXP):
-								chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_IMPOSSIBLE_EVOLUTION_ITEM)
-								return
-
-							if player.FindUsingAuraSlot(AuraSlot) != player.NPOS():
-								return
-
-							net.SendAuraRefineCheckIn(player.INVENTORY, slotIndex, AuraSlot, player.GetAuraWindowType())
-						else:
-							chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_POSSIBLE_AURAITEM)
-							return
-
-					elif AuraSlot == player.AURA_SLOT_SUB:
-						Cell = player.FindUsingAuraSlot(player.AURA_SLOT_MAIN)
-						if Cell == player.NPOS():
-							chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_POSSIBLE_REGISTER_AURAITEM)
-							return
-
-						socketLevelValue = player.GetItemMetinSocket(*(Cell + (item.ITEM_SOCKET_AURA_LEVEL_VALUE,)))
-						curLevel = (socketLevelValue / 100000) - 1000
-						curExp = socketLevelValue % 100000;
-						if curLevel >= player.AURA_MAX_LEVEL:
-							chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_MAX_LEVEL)
-							return
-
-						if curExp < player.GetAuraRefineInfo(curLevel, item.AURA_REFINE_INFO_NEED_EXP):
-							chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_IMPOSSIBLE_EVOLUTION_ITEM)
-							return
-
-						if player.GetItemIndex(slotIndex) != player.GetAuraRefineInfo(curLevel, item.AURA_REFINE_INFO_MATERIAL_VNUM):
-							chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_IMPOSSIBLE_EVOLUTION_ITEM)
-							return
-
-						if player.GetItemCount(slotIndex) < player.GetAuraRefineInfo(curLevel, item.AURA_REFINE_INFO_MATERIAL_COUNT):
-							chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_IMPOSSIBLE_EVOLUTION_ITEMCOUNT)
-							return
-
-						if UsingAuraSlot == player.AURA_SLOT_MAX:
-							if AuraSlot != player.AURA_SLOT_MAX:
-								if player.FindUsingAuraSlot(AuraSlot) != player.NPOS():
-									return
-
-							net.SendAuraRefineCheckIn(player.INVENTORY, slotIndex, AuraSlot, player.GetAuraWindowType())
-
-		def OnAuraAcceptEvent(self, slotIndex, AuraSlot):
-			self.OnAuraCloseEvent()
-			net.SendAuraRefineCheckIn(player.INVENTORY, slotIndex, AuraSlot, player.GetAuraWindowType())
-
-		def OnAuraCloseEvent(self):
-			self.pop.Close()
-			self.pop = None
-
-		def __UseAuraClearItem(self, src_item_window, src_item_pos, dst_item_window, dst_item_pos):
-			if self.clear_aura_item_question_dialog:
-				return
-
-			if app.ENABLE_SOULBIND_SYSTEM:
-				if player.GetItemSealDate(dst_item_window, dst_item_pos) != item.E_SEAL_DATE_DEFAULT_TIMESTAMP:
-					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.AURA_CLEAR_CANNOT_USE_SEALED_ITEM)
-					return
-
-			question_dialog = uiCommon.QuestionDialog()
-			question_dialog.SetText(localeInfo.AURA_CLEAR_QUESTION_WHEN_USE)
-			question_dialog.SetAcceptEvent(ui.__mem_func__(self.__AuraClearItemAccept))
-			question_dialog.SetCancelEvent(ui.__mem_func__(self.__AuraClearItemCancel))
-			question_dialog.Open()
-			question_dialog.srcItemWindow = src_item_window
-			question_dialog.srcItemPos = src_item_pos
-			question_dialog.dstItemWindow = dst_item_window
-			question_dialog.dstItemPos = dst_item_pos
-			self.clear_aura_item_question_dialog = question_dialog
-			constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(1)
-
-		def __AuraClearItemAccept(self):
-			if self.clear_aura_item_question_dialog:
-				self.__SendUseItemToItemPacket(\
-					self.clear_aura_item_question_dialog.srcItemWindow,\
-					self.clear_aura_item_question_dialog.srcItemPos,\
-					self.clear_aura_item_question_dialog.dstItemWindow,\
-					self.clear_aura_item_question_dialog.dstItemPos)
-
-			self.__AuraClearQuestionDialogClose()
-
-		def __AuraClearItemCancel(self):
-			self.__AuraClearQuestionDialogClose()
-
-		def __AuraClearQuestionDialogClose(self):
-			if self.clear_aura_item_question_dialog:
-				self.clear_aura_item_question_dialog.Close()
-			self.clear_aura_item_question_dialog = None
-			constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(0)
-
-	if app.ENABLE_GEM_CONVERTER:
-		def __CanUseGemConverter(self, src_item_vnum, src_item_window, src_item_pos, dst_item_window, dst_item_pos):
-			if src_item_window == dst_item_window and src_item_pos == dst_item_pos:
-				return False
-
-			if src_item_vnum != item.ITEM_VNUM_GEM_CONVERTER:
-				return False
-
-			item.SelectItem(src_item_vnum)
-
-			gem_conv_count = player.GetItemCount(src_item_window, src_item_pos)
-			gem_stone_vnum = player.GetItemIndex(dst_item_window, dst_item_pos)
-			gem_stone_count = player.GetItemCount(dst_item_window, dst_item_pos)
-
-			need_gem_stone_count = gem_conv_count * item.GetValue(0)
-
-			if gem_stone_vnum != item.ITEM_VNUM_GEM_STONE:
-				return False
-
-			if gem_stone_count < need_gem_stone_count:
-				return False
-
-			return True
-
-		def __UseGemConverter(self, src_item_window, src_item_pos, dst_item_window, dst_item_pos):
-			if self.gem_converter_question_dialog:
-				return
-
-			self.gem_converter_item_pos = (src_item_pos, dst_item_pos)
-
-			self.SetCantMouseEventSlot(src_item_pos)
-			self.SetCantMouseEventSlot(dst_item_pos)
-
-			question_dialog = uiCommon.QuestionDialog()
-			question_dialog.SetText(localeInfo.GEM_CONVERTER_MESSAGE_USE_CONVERTER_QUESTION)
-			question_dialog.SetAcceptEvent(ui.__mem_func__(self.__AcceptGemConverterUse))
-			question_dialog.SetCancelEvent(ui.__mem_func__(self.__CancelGemConverterUse))
-			question_dialog.Open()
-			question_dialog.srcItemWindow = src_item_window
-			question_dialog.srcItemPos = src_item_pos
-			question_dialog.dstItemWindow = dst_item_window
-			question_dialog.dstItemPos = dst_item_pos
-			self.gem_converter_question_dialog = question_dialog
-			constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(1)
-
-		def __AcceptGemConverterUse(self):
-			if not self.gem_converter_question_dialog:
-				return
-
-			gem_conv_vnum = player.GetItemIndex(self.gem_converter_question_dialog.srcItemWindow, self.gem_converter_question_dialog.srcItemPos)
-			gem_conv_count = player.GetItemCount(self.gem_converter_question_dialog.srcItemWindow, self.gem_converter_question_dialog.srcItemPos)
-			gem_stone_count = player.GetItemCount(self.gem_converter_question_dialog.dstItemWindow, self.gem_converter_question_dialog.dstItemPos)
-
-			item.SelectItem(gem_conv_vnum)
-			need_gem_stone_count = gem_conv_count * item.GetValue(0)
-			conv_to_gem = need_gem_stone_count / item.GetValue(0)
-			conv_cost = gem_conv_count * item.GetValue(1)
-
-			if gem_stone_count < need_gem_stone_count:
-				self.__CancelGemConverterUse()
-				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.GEM_CONVERTER_MESSAGE_NOT_ENOUGH_GEMSTONE % localeInfo.NumberToMoneyString(need_gem_stone_count))
-				return
-
-			if player.GetElk() < conv_cost:
-				self.__CancelGemConverterUse()
-				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.GEM_CONVERTER_MESSAGE_NOT_ENOUGH_GOLD)
-				return
-
-			if player.GetGem() + conv_to_gem >= player.GEM_MAX:
-				self.__CancelGemConverterUse()
-				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.GEM_CONVERTER_MESSAGE_GEM_MAX)
-				return
-
-			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.GEM_CONVERTER_MESSAGE_CONVERT_SUCCESS_GEM_STONE % gem_conv_count)
-			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.GEM_CONVERTER_MESSAGE_CONVERT_SUCCESS_CONVERTER % need_gem_stone_count)
-
-			self.__SendUseItemToItemPacket(\
-				self.gem_converter_question_dialog.srcItemWindow,\
-				self.gem_converter_question_dialog.srcItemPos,\
-				self.gem_converter_question_dialog.dstItemWindow,\
-				self.gem_converter_question_dialog.dstItemPos)
-
-			self.__CancelGemConverterUse()
-
-		def __CancelGemConverterUse(self):
-			for i in self.gem_converter_item_pos:
-				self.SetCanMouseEventSlot(i)
-			self.gem_converter_item_pos = [-1, -1]
-
-			self.__CloseGemConverterUseQuestionDialog()
-
-		def __CloseGemConverterUseQuestionDialog(self):
-			if self.gem_converter_question_dialog:
-				self.gem_converter_question_dialog.Close()
-			self.gem_converter_question_dialog = None
-			constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(0)
+			self.__SendUseItemPacket(slotIndex)
+			#net.SendItemUsePacket(slotIndex)
 
 	def __UseItemQuestionDialog_OnCancel(self):
 		self.OnCloseQuestionDialog()
@@ -3047,229 +2154,52 @@
 		self.__SendUseItemPacket(self.questionDialog.slotIndex)
 		self.OnCloseQuestionDialog()
 
-	def __SendUseItemToItemPacket(self, srcSlotWindow, srcSlotPos, dstSlotWindow, dstSlotPos):
+	def __SendUseItemToItemPacket(self, srcSlotPos, dstSlotPos):
 		# 개인상점 열고 있는 동안 아이템 사용 방지
 		if uiPrivateShopBuilder.IsBuildingPrivateShop():
 			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.USE_ITEM_FAILURE_PRIVATE_SHOP)
 			return
 
-		#if self.interface.IsShowDlgQuestionWindow():
-		#	chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.DONT_USE_ITEM_WHEN_SHOW_CONFIRM)
-		#	return
+		if self.interface.IsShowDlgQuestionWindow():
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.DONT_USE_ITEM_WHEN_SHOW_CONFIRM)
+			return
 
-		net.SendItemUseToItemPacket(srcSlotWindow, srcSlotPos, dstSlotWindow, dstSlotPos)
+		net.SendItemUseToItemPacket(srcSlotPos, dstSlotPos)
 
-	def __SendUseItemPacket(self, slotPos, slotWindow = player.INVENTORY):
+	def __SendUseItemPacket(self, slotPos):
 		# 개인상점 열고 있는 동안 아이템 사용 방지
 		if uiPrivateShopBuilder.IsBuildingPrivateShop():
 			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.USE_ITEM_FAILURE_PRIVATE_SHOP)
 			return
 
-		#if self.interface.IsShowDlgQuestionWindow():
-		#	chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.DONT_USE_ITEM_WHEN_SHOW_CONFIRM)
-		#	return
+		if self.interface.IsShowDlgQuestionWindow():
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.DONT_USE_ITEM_WHEN_SHOW_CONFIRM)
+			return
 
-		net.SendItemUsePacket(slotWindow, slotPos)
+		net.SendItemUsePacket(slotPos)
 
-	def __SendMoveItemPacket(self, srcSlotWindow, srcSlotPos, dstSlotWindow, dstSlotPos, srcItemCount):
+	def __SendMoveItemPacket(self, srcSlotPos, dstSlotPos, srcItemCount):
 		# 개인상점 열고 있는 동안 아이템 사용 방지
 		if uiPrivateShopBuilder.IsBuildingPrivateShop():
 			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.MOVE_ITEM_FAILURE_PRIVATE_SHOP)
 			return
 
-		#if self.interface.IsShowDlgQuestionWindow():
-		#	chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.DONT_USE_ITEM_WHEN_SHOW_CONFIRM)
-		#	return
+		if self.interface.IsShowDlgQuestionWindow():
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.DONT_USE_ITEM_WHEN_SHOW_CONFIRM)
+			return
 
-		net.SendItemMovePacket(srcSlotWindow, srcSlotPos, dstSlotWindow, dstSlotPos, srcItemCount)
+		net.SendItemMovePacket(srcSlotPos, dstSlotPos, srcItemCount)
 
 	def SetDragonSoulRefineWindow(self, DragonSoulRefine):
 		from _weakref import proxy
 		self.wndDragonSoulRefine = proxy(DragonSoulRefine)
 
 	def OnMoveWindow(self, x, y):
-		if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-			pass
-		else:
-			if self.wndBelt:
-				self.wndBelt.AdjustPosition()
-
-	# 악세서리 슬롯 테두리 추가, 제거.
-	## HilightSlot Change
-	def DeactivateSlot(self, slotindex, type):
-		if type == wndMgr.HILIGHTSLOT_MAX:
-			return
-
-		if app.ENABLE_ACCE_COSTUME_SYSTEM:
-			if type == wndMgr.HILIGHTSLOT_ACCE:
-				self.__DelHighlightSlotAcce(slotindex)
-
-		if app.ENABLE_CHANGE_LOOK_SYSTEM:
-			if type == wndMgr.HILIGHTSLOT_CHANGE_LOOK:
-				self.__DelHighlightSlotChangeLook(slotindex)
-
-		if app.ENABLE_AURA_COSTUME_SYSTEM:
-			if type == wndMgr.HILIGHTSLOT_AURA:
-				self.__DelHighlightSlotAura(slotindex)
-
-		if app.ENABLE_CUBE_RENEWAL:
-			if type == wndMgr.HILIGHTSLOT_CUBE:
-				self.__DelHighlightSlotCube(slotindex)
-
-	## HilightSlot Change
-	def ActivateSlot(self, slotindex, type):
-		if type == wndMgr.HILIGHTSLOT_MAX:
-			return
-
-		#if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
-		#	self.DelHighlightSlot(slotindex)
-
-		if app.ENABLE_ACCE_COSTUME_SYSTEM:
-			if type == wndMgr.HILIGHTSLOT_ACCE:
-				self.__AddHighlightSlotAcce(slotindex)
-
-		if app.ENABLE_CHANGE_LOOK_SYSTEM:
-			if type == wndMgr.HILIGHTSLOT_CHANGE_LOOK:
-				self.__AddHighlightSlotChangeLook(slotindex)
-
-		if app.ENABLE_AURA_COSTUME_SYSTEM:
-			if type == wndMgr.HILIGHTSLOT_AURA:
-				self.__AddHighlightSlotAura(slotindex)
-
-		if app.ENABLE_CUBE_RENEWAL:
-			if type == wndMgr.HILIGHTSLOT_CUBE:
-				self.__AddHighlightSlotCube(slotindex)
-
-	if app.ENABLE_ACCE_COSTUME_SYSTEM:
-		## 악세서리 용 하이라이트 list 추가.
-		def __AddHighlightSlotAcce(self, slotIndex):
-			if not slotIndex in self.listHighlightedAcceSlot:
-				self.listHighlightedAcceSlot.append(slotIndex)
-
-		## 악세서리 용 하이라이트 list 삭제.
-		def __DelHighlightSlotAcce(self, slotIndex):
-			if slotIndex in self.listHighlightedAcceSlot:
-				if slotIndex >= player.INVENTORY_PAGE_SIZE:
-					self.wndItem.DeactivateSlot(slotIndex - (self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE))
-					self.wndItem.SetCanMouseEventSlot(slotIndex - (self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE))
-				else:
-					self.wndItem.DeactivateSlot(slotIndex)
-					self.wndItem.SetCanMouseEventSlot(slotIndex)
-
-				self.listHighlightedAcceSlot.remove(slotIndex)
-
-	if app.ENABLE_CHANGE_LOOK_SYSTEM:
-		def __AddHighlightSlotChangeLook(self, slotIndex):
-			if not slotIndex in self.listHighlightedChangeLookSlot:
-				self.listHighlightedChangeLookSlot.append(slotIndex)
-
-		def __DelHighlightSlotChangeLook(self, slotIndex):
-			if slotIndex in self.listHighlightedChangeLookSlot:
-				if slotIndex >= player.INVENTORY_PAGE_SIZE:
-					self.wndItem.DeactivateSlot(slotIndex - (self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE))
-					self.wndItem.SetCanMouseEventSlot(slotIndex - (self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE))
-				else:
-					self.wndItem.DeactivateSlot(slotIndex)
-					self.wndItem.SetCanMouseEventSlot(slotIndex)
-				self.listHighlightedChangeLookSlot.remove(slotIndex)
-
-	if app.ENABLE_CUBE_RENEWAL:
-		def __AddHighlightSlotCube(self, slotIndex):
-			if not slotIndex in self.listHighlightedCubeSlot:
-				self.listHighlightedCubeSlot.append(slotIndex)
-
-		def __DelHighlightSlotCube(self, slotIndex):
-			if slotIndex in self.listHighlightedCubeSlot:
-				if slotIndex >= player.INVENTORY_PAGE_SIZE:
-					self.wndItem.DeactivateSlot(slotIndex - (self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE))
-				else:
-					self.wndItem.DeactivateSlot(slotIndex)
-				self.listHighlightedCubeSlot.remove(slotIndex)
-
-	if app.ENABLE_AURA_COSTUME_SYSTEM:
-		def __AddHighlightSlotAura(self, slotIndex):
-			if not slotIndex in self.listHighlightedAuraSlot:
-				self.listHighlightedAuraSlot.append(slotIndex)
-
-		def __DelHighlightSlotAura(self, slotIndex):
-			if slotIndex in self.listHighlightedAuraSlot:
-				if slotIndex >= player.INVENTORY_PAGE_SIZE:
-					self.wndItem.DeactivateSlot(slotIndex - (self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE))
-					self.wndItem.SetCanMouseEventSlot(slotIndex - (self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE))
-				else:
-					self.wndItem.DeactivateSlot(slotIndex)
-					self.wndItem.SetCanMouseEventSlot(slotIndex)
-				self.listHighlightedAuraSlot.remove(slotIndex)
-
-	## 하이라이트 리프레쉬.
-	def __HighlightSlot_Refresh(self):
-		## 악세서리.
-		for i in xrange(self.wndItem.GetSlotCount()):
-			slotNumber = self.__InventoryLocalSlotPosToGlobalSlotPos(i)
-
-			if app.ENABLE_ACCE_COSTUME_SYSTEM:
-				if slotNumber in self.listHighlightedAcceSlot:
-					self.wndItem.ActivateSlot(i)
-					self.wndItem.SetSlotDiffuseColor(i, wndMgr.COLOR_TYPE_GREEN)
-					self.wndItem.SetCantMouseEventSlot(i)
-
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				if slotNumber in self.listHighlightedChangeLookSlot:
-					self.wndItem.ActivateSlot(i)
-					self.wndItem.SetSlotDiffuseColor(i, wndMgr.COLOR_TYPE_RED)
-					self.wndItem.SetCantMouseEventSlot(i)
-
-			if app.ENABLE_AURA_COSTUME_SYSTEM:
-				if slotNumber in self.listHighlightedAuraSlot:
-					self.wndItem.ActivateSlot(i)
-					self.wndItem.SetSlotDiffuseColor(i, wndMgr.COLOR_TYPE_GREEN)
-					self.wndItem.SetCantMouseEventSlot(i)
-
-			if app.ENABLE_CUBE_RENEWAL:
-				if slotNumber in self.listHighlightedCubeSlot:
-					self.wndItem.ActivateSlot(i)
-					self.wndItem.SetSlotDiffuseColor(i, wndMgr.COLOR_TYPE_RED)
-
-			## HilightSlot Change
-			if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
-				if slotNumber in self.listHighlightedSlot:
-					self.wndItem.ActivateSlot(i)
-					self.wndItem.SetSlotDiffuseColor(i, wndMgr.COLOR_TYPE_MAX)
-
-	## 악세서리 용 하이라이트 list 클리어.
-	def __HighlightSlot_Clear(self):
-		## 악세서리
-		for i in xrange(self.wndItem.GetSlotCount()):
-			slotNumber = self.__InventoryLocalSlotPosToGlobalSlotPos(i)
-
-			if app.ENABLE_ACCE_COSTUME_SYSTEM:
-				if slotNumber in self.listHighlightedAcceSlot:
-					self.wndItem.DeactivateSlot(i)
-					self.wndItem.SetCanMouseEventSlot(i)
-					self.listHighlightedAcceSlot.remove(slotNumber)
-
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				if slotNumber in self.listHighlightedChangeLookSlot:
-					self.wndItem.DeactivateSlot(i)
-					self.wndItem.SetCanMouseEventSlot(i)
-					self.listHighlightedChangeLookSlot.remove(slotNumber)
-
-			if app.ENABLE_AURA_COSTUME_SYSTEM:
-				if slotNumber in self.listHighlightedAuraSlot:
-					self.wndItem.DeactivateSlot(i)
-					self.wndItem.SetCanMouseEventSlot(i)
-					self.listHighlightedAuraSlot.remove(slotNumber)
-
-			if app.ENABLE_CUBE_RENEWAL:
-				if slotNumber in self.listHighlightedCubeSlot:
-					self.wndItem.DeactivateSlot(i)
-					self.listHighlightedCubeSlot.remove(slotNumber)
-
-			## HilightSlot Change
-			if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
-				if slotNumber in self.listHighlightedSlot:
-					self.wndItem.DeactivateSlot(i)
-					self.listHighlightedSlot.remove(slotNumber)
+		if self.wndBelt:
+			if localeInfo.IsARABIC():
+				self.wndBelt.AdjustPositionAndSizeAE()
+			else:
+				self.wndBelt.AdjustPositionAndSize()
 
 	if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
 		# 슬롯 highlight 관련
@@ -3292,6 +2222,22 @@
 
 				self.listHighlightedSlot.remove(inventorylocalslot)
 
+		## 하이라이트 리프레쉬.
+		def __HighlightSlot_Refresh(self):
+			for i in xrange(self.wndItem.GetSlotCount()):
+				slotNumber = self.__InventoryLocalSlotPosToGlobalSlotPos(i)
+				if slotNumber in self.listHighlightedSlot:
+					self.wndItem.ActivateSlot(i)
+
+		## 악세서리 용 하이라이트 list 클리어.
+		def __HighlightSlot_Clear(self):
+			## 악세서리
+			for i in xrange(self.wndItem.GetSlotCount()):
+				slotNumber = self.__InventoryLocalSlotPosToGlobalSlotPos(i)
+				if slotNumber in self.listHighlightedSlot:
+					self.wndItem.DeactivateSlot(i)
+					self.listHighlightedSlot.remove(slotNumber)
+
 		# 슬롯 highlight 관련 끝
 
 	# wj.2014.12.2. 인벤토리와 DS인벤 간의 상태를 확인 및 설정하기 위한 함수.
@@ -3307,10 +2253,73 @@
 	def SetUseItemMode(self, bUse):
 		self.wndItem.SetUseMode(bUse)
 
-	if app.ENABLE_MOVE_COSTUME_ATTR or app.ENABLE_CHEQUE_SYSTEM or app.ENABLE_ATTR_6TH_7TH:
-		def GetInventoryPageIndex(self):
-			## 0 or 1
-			return self.inventoryPageIndex
+	def GetInventoryPageIndex(self):
+		## 0 or 1
+		return self.inventoryPageIndex
+
+	if app.ENABLE_CHEQUE_SYSTEM:
+		def OverInToolTip(self, arg):
+			arglen = len(str(arg))
+			pos_x, pos_y = wndMgr.GetMousePosition()
+
+			self.toolTip.ClearToolTip()
+			self.toolTip.SetThinBoardSize(11 * arglen)
+			self.toolTip.SetToolTipPosition(pos_x + 5, pos_y - 5)
+			self.toolTip.AppendTextLine(arg, 0xffffff00)
+			self.toolTip.Show()
+
+		def OverOutToolTip(self):
+			self.toolTip.Hide()
+
+		def EventProgress(self, event_type, idx):
+			if "mouse_over_in" == str(event_type):
+				if idx == 0:
+					self.OverInToolTip(localeInfo.CHEQUE_SYSTEM_UNIT_YANG)
+				elif idx == 1:
+					self.OverInToolTip(localeInfo.CHEQUE_SYSTEM_UNIT_WON)
+				elif app.ENABLE_GEM_SYSTEM and idx == 2 :
+					self.OverInToolTip(localeInfo.GEM_SYSTEM_NAME)
+				else:
+					return
+			elif "mouse_over_out" == str(event_type):
+				self.OverOutToolTip()
+			else:
+				return
+
+	if app.ENABLE_ACCE_COSTUME_SYSTEM:
+		def SetAcceWindow(self, wndAcceCombine, wndAcceAbsorption):
+			self.wndAcceCombine = wndAcceCombine
+			self.wndAcceAbsorption = wndAcceAbsorption
+
+		def isShowAcceWindow(self):
+			if self.wndAcceCombine:
+				if self.wndAcceCombine.IsShow():
+					return 1
+
+			if self.wndAcceAbsorption:
+				if self.wndAcceAbsorption.IsShow():
+					return 1
+
+			return 0
+
+	if app.ENABLE_CHANGE_LOOK_SYSTEM:
+		def SetChangeLookWindow(self, wndChangeLook):
+			self.wndChangeLook = wndChangeLook
+
+		def isShowChangeLookWindow(self):
+			if self.wndChangeLook:
+				if self.wndChangeLook.IsShow():
+					return 1
+
+			return 0
+
+	if app.ENABLE_HIDE_COSTUME_SYSTEM:
+		def RefreshVisibleCostume(self):
+			if self.wndCostume:
+				self.wndCostume.RefreshVisibleCostume()
+			else:
+				self.wndCostume = CostumeWindow(self)
+				self.wndCostume.RefreshVisibleCostume()
 
 	if app.ENABLE_GROWTH_PET_SYSTEM:
 		def __UseItemPet(self, slotIndex):
@@ -3622,7 +2631,7 @@
 				
 				elif item.PET_BAG == srcItemSubType:
 					self.PetItemQuestionDlg.SetText( localeInfo.INVENTORY_REALLY_USE_PET_BAG_ITEM )
-					self.PetItemQuestionDlg.Open()
+					self.PetItemQuestionDlg.Open()			
 				
 		def __PetItemAccept(self):
 			self.PetItemQuestionDlg.Close()
@@ -3657,48 +2666,3 @@
 				page = self.GetInventoryPageIndex() # range 0,1,2,3
 				inven_slot_index -= (page * player.INVENTORY_PAGE_SIZE)
 			self.wndItem.SetCantMouseEventSlot(inven_slot_index)
-
-	if app.ENABLE_CHEQUE_SYSTEM:
-		def OverInToolTip(self, arg) :
-			arglen = len(str(arg))
-			pos_x, pos_y = wndMgr.GetMousePosition()
-
-			self.toolTip.ClearToolTip()
-			self.toolTip.SetThinBoardSize(11 * arglen)
-			self.toolTip.SetToolTipPosition(pos_x + 5, pos_y - 5)
-			self.toolTip.AppendTextLine(arg, 0xffffff00)
-			self.toolTip.Show()
-
-		def OverOutToolTip(self) :
-			self.toolTip.Hide()
-
-		def EventProgress(self, event_type, idx):
-			if "mouse_over_in" == str(event_type):
-				if idx == 0:
-					self.OverInToolTip(localeInfo.CHEQUE_SYSTEM_UNIT_YANG)
-				elif idx == 1:
-					self.OverInToolTip(localeInfo.CHEQUE_SYSTEM_UNIT_WON)
-				elif app.ENABLE_GEM_SYSTEM and idx == 2:
-					self.OverInToolTip(localeInfo.GEM_SYSTEM_NAME)
-				else:
-					return
-			elif "mouse_over_out" == str(event_type):
-				self.OverOutToolTip()
-			else:
-				return
-
-	if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-		def BindEquipmentWindow(self, equipment_window):
-			self.wndEquipment = equipment_window
-
-	def UseInventoryItemInQuickSlot(self, global_slot_index):
-		self.__UseItem(global_slot_index, player.INVENTORY)
-
-	if app.ENABLE_HIDE_COSTUME_SYSTEM:
-		def SetHiddenCostumePart(self, part, hidden):
-			if app.ENABLE_ADDITIONAL_EQUIPMENT_PAGE:
-				if self.wndEquipment:
-					self.wndEquipment.SetHiddenCostumePart(part, hidden)
-			else:
-				if self.wndCostume:
-					self.wndCostume.SetHiddenCostumePart(part, hidden)
diff -ruN client_base/client/client/pack/root/uipetinfo.py client_final/client/client/pack/root/uipetinfo.py
--- client_base/client/client/pack/root/uipetinfo.py	2026-02-13 09:22:34.000000000 +0000
+++ client_final/client/client/pack/root/uipetinfo.py	2026-02-20 18:13:16.470973942 +0000
@@ -1,4 +1,3 @@
-# -*- coding: utf-8 -*-
 import ui
 import uiScriptLocale
 import app
@@ -9,11 +8,15 @@
 import mouseModule
 import wndMgr
 import skill
+import playerSettingModule
+import quest
 import localeInfo
 import uiToolTip
 import constInfo
+import emotion
 import chr
 import item
+import uiPrivateShopBuilder
 import chat
 import uiCommon
 import uiAffectShower
@@ -157,7 +160,7 @@
 			self.lifeTimeGauge.SetWindowHorizontalAlignLeft()
 			if localeInfo.IsARABIC():
 				self.GetChild("gauge_left").LeftRightReverse()
-				self.GetChild("gauge_right").LeftRightReverse()
+				self.GetChild("gauge_right").LeftRightReverse()				
 				
 		except:
 			import exception
@@ -215,7 +218,7 @@
 	def SetLifeTime(self, curPoint, maxPoint):
 		curPoint = min(curPoint, maxPoint)
 		if maxPoint > 0:
-			self.lifeTimeGauge.SetPercentage(curPoint, maxPoint)
+			self.lifeTimeGauge.SetPercentageWithScale(curPoint, maxPoint)
 				
 	def SetExperience(self, curPoint, maxPoint, itemExp, itemExpMax):
 		
@@ -261,23 +264,25 @@
 		if output_max_exp:
 			expPercent = float(output_cur_exp) / float(output_max_exp) * 100
 		
-		## TEXT output is based on hunting experience + item experience.
+		# If WJ_MULTI_TEXTLINE is active, experience points will be
+		# shown seperately based on type.
 		if app.WJ_MULTI_TEXTLINE:
 			if localeInfo.IsARABIC():
 				tooltip_text = str(curPoint)				+ ' :'	+ str(localeInfo.PET_INFO_EXP)			+ '\\n'	\
 							 + str(maxPoint - curPoint)		+ ' :'	+ str(localeInfo.PET_INFO_NEXT_EXP)		+ '\\n'	\
 							 + str(itemExp)					+ ' :'	+ str(localeInfo.PET_INFO_ITEM_EXP)		+ '\\n'	\
-							 + str(itemExpMax - itemExp)	+ ' :'	+ str(localeInfo.PET_INFO_NEXT_ITEM_EXP)
+							 + str(itemExpMax - itemExp)	+ ' :'	+ str(localeInfo.PET_INFO_NEXT_ITEM_EXP)	
 				self.tooltipEXP.SetText(tooltip_text)
 			else:
 				tooltip_text = str(localeInfo.PET_INFO_EXP) + ': '+ str(curPoint) + '\\n'	\
 							 + str(localeInfo.PET_INFO_NEXT_EXP) + ': ' + str(maxPoint - curPoint) + '\\n'	\
 							 + str(localeInfo.PET_INFO_ITEM_EXP) + ': '+ str(itemExp) + '\\n'	\
 							 + str(localeInfo.PET_INFO_NEXT_ITEM_EXP) + ': ' + str(itemExpMax - itemExp)
+							 
 				self.tooltipEXP.SetText(tooltip_text)
 		else:
-			self.tooltipEXP.SetText("%s : %.2f%%" % (localeInfo.TASKBAR_EXP, float(output_cur_exp) / max(1, float(output_max_exp - output_cur_exp)) * 100))
-
+			self.tooltipEXP.SetText("%s : %.2f%%" % (localeInfo.TASKBAR_EXP, expPercent))
+			
 	def OnFlashEvent(self):
 		if self.petSlotAniImg:
 			self.petSlotAniImg.Show()
@@ -526,8 +531,8 @@
 		self.hatchingSlot.SetItemSlot(0, growthPetVnum)
 		self.hatchingSlot.RefreshSlot()
 		item_string = item.GetItemName()
-		self.petName = item_string[:item.PET_NAME_MAX_SIZE]
-		self.petNameEdit.SetText(self.petName)
+		#self.petName = item_string[:item.PET_NAME_MAX_SIZE]
+		#self.petNameEdit.SetText(self.petName)
 		self.petNameEdit.SetEndPosition()
 		self.petNameEdit.SetFocus()
 		self.petNameEdit.Show()
@@ -1133,11 +1138,12 @@
 		return -1
 	
 	# Move items inside the feed window (item slot grid)
-	def ItemMoveFeedWindow(self, slotWindow, attachSlotType, slotIndex):
-		#if player.INVENTORY == slotWindow:
-		#	attachSlotType = player.SLOT_TYPE_INVENTORY
-		#else:
-		#	return False
+	def ItemMoveFeedWindow(self, slotWindow, slotIndex):
+		if player.INVENTORY == slotWindow:
+			attachSlotType = player.SLOT_TYPE_INVENTORY
+		else:
+			return False
+	
 		checkTime = app.GetGlobalTimeStamp() - self.feedButtonClickTime
 		if checkTime < 2:
 			if slotIndex in self.backupFeedItems:
@@ -1180,7 +1186,7 @@
 				if value:
 					attributeCount += 1
 					
-			if attributeCount:
+			if attributeCount >= 3:
 				self.questionDialogEmptyPos = emptySlotIndex
 				self.questionDialogItemPos = slotIndex
 				
@@ -1232,19 +1238,11 @@
 		attachedSlotType	= mouseModule.mouseController.GetAttachedType()			
 		attachedSlotPos		= mouseModule.mouseController.GetAttachedSlotNumber()
 		
-		#if player.SLOT_TYPE_INVENTORY != attachedSlotType:
-		#	return False
+		if player.SLOT_TYPE_INVENTORY != attachedSlotType:
+			return False
+		
+		self.ItemMoveFeedWindow(player.INVENTORY, attachedSlotPos)
 		
-		if player.SLOT_TYPE_INVENTORY == attachedSlotType or\
-				player.SLOT_TYPE_SKILL_BOOK_INVENTORY == attachedSlotType or\
-				player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == attachedSlotType or\
-				player.SLOT_TYPE_STONE_INVENTORY == attachedSlotType or\
-				player.SLOT_TYPE_GIFT_BOX_INVENTORY == attachedSlotType or\
-				player.SLOT_TYPE_SWITCH_INVENTORY == attachedSlotType or\
-				player.SLOT_TYPE_COSTUME_INVENTORY == attachedSlotType:
-
-			self.ItemMoveFeedWindow(player.INVENTORY, attachedSlotType, attachedSlotPos)
-
 	def InsertItemToSlot(self, slotIndex):
 		checkTime = app.GetGlobalTimeStamp() - self.feedButtonClickTime
 		if checkTime < 2:
@@ -1266,36 +1264,30 @@
 		itemSubType = item.GetItemSubType()			
 		
 		# Return if item is beging attached from not inventory window
-		if player.SLOT_TYPE_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_SKILL_BOOK_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_STONE_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_GIFT_BOX_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_SWITCH_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_COSTUME_INVENTORY != attachedSlotType:
+		if player.SLOT_TYPE_INVENTORY != attachedSlotType:
 			return False
-
-		# Return if item position is bigger than player.INVENTORY_SLOT_COUNT
-		if attachedSlotPos >= player.INVENTORY_SLOT_COUNT: 
+			
+		# Return if item position is bigger than player.ITEM_SLOT_COUNT
+		if attachedSlotPos >= player.ITEM_SLOT_COUNT: 
 			return False
 		
 		# Return if there is no pet summoned
 		petVNum = player.GetActivePetItemVNum()
 		if 0 == petVNum:
 			return False
-
+			
 		# Return if active pet is being dragged to the window
 		if item.ITEM_TYPE_PET == itemType and itemSubType == item.PET_UPBRINGING:
 			activePetId = player.GetActivePetItemId()
 			petId = player.GetItemMetinSocket(attachedSlotPos, 2)
 			if petId == activePetId:
 				return False
-		
+				
 		# Display a msg if item type does not correspond to condtions
 		if self.wndPetInformation.CantFeedItem(attachedSlotPos):
 			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.PET_CAN_NOT_FEED_TYPE)
 			return False
-		
+			
 		if -1 != self.FeedItems[slotIndex]:
 			return False
 		
@@ -1427,7 +1419,6 @@
 		interface = self.wndPetInformation.interface
 		interface.SetOnTopWindow(player.ON_TOP_WND_PET_FEED)
 		interface.RefreshMarkInventoryBag()
-
 	
 """
 		PetInformationWindow is opened through taskbar or 'P' key.
@@ -1599,6 +1590,7 @@
 				
 			# Life Time Gauge
 			self.lifeTimeGauge = self.GetChild("LifeGauge")
+			self.lifeTimeGauge.SetScale(1.61, 1.0)
 			self.lifeTimeGauge.SetWindowHorizontalAlignLeft()
 			
 			if localeInfo.IsARABIC():
@@ -1681,8 +1673,7 @@
 				
 			# Determine Button
 			self.GetChild("DetermineButton").SetEvent(ui.__mem_func__(self.ClickDetermineButton))
-			# Shop Button
-
+				
 			# Attr Change Slot
 			attrChangeSlot = self.GetChild("Change_Pet_Slot")
 			attrChangeSlot.SetSelectEmptySlotEvent(ui.__mem_func__(self.SelectEmptyAttrChangeSlot))
@@ -1883,7 +1874,7 @@
 	def __OnClickTabButton(self, stateKey):
 		if stateKey == self.state:
 			return
-		
+			
 		# Update server with current opened window
 		if stateKey == player.PET_WINDOW_INFO:
 			net.SendPetWindowType(player.PET_WINDOW_INFO)
@@ -1920,7 +1911,7 @@
 		self.tabDict[stateKey].Show()
 		self.pageDict[stateKey].Show()
 		
-		if self.interface and self.IsShow():
+		if self.interface:
 			if stateKey == player.PET_WINDOW_INFO:
 				self.interface.SetOnTopWindow(player.ON_TOP_WND_NONE)
 				self.interface.RefreshMarkInventoryBag()
@@ -1939,23 +1930,11 @@
 				self.interface.SetOnTopWindow(player.ON_TOP_WND_PET_PRIMIUM_FEEDSTUFF)
 				self.interface.RefreshMarkInventoryBag()
 		
-			# Clear attr change/revive windows
-			self.__ClearAttrChangeWindow()
-			self.__ClearPetReviveWindow()
+		# Clear attr change/revive windows
+		self.__ClearAttrChangeWindow()
+		self.__ClearPetReviveWindow()
 		
-	def OnTop(self):
-		if self.state == player.PET_WINDOW_INFO:
-			self.interface.SetOnTopWindow(player.ON_TOP_WND_NONE)
-			self.interface.RefreshMarkInventoryBag()
-			
-		elif self.state == player.PET_WINDOW_ATTR_CHANGE:
-			self.interface.SetOnTopWindow(player.ON_TOP_WND_PET_ATTR_CHANGE)
-			self.interface.RefreshMarkInventoryBag()
-			
-		elif self.state == player.PET_WINDOW_PRIMIUM_FEEDSTUFF:
-			self.interface.SetOnTopWindow(player.ON_TOP_WND_PET_PRIMIUM_FEEDSTUFF)
-			self.interface.RefreshMarkInventoryBag()
-			
+	
 	def GetState(self):
 		return self.state
 		
@@ -1975,7 +1954,7 @@
 		
 	def OnPressedSkill3SlotButton(self, slotIndex):
 		self.OnPressedSkillSlotButton(2, slotIndex)
-
+	
 	# Open skill upgrade question dialog, triggered from OnPressedSkillXSlotButton
 	def OnPressedSkillSlotButton(self, slotPos, slotIndex):
 		self.OpenPetSkillUpGradeQuestionDialog(slotPos, slotIndex)
@@ -2047,12 +2026,6 @@
 		
 	def SetSelectItemSlotEvent3(self, slotIndex):
 		self.SetSelectItemSlotEvent(2)
-		
-	def SetSelectItemSlotEvent4(self, slotIndex):
-		self.SetSelectItemSlotEvent(3)
-		
-	def SetSelectItemSlotEvent5(self, slotIndex):
-		self.SetSelectItemSlotEvent(4)
 
 	# Delete skill dialog, triggered from SetSelectItemSlotEventX
 	def SetSelectItemSlotEvent(self, skillSlotIndex):
@@ -2070,6 +2043,7 @@
 		
 		# Skill data
 		(skill_count, pet_skill1, pet_skill_level1, pet_skill_cool1, pet_skill2, pet_skill_level2, pet_skill_cool2, pet_skill3, pet_skill_level3, pet_skill_cool3) = player.GetPetSkill(pet_id)
+			
 		if 0 == skill_count:
 			return
 			
@@ -2085,7 +2059,7 @@
 		elif 2 == skillSlotIndex:
 			if not pet_skill3:
 				return
-
+				
 		attachedSlotType	= mouseModule.mouseController.GetAttachedType()			
 		attachedSlotPos		= mouseModule.mouseController.GetAttachedSlotNumber()
 		attachedItemCount	= mouseModule.mouseController.GetAttachedItemCount()
@@ -2097,22 +2071,21 @@
 		
 		# Return if item is not from inventory
 		if player.SLOT_TYPE_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_SKILL_BOOK_INVENTORY != attachedSlotType and\
+			(player.SLOT_TYPE_SKILL_BOOK_INVENTORY != attachedSlotType and\
 			player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY != attachedSlotType and\
 			player.SLOT_TYPE_STONE_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_GIFT_BOX_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_SWITCH_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_COSTUME_INVENTORY != attachedSlotType:
-			return
+			player.SLOT_TYPE_GIFT_BOX_INVENTORY != attachedSlotType and app.ENABLE_SPECIAL_INVENTORY_SYSTEM):
 
-		# Return if item position is bigger than player.INVENTORY_SLOT_COUNT
-		if attachedSlotPos >= player.INVENTORY_SLOT_COUNT: 
+			return False
+			
+		# Return if item position is bigger than player.ITEM_SLOT_COUNT
+		if attachedSlotPos >= player.ITEM_SLOT_COUNT: 
 			return
 		
 		# Return if it is not a skill delete item
 		if item.ITEM_TYPE_PET != itemType or item.PET_SKILL_DEL_BOOK != itemSubType:
-			return			
-
+			return
+			
 		# Initialize skill delete question dialog if it hasn't been yet
 		if not self.questionSkillDelDlg:
 			self.questionSkillDelDlg = uiCommon.QuestionDialog2()
@@ -2162,7 +2135,7 @@
 		
 	def OverInSkillSlot3(self, slotIndex):
 		self.OverInPetSkillSlot(2, slotIndex)
-
+		
 	# Show pet tooltip
 	def OverInPetSkillSlot(self, slot, index):
 		pet_id = player.GetActivePetItemId()
@@ -2210,6 +2183,7 @@
 		
 		# Skill data
 		(skill_count, pet_skill1, pet_skill_level1, pet_skill_cool1, pet_skill2, pet_skill_level2, pet_skill_cool2, pet_skill3, pet_skill_level3, pet_skill_cool3) = player.GetPetSkill(pet_id)
+			
 		attachedSlotType	= mouseModule.mouseController.GetAttachedType()			
 		attachedSlotPos		= mouseModule.mouseController.GetAttachedSlotNumber()
 		attachedItemCount	= mouseModule.mouseController.GetAttachedItemCount()
@@ -2221,22 +2195,21 @@
 		
 		# Return if item is not from inventory
 		if player.SLOT_TYPE_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_SKILL_BOOK_INVENTORY != attachedSlotType and\
+			(player.SLOT_TYPE_SKILL_BOOK_INVENTORY != attachedSlotType and\
 			player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY != attachedSlotType and\
 			player.SLOT_TYPE_STONE_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_GIFT_BOX_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_SWITCH_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_COSTUME_INVENTORY != attachedSlotType:
-			return
+			player.SLOT_TYPE_GIFT_BOX_INVENTORY != attachedSlotType and app.ENABLE_SPECIAL_INVENTORY_SYSTEM):
 
-		# Return if item position is bigger than player.INVENTORY_SLOT_COUNT
-		if attachedSlotPos >= player.INVENTORY_SLOT_COUNT: 
+			return False
+			
+		# Return if item position is bigger than player.ITEM_SLOT_COUNT
+		if attachedSlotPos >= player.ITEM_SLOT_COUNT: 
 			return
-
+		
 		# Check if item is item.ITEM_TYPE_PET
 		if item.ITEM_TYPE_PET != itemType:
 			return
-
+		
 		# Return if skill delete item is dragged to an empty slot
 		if item.PET_SKILL_DEL_BOOK == itemSubType:
 			self.__OpenPopupDialog(localeInfo.PET_EMPTY_SKILL_SLOT_USE_ITEM)
@@ -2514,6 +2487,7 @@
 		
 		# Skill data
 		(skill_count, pet_skill1, pet_skill_level1, pet_skill_cool1, pet_skill2, pet_skill_level2, pet_skill_cool2, pet_skill3, pet_skill_level3, pet_skill_cool3) = player.GetPetSkill(pet_id)
+		
 		if skill_count:
 			for value in range(skill_count):
 				self.skillSlot[value].SetAlwaysRenderCoverButton(0, False)
@@ -2590,7 +2564,6 @@
 			elif skill.PET_SKILL_USE_TYPE_PASSIVE == pet_skill_use_type:	
 				if self.AffectShower:
 					self.AffectShower.SetPetSkillAffect(3, pet_skill3)		
-					
 
 		self.wndPetMiniInfo.Show()	
 		
@@ -2606,7 +2579,7 @@
 		self.GetChild("HpValue").SetText("")
 		self.SetExperience(0, 0, 0, 0)
 		self.SetLifeTime(100, 100)
-		self.__ClearPetSkillSlot()	#캣 clear
+		self.__ClearPetSkillSlot()	#스킬 clear
 		
 		if self.wndPetFeed:
 			if self.wndPetFeed.IsShow():
@@ -2685,6 +2658,7 @@
 		
 		# Skill data
 		(skill_count, pet_skill1, pet_skill_level1, pet_skill_cool1, pet_skill2, pet_skill_level2, pet_skill_cool2, pet_skill3, pet_skill_level3, pet_skill_cool3) = player.GetPetSkill(pet_id)
+		
 		if pet_skill1:
 		
 			(pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time) = skill.GetPetSkillInfo(pet_skill1)
@@ -2722,6 +2696,8 @@
 				
 			elif skill.PET_SKILL_USE_TYPE_PASSIVE == pet_skill_use_type:
 				self.AffectShower.SetPetSkillAffect(3, pet_skill3)
+				
+				
 	
 	def PetEvolFlashEventCheck(self, pet_level, evol_level, birthday, curEXP, nextEXP, itemEXP, itemMaxEXP):
 		# Return if pet has reached peak evolution
@@ -2841,27 +2817,31 @@
 		if output_max_exp:
 			expPercent = float(output_cur_exp) / float(output_max_exp) * 100
 		
-		## TEXT output is based on hunting experience + item experience.
+		# If WJ_MULTI_TEXTLINE is active, experience points will be
+		# shown seperately based on type.
 		if app.WJ_MULTI_TEXTLINE:
+			
 			if localeInfo.IsARABIC():
 				tooltip_text = str(curPoint)				+ ' :'	+ str(localeInfo.PET_INFO_EXP)			+ '\\n'	\
 							 + str(maxPoint - curPoint)		+ ' :'	+ str(localeInfo.PET_INFO_NEXT_EXP)		+ '\\n'	\
 							 + str(itemExp)					+ ' :'	+ str(localeInfo.PET_INFO_ITEM_EXP)		+ '\\n'	\
-							 + str(itemExpMax - itemExp)	+ ' :'	+ str(localeInfo.PET_INFO_NEXT_ITEM_EXP)
+							 + str(itemExpMax - itemExp)	+ ' :'	+ str(localeInfo.PET_INFO_NEXT_ITEM_EXP)	
 				self.tooltipEXP.SetText(tooltip_text)
 			else:
 				tooltip_text = str(localeInfo.PET_INFO_EXP) + ': '+ str(curPoint) + '\\n'	\
 							 + str(localeInfo.PET_INFO_NEXT_EXP) + ': ' + str(maxPoint - curPoint) + '\\n'	\
 							 + str(localeInfo.PET_INFO_ITEM_EXP) + ': '+ str(itemExp) + '\\n'	\
 							 + str(localeInfo.PET_INFO_NEXT_ITEM_EXP) + ': ' + str(itemExpMax - itemExp)
+							 
 				self.tooltipEXP.SetText(tooltip_text)
 		else:
-			self.tooltipEXP.SetText("%s : %.2f%%" % (localeInfo.TASKBAR_EXP, float(output_cur_exp) / max(1, float(output_max_exp - output_cur_exp)) * 100))
+			self.tooltipEXP.SetText("%s : %.2f%%" % (localeInfo.TASKBAR_EXP, expPercent))
+			
 		
 	def SetLifeTime(self, curPoint, maxPoint):
 		curPoint = min(curPoint, maxPoint)
 		if maxPoint > 0:
-			self.lifeTimeGauge.SetPercentage(curPoint, maxPoint)
+			self.lifeTimeGauge.SetPercentageWithScale(curPoint, maxPoint)
 			
 	def SetItemToolTip(self, tooltipItem):
 		self.tooltipItem = tooltipItem
@@ -2974,7 +2954,7 @@
 				return False
 			
 		return True
-	
+		
 	def PetInfoBindAffectShower(self, affect_shower):
 		self.AffectShower = affect_shower
 		
@@ -3049,28 +3029,23 @@
 		itemSubType = item.GetItemSubType()			
 
 		# Return if item is beging attached from not inventory window
-		if player.SLOT_TYPE_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_SKILL_BOOK_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_STONE_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_GIFT_BOX_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_SWITCH_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_COSTUME_INVENTORY != attachedSlotType:
+		if player.SLOT_TYPE_INVENTORY != attachedSlotType:
 			return False
-
-		# Return if item position is bigger than player.INVENTORY_SLOT_COUNT
-		if attachedSlotPos >= player.INVENTORY_SLOT_COUNT: 
+			
+		# Return if item position is bigger than player.ITEM_SLOT_COUNT
+		if attachedSlotPos >= player.ITEM_SLOT_COUNT: 
 			return False
 
 		if slotIndex == player.PET_WND_SLOT_ATTR_CHANGE:
-
+		
 			# Return if upbringing item is already in place
 			if -1 != self.attrChangeIndex[player.PET_WND_SLOT_ATTR_CHANGE]:
 				return False
+			
 
 			if item.ITEM_TYPE_PET != itemType or itemSubType != item.PET_UPBRINGING:
 				return False
-
+				
 			# Return if there is an active pet
 			activePetId = player.GetActivePetItemId()
 			if activePetId != 0:
@@ -3083,6 +3058,7 @@
 				if attrChangePos != -1:
 					self.attrChangeIndex[player.PET_WND_SLOT_ATTR_CHANGE_ITEM] = attrChangePos
 					self.attrChangeSlot.SetItemSlot(player.PET_WND_SLOT_ATTR_CHANGE_ITEM, player.PET_ATTR_CHANGE_ITEM)
+					#self.attrChangeButton.Show()
 				
 		elif slotIndex == player.PET_WND_SLOT_ATTR_CHANGE_ITEM:
 		
@@ -3139,6 +3115,7 @@
 	def __PetAttrChangeCancel(self):
 		self.questionDialog.Close()
 		
+		
 	def PetAttrChangeResult(self, slotIndex, byType):
 		self.attrChangeButton.Hide()
 
@@ -3196,7 +3173,7 @@
 			sourcePos = player.GetItemSlotIndex(player.PET_ATTR_DETERMINE_ITEM)
 			if sourcePos != -1:
 				net.SendPetAttrDetermine(sourcePos)
-
+		
 	def PetAttrDetermineResult(self, byType):
 		# Display determine result in a popup dialog
 		text = self.typeInfo[byType]
@@ -3267,6 +3244,7 @@
 						item.SelectItem(itemVnum)
 						
 						(skill_count, pet_skill1, pet_skill_level1, pet_skill_cool1, pet_skill2, pet_skill_level2, pet_skill_cool2, pet_skill3, pet_skill_level3, pet_skill_cool3) = player.GetPetSkill(pet_id)
+
 						(pet_level, evol_level, birthday, pet_nick, pet_hp, pet_def, pet_sp) = player.GetPetItem(pet_id)
 						
 						# Item Title
@@ -3276,23 +3254,6 @@
 						itemDesc = item.GetItemDescription()
 						self.tooltipItem.AppendDescription(itemDesc, 26)
 						
-						## Pet Type
-						PET_TYPES = [
-							0,
-							localeInfo.PET_ATTR_DETERMINE_TYPE1_TOOLTIP,
-							localeInfo.PET_ATTR_DETERMINE_TYPE2_TOOLTIP,
-							localeInfo.PET_ATTR_DETERMINE_TYPE3_TOOLTIP,
-							localeInfo.PET_ATTR_DETERMINE_TYPE4_TOOLTIP,
-							localeInfo.PET_ATTR_DETERMINE_TYPE5_TOOLTIP,
-							localeInfo.PET_ATTR_DETERMINE_TYPE6_TOOLTIP,
-							localeInfo.PET_ATTR_DETERMINE_TYPE7_TOOLTIP,
-							localeInfo.PET_ATTR_DETERMINE_TYPE8_TOOLTIP,
-						]
-						
-						pet_type = metinSlot[3]
-						self.tooltipItem.AppendSpace(5)
-						self.tooltipItem.AppendTextLine(PET_TYPES[pet_type], self.tooltipItem.SPECIAL_POSITIVE_COLOR2)
-						
 						# Pet Level/Age
 						self.tooltipItem.AppendSpace(5)
 						birthSec = max(0, metinSlot[0] - birthday)
@@ -3309,7 +3270,8 @@
 						self.tooltipItem.AppendSpace(5)
 						self.tooltipItem.AppendTextLine(localeInfo.PET_TOOLTIP_HP + " +" + str("%0.1f" % pet_hp) + "%", self.tooltipItem.SPECIAL_POSITIVE_COLOR)
 						self.tooltipItem.AppendTextLine(localeInfo.PET_TOOLTIP_DEF + " +" + str("%0.1f" % pet_def) + "%", self.tooltipItem.SPECIAL_POSITIVE_COLOR)
-						self.tooltipItem.AppendTextLine(localeInfo.PET_TOOLTIP_SP + " +" + str("%0.1f" % pet_sp) + "%", self.tooltipItem.SPECIAL_POSITIVE_COLOR)	
+						self.tooltipItem.AppendTextLine(localeInfo.PET_TOOLTIP_SP + " +" + str("%0.1f" % pet_sp) + "%", self.tooltipItem.SPECIAL_POSITIVE_COLOR)				
+
 						# Pet Skills
 						if pet_skill1:
 							self.tooltipItem.AppendSpace(5)
@@ -3323,6 +3285,7 @@
 							self.tooltipItem.AppendSpace(5)
 							(pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time) = skill.GetPetSkillInfo(pet_skill3)
 							self.tooltipItem.AppendTextLine(localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level3) , self.tooltipItem.SPECIAL_POSITIVE_COLOR)
+
 						# Pet Lifetime
 						for i in xrange(item.LIMIT_MAX_NUM):
 							(limitType, limitValue) = item.GetLimit(i)
@@ -3391,27 +3354,26 @@
 
 		# Return if item is beging attached from not inventory window
 		if player.SLOT_TYPE_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_SKILL_BOOK_INVENTORY != attachedSlotType and\
+			(player.SLOT_TYPE_SKILL_BOOK_INVENTORY != attachedSlotType and\
 			player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY != attachedSlotType and\
 			player.SLOT_TYPE_STONE_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_GIFT_BOX_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_SWITCH_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_COSTUME_INVENTORY != attachedSlotType:
-			return False
+			player.SLOT_TYPE_GIFT_BOX_INVENTORY != attachedSlotType and app.ENABLE_SPECIAL_INVENTORY_SYSTEM):
 
-		# Return if item position is bigger than player.INVENTORY_SLOT_COUNT
-		if attachedSlotPos >= player.INVENTORY_SLOT_COUNT: 
 			return False
-
+			
+		# Return if item position is bigger than player.ITEM_SLOT_COUNT
+		if attachedSlotPos >= player.ITEM_SLOT_COUNT: 
+			return False
+			
 		curTime = app.GetGlobalTimeStamp()
 		metinSlot = [player.GetItemMetinSocket(attachedSlotPos, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-
+		
 		# Return if there is an active pet or target pet is still alive
 		if item.ITEM_TYPE_PET == itemType and itemSubType == item.PET_UPBRINGING:
 			activePetId = player.GetActivePetItemId()
 			if activePetId != 0:
 				return False
-
+				
 			if metinSlot[0] > curTime:
 				return False
 		else:
@@ -3464,37 +3426,36 @@
 		
 		# Return if item is beging attached from not inventory window
 		if player.SLOT_TYPE_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_SKILL_BOOK_INVENTORY != attachedSlotType and\
+			(player.SLOT_TYPE_SKILL_BOOK_INVENTORY != attachedSlotType and\
 			player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY != attachedSlotType and\
 			player.SLOT_TYPE_STONE_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_GIFT_BOX_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_SWITCH_INVENTORY != attachedSlotType and\
-			player.SLOT_TYPE_COSTUME_INVENTORY != attachedSlotType:
-			return False
+			player.SLOT_TYPE_GIFT_BOX_INVENTORY != attachedSlotType and app.ENABLE_SPECIAL_INVENTORY_SYSTEM):
 
-		# Return if item position is bigger than player.INVENTORY_SLOT_COUNT
-		if attachedSlotPos >= player.INVENTORY_SLOT_COUNT: 
 			return False
-
+			
+		# Return if item position is bigger than player.ITEM_SLOT_COUNT
+		if attachedSlotPos >= player.ITEM_SLOT_COUNT: 
+			return False
+		
 		# Return if there is no to-be-revived pet in slot
 		if self.petReviveIndex == -1:
 			return False
-
+			
 		# Return if material is not item.PET_PRIMIUM_FEEDSTUFF
-		if itemType != item.ITEM_TYPE_PET or itemSubType != item.PET_PRIMIUM_FEEDSTUFF:
+		if itemType != item.ITEM_TYPE_PET and itemSubType != item.PET_PRIMIUM_FEEDSTUFF:
 			return False
-
+			
 		# Return if the slot is already occupied or item is in another slot
 		if self.petReviveItems[slotIndex] != -1:
 			return False
-
+			
 		if attachedSlotPos in self.petReviveItems:
 			return False
-
+			
 		# Return if enough material has been appended
 		if self.HasEnoughPetReviveMaterial():
 			return False
-
+	
 		self.petReviveItems[slotIndex] = attachedSlotPos
 		self.petReviveItemsCount[slotIndex] = attachedItemCount
 		self.petReviveMaterialSlot.SetItemSlot(slotIndex, attachedItemVNum, attachedItemCount)
@@ -3640,11 +3601,11 @@
 			self.__ClearPetReviveWindow()
 			
 			
-	def ItemMovePremiumFeedWindow(self, slotWindow, attachSlotType, slotIndex):
-		#if player.INVENTORY == slotWindow:
-		#	attachSlotType = player.SLOT_TYPE_INVENTORY
-		#else:
-		#	return False
+	def ItemMovePremiumFeedWindow(self, slotWindow, slotIndex):
+		if player.INVENTORY == slotWindow:
+			attachSlotType = player.SLOT_TYPE_INVENTORY
+		else:
+			return False
 	
 		mouseModule.mouseController.DeattachObject()
 		
@@ -3667,11 +3628,11 @@
 		
 		return False
 	
-	def AttachItemToPetWindow(self, windowType, slotType, slotIndex):
+	def AttachItemToPetWindow(self, windowType, slotIndex):
 		if self.IsShow():
 			if self.GetState() == player.PET_WINDOW_INFO and self.feedIndex != player.FEED_BUTTON_MAX:
 				if not self.CantFeedItem(slotIndex):
-					if self.wndPetFeed.ItemMoveFeedWindow(windowType, slotType, slotIndex):
+					if self.wndPetFeed.ItemMoveFeedWindow(windowType, slotIndex):
 						return True
 					
 			elif self.GetState() == player.PET_WINDOW_ATTR_CHANGE:
@@ -3679,7 +3640,7 @@
 					return True
 				
 			elif  self.GetState() == player.PET_WINDOW_PRIMIUM_FEEDSTUFF:
-				if self.ItemMovePremiumFeedWindow(windowType, slotType, slotIndex):
+				if self.ItemMovePremiumFeedWindow(windowType, slotIndex):
 					return True
 
 		return False
@@ -3688,7 +3649,7 @@
 	def __init__(self):
 		ui.Window.__init__(self, "TOP_MOST")
 
-		textLine = ui.TextLine()
+		textLine = ui.TextLinePet()
 		textLine.SetParent(self)
 		textLine.SetHorizontalAlignCenter()
 		textLine.SetOutline()
diff -ruN client_base/client/client/pack/root/uisafebox.py client_final/client/client/pack/root/uisafebox.py
--- client_base/client/client/pack/root/uisafebox.py	2026-02-13 09:22:34.000000000 +0000
+++ client_final/client/client/pack/root/uisafebox.py	2026-02-20 18:13:16.540072517 +0000
@@ -23,10 +23,10 @@
 	def __LoadDialog(self):
 		try:
 			pyScrLoader = ui.PythonScriptLoader()
-			#if localeInfo.IsEUROPE()and app.GetLocalePath() != "locale/ca"and app.GetLocalePath() != "locale/sg":
-			pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_COMMON_UISCRIPT_PATH + "passworddialog.py")
-			#else:
-				#pyScrLoader.LoadScriptFile(self, "uiscript/passworddialog.py")
+			# if localeInfo.IsEUROPE()and app.GetLocalePath() != "locale/ca"and app.GetLocalePath() != "locale/sg" :
+			pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "passworddialog.py")
+			# else:
+				# pyScrLoader.LoadScriptFile(self, "uiscript/passworddialog.py")
 		except:
 			import exception
 			exception.Abort("PasswordDialog.__LoadDialog.LoadObject")
@@ -64,6 +64,7 @@
 			if player.IsOpenPetHatchingWindow():
 				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.PET_HATCHING_WINDOW_OPEN_CAN_NOT_USE)
 				return False
+
 		self.passwordValue.SetText("")
 		self.passwordValue.SetFocus()
 		self.SetCenterPosition()
@@ -74,7 +75,7 @@
 		self.Hide()
 
 	def OnAccept(self):
-		net.SendCommandPacket(self.sendMessage + self.passwordValue.GetText())
+		net.SendChatPacket(self.sendMessage + self.passwordValue.GetText())
 		self.CloseDialog()
 		return True
 
@@ -180,7 +181,7 @@
 			self.dlgMessage.SetTop()
 			self.dlgMessage.Show()
 			return True
-		net.SendCommandPacket("/safebox_change_password %s %s" % (oldPasswordText, newPasswordText))
+		net.SendChatPacket("/safebox_change_password %s %s" % (oldPasswordText, newPasswordText))
 		self.Close()
 		return True
 
@@ -206,9 +207,6 @@
 		self.isLoaded = 0
 		self.xSafeBoxStart = 0
 		self.ySafeBoxStart = 0
-		if app.ENABLE_EXTEND_MALLBOX:
-			self.timeSendClosePacket = 0
-
 		self.interface = None
 
 		self.__LoadWindow()
@@ -317,8 +315,6 @@
 		if app.ENABLE_GROWTH_PET_SYSTEM:
 			player.SetOpenSafeBox(True)
 
-		player.SetOpenSafeBox(True)
-
 	def __MakePageButton(self, pageCount):
 		self.curPageIndex = 0
 		self.pageButtonList = []
@@ -385,11 +381,11 @@
 			setItemID(i, getItemID(slotIndex), itemCount)
 
 			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				changelookitemvnum = safebox.GetItemChangeLookVnum(slotIndex)
-				if not changelookitemvnum == 0:
-					self.wndItem.SetSlotCoverImage(i, "icon/item/ingame_convert_Mark.tga")
+				changelookvnum = safebox.GetItemTransmutation(slotIndex)
+				if changelookvnum:
+					self.wndItem.DisableCoverButton(i)
 				else:
-					self.wndItem.EnableSlotCoverImage(i, False)
+					self.wndItem.EnableCoverButton(i)
 
 			if app.ENABLE_GROWTH_PET_SYSTEM:
 				self.__SetCoolTimePetItemSlot( slotIndex, getItemID(slotIndex))
@@ -404,11 +400,9 @@
 		self.tooltipItem = tooltip
 
 	def Close(self):
-		net.SendCommandPacket("/safebox_close")
+		net.SendChatPacket("/safebox_close")
 
 	def CommandCloseSafebox(self):
-		player.SetOpenSafeBox(False)
-
 		if self.tooltipItem:
 			self.tooltipItem.HideToolTip()
 
@@ -416,44 +410,12 @@
 			if self.interface:
 				self.interface.SetOnTopWindow(player.ON_TOP_WND_NONE)
 				self.interface.RefreshMarkInventoryBag()
-
-		if app.ENABLE_GROWTH_PET_SYSTEM:
-			player.SetOpenSafeBox(False)
-
 		self.dlgPickMoney.Close()
 		self.dlgChangePassword.Close()
 		self.Hide()
 
-	if app.ENABLE_GROWTH_PET_SYSTEM:
-		def __SetCoolTimePetItemSlot(self, slotNumber, itemVnum):
-			if 0 == itemVnum:
-				return
-				
-			item.SelectItem(itemVnum)
-			itemSubType = item.GetItemSubType()
-				
-			if itemSubType not in [item.PET_UPBRINGING, item.PET_BAG]:
-				return
-						
-			if itemSubType == item.PET_BAG:
-				id = safebox.GetItemMetinSocket(slotNumber, 2)
-				if id == 0:
-					return
-					
-			(limitType, limitValue) = item.GetLimit(0)
-
-			if itemSubType == item.PET_UPBRINGING:
-				limitValue = safebox.GetItemMetinSocket(slotNumber, 1)
-
-			if limitType in [item.LIMIT_REAL_TIME, item.LIMIT_REAL_TIME_START_FIRST_USE]:
-
-				sock_time   = safebox.GetItemMetinSocket(slotNumber, 0)
-				remain_time = max( 0, sock_time - app.GetGlobalTimeStamp() )
-
-				if slotNumber >= safebox.SAFEBOX_PAGE_SIZE:
-					slotNumber -= (self.curPageIndex * safebox.SAFEBOX_PAGE_SIZE)
-
-				self.wndItem.SetSlotCoolTimeInverse(slotNumber, limitValue, limitValue - remain_time)
+		if app.ENABLE_GROWTH_PET_SYSTEM:
+			player.SetOpenSafeBox(False)
 
 	## Slot Event
 	def SelectEmptySlot(self, selectedSlotPos):
@@ -486,14 +448,29 @@
 		if mouseModule.mouseController.isAttached():
 			attachedSlotType = mouseModule.mouseController.GetAttachedType()
 
-			if player.SLOT_TYPE_INVENTORY == attachedSlotType:
-				if player.ITEM_MONEY == mouseModule.mouseController.GetAttachedItemIndex():
-					net.SendSafeboxSaveMoneyPacket(mouseModule.mouseController.GetAttachedItemCount())
-					snd.PlaySound("sound/ui/money.wav")
-				else:
-					attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
-					#net.SendSafeboxCheckinPacket(attachedSlotPos, selectedSlotPos)
-					#snd.PlaySound("sound/ui/drop.wav")
+			if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+				if player.SLOT_TYPE_INVENTORY == attachedSlotType or\
+					player.SLOT_TYPE_SKILL_BOOK_INVENTORY == attachedSlotType or\
+					player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == attachedSlotType or\
+					player.SLOT_TYPE_STONE_INVENTORY == attachedSlotType or\
+					player.SLOT_TYPE_GIFT_BOX_INVENTORY == attachedSlotType:
+
+					if player.ITEM_MONEY == mouseModule.mouseController.GetAttachedItemIndex():
+						net.SendSafeboxSaveMoneyPacket(mouseModule.mouseController.GetAttachedItemCount())
+						snd.PlaySound("sound/ui/money.wav")
+					else:
+						attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
+						#net.SendSafeboxCheckinPacket(attachedSlotPos, selectedSlotPos)
+						#snd.PlaySound("sound/ui/drop.wav")
+			else:
+				if player.SLOT_TYPE_INVENTORY == attachedSlotType:
+					if player.ITEM_MONEY == mouseModule.mouseController.GetAttachedItemIndex():
+						net.SendSafeboxSaveMoneyPacket(mouseModule.mouseController.GetAttachedItemCount())
+						snd.PlaySound("sound/ui/money.wav")
+					else:
+						attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
+						#net.SendSafeboxCheckinPacket(attachedSlotPos, selectedSlotPos)
+						#snd.PlaySound("sound/ui/drop.wav")
 
 			mouseModule.mouseController.DeattachObject()
 		else:
@@ -510,13 +487,7 @@
 				snd.PlaySound("sound/ui/pick.wav")
 
 	def UseItemSlot(self, slotIndex):
-		if app.ENABLE_SAFEBOX_IMPROVING:
-			mouseModule.mouseController.DeattachObject()
-			if app.ENABLE_EXTEND_MALLBOX:
-				slotIndex = self.__LocalPosToGlobalPos(slotIndex)
-			net.SendSafeboxCheckoutPacket(slotIndex, player.INVENTORY, 0)
-		else:
-			mouseModule.mouseController.DeattachObject()
+		mouseModule.mouseController.DeattachObject()
 
 	def __ShowToolTip(self, slotIndex):
 		if self.tooltipItem:
@@ -532,6 +503,37 @@
 		if self.tooltipItem:
 			self.tooltipItem.HideToolTip()
 
+	if app.ENABLE_GROWTH_PET_SYSTEM:
+		def __SetCoolTimePetItemSlot(self, slotNumber, itemVnum):
+			if 0 == itemVnum:
+				return
+				
+			item.SelectItem(itemVnum)
+			itemSubType = item.GetItemSubType()
+				
+			if itemSubType not in [item.PET_UPBRINGING, item.PET_BAG]:
+				return
+						
+			if itemSubType == item.PET_BAG:
+				id = safebox.GetItemMetinSocket(slotNumber, 2)
+				if id == 0:
+					return
+					
+			(limitType, limitValue) = item.GetLimit(0)
+
+			if itemSubType == item.PET_UPBRINGING:
+				limitValue = safebox.GetItemMetinSocket(slotNumber, 1)
+							
+			if limitType in [item.LIMIT_REAL_TIME, item.LIMIT_REAL_TIME_START_FIRST_USE]:
+										
+				sock_time   = safebox.GetItemMetinSocket(slotNumber, 0)
+				remain_time = max( 0, sock_time - app.GetGlobalTimeStamp() )
+
+				if slotNumber >= safebox.SAFEBOX_PAGE_SIZE:
+					slotNumber -= (self.curPageIndex * safebox.SAFEBOX_PAGE_SIZE)
+
+				self.wndItem.SetSlotCoolTimeInverse(slotNumber, limitValue, limitValue - remain_time)
+
 	def OnPickMoney(self, money):
 		mouseModule.mouseController.AttachMoney(self, player.SLOT_TYPE_SAFEBOX, money)
 
@@ -546,13 +548,8 @@
 		USE_SAFEBOX_LIMIT_RANGE = 1000
 
 		(x, y, z) = player.GetMainCharacterPosition()
-		if app.ENABLE_EXTEND_MALLBOX:
-			if self.timeSendClosePacket < app.GetTime() and (abs(x - self.xSafeBoxStart) > USE_SAFEBOX_LIMIT_RANGE or abs(y - self.ySafeBoxStart) > USE_SAFEBOX_LIMIT_RANGE):
-				self.timeSendClosePacket = app.GetTime() + 10
-				self.Close()
-		else:
-			if abs(x - self.xSafeBoxStart) > USE_SAFEBOX_LIMIT_RANGE or abs(y - self.ySafeBoxStart) > USE_SAFEBOX_LIMIT_RANGE:
-				self.Close()
+		if abs(x - self.xSafeBoxStart) > USE_SAFEBOX_LIMIT_RANGE or abs(y - self.ySafeBoxStart) > USE_SAFEBOX_LIMIT_RANGE:
+			self.Close()
 
 	if app.WJ_ENABLE_TRADABLE_ICON:
 		def CantCheckInItem(self, slotIndex):
@@ -577,9 +574,6 @@
 class MallWindow(ui.ScriptWindow):
 	BOX_WIDTH = 176
 
-	if app.ENABLE_EXTEND_MALLBOX:
-		PAGE_TEXT = ("I", "II", "III", "IV", "V")
-
 	def __init__(self):
 		ui.ScriptWindow.__init__(self)
 		self.tooltipItem = None
@@ -589,8 +583,6 @@
 		self.isLoaded = 0
 		self.xSafeBoxStart = 0
 		self.ySafeBoxStart = 0
-		if app.ENABLE_EXTEND_MALLBOX:
-			self.timeSendClosePacket = 0
 
 		self.__LoadWindow()
 
@@ -653,119 +645,54 @@
 		if app.ENABLE_GROWTH_PET_SYSTEM:
 			player.SetOpenMall(True)
 
-		player.SetOpenMall(True)
-
 	def SetTableSize(self, size):
 		pageCount = max(1, size / safebox.SAFEBOX_SLOT_Y_COUNT)
-		if app.ENABLE_EXTEND_MALLBOX:
-			pageCount = min(5, pageCount)
-		else:
-			pageCount = min(3, pageCount)
+		pageCount = min(3, pageCount)
 		size = safebox.SAFEBOX_SLOT_Y_COUNT
 
-		if app.ENABLE_EXTEND_MALLBOX:
-			self.__MakePageButton(pageCount)
-
 		self.wndItem.ArrangeSlot(0, safebox.SAFEBOX_SLOT_X_COUNT, size, 32, 32, 0, 0)
 		self.wndItem.RefreshSlot()
 		self.wndItem.SetSlotBaseImage("d:/ymir work/ui/public/Slot_Base.sub", 1.0, 1.0, 1.0, 1.0)
-		if app.ENABLE_EXTEND_MALLBOX:
-			self.wndBoard.SetSize(self.BOX_WIDTH, 102 + 32 * size)
-			self.SetSize(self.BOX_WIDTH, 105 + 32 * size)
-		else:
-			self.wndBoard.SetSize(self.BOX_WIDTH, 82 + 32 * size)
-			self.SetSize(self.BOX_WIDTH, 85 + 32 * size)
+		self.wndBoard.SetSize(self.BOX_WIDTH, 82 + 32*size)
+		self.SetSize(self.BOX_WIDTH, 85 + 32*size)
 		self.UpdateRect()
 
-	if app.ENABLE_EXTEND_MALLBOX:
-		def __MakePageButton(self, pageCount):
-			self.curPageIndex = 0
-			self.pageButtonList = []
-
-			pos = -int(float(pageCount - 1) / 2 * 32)
-			for i in xrange(pageCount):
-				text = self.PAGE_TEXT[i]
-				button = ui.RadioButton()
-				button.SetParent(self)
-				button.SetUpVisual("d:/ymir work/ui/game/windows/tab_button_small_01.sub")
-				button.SetOverVisual("d:/ymir work/ui/game/windows/tab_button_small_02.sub")
-				button.SetDownVisual("d:/ymir work/ui/game/windows/tab_button_small_03.sub")
-				button.SetWindowHorizontalAlignCenter()
-				button.SetWindowVerticalAlignBottom()
-				button.SetPosition(pos, 65)
-				button.SetText(text)
-				button.SetEvent(lambda arg = i: self.SelectPage(arg))
-				button.Show()
-				self.pageButtonList.append(button)
-
-				pos += 32
-
-			self.pageButtonList[0].Down()
-
-		def SelectPage(self, index):
-			self.curPageIndex = index
-
-			for btn in self.pageButtonList:
-				btn.SetUp()
-
-			self.pageButtonList[index].Down()
-			self.RefreshMall()
+	def RefreshMall(self):
+		getItemID=safebox.GetMallItemID
+		getItemCount=safebox.GetMallItemCount
+		setItemID=self.wndItem.SetItemSlot
 
-		def __LocalPosToGlobalPos(self, local):
-			return self.curPageIndex * safebox.SAFEBOX_PAGE_SIZE + local
+		for i in xrange(safebox.GetMallSize()):
+			itemID = getItemID(i)
+			itemCount = getItemCount(i)
+			if itemCount <= 1:
+				itemCount = 0
+			setItemID(i, itemID, itemCount)
 
-	def RefreshMall(self):
-		getItemID = safebox.GetMallItemID
-		getItemCount = safebox.GetMallItemCount
-		setItemID = self.wndItem.SetItemSlot
-
-		if app.ENABLE_EXTEND_MALLBOX:
-			for i in xrange(safebox.SAFEBOX_PAGE_SIZE):
-				slotIndex = self.__LocalPosToGlobalPos(i)
-				itemCount = getItemCount(slotIndex)
-				if itemCount <= 1:
-					itemCount = 0
-				setItemID(i, getItemID(slotIndex), itemCount)
-
-				if app.ENABLE_CHANGE_LOOK_SYSTEM:
-					changelookitemvnum = safebox.GetMallItemChangeLookVnum(slotIndex)
-					if not changelookitemvnum == 0:
-						self.wndItem.SetSlotCoverImage(i, "icon/item/ingame_convert_Mark.tga")
-					else:
-						self.wndItem.EnableSlotCoverImage(i, False)
-		else:
-			for i in xrange(safebox.GetMallSize()):
-				itemID = getItemID(i)
-				itemCount = getItemCount(i)
-				if itemCount <= 1:
-					itemCount = 0
-				setItemID(i, itemID, itemCount)
-
-				if app.ENABLE_CHANGE_LOOK_SYSTEM:
-					changelookitemvnum = safebox.GetMallItemChangeLookVnum(i)
-					if not changelookitemvnum == 0:
-						self.wndItem.SetSlotCoverImage(i, "icon/item/ingame_convert_Mark.tga")
-					else:
-						self.wndItem.EnableSlotCoverImage(i, False)
+			if app.ENABLE_CHANGE_LOOK_SYSTEM:
+				changelookvnum = safebox.GetMallItemTransmutation(i)
+				if changelookvnum:
+					self.wndItem.DisableCoverButton(i)
+				else:
+					self.wndItem.EnableCoverButton(i)
 
-			self.wndItem.RefreshSlot()
+		self.wndItem.RefreshSlot()
 
 	def SetItemToolTip(self, tooltip):
 		self.tooltipItem = tooltip
 
 	def Close(self):
-		net.SendCommandPacket("/mall_close")
+		net.SendChatPacket("/mall_close")
 
 	def CommandCloseMall(self):
-		player.SetOpenMall(False)
-
 		if self.tooltipItem:
 			self.tooltipItem.HideToolTip()
-		if app.ENABLE_GROWTH_PET_SYSTEM:
-			player.SetOpenMall(False)
 
 		self.Hide()
 
+		if app.ENABLE_GROWTH_PET_SYSTEM:
+			player.SetOpenMall(False)
+
 	## Slot Event
 	def SelectEmptySlot(self, selectedSlotPos):
 		if mouseModule.mouseController.isAttached():
@@ -773,9 +700,6 @@
 			mouseModule.mouseController.DeattachObject()
 
 	def SelectItemSlot(self, selectedSlotPos):
-		if app.ENABLE_EXTEND_MALLBOX:
-			selectedSlotPos = self.__LocalPosToGlobalPos(selectedSlotPos)
-
 		if mouseModule.mouseController.isAttached():
 			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.MALL_CANNOT_INSERT)
 			mouseModule.mouseController.DeattachObject()
@@ -786,22 +710,13 @@
 			snd.PlaySound("sound/ui/pick.wav")
 
 	def UseItemSlot(self, slotIndex):
-		if app.ENABLE_SAFEBOX_IMPROVING:
-			mouseModule.mouseController.DeattachObject()
-			if app.ENABLE_EXTEND_MALLBOX:
-				slotIndex = self.__LocalPosToGlobalPos(slotIndex)
-			net.SendMallCheckoutPacket(slotIndex, player.INVENTORY, 0)
-		else:
-			mouseModule.mouseController.DeattachObject()
+		mouseModule.mouseController.DeattachObject()
 
 	def __ShowToolTip(self, slotIndex):
 		if self.tooltipItem:
 			self.tooltipItem.SetMallItem(slotIndex)
 
 	def OverInItem(self, slotIndex):
-		if app.ENABLE_EXTEND_MALLBOX:
-			slotIndex = self.__LocalPosToGlobalPos(slotIndex)
-
 		self.__ShowToolTip(slotIndex)
 
 	def OverOutItem(self):
@@ -817,13 +732,8 @@
 		USE_SAFEBOX_LIMIT_RANGE = 1000
 
 		(x, y, z) = player.GetMainCharacterPosition()
-		if app.ENABLE_EXTEND_MALLBOX:
-			if self.timeSendClosePacket < app.GetTime() and (abs(x - self.xSafeBoxStart) > USE_SAFEBOX_LIMIT_RANGE or abs(y - self.ySafeBoxStart) > USE_SAFEBOX_LIMIT_RANGE):
-				self.timeSendClosePacket = app.GetTime() + 10
-				self.Close()
-		else:
-			if abs(x - self.xSafeBoxStart) > USE_SAFEBOX_LIMIT_RANGE or abs(y - self.ySafeBoxStart) > USE_SAFEBOX_LIMIT_RANGE:
-				self.Close()
+		if abs(x - self.xSafeBoxStart) > USE_SAFEBOX_LIMIT_RANGE or abs(y - self.ySafeBoxStart) > USE_SAFEBOX_LIMIT_RANGE:
+			self.Close()
 
 if __name__ == "__main__":
 	import app
diff -ruN client_base/client/client/pack/root/uiscriptlocale.py client_final/client/client/pack/root/uiscriptlocale.py
--- client_base/client/client/pack/root/uiscriptlocale.py	2026-02-13 09:22:34.000000000 +0000
+++ client_final/client/client/pack/root/uiscriptlocale.py	2026-02-20 18:13:16.592293929 +0000
@@ -4,134 +4,34 @@
 AUTOBAN_QUIZ_REFRESH = "REFRESH"
 AUTOBAN_QUIZ_REST_TIME = "REST_TIME"
 
+OPTION_SHADOW = "SHADOW"
+
 CODEPAGE = str(app.GetDefaultCodePage())
 
 #CUBE_TITLE = "Cube Window"
 
-if app.ENABLE_LOCALE_CLIENT:
-	alsoExportToCharset = "windows-1250"
-	localeDict = {}
-
-	def LoadLocaleFile(srcFileName):
-		global localeDict
-
-		localeDict["CUBE_INFO_TITLE"] = "Recipe"
-		localeDict["CUBE_REQUIRE_MATERIAL"] = "Requirements"
-		localeDict["CUBE_REQUIRE_MATERIAL_OR"] = "or"
-
-		try:
-			lines = open(srcFileName, "r").readlines()
-		except IOError:
-			import dbg
-			dbg.LogBox("LoadUIScriptLocaleError(%(srcFileName)s)" % locals())
-			app.Abort()
-
-		for line in lines:
-			tokens = line[:-1].split("\t")
-
-			if len(tokens) >= 2:
-				localeDict[tokens[0]] = tokens[1]
-			else:
-				print(len(tokens), lines.index(line), line)
-
-		globals().update(localeDict)
-
-	def ReloadLocaleFile():
-		global localeDict
-		localeDict.clear()
-
-		global CODEPAGE
-		CODEPAGE = str(app.GetDefaultCodePage())
-
-		if "HONGKONG" == app.GetLocaleServiceName():
-			name = "locale/hongkong"
-		elif "JAPAN" == app.GetLocaleServiceName():
-			name = "locale/japan"
-		elif "TAIWAN" == app.GetLocaleServiceName():
-			name = "locale/taiwan"
-		elif "NEWCIBN" == app.GetLocaleServiceName():
-			name = "locale/newcibn"
-		elif "EUROPE" == app.GetLocaleServiceName():
-			name = app.GetLocalePath()
-		else:
-			name = "locale/ymir"
-
-		global LOCALE_UISCRIPT_PATH
-		LOCALE_UISCRIPT_PATH = "%s/ui/" % (name)
+def LoadLocaleFile(srcFileName, localeDict):
+	localeDict["CUBE_INFO_TITLE"] = "Recipe"
+	localeDict["CUBE_REQUIRE_MATERIAL"] = "Requirements"
+	localeDict["CUBE_REQUIRE_MATERIAL_OR"] = "or"
+
+	try:
+		lines = open(srcFileName, "r").readlines()
+	except IOError:
+		import dbg
+		dbg.LogBox("LoadUIScriptLocaleError(%(srcFileName)s)" % locals())
+		app.Abort()
 
-		global LOGIN_PATH, EMPIRE_PATH, GUILD_PATH, SELECT_PATH, WINDOWS_PATH, MAPNAME_PATH
-		LOGIN_PATH = "locale/common/ui/login/"
-		EMPIRE_PATH = "%s/ui/empire/" % (name)
-		GUILD_PATH = "locale/common/ui/guild/"
-		SELECT_PATH = "%s/ui/select/" % (name)
-		WINDOWS_PATH = "%s/ui/windows/" % (name)
-		MAPNAME_PATH = "%s/ui/mapname/" % (name)
-
-		global JOBDESC_WARRIOR_PATH, JOBDESC_ASSASSIN_PATH, JOBDESC_SURA_PATH, JOBDESC_SHAMAN_PATH, JOBDESC_WOLFMAN_PATH
-		JOBDESC_WARRIOR_PATH = "%s/jobdesc_warrior.txt" % (name)
-		JOBDESC_ASSASSIN_PATH = "%s/jobdesc_assassin.txt" % (name)
-		JOBDESC_SURA_PATH = "%s/jobdesc_sura.txt" % (name)
-		JOBDESC_SHAMAN_PATH = "%s/jobdesc_shaman.txt" % (name)
-		JOBDESC_WOLFMAN_PATH = "%s/jobdesc_wolfman.txt" % (name)
-
-		global EMPIREDESC_A, EMPIREDESC_B, EMPIREDESC_C
-		EMPIREDESC_A = "%s/empiredesc_a.txt" % (name)
-		EMPIREDESC_B = "%s/empiredesc_b.txt" % (name)
-		EMPIREDESC_C = "%s/empiredesc_c.txt" % (name)
-
-		global LOCALE_INTERFACE_FILE_NAME, NEW_LOCALE_INTERFACE_FILE_NAME
-		LOCALE_INTERFACE_FILE_NAME = "%s/locale_interface.txt" % (name)
-		NEW_LOCALE_INTERFACE_FILE_NAME = "%s/new_locale_interface.txt" % (name)
-
-		if app.ENABLE_LOADING_TIP:
-			global LOADING_TIP_LIST
-			LOADING_TIP_LIST = "%s/loading_tip_vnum.txt" % (name)
-
-		if app.ENABLE_MINI_GAME_RUMI:
-			global MINIGAME_RUMI_DESC
-			MINIGAME_RUMI_DESC = "%s/mini_game_okey_desc.txt" % (name)
-
-		if app.ENABLE_MINI_GAME_YUTNORI:
-			global YUTNORI_EVENT_DESC
-			YUTNORI_EVENT_DESC = "%s/yutnori_event_desc.txt" % (name)
-
-		if app.ENABLE_MINI_GAME_CATCH_KING:
-			global MINIGAME_CATCH_KING_DESC, MINIGAME_CATCH_KING_SIMPLE_DESC
-			MINIGAME_CATCH_KING_DESC = "%s/catchking_event_desc.txt" % (name)
-			MINIGAME_CATCH_KING_SIMPLE_DESC = "%s/catchking_event_simple_desc.txt" % (name)
-
-		if app.ENABLE_SNOWFLAKE_STICK_EVENT:
-			global SNOWFLAKE_STICK_EVENT_DESC_FILE
-			SNOWFLAKE_STICK_EVENT_DESC_FILE = "%s/snowflake_stick_event_desc.txt" % (name)
+	for line in lines:
+		tokens = line[:-1].split("\t")
 
-		if app.ENABLE_GROWTH_PET_SYSTEM:
-			PET_PRIMIUM_FEEDSTUFF_DESC = "%s/pet_primium_feedstuff_desc.txt" % (name)
-
-		LoadLocaleFile(LOCALE_INTERFACE_FILE_NAME)
-		LoadLocaleFile(NEW_LOCALE_INTERFACE_FILE_NAME)
-else:
-	def LoadLocaleFile(srcFileName, localeDict):
-		localeDict["CUBE_INFO_TITLE"] = "Recipe"
-		localeDict["CUBE_REQUIRE_MATERIAL"] = "Requirements"
-		localeDict["CUBE_REQUIRE_MATERIAL_OR"] = "or"
-
-		try:
-			lines = open(srcFileName, "r").readlines()
-		except IOError:
-			import dbg
-			dbg.LogBox("LoadUIScriptLocaleError(%(srcFileName)s)" % locals())
-			app.Abort()
-
-		for line in lines:
-			tokens = line[:-1].split("\t")
-
-			if len(tokens) >= 2:
-				localeDict[tokens[0]] = tokens[1]
-			else:
-				print(len(tokens), lines.index(line), line)
+		if len(tokens) >= 2:
+			localeDict[tokens[0]] = tokens[1]
+		else:
+			print len(tokens), lines.index(line), line
 
 if "locale/ymir" == app.GetLocalePath():
-	LOCALE_COMMON_UISCRIPT_PATH = "locale/ymir_ui/"
+	LOCALE_UISCRIPT_PATH = "locale/ymir_ui/"
 
 	WINDOWS_PATH = "d:/ymir work/ui/game/949_windows/"
 	SELECT_PATH = "d:/ymir work/ui/intro/949_select/"
@@ -151,7 +51,7 @@
 	EMPIREDESC_C = "locale/ymir/desc_empire_c.txt"
 
 	LOCALE_INTERFACE_FILE_NAME = "locale/ymir/locale_interface.txt"
-	NEW_LOCALE_INTERFACE_FILE_NAME = "locale/ymir/new_locale_interface.txt"
+	NEW_LOCALE_INTERFACE_FILE_NAME = "%s/new_locale_interface.txt" % (name)
 else:
 	if "HONGKONG" == app.GetLocaleServiceName():
 		name = "locale/hongkong"
@@ -166,9 +66,7 @@
 	else:
 		name = "locale/ymir"
 
-	LOCALE_COMMON_UISCRIPT_PATH = "locale/common/ui/"
-	LOCALE_UISCRIPT_PATH = "%s/ui/" % (name)
-
+	LOCALE_UISCRIPT_PATH = "locale/common/ui/"
 	LOGIN_PATH = "locale/common/ui/login/"
 	EMPIRE_PATH = "%s/ui/empire/" % (name)
 	GUILD_PATH = "locale/common/ui/guild/"
@@ -193,25 +91,15 @@
 		LOADING_TIP_LIST = "locale/common/loading_tip_list.txt"
 		LOADING_TIP_VNUM = "%s/loading_tip_vnum.txt" % (name)
 
-	if app.ENABLE_MINI_GAME_RUMI:
+	if app.ENABLE_MINI_GAME_OKEY:
 		MINIGAME_RUMI_DESC = "%s/mini_game_okey_desc.txt" % (name)
 
-	if app.ENABLE_MINI_GAME_YUTNORI:
-		YUTNORI_EVENT_DESC = "%s/yutnori_event_desc.txt" % (name)
-
 	if app.ENABLE_MINI_GAME_CATCH_KING:
 		MINIGAME_CATCH_KING_DESC = "%s/catchking_event_desc.txt" % (name)
 		MINIGAME_CATCH_KING_SIMPLE_DESC = "%s/catchking_event_simple_desc.txt" % (name)
 
-	if app.ENABLE_SNOWFLAKE_STICK_EVENT:
-		SNOWFLAKE_STICK_EVENT_DESC_FILE = "%s/snowflake_stick_event_desc.txt" % (name)
-
 	if app.ENABLE_GROWTH_PET_SYSTEM:
 		PET_PRIMIUM_FEEDSTUFF_DESC = "%s/pet_primium_feedstuff_desc.txt" % (name)
 
-if app.ENABLE_LOCALE_CLIENT:
-	LoadLocaleFile(LOCALE_INTERFACE_FILE_NAME)
-	LoadLocaleFile(NEW_LOCALE_INTERFACE_FILE_NAME)
-else:
-	LoadLocaleFile(LOCALE_INTERFACE_FILE_NAME, locals())
-	LoadLocaleFile(NEW_LOCALE_INTERFACE_FILE_NAME, locals())
+LoadLocaleFile(LOCALE_INTERFACE_FILE_NAME, locals())
+LoadLocaleFile(NEW_LOCALE_INTERFACE_FILE_NAME, locals())
diff -ruN client_base/client/client/pack/root/uispecialinventory.py client_final/client/client/pack/root/uispecialinventory.py
--- client_base/client/client/pack/root/uispecialinventory.py	1970-01-01 00:00:00.000000000 +0000
+++ client_final/client/client/pack/root/uispecialinventory.py	2026-02-20 18:13:16.643152659 +0000
@@ -0,0 +1,1239 @@
+import ui
+import player
+import mouseModule
+import net
+import app
+import snd
+import item
+import player
+import chat
+import grp
+import uiScriptLocale
+import uiRefine
+import uiAttachMetin
+import uiPickMoney
+import uiCommon
+import uiPrivateShopBuilder
+import localeInfo
+import constInfo
+import osfInfo
+import ime
+import wndMgr
+
+if app.ENABLE_CHEQUE_SYSTEM:
+	import uiToolTip
+	import uiPickETC
+
+ITEM_MALL_BUTTON_ENABLE = True
+ITEM_FLAG_APPLICABLE = 1 << 14
+
+class SpecialInventoryWindow(ui.ScriptWindow):
+	USE_TYPE_TUPLE = (
+		"USE_CLEAN_SOCKET",
+		"USE_CHANGE_ATTRIBUTE",
+		"USE_ADD_ATTRIBUTE",
+		"USE_ADD_ATTRIBUTE2",
+		"USE_ADD_ACCESSORY_SOCKET",
+		"USE_PUT_INTO_ACCESSORY_SOCKET",
+		"USE_PUT_INTO_BELT_SOCKET",
+		"USE_PUT_INTO_RING_SOCKET",
+		"USE_CHANGE_COSTUME_ATTR",
+		"USE_RESET_COSTUME_ATTR"
+	)
+
+	questionDialog = None
+	tooltipItem = None
+	dlgPickMoney = None
+	if app.ENABLE_CHEQUE_SYSTEM:
+		dlgPickETC = None
+
+	sellingSlotNumber = -1
+	isLoaded = 0
+
+	interface = None
+
+	inventoryPageIndex = 0
+
+	if app.ENABLE_GROWTH_PET_SYSTEM:
+		petHatchingWindow	= None
+		petFeedWindow		= None
+		petNameChangeWindow = None
+
+	def __init__(self):
+		ui.ScriptWindow.__init__(self)
+
+		self.__LoadWindow()
+
+	def __del__(self):
+		ui.ScriptWindow.__del__(self)
+
+	def Show(self, category = 0):
+		self.__LoadWindow()
+
+		ui.ScriptWindow.Show(self)
+
+		self.RefreshItemSlot()
+
+	def BindInterfaceClass(self, interface):
+		from _weakref import proxy
+		self.interface = proxy(interface)
+
+	def __LoadWindow(self):
+		if self.isLoaded == 1:
+			return
+
+		self.isLoaded = 1
+
+		try:
+			pyScrLoader = ui.PythonScriptLoader()
+			pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "SpecialInventoryWindow.py")
+		except:
+			import exception
+			exception.Abort("SpecialInventoryWindow.LoadWindow.LoadObject")
+
+		try:
+			wndItem = self.GetChild("ItemSlot")
+			self.GetChild("TitleBar").SetCloseEvent(ui.__mem_func__(self.Close))
+			self.titleName = self.GetChild("TitleName")
+			if app.ENABLE_SORT_INVENTORY:
+				self.sortInventoryButton = self.GetChild2("SortInventoryButton")
+
+			self.SkillBookButton = self.GetChild("SkillBookButton")
+			self.UpgradeItemsButton = self.GetChild("UpgradeItemsButton")
+			self.stoneButton = self.GetChild("StoneButton")
+			self.GiftBoxButton = self.GetChild("GiftBoxButton")
+
+			self.inventoryTab = []
+			self.inventoryTab.append(self.GetChild("Inventory_Tab_01"))
+			self.inventoryTab.append(self.GetChild("Inventory_Tab_02"))
+			self.inventoryTab.append(self.GetChild("Inventory_Tab_03"))
+			self.inventoryTab.append(self.GetChild("Inventory_Tab_04"))
+			self.inventoryTab.append(self.GetChild("Inventory_Tab_05"))
+
+			self.dlgQuestion = uiCommon.QuestionDialog2()
+			self.dlgQuestion.Close()
+
+			if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
+				self.listHighlightedSlot = []
+		except:
+			import exception
+			exception.Abort("SpecialInventoryWindow.LoadWindow.BindObject")
+
+		## Item
+		wndItem.SetSelectEmptySlotEvent(ui.__mem_func__(self.SelectEmptySlot))
+		wndItem.SetSelectItemSlotEvent(ui.__mem_func__(self.SelectItemSlot))
+		wndItem.SetUnselectItemSlotEvent(ui.__mem_func__(self.UseItemSlot))
+		wndItem.SetUseSlotEvent(ui.__mem_func__(self.UseItemSlot))
+		wndItem.SetOverInItemEvent(ui.__mem_func__(self.OverInItem))
+		wndItem.SetOverOutItemEvent(ui.__mem_func__(self.OverOutItem))
+
+		self.SkillBookButton.SetEvent(lambda arg=0: self.SetInventoryType(arg))
+		self.UpgradeItemsButton.SetEvent(lambda arg=1: self.SetInventoryType(arg))
+		self.stoneButton.SetEvent(lambda arg=2: self.SetInventoryType(arg))
+		self.GiftBoxButton.SetEvent(lambda arg=3: self.SetInventoryType(arg))
+		self.SkillBookButton.Down()
+
+		## PickMoneyDialog
+		dlgPickMoney = uiPickMoney.PickMoneyDialog()
+		dlgPickMoney.LoadDialog()
+		dlgPickMoney.Hide()
+
+		## PickETCDialog
+		if app.ENABLE_CHEQUE_SYSTEM:
+			dlgPickETC = uiPickETC.PickETCDialog()
+			dlgPickETC.LoadDialog()
+			dlgPickETC.Hide()
+			self.dlgPickETC = dlgPickETC
+
+		## AttachMetinDialog
+		self.attachMetinDialog = uiAttachMetin.AttachMetinDialog()
+		self.attachMetinDialog.Hide()
+
+		for inven_index in range(player.SPECIAL_INVENTORY_PAGE_COUNT):
+			self.inventoryTab[inven_index].SetEvent(lambda arg=inven_index: self.SetInventoryPage(arg))
+		self.inventoryTab[0].Down()
+
+		self.wndItem = wndItem
+		self.dlgPickMoney = dlgPickMoney
+
+		if app.ENABLE_SORT_INVENTORY:
+			if self.sortInventoryButton:
+				self.sortInventoryButton.SetEvent(ui.__mem_func__(self.SortInventoryButton))
+		
+		if app.ENABLE_GROWTH_PET_SYSTEM:
+			self.PetItemQuestionDlg = uiCommon.QuestionDialog()
+			self.PetItemQuestionDlg.Close()
+
+			self.PetSkillDelDlg = uiCommon.QuestionDialog2()
+			self.PetSkillDelDlg.Close()
+			self.PetSkillAllDelBookIndex = -1
+
+		## Refresh
+		self.SetInventoryType(0)
+		self.SetInventoryPage(0)
+
+		self.RefreshItemSlot()
+
+	def Destroy(self):
+		self.ClearDictionary()
+
+		self.dlgPickMoney.Destroy()
+		self.dlgPickMoney = 0
+
+		if app.ENABLE_CHEQUE_SYSTEM:
+			self.dlgPickETC.Destroy()
+			self.dlgPickETC = 0
+
+		self.attachMetinDialog.Destroy()
+		self.attachMetinDialog = 0
+
+		self.tooltipItem = None
+		self.wndItem = 0
+		self.dlgPickMoney = 0
+		self.questionDialog = None
+		self.interface = None
+
+		if app.ENABLE_GROWTH_PET_SYSTEM:
+			if self.petHatchingWindow:
+				self.petHatchingWindow = None
+				
+			if self.petFeedWindow:
+				self.petFeedWindow = None
+				
+			if self.petNameChangeWindow:
+				self.petNameChangeWindow = None 
+
+		self.inventoryTab = []
+		self.inventoryPageIndex = 0
+
+	def Hide(self):
+		if constInfo.GET_ITEM_QUESTION_DIALOG_STATUS():
+			self.OnCloseQuestionDialog()
+			return
+
+		if None != self.tooltipItem:
+			self.tooltipItem.HideToolTip()
+
+		if self.dlgPickMoney:
+			self.dlgPickMoney.Close()
+
+		if app.ENABLE_CHEQUE_SYSTEM:
+			if self.dlgPickETC:
+				self.dlgPickETC.Close()
+
+		wndMgr.Hide(self.hWnd)
+
+	def Close(self):
+		self.Hide()
+
+	def SetInventoryPage(self, page):
+		self.inventoryPageIndex = page
+
+		for index in range(len(self.inventoryTab)):
+			if index == page:
+				continue
+			self.inventoryTab[index].SetUp()
+
+		self.RefreshBagSlotWindow()
+
+	def SetInventoryType(self, type):
+		self.inventoryType = int(type)
+
+		if type == 0:
+			self.SkillBookButton.Down()
+			self.UpgradeItemsButton.SetUp()
+			self.stoneButton.SetUp()
+			self.GiftBoxButton.SetUp()
+			self.titleName.SetText(localeInfo.SPECIAL_INVENTORY_SKILL_BOOK)
+
+		elif type == 2:
+			self.stoneButton.Down()
+			self.GiftBoxButton.SetUp()
+			self.UpgradeItemsButton.SetUp()
+			self.SkillBookButton.SetUp()
+			self.titleName.SetText(localeInfo.SPECIAL_INVENTORY_STONE)
+
+		elif type == 3:
+			self.GiftBoxButton.Down()
+			self.stoneButton.SetUp()
+			self.UpgradeItemsButton.SetUp()
+			self.SkillBookButton.SetUp()
+			self.titleName.SetText(localeInfo.SPECIAL_INVENTORY_CHEST)
+
+		else:
+			self.UpgradeItemsButton.Down()
+			self.SkillBookButton.SetUp()
+			self.stoneButton.SetUp()
+			self.GiftBoxButton.SetUp()
+			self.titleName.SetText(localeInfo.SPECIAL_INVENTORY_MATERIAL)
+
+		self.RefreshBagSlotWindow()
+
+	if app.ENABLE_SORT_INVENTORY:
+		def SortInventoryButton(self):
+			self.questionDialog = uiCommon.QuestionDialog()
+			self.questionDialog.SetText(localeInfo.SPECIAL_INVENTORY_DO_YOU_SORT)
+			self.questionDialog.SetAcceptEvent(ui.__mem_func__(self.OnSortInventoryItems))
+			self.questionDialog.SetCancelEvent(ui.__mem_func__(self.OnCloseQuestionDialog))
+			self.questionDialog.Open()
+
+			constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(1)
+
+		def OnSortInventoryItems(self):
+			if None == self.questionDialog:
+				return
+
+			net.SendChatPacket("/sort_special_inventory %d" % self.inventoryType)
+			snd.PlaySound("sound/ui/pickup_item_in_inventory.wav")
+
+			self.OnCloseQuestionDialog()
+
+	def OnPickItem(self, count):
+		if app.ENABLE_CHEQUE_SYSTEM:
+			itemSlotIndex = self.dlgPickETC.itemGlobalSlotIndex
+		else:
+			itemSlotIndex = self.dlgPickMoney.itemGlobalSlotIndex
+
+		selectedItemVNum = player.GetItemIndex(itemSlotIndex)
+
+		if self.inventoryType == 0:
+			mouseModule.mouseController.AttachObject(self, player.SLOT_TYPE_SKILL_BOOK_INVENTORY, itemSlotIndex, selectedItemVNum, count)
+		elif self.inventoryType == 1:
+			mouseModule.mouseController.AttachObject(self, player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY, itemSlotIndex, selectedItemVNum, count)
+		elif self.inventoryType == 2:
+			mouseModule.mouseController.AttachObject(self, player.SLOT_TYPE_STONE_INVENTORY, itemSlotIndex, selectedItemVNum, count)
+		elif self.inventoryType == 3:
+			mouseModule.mouseController.AttachObject(self, player.SLOT_TYPE_GIFT_BOX_INVENTORY, itemSlotIndex, selectedItemVNum, count)
+
+	def __InventoryLocalSlotPosToGlobalSlotPos(self, local):
+		if self.inventoryType == 0:
+			return self.inventoryPageIndex * player.SPECIAL_INVENTORY_PAGE_SIZE + local + item.SKILL_BOOK_INVENTORY_SLOT_START
+		elif self.inventoryType == 1:
+			return self.inventoryPageIndex * player.SPECIAL_INVENTORY_PAGE_SIZE + local + item.UPGRADE_ITEMS_INVENTORY_SLOT_START
+		elif self.inventoryType == 2:
+			return self.inventoryPageIndex * player.SPECIAL_INVENTORY_PAGE_SIZE + local + item.STONE_INVENTORY_SLOT_START
+		elif self.inventoryType == 3:
+			return self.inventoryPageIndex * player.SPECIAL_INVENTORY_PAGE_SIZE + local + item.GIFT_BOX_INVENTORY_SLOT_START
+
+	def RefreshBagSlotWindow(self):
+		if not self.wndItem:
+			return
+
+		getItemVNum = player.GetItemIndex
+		getItemCount = player.GetItemCount
+		setItemVNum = self.wndItem.SetItemSlot
+
+		for i in xrange(self.wndItem.GetSlotCount()):
+			self.wndItem.DeactivateSlot(i)
+
+		if app.WJ_ENABLE_TRADABLE_ICON:
+			if self.interface:
+				onTopWindow = self.interface.GetOnTopWindow()
+
+		for i in xrange(player.SPECIAL_INVENTORY_PAGE_SIZE):
+			slotNumber = self.__InventoryLocalSlotPosToGlobalSlotPos(i)
+
+			itemCount = getItemCount(slotNumber)
+			if 0 == itemCount:
+				self.wndItem.ClearSlot(i)
+				continue
+			elif 1 == itemCount:
+				itemCount = 0
+
+			itemVnum = getItemVNum(slotNumber)
+			setItemVNum(i, itemVnum, itemCount)
+
+			if app.ENABLE_GROWTH_PET_SYSTEM:
+				if constInfo.IS_PET_ITEM(itemVnum):
+					self.__ActivePetHighlightSlot(slotNumber)
+					self.__SetCoolTimePetItemSlot(slotNumber, itemVnum)
+
+			if app.WJ_ENABLE_TRADABLE_ICON:
+				if itemVnum and self.interface and onTopWindow:
+					if self.interface.MarkUnusableInvenSlotOnTopWnd(onTopWindow, slotNumber):
+						self.wndItem.SetUnusableSlotOnTopWnd(i)
+					else:
+						self.wndItem.SetUsableSlotOnTopWnd(i)
+				else:
+					self.wndItem.SetUsableSlotOnTopWnd(i)
+
+		if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
+			self.__HighlightSlot_Refresh()
+
+		self.wndItem.RefreshSlot()
+
+	def RefreshItemSlot(self):
+		self.RefreshBagSlotWindow()
+
+	def SetItemToolTip(self, tooltipItem):
+		self.tooltipItem = tooltipItem
+
+	def SellItem(self):
+		if self.sellingSlotitemIndex == player.GetItemIndex(self.sellingSlotNumber):
+			if self.sellingSlotitemCount == player.GetItemCount(self.sellingSlotNumber):
+				net.SendShopSellPacketNew(self.sellingSlotNumber, self.questionDialog.count, player.INVENTORY)
+				snd.PlaySound("sound/ui/money.wav")
+
+		self.OnCloseQuestionDialog()
+
+	def OnDetachMetinFromItem(self):
+		if None == self.questionDialog:
+			return
+
+		self.__SendUseItemToItemPacket(self.questionDialog.sourcePos, self.questionDialog.targetPos)
+		self.OnCloseQuestionDialog()
+
+	def OnCloseQuestionDialog(self):
+		if not self.questionDialog:
+			return
+
+		self.questionDialog.Close()
+		self.questionDialog = None
+		constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(0)
+
+	def SelectEmptySlot(self, selectedSlotPos):
+		if constInfo.GET_ITEM_QUESTION_DIALOG_STATUS() == 1:
+			return
+
+		selectedSlotPos = self.__InventoryLocalSlotPosToGlobalSlotPos(selectedSlotPos)
+
+		if mouseModule.mouseController.isAttached():
+			attachedSlotType = mouseModule.mouseController.GetAttachedType()
+			attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
+			attachedItemCount = mouseModule.mouseController.GetAttachedItemCount()
+			attachedItemIndex = mouseModule.mouseController.GetAttachedItemIndex()
+
+			if player.SLOT_TYPE_INVENTORY == attachedSlotType or\
+				player.SLOT_TYPE_SKILL_BOOK_INVENTORY == attachedSlotType or\
+				player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == attachedSlotType or\
+				player.SLOT_TYPE_STONE_INVENTORY == attachedSlotType or\
+				player.SLOT_TYPE_GIFT_BOX_INVENTORY == attachedSlotType:
+
+				itemCount = player.GetItemCount(attachedSlotPos)
+				attachedCount = mouseModule.mouseController.GetAttachedItemCount()
+
+				self.__SendMoveItemPacket(attachedSlotPos, selectedSlotPos, attachedCount)
+
+				if item.IsRefineScroll(attachedItemIndex):
+					self.interface.SetUseItemMode(False)
+
+			elif player.SLOT_TYPE_PRIVATE_SHOP == attachedSlotType:
+				mouseModule.mouseController.RunCallBack("INVENTORY")
+
+			elif player.SLOT_TYPE_SHOP == attachedSlotType:
+				net.SendShopBuyPacket(attachedSlotPos)
+
+			elif player.SLOT_TYPE_SAFEBOX == attachedSlotType:
+				if player.ITEM_MONEY == attachedItemIndex:
+					net.SendSafeboxWithdrawMoneyPacket(mouseModule.mouseController.GetAttachedItemCount())
+					snd.PlaySound("sound/ui/money.wav")
+				else:
+					net.SendSafeboxCheckoutPacket(attachedSlotPos, selectedSlotPos)
+
+			elif player.SLOT_TYPE_MALL == attachedSlotType:
+				net.SendMallCheckoutPacket(attachedSlotPos, selectedSlotPos)
+
+			mouseModule.mouseController.DeattachObject()
+
+	def SelectItemSlot(self, itemSlotIndex):
+		if constInfo.GET_ITEM_QUESTION_DIALOG_STATUS() == 1:
+			return
+
+		itemSlotIndex = self.__InventoryLocalSlotPosToGlobalSlotPos(itemSlotIndex)
+
+		if mouseModule.mouseController.isAttached():
+			attachedSlotType = mouseModule.mouseController.GetAttachedType()
+			attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
+			attachedItemVID = mouseModule.mouseController.GetAttachedItemIndex()
+
+			if player.SLOT_TYPE_INVENTORY == attachedSlotType or\
+				player.SLOT_TYPE_SKILL_BOOK_INVENTORY == attachedSlotType or\
+				player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == attachedSlotType or\
+				player.SLOT_TYPE_STONE_INVENTORY == attachedSlotType or\
+				player.SLOT_TYPE_GIFT_BOX_INVENTORY == attachedSlotType:
+
+				self.__DropSrcItemToDestItemInInventory(attachedItemVID, attachedSlotPos, itemSlotIndex)
+
+			mouseModule.mouseController.DeattachObject()
+		else:
+			curCursorNum = app.GetCursor()
+
+			if app.SELL == curCursorNum:
+				self.__SellItem(itemSlotIndex)
+
+			elif app.BUY == curCursorNum:
+				chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.SHOP_BUY_INFO)
+
+			elif app.IsPressed(app.DIK_LALT):
+				link = player.GetItemLink(itemSlotIndex)
+				ime.PasteString(link)
+
+			elif app.IsPressed(app.DIK_LSHIFT):
+				itemCount = player.GetItemCount(itemSlotIndex)
+
+				if itemCount > 1:
+					if app.ENABLE_CHEQUE_SYSTEM:
+						self.dlgPickETC.SetTitleName(localeInfo.PICK_ITEM_TITLE)
+						self.dlgPickETC.SetAcceptEvent(ui.__mem_func__(self.OnPickItem))
+						self.dlgPickETC.Open(itemCount)
+						self.dlgPickETC.itemGlobalSlotIndex = itemSlotIndex
+					else:
+						self.dlgPickMoney.SetTitleName(localeInfo.PICK_ITEM_TITLE)
+						self.dlgPickMoney.SetAcceptEvent(ui.__mem_func__(self.OnPickItem))
+						self.dlgPickMoney.Open(itemCount)
+						self.dlgPickMoney.itemGlobalSlotIndex = itemSlotIndex
+
+			elif app.IsPressed(app.DIK_LCONTROL):
+				itemIndex = player.GetItemIndex(itemSlotIndex)
+
+				if True == item.CanAddToQuickSlotItem(itemIndex):
+					player.RequestAddToEmptyLocalQuickSlot(player.SLOT_TYPE_INVENTORY, itemSlotIndex)
+				else:
+					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.QUICKSLOT_REGISTER_DISABLE_ITEM)
+			else:
+				selectedItemVNum = player.GetItemIndex(itemSlotIndex)
+				itemCount = player.GetItemCount(itemSlotIndex)
+
+				if app.ENABLE_GROWTH_PET_SYSTEM:
+					if self.__CanAttachGrowthPetItem(selectedItemVNum, itemSlotIndex):
+						mouseModule.mouseController.AttachObject(self, player.SLOT_TYPE_INVENTORY, itemSlotIndex, selectedItemVNum, itemCount)
+				else:
+					mouseModule.mouseController.AttachObject(self, player.SLOT_TYPE_INVENTORY, itemSlotIndex, selectedItemVNum, itemCount)
+
+				if self.__IsUsableItemToItem(selectedItemVNum, itemSlotIndex):
+					self.interface.SetUseItemMode(True)
+				else:
+					self.interface.SetUseItemMode(False)
+
+				snd.PlaySound("sound/ui/pick.wav")
+
+	def __DropSrcItemToDestItemInInventory(self, srcItemVID, srcItemSlotPos, dstItemSlotPos):
+		if srcItemSlotPos == dstItemSlotPos:
+			return
+
+		if item.IsRefineScroll(srcItemVID):
+			self.RefineItem(srcItemSlotPos, dstItemSlotPos)
+			self.interface.SetUseItemMode(False)
+
+		elif item.IsMetin(srcItemVID):
+			self.AttachMetinToItem(srcItemSlotPos, dstItemSlotPos)
+
+		elif item.IsDetachScroll(srcItemVID):
+			self.DetachMetinFromItem(srcItemSlotPos, dstItemSlotPos)
+
+		elif item.IsKey(srcItemVID):
+			self.__SendUseItemToItemPacket(srcItemSlotPos, dstItemSlotPos)
+
+		elif (player.GetItemFlags(srcItemSlotPos) & ITEM_FLAG_APPLICABLE) == ITEM_FLAG_APPLICABLE:
+			self.__SendUseItemToItemPacket(srcItemSlotPos, dstItemSlotPos)
+
+		elif item.GetUseType(srcItemVID) in self.USE_TYPE_TUPLE:
+			self.__SendUseItemToItemPacket(srcItemSlotPos, dstItemSlotPos)
+
+		else:
+			if app.ENABLE_GROWTH_PET_SYSTEM:
+				if self.__IsPetItem(srcItemVID):
+					if self.__SendUsePetItemToItemPacket(srcItemVID, srcItemSlotPos, dstItemSlotPos):
+						return
+
+			self.__SendMoveItemPacket(srcItemSlotPos, dstItemSlotPos, 0)
+
+	def __SellItem(self, itemSlotPos):
+		self.sellingSlotNumber = itemSlotPos
+		itemIndex = player.GetItemIndex(itemSlotPos)
+		itemCount = player.GetItemCount(itemSlotPos)
+
+		self.sellingSlotitemIndex = itemIndex
+		self.sellingSlotitemCount = itemCount
+
+		item.SelectItem(itemIndex)
+		## 안티 플레그 검사 빠져서 추가
+		## 20140220
+		if item.IsAntiFlag(item.ANTIFLAG_SELL):
+			popup = uiCommon.PopupDialog()
+			popup.SetText(localeInfo.SHOP_CANNOT_SELL_ITEM)
+			popup.SetAcceptEvent(self.__OnClosePopupDialog)
+			popup.Open()
+			self.popup = popup
+			return
+
+		itemPrice = item.GetISellItemPrice()
+
+		if item.Is1GoldItem():
+			itemPrice = itemCount / itemPrice / 5
+		else:
+			itemPrice = itemPrice * itemCount / 5
+
+		item.GetItemName(itemIndex)
+		itemName = item.GetItemName()
+
+		self.questionDialog = uiCommon.QuestionDialog()
+		self.questionDialog.SetText(localeInfo.DO_YOU_SELL_ITEM(itemName, itemCount, itemPrice))
+		self.questionDialog.SetAcceptEvent(ui.__mem_func__(self.SellItem))
+		self.questionDialog.SetCancelEvent(ui.__mem_func__(self.OnCloseQuestionDialog))
+		self.questionDialog.Open()
+		self.questionDialog.count = itemCount
+
+		constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(1)
+
+	def __OnClosePopupDialog(self):
+		self.pop = None
+
+	def DetachMetinFromItem(self, scrollSlotPos, targetSlotPos):
+		scrollIndex = player.GetItemIndex(scrollSlotPos)
+		targetIndex = player.GetItemIndex(targetSlotPos)
+
+		if not player.CanDetach(scrollIndex, targetSlotPos):
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.REFINE_FAILURE_METIN_INSEPARABLE_ITEM)
+			return
+
+		self.questionDialog = uiCommon.QuestionDialog()
+		self.questionDialog.SetText(localeInfo.REFINE_DO_YOU_SEPARATE_METIN)
+		self.questionDialog.SetAcceptEvent(ui.__mem_func__(self.OnDetachMetinFromItem))
+		self.questionDialog.SetCancelEvent(ui.__mem_func__(self.OnCloseQuestionDialog))
+		self.questionDialog.Open()
+		self.questionDialog.sourcePos = scrollSlotPos
+		self.questionDialog.targetPos = targetSlotPos
+
+	def AttachMetinToItem(self, metinSlotPos, targetSlotPos):
+		metinIndex = player.GetItemIndex(metinSlotPos)
+		targetIndex = player.GetItemIndex(targetSlotPos)
+
+		item.SelectItem(metinIndex)
+		itemName = item.GetItemName()
+
+		result = player.CanAttachMetin(metinIndex, targetSlotPos)
+
+		if player.ATTACH_METIN_NOT_MATCHABLE_ITEM == result:
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.REFINE_FAILURE_CAN_NOT_ATTACH % (itemName))
+
+		if player.ATTACH_METIN_NO_MATCHABLE_SOCKET == result:
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.REFINE_FAILURE_NO_SOCKET(itemName))
+
+		elif player.ATTACH_METIN_NOT_EXIST_GOLD_SOCKET == result:
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.REFINE_FAILURE_NO_GOLD_SOCKET(itemName))
+
+		elif player.ATTACH_METIN_CANT_ATTACH_TO_EQUIPMENT == result:
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.REFINE_FAILURE_EQUIP_ITEM)
+
+		if player.ATTACH_METIN_OK != result:
+			return
+
+		self.attachMetinDialog.Open(metinSlotPos, targetSlotPos)
+
+	def OverOutItem(self):
+		self.wndItem.SetUsableItem(False)
+		if None != self.tooltipItem:
+			self.tooltipItem.HideToolTip()
+
+	def OverInItem(self, overSlotPos):
+		if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
+			overInvenSlotPos = self.__InventoryLocalSlotPosToGlobalSlotPos(overSlotPos)
+			self.wndItem.SetUsableItem(False)
+
+			getItemVNum = player.GetItemIndex
+			itemVnum = getItemVNum(overInvenSlotPos)
+			self.DelHighlightSlot(overInvenSlotPos)
+
+			if mouseModule.mouseController.isAttached():
+				attachedItemType = mouseModule.mouseController.GetAttachedType()
+
+				if player.SLOT_TYPE_INVENTORY == attachedItemType or\
+					player.SLOT_TYPE_SKILL_BOOK_INVENTORY == attachedItemType or\
+					player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == attachedItemType or\
+					player.SLOT_TYPE_STONE_INVENTORY == attachedItemType or\
+					player.SLOT_TYPE_GIFT_BOX_INVENTORY == attachedItemType:
+
+					attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
+					attachedItemVNum = mouseModule.mouseController.GetAttachedItemIndex()
+
+					if self.__CanUseSrcItemToDstItem(attachedItemVNum, attachedSlotPos, overInvenSlotPos):
+						self.wndItem.SetUsableItem(True)
+						self.ShowToolTip(overInvenSlotPos)
+						return
+
+			self.ShowToolTip(overInvenSlotPos)
+		else:
+			overSlotPos = self.__InventoryLocalSlotPosToGlobalSlotPos(overSlotPos)
+			self.wndItem.SetUsableItem(False)
+
+			if mouseModule.mouseController.isAttached():
+				attachedItemType = mouseModule.mouseController.GetAttachedType()
+
+				if player.SLOT_TYPE_INVENTORY == attachedItemType or\
+					player.SLOT_TYPE_SKILL_BOOK_INVENTORY == attachedItemType or\
+					player.SLOT_TYPE_UPGRADE_ITEMS_INVENTORY == attachedItemType or\
+					player.SLOT_TYPE_STONE_INVENTORY == attachedItemType or\
+					player.SLOT_TYPE_GIFT_BOX_INVENTORY == attachedItemType:
+
+					attachedSlotPos = mouseModule.mouseController.GetAttachedSlotNumber()
+					attachedItemVNum = mouseModule.mouseController.GetAttachedItemIndex()
+
+					if self.__CanUseSrcItemToDstItem(attachedItemVNum, attachedSlotPos, overSlotPos):
+						self.wndItem.SetUsableItem(True)
+						self.ShowToolTip(overSlotPos)
+						return
+
+			self.ShowToolTip(overSlotPos)
+
+	def __IsUsableItemToItem(self, srcItemVNum, srcSlotPos):
+		if item.IsRefineScroll(srcItemVNum):
+			return True
+		elif item.IsMetin(srcItemVNum):
+			return True
+		elif item.IsDetachScroll(srcItemVNum):
+			return True
+		elif item.IsKey(srcItemVNum):
+			return True
+		elif (player.GetItemFlags(srcSlotPos) & ITEM_FLAG_APPLICABLE) == ITEM_FLAG_APPLICABLE:
+			return True
+		else:
+			if app.ENABLE_GROWTH_PET_SYSTEM:
+				if self.__IsUsablePetItem(srcItemVNum):
+					return True
+
+			if item.GetUseType(srcItemVNum) in self.USE_TYPE_TUPLE:
+				return True
+
+		return False
+
+	def __CanUseSrcItemToDstItem(self, srcItemVNum, srcSlotPos, dstSlotPos):
+		if srcSlotPos == dstSlotPos:
+			return False
+
+		if item.IsRefineScroll(srcItemVNum):
+			if player.REFINE_OK == player.CanRefine(srcItemVNum, dstSlotPos):
+				return True
+		elif item.IsMetin(srcItemVNum):
+			if player.ATTACH_METIN_OK == player.CanAttachMetin(srcItemVNum, dstSlotPos):
+				return True
+		elif item.IsDetachScroll(srcItemVNum):
+			if player.DETACH_METIN_OK == player.CanDetach(srcItemVNum, dstSlotPos):
+				return True
+		elif item.IsKey(srcItemVNum):
+			if player.CanUnlock(srcItemVNum, dstSlotPos):
+				return True
+		elif (player.GetItemFlags(srcSlotPos) & ITEM_FLAG_APPLICABLE) == ITEM_FLAG_APPLICABLE:
+			return True
+		else:
+			if app.ENABLE_GROWTH_PET_SYSTEM:
+				if self.__CanUseSrcPetItemToDstPetItem(srcItemVNum, srcSlotPos, dstSlotPos):
+					return True
+
+			useType=item.GetUseType(srcItemVNum)
+
+			if "USE_CLEAN_SOCKET" == useType:
+				if self.__CanCleanBrokenMetinStone(dstSlotPos):
+					return True
+			elif "USE_CHANGE_ATTRIBUTE" == useType:
+				if self.__CanChangeItemAttrList(dstSlotPos):
+					return True
+			elif "USE_ADD_ATTRIBUTE" == useType:
+				if self.__CanAddItemAttr(dstSlotPos):
+					return True
+			elif "USE_ADD_ATTRIBUTE2" == useType:
+				if self.__CanAddItemAttr(dstSlotPos):
+					return True
+			elif "USE_ADD_ACCESSORY_SOCKET" == useType:
+				if self.__CanAddAccessorySocket(dstSlotPos):
+					return True
+			elif "USE_PUT_INTO_ACCESSORY_SOCKET" == useType:
+				if self.__CanPutAccessorySocket(dstSlotPos, srcItemVNum):
+					return True;
+			elif "USE_PUT_INTO_BELT_SOCKET" == useType:
+				dstItemVNum = player.GetItemIndex(dstSlotPos)
+
+				item.SelectItem(dstItemVNum)
+
+				if item.ITEM_TYPE_BELT == item.GetItemType():
+					return True
+			elif "USE_CHANGE_COSTUME_ATTR" == useType:
+				if self.__CanChangeCostumeAttrList(dstSlotPos):
+					return True
+			elif "USE_RESET_COSTUME_ATTR" == useType:
+				if self.__CanResetCostumeAttr(dstSlotPos):
+					return True
+			else:
+				pass
+
+		return False
+
+	def ShowToolTip(self, slotIndex):
+		if None != self.tooltipItem:
+			self.tooltipItem.SetInventoryItem(slotIndex)
+
+	def OnTop(self):
+		if None != self.tooltipItem:
+			self.tooltipItem.SetTop()
+
+	def OnPressEscapeKey(self):
+		self.Close()
+		return True
+
+	def UseItemSlot(self, slotIndex):
+		curCursorNum = app.GetCursor()
+		if app.SELL == curCursorNum:
+			return
+
+		if constInfo.GET_ITEM_QUESTION_DIALOG_STATUS():
+			return
+
+		slotIndex = self.__InventoryLocalSlotPosToGlobalSlotPos(slotIndex)
+
+		self.__UseItem(slotIndex)
+		mouseModule.mouseController.DeattachObject()
+		self.OverOutItem()
+
+	def __UseItem(self, slotIndex):
+		ItemVNum = player.GetItemIndex(slotIndex)
+		item.SelectItem(ItemVNum)
+
+		if app.WJ_ENABLE_TRADABLE_ICON:
+			if self.interface.AttachInvenItemToOtherWindowSlot(slotIndex):
+				return
+
+		if item.IsFlag(item.ITEM_FLAG_CONFIRM_WHEN_USE):
+			self.questionDialog = uiCommon.QuestionDialog()
+			self.questionDialog.SetText(localeInfo.INVENTORY_REALLY_USE_ITEM2)
+
+			self.questionDialog.SetAcceptEvent(ui.__mem_func__(self.__UseItemQuestionDialog_OnAccept))
+			self.questionDialog.SetCancelEvent(ui.__mem_func__(self.__UseItemQuestionDialog_OnCancel))
+			self.questionDialog.Open()
+			self.questionDialog.slotIndex = slotIndex
+
+			constInfo.SET_ITEM_QUESTION_DIALOG_STATUS(1)
+		else:
+			self.__SendUseItemPacket(slotIndex)
+
+	def __UseItemQuestionDialog_OnCancel(self):
+		self.OnCloseQuestionDialog()
+
+	def __UseItemQuestionDialog_OnAccept(self):
+		self.__SendUseItemPacket(self.questionDialog.slotIndex)
+		self.OnCloseQuestionDialog()
+
+	def __SendUseItemToItemPacket(self, srcSlotPos, dstSlotPos):
+		if uiPrivateShopBuilder.IsBuildingPrivateShop():
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.USE_ITEM_FAILURE_PRIVATE_SHOP)
+			return
+
+		if self.interface.IsShowDlgQuestionWindow():
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.DONT_USE_ITEM_WHEN_SHOW_CONFIRM)
+			return
+
+		net.SendItemUseToItemPacket(srcSlotPos, dstSlotPos)
+
+	def __SendUseItemPacket(self, slotPos):
+		if uiPrivateShopBuilder.IsBuildingPrivateShop():
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.USE_ITEM_FAILURE_PRIVATE_SHOP)
+			return
+
+		if self.interface.IsShowDlgQuestionWindow():
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.DONT_USE_ITEM_WHEN_SHOW_CONFIRM)
+			return
+
+		net.SendItemUsePacket(slotPos)
+
+	def __SendMoveItemPacket(self, srcSlotPos, dstSlotPos, srcItemCount):
+		if uiPrivateShopBuilder.IsBuildingPrivateShop():
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.MOVE_ITEM_FAILURE_PRIVATE_SHOP)
+			return
+
+		if self.interface.IsShowDlgQuestionWindow():
+			chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.DONT_USE_ITEM_WHEN_SHOW_CONFIRM)
+			return
+
+		net.SendItemMovePacket(srcSlotPos, dstSlotPos, srcItemCount)
+
+	if app.WJ_ENABLE_PICKUP_ITEM_EFFECT:
+		def HighlightSlot(self, slot):
+			if not slot in self.listHighlightedSlot:
+				self.listHighlightedSlot.append(slot)
+
+		def DelHighlightSlot(self, inventorylocalslot):
+			if inventorylocalslot in self.listHighlightedSlot:
+				if inventorylocalslot >= player.SPECIAL_INVENTORY_PAGE_SIZE:
+					self.wndItem.DeactivateSlot(inventorylocalslot - (self.inventoryPageIndex * player.SPECIAL_INVENTORY_PAGE_SIZE))
+				else:
+					self.wndItem.DeactivateSlot(inventorylocalslot)
+
+				self.listHighlightedSlot.remove(inventorylocalslot)
+
+				self.RefreshBagSlotWindow() # hot fix
+
+		def __HighlightSlot_Refresh(self):
+			for i in xrange(self.wndItem.GetSlotCount()):
+				slotNumber = self.__InventoryLocalSlotPosToGlobalSlotPos(i)
+				if slotNumber in self.listHighlightedSlot:
+					self.wndItem.ActivateSlot(i)
+
+		def __HighlightSlot_Clear(self):
+			for i in xrange(self.wndItem.GetSlotCount()):
+				slotNumber = self.__InventoryLocalSlotPosToGlobalSlotPos(i)
+				if slotNumber in self.listHighlightedSlot:
+					self.wndItem.DeactivateSlot(i)
+					self.listHighlightedSlot.remove(slotNumber)
+
+	def IsDlgQuestionShow(self):
+		if self.dlgQuestion.IsShow():
+			return True
+		else:
+			return False
+
+	def SetUseItemMode(self, bUse):
+		self.wndItem.SetUseMode(bUse)
+
+	def CancelDlgQuestion(self):
+		self.__Cancel()
+
+	def GetInventoryPageIndex(self):
+		return self.inventoryPageIndex
+
+	def GetInventoryType(self):
+		return self.inventoryType
+
+	if app.ENABLE_GROWTH_PET_SYSTEM:
+		def __UseItemPet(self, slotIndex):
+			itemSubType = item.GetItemSubType()		
+			if item.PET_EGG == itemSubType:
+				self.petHatchingWindow.HatchingWindowOpen(player.INVENTORY, slotIndex)
+				
+			elif item.PET_UPBRINGING == itemSubType:
+				if self.__CanUseGrowthPet(slotIndex):
+					self.__SendUseItemPacket(slotIndex)
+						
+			elif item.PET_BAG == itemSubType:
+				if self.__CanUsePetBagItem(slotIndex):
+					if self.questionDialog:
+						self.questionDialog.Close()
+						
+					self.questionDialog = uiCommon.QuestionDialog()
+					self.questionDialog.SetText(localeInfo.INVENTORY_REALLY_USE_PET_BAG_TAKE_OUT)
+					self.questionDialog.SetAcceptEvent(ui.__mem_func__(self.__UseItemQuestionDialog_OnAccept))
+					self.questionDialog.SetCancelEvent(ui.__mem_func__(self.__UseItemQuestionDialog_OnCancel))
+					self.questionDialog.slotIndex = slotIndex
+					self.questionDialog.Open()
+
+			if item.PET_SKILL_ALL_DEL_BOOK == itemSubType:
+				pet_id = player.GetActivePetItemId()
+				if 0 == pet_id:
+					return
+				(skill_count, pet_skill1, pet_skill_level1, pet_skill_cool1, pet_skill2, pet_skill_level2, pet_skill_cool2, pet_skill3, pet_skill_level3, pet_skill_cool3) = player.GetPetSkill(pet_id)
+				if 0 == pet_skill1 and 0 == pet_skill2 and 0 == pet_skill3:
+					popup = uiCommon.PopupDialog()
+					popup.SetText(localeInfo.PET_EMPTY_SKILL_SLOT_USE_ITEM)
+					popup.SetAcceptEvent(self.__OnClosePopupDialog)
+					popup.Open()
+					self.pop = popup
+					return
+			
+				self.PetSkillAllDelBookIndex = slotIndex
+				self.SetCantMouseEventSlot( self.PetSkillAllDelBookIndex )
+				
+				self.PetSkillDelDlg.SetAcceptEvent(ui.__mem_func__(self.__PetSkillDeleteQuestionDialogAccept))
+				self.PetSkillDelDlg.SetCancelEvent(ui.__mem_func__(self.__PetSkillDeleteQuestionDialogCancel))
+				
+				self.PetSkillDelDlg.SetText1( localeInfo.PET_SKILL_DELETE_QUESTION_DLG_MSG1 )
+				self.PetSkillDelDlg.SetText2( localeInfo.PET_SKILL_DELETE_QUESTION_DLG_MSG2 )
+				(w,h) = self.PetSkillDelDlg.GetTextSize1()
+				self.PetSkillDelDlg.SetWidth(w+100)
+				self.PetSkillDelDlg.Open()
+				
+		def __OnClosePopupDialog(self):
+			self.pop = None
+
+		def __ActivePetHighlightSlot(self, slotNumber):
+			active_id = player.GetActivePetItemId()
+			
+			if active_id == player.GetItemMetinSocket(player.INVENTORY, slotNumber, 2):
+				
+				if slotNumber >= player.INVENTORY_PAGE_SIZE:
+					slotNumber -= (self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE)
+			
+				self.wndItem.ActivateSlot(slotNumber)
+			else:
+				if slotNumber >= player.INVENTORY_PAGE_SIZE:
+					slotNumber -= (self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE)
+					
+				self.wndItem.DeactivateSlot(slotNumber)
+
+		def __SetCoolTimePetItemSlot(self, slotNumber, itemVnum):
+		
+			item.SelectItem(itemVnum)
+			itemSubType = item.GetItemSubType()
+		
+			if itemSubType not in [item.PET_UPBRINGING, item.PET_BAG]:
+				return
+				
+			if itemSubType == item.PET_BAG:
+				id = player.GetItemMetinSocket(player.INVENTORY, slotNumber, 2)
+				if id == 0:
+					return
+			
+			(limitType, limitValue) = item.GetLimit(0)
+
+			if itemSubType == item.PET_UPBRINGING:
+				limitValue = player.GetItemMetinSocket(player.INVENTORY, slotNumber, 1)
+					
+			if limitType in [item.LIMIT_REAL_TIME, item.LIMIT_REAL_TIME_START_FIRST_USE]:
+								
+				sock_time   = player.GetItemMetinSocket(player.INVENTORY, slotNumber, 0)
+				
+				remain_time = max(0, sock_time - app.GetGlobalTimeStamp())
+			
+				if slotNumber >= player.INVENTORY_PAGE_SIZE:
+					slotNumber -= (self.inventoryPageIndex * player.INVENTORY_PAGE_SIZE)
+
+				self.wndItem.SetSlotCoolTimeInverse(slotNumber, limitValue, limitValue - remain_time)
+
+		def __IsPetItem(self, srcItemVID):
+			item.SelectItem(srcItemVID)
+			
+			if item.GetItemType() == item.ITEM_TYPE_PET:
+				return True
+			
+			return False
+
+		def __SendUsePetItemToItemPacket(self, srcItemVID, srcItemSlotPos, dstItemSlotPos):
+			if self.__CanUseSrcPetItemToDstPetItem(srcItemVID, srcItemSlotPos, dstItemSlotPos):
+				srcItemVnum		= player.GetItemIndex(srcItemSlotPos)
+				item.SelectItem( srcItemVnum )
+				srcItemType		= item.GetItemType()
+				srcItemSubType	= item.GetItemSubType()
+				
+				if item.ITEM_TYPE_PET == srcItemType:					
+					if srcItemSubType in [item.PET_FEEDSTUFF, item.PET_BAG]:
+						self.__OpenPetItemQuestionDialog(srcItemSlotPos, dstItemSlotPos)
+					elif item.PET_NAME_CHANGE == srcItemSubType:
+						self.__UseItemPetNameChange(srcItemSlotPos, dstItemSlotPos)
+				return True
+				
+			return False
+			
+		def __UseItemPetNameChange(self, srcSlotPos, dstSlotPos):
+			if self.petNameChangeWindow:
+				self.petNameChangeWindow.NameChangeWindowOpen(srcSlotPos, dstSlotPos)
+
+		def __IsUsablePetItem(self, srcItemVNum):
+			item.SelectItem(srcItemVNum)
+			srcItemType		= item.GetItemType()
+			srcItemSubType	= item.GetItemSubType()
+
+			if srcItemType != item.ITEM_TYPE_PET:
+				return False
+			
+			if srcItemSubType not in [item.PET_UPBRINGING, item.PET_FEEDSTUFF, item.PET_BAG, item.PET_NAME_CHANGE]:
+				return False
+			
+			return True
+
+		def __CanUseSrcPetItemToDstPetItem(self, srcItemVNum, srcSlotPos, dstSlotPos):
+			item.SelectItem(srcItemVNum)
+			srcItemType		= item.GetItemType()
+			srcItemSubType	= item.GetItemSubType()
+			
+			if srcItemType != item.ITEM_TYPE_PET:
+				return False
+			
+			if srcItemSubType == item.PET_FEEDSTUFF:		
+				detIndex = player.GetItemIndex(dstSlotPos)
+				item.SelectItem(detIndex)
+				
+				dstItemType		= item.GetItemType()
+				dstItemSubType	= item.GetItemSubType()
+				
+				if dstItemType != item.ITEM_TYPE_PET:
+					return False
+					
+				if dstItemSubType not in [item.PET_UPBRINGING]:
+					return False
+					
+				if dstItemSubType == item.PET_BAG:
+					incaseTime = player.GetItemMetinSocket(dstSlotPos, 1)
+					if incaseTime == 0:
+						return False
+			
+			elif srcItemSubType == item.PET_BAG:
+				detIndex = player.GetItemIndex(dstSlotPos)
+				item.SelectItem(detIndex)
+				
+				dstItemType		= item.GetItemType()
+				dstItemSubType	= item.GetItemSubType()
+				
+				if dstItemType != item.ITEM_TYPE_PET:
+					return False
+					
+				if dstItemSubType not in [item.PET_UPBRINGING, item.PET_BAG]:
+					return False
+			
+				lifeTime = player.GetItemMetinSocket(dstSlotPos, 0)
+					
+				if dstItemSubType == item.PET_UPBRINGING:
+					if lifeTime < app.GetGlobalTimeStamp():
+						return False
+
+					srcIncase = player.GetItemMetinSocket(srcSlotPos, 1)
+					if srcIncase != 0:
+						return False
+					
+				elif dstItemSubType == item.PET_BAG:
+					if lifeTime > app.GetGlobalTimeStamp():
+						return False
+						
+					srcIncase = player.GetItemMetinSocket(srcSlotPos, 1)
+					if srcIncase != 0:
+						return False
+					
+					destIncase = player.GetItemMetinSocket(dstSlotPos, 1)
+					if destIncase == 0:
+						return False
+						
+			elif srcItemSubType == item.PET_NAME_CHANGE:
+				detIndex = player.GetItemIndex(dstSlotPos)
+				item.SelectItem(detIndex)
+				
+				dstItemType		= item.GetItemType()
+				dstItemSubType	= item.GetItemSubType()
+				
+				if dstItemType != item.ITEM_TYPE_PET:
+					return False
+					
+				if dstItemSubType not in [item.PET_UPBRINGING]:
+					return False
+					
+			else:
+				return False
+			
+			return True
+
+		def __CanUseGrowthPet(self, slotIndex):
+			if not player.GetItemMetinSocket(player.INVENTORY, slotIndex, 2):
+				return False
+				
+			(limitType, limitValue) = item.GetLimit(0)
+			remain_time = 999
+			if item.LIMIT_REAL_TIME == limitType:
+				sock_time   = player.GetItemMetinSocket(player.INVENTORY, slotIndex, 0)
+				if app.GetGlobalTimeStamp() > sock_time:
+					chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.PET_CAN_NOT_SUMMON_BECAUSE_LIFE_TIME_END)
+					return False
+					
+			return True
+
+		def __CanUsePetBagItem(self, slotIndex):
+			if not player.GetItemMetinSocket(player.INVENTORY, slotIndex, 2):
+				return False
+				
+			(limitType, limitValue) = item.GetLimit(0)
+			remain_time = 999
+			if item.LIMIT_REAL_TIME_START_FIRST_USE == limitType:
+				sock_time   = player.GetItemMetinSocket(player.INVENTORY, slotIndex, 0)
+				use_cnt	    = player.GetItemMetinSocket(player.INVENTORY, slotIndex, 1)
+				
+				if use_cnt:
+					if app.GetGlobalTimeStamp() > sock_time:
+						chat.AppendChat(chat.CHAT_TYPE_INFO, localeInfo.PET_CAN_NOT_USE_BAG)
+						return False;
+						
+			return True
+
+		def __CanAttachGrowthPetItem(self, itemVNum, itemSlotIndex):
+			activePetId = player.GetActivePetItemId()
+			if activePetId == 0:
+				return True
+			
+			item.SelectItem(itemVNum)
+			itemType	= item.GetItemType()
+			itemSubType = item.GetItemSubType()
+			
+			if item.ITEM_TYPE_PET == itemType and itemSubType == item.PET_UPBRINGING:
+				petId = player.GetItemMetinSocket(itemSlotIndex, 2)
+				if petId == activePetId:
+					return False
+					
+					
+			return True
+
+		def SetPetHatchingWindow(self, window):
+			self.petHatchingWindow = window
+
+		def SetPetNameChangeWindow(self, window):
+			self.petNameChangeWindow = window
+
+		def SetPetFeedWindow(self, window):
+			self.petFeedWindow = window
+
+		def ItemMoveFeedWindow(self, slotWindow, slotIndex):
+			if not self.petFeedWindow:
+				return
+				
+			self.petFeedWindow.ItemMoveFeedWindow(slotWindow, slotIndex)
+
+		def __OpenPetBagQuestionDialog(self, srcItemSlotPos, dstItemSlotPos):
+			if self.interface.IsShowDlgQuestionWindow():
+				self.interface.CloseDlgQuestionWindow()
+
+		def __OpenPetItemQuestionDialog(self, srcItemPos, dstItemPos):
+			if self.interface.IsShowDlgQuestionWindow():
+				self.interface.CloseDlgQuestionWindow()
+			
+			getItemVNum=player.GetItemIndex
+			self.srcItemPos = srcItemPos
+			self.dstItemPos = dstItemPos
+
+			srcItemVnum = getItemVNum(srcItemPos)
+			dstItemVnum = getItemVNum(dstItemPos)
+			
+			item.SelectItem( srcItemVnum )
+			src_item_name = item.GetItemName( srcItemVnum )
+			srcItemType		= item.GetItemType()
+			srcItemSubType	= item.GetItemSubType()
+			
+			item.SelectItem( dstItemVnum )
+			dst_item_name = item.GetItemName( getItemVNum(dstItemPos) )
+			
+			self.PetItemQuestionDlg.SetAcceptEvent(ui.__mem_func__(self.__PetItemAccept))
+			self.PetItemQuestionDlg.SetCancelEvent(ui.__mem_func__(self.__PetItemCancel))
+			
+			if item.ITEM_TYPE_PET == srcItemType:
+				if item.PET_FEEDSTUFF == srcItemSubType:
+					self.PetItemQuestionDlg.SetText( localeInfo.INVENTORY_REALLY_USE_PET_FEEDSTUFF_ITEM % ( src_item_name, dst_item_name ) )
+					self.PetItemQuestionDlg.Open()
+				
+				elif item.PET_BAG == srcItemSubType:
+					self.PetItemQuestionDlg.SetText( localeInfo.INVENTORY_REALLY_USE_PET_BAG_ITEM )
+					self.PetItemQuestionDlg.Open()			
+				
+		def __PetItemAccept(self):
+			self.PetItemQuestionDlg.Close()
+			self.__SendUseItemToItemPacket(self.srcItemPos, self.dstItemPos)
+			self.srcItemPos = (0, 0)
+			self.dstItemPos = (0, 0)
+			self.srcItemWindow = None
+			self.dstItemWindow = None
+
+		def __PetItemCancel(self):
+			self.srcItemPos = (0, 0)
+			self.dstItemPos = (0, 0)
+			self.PetItemQuestionDlg.Close()
+
+		def __PetSkillDeleteQuestionDialogAccept(self):
+			net.SendPetDeleteAllSkill( self.PetSkillAllDelBookIndex )	
+			self.__PetSkillDeleteQuestionDialogCancel()
+			
+		def __PetSkillDeleteQuestionDialogCancel(self):
+			self.PetSkillDelDlg.Close()
+			self.SetCanMouseEventSlot( self.PetSkillAllDelBookIndex )
+			self.PetSkillAllDelBookIndex = -1
+			
+		def SetCanMouseEventSlot(self, inven_slot_index):
+			if inven_slot_index >= player.INVENTORY_PAGE_SIZE:
+				page = self.GetInventoryPageIndex() # range 0,1,2,3
+				inven_slot_index -= (page * player.INVENTORY_PAGE_SIZE)
+			self.wndItem.SetCanMouseEventSlot(inven_slot_index)
+			
+		def SetCantMouseEventSlot(self, inven_slot_index):
+			if inven_slot_index >= player.INVENTORY_PAGE_SIZE:
+				page = self.GetInventoryPageIndex() # range 0,1,2,3
+				inven_slot_index -= (page * player.INVENTORY_PAGE_SIZE)
+			self.wndItem.SetCantMouseEventSlot(inven_slot_index)
\ No newline at end of file
diff -ruN client_base/client/client/pack/root/uitaskbar.py client_final/client/client/pack/root/uitaskbar.py
--- client_base/client/client/pack/root/uitaskbar.py	2026-02-13 09:22:34.000000000 +0000
+++ client_final/client/client/pack/root/uitaskbar.py	2026-02-20 18:13:16.646247069 +0000
@@ -6,14 +6,12 @@
 import wndMgr
 import player
 import constInfo
+import osfInfo
 import mouseModule
 import uiScriptLocale
 import app
 import guild
 
-import emotion
-import uiToolTip
-
 MOUSE_SETTINGS = [0, 0]
 
 def InitMouseButtonSettings(left, right):
@@ -82,7 +80,7 @@
 	def LoadWindow(self):
 		try:
 			pyScrLoader = ui.PythonScriptLoader()
-			pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_COMMON_UISCRIPT_PATH + "giftbox.py")
+			pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "giftbox.py")
 		except:
 			import exception
 			exception.Abort("GiftBox.LoadWindow.LoadObject")
@@ -94,12 +92,9 @@
 	def Destroy(self):
 		self.giftBoxIcon = None
 		self.giftBoxToolTip = None
-		if self.tooltipGift:
-			del self.tooltipGift
-		self.tooltipGift = None
 
 	def OpenMall(self):
-		net.SendCommandPacket("/click_mall")
+		net.SendChatPacket("/click_mall")
 		self.Hide()
 
 #-------------------Giftbox End------------------------------
@@ -139,10 +134,7 @@
 	def LoadWindow(self):
 		try:
 			pyScrLoader = ui.PythonScriptLoader()
-			if localeInfo.IsARABIC():
-				pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "EnergyBar.py")
-			else:
-				pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_COMMON_UISCRIPT_PATH + "EnergyBar.py")
+			pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "EnergyBar.py")
 		except:
 			import exception
 			exception.Abort("EnergyBar.LoadWindow.LoadObject")
@@ -166,7 +158,13 @@
 	## Gauge
 	def RefreshStatus(self):
 		pointEnergy = player.GetStatus(player.ENERGY)
-		leftTimeEnergy = player.GetStatus(player.ENERGY_END_TIME) - app.GetGlobalTimeStamp()
+		if app.ENABLE_EXTENDED_BLEND_AFFECT:
+			if pointEnergy != 0:
+				leftTimeEnergy = 7200
+			else:
+				leftTimeEnergy = player.GetStatus(player.ENERGY_END_TIME) - app.GetGlobalTimeStamp()
+		else:
+			leftTimeEnergy = player.GetStatus(player.ENERGY_END_TIME) - app.GetGlobalTimeStamp()
 		# 충기환 지속 시간 = 2시간.
 		self.SetEnergy(pointEnergy, leftTimeEnergy, 7200)
 
@@ -194,7 +192,7 @@
 		else:
 			self.tooltipEnergy.Hide()
 
-if app.ENABLE_GEM_SYSTEM or app.ENABLE_CHEQUE_SYSTEM:
+if app.ENABLE_GEM_SYSTEM:
 	class ExpandedMoneyTaskBar(ui.ScriptWindow):
 		def __init__(self):
 			ui.Window.__init__(self)
@@ -326,11 +324,17 @@
 class ExpandedTaskBar(ui.ScriptWindow):
 	BUTTON_DRAGON_SOUL = 0
 
+	if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+		BUTTON_SPECIAL_INVENTORY = 1
+
+	if app.ENABLE_GROWTH_PET_SYSTEM:
+		BUTTON_PET_INFO = 2
+
 	def __init__(self):
 		ui.Window.__init__(self)
 		self.SetWindowName("ExpandedTaskBar")
 
-		self.exclusion_list = []
+		self.exclusion_list	= []
 
 	def __del__(self):
 		ui.Window.__del__(self)
@@ -338,7 +342,7 @@
 	def LoadWindow(self):
 		try:
 			pyScrLoader = ui.PythonScriptLoader()
-			pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_COMMON_UISCRIPT_PATH + "ExpandedTaskBar.py")
+			pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "ExpandedTaskBar.py")
 		except:
 			import exception
 			exception.Abort("ExpandedTaskBar.LoadWindow.LoadObject")
@@ -349,6 +353,14 @@
 		self.toggleButtonDict[ExpandedTaskBar.BUTTON_DRAGON_SOUL] = self.GetChild("DragonSoulButton")
 		self.toggleButtonDict[ExpandedTaskBar.BUTTON_DRAGON_SOUL].SetParent(self)
 
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			self.toggleButtonDict[ExpandedTaskBar.BUTTON_SPECIAL_INVENTORY] = self.GetChild("SpecialInventoryButton")
+			self.toggleButtonDict[ExpandedTaskBar.BUTTON_SPECIAL_INVENTORY].SetParent(self)
+
+		if app.ENABLE_GROWTH_PET_SYSTEM:
+			self.toggleButtonDict[ExpandedTaskBar.BUTTON_PET_INFO] = self.GetChild("PetInfoButton")
+			self.toggleButtonDict[ExpandedTaskBar.BUTTON_PET_INFO].SetParent(self)
+
 		# 버튼의 위치를 다시 조정해 주는 함수
 		# 마지막에 호출 되어야 한다.
 		self.RePositionButton()
@@ -361,17 +373,21 @@
 		if not ExpandedTaskBar.BUTTON_DRAGON_SOUL in self.exclusion_list:
 			button_order.append(ExpandedTaskBar.BUTTON_DRAGON_SOUL)
 
+		if app.ENABLE_SPECIAL_INVENTORY_SYSTEM:
+			if not ExpandedTaskBar.BUTTON_SPECIAL_INVENTORY in self.exclusion_list:
+				button_order.append(ExpandedTaskBar.BUTTON_SPECIAL_INVENTORY)
+
 		## 부모 window 의 position 을 다시 계산
-		total_count = len(button_order) # 정렬할 총 개수
-		quotient = total_count / 2 # 몫
+		total_count = len( button_order ) # 정렬할 총 개수
+		quotient = total_count /2 # 몫
 		remainder = total_count % 2 # 나머지
 
-		window_x = (wndMgr.GetScreenWidth() / 2 + 33) + (-36 * quotient)
+		window_x = (wndMgr.GetScreenWidth()/2 + 33) + (-36 * quotient)
 		if 0 == remainder: ## 짝수일때는 추가 위치 조정을 해준다
 			window_x = window_x + 18
 
 		window_y = wndMgr.GetScreenHeight() - 74
-		self.SetPosition(window_x, window_y)
+		self.SetPosition( window_x, window_y )
 
 		## 버튼들의 위치를 다시 계산한다.
 		pos_x = 0
@@ -383,7 +399,7 @@
 			if key in self.exclusion_list:
 				continue
 
-			self.toggleButtonDict[key].SetPosition(pos_x, pos_y)
+			self.toggleButtonDict[key].SetPosition( pos_x, pos_y)
 			pos_x = pos_x + 36
 
 	def SetTop(self):
@@ -416,9 +432,7 @@
 	BUTTON_EXPAND = 4
 	if app.ENABLE_GEM_SYSTEM:
 		BUTTON_EXPAND_MONEY = 5
-	if app.ENABLE_EXTENDED_BATTLE_PASS:
-		BUTTON_BATTLEPASS = 6
-	IS_EXPANDED = True
+	IS_EXPANDED = False
 
 	MOUSE_BUTTON_LEFT = 0
 	MOUSE_BUTTON_RIGHT = 1
@@ -530,7 +544,7 @@
 			if player.IsSkillActive(skillSlotNumber):
 				self.ActivateSlot(slotNumber)
 
-		def SetSkillEvent(self, event, arg = 0):
+		def SetSkillEvent(self, event, arg=0):
 			self.event = event
 			self.arg = arg
 
@@ -571,9 +585,11 @@
 		self.quickPageNumImageBox = None
 		self.tooltipItem = None
 		self.tooltipSkill = None
-		self.tooltipEmotion = uiToolTip.ToolTip()
 		self.mouseModeButtonList = [ ui.ScriptWindow("TOP_MOST"), ui.ScriptWindow("TOP_MOST") ]
 
+		if app.ENABLE_HEART_BEAT_MALL:
+			self.heartBeat = False
+
 		self.tooltipHP = self.TextToolTip()
 		self.tooltipHP.Show()
 		self.tooltipSP = self.TextToolTip()
@@ -605,26 +621,14 @@
 
 			if constInfo.IN_GAME_SHOP_ENABLE:
 				if app.ENABLE_GEM_SYSTEM:
-					if localeInfo.IsARABIC():
-						pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "newtaskbar.py")
-					else:
-						pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_COMMON_UISCRIPT_PATH + "newtaskbar.py")
+					pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "newtaskbar.py")
 				else:
-					if localeInfo.IsARABIC():
-						pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "TaskBar.py")
-					else:
-						pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_COMMON_UISCRIPT_PATH + "TaskBar.py")
+					pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "TaskBar.py")
 			else:
 				if app.ENABLE_GEM_SYSTEM:
-					if localeInfo.IsARABIC():
-						pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "newtaskbar.py")
-					else:
-						pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_COMMON_UISCRIPT_PATH + "newtaskbar.py")
+					pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "newtaskbar.py")
 				else:
-					if localeInfo.IsARABIC():
-						pyScrLoader.LoadScriptFile(self, uiScriptLocale.LOCALE_UISCRIPT_PATH + "TaskBar.py")
-					else:
-						pyScrLoader.LoadScriptFile(self, "UIScript/TaskBar.py")
+					pyScrLoader.LoadScriptFile(self, "UIScript/TaskBar.py")
 
 			pyScrLoader.LoadScriptFile(self.mouseModeButtonList[self.MOUSE_BUTTON_LEFT], "UIScript/MouseButtonWindow.py")
 			pyScrLoader.LoadScriptFile(self.mouseModeButtonList[self.MOUSE_BUTTON_RIGHT], "UIScript/RightMouseButtonWindow.py")
@@ -648,14 +652,12 @@
 		toggleButtonDict[TaskBar.BUTTON_INVENTORY] = self.GetChild("InventoryButton")
 		toggleButtonDict[TaskBar.BUTTON_MESSENGER] = self.GetChild("MessengerButton")
 		toggleButtonDict[TaskBar.BUTTON_SYSTEM] = self.GetChild("SystemButton")
-		if app.ENABLE_EXTENDED_BATTLE_PASS:
-			toggleButtonDict[TaskBar.BUTTON_BATTLEPASS]=self.GetChild("BattlePassButton")
 
 		# ChatButton, ExpandButton 둘 중 하나는 반드시 존재한다.
 		try:
-			toggleButtonDict[TaskBar.BUTTON_CHAT] = self.GetChild("ChatButton")
+			toggleButtonDict[TaskBar.BUTTON_CHAT]=self.GetChild("ChatButton")
 		except:
-			toggleButtonDict[TaskBar.BUTTON_EXPAND] = self.GetChild("ExpandButton")
+			toggleButtonDict[TaskBar.BUTTON_EXPAND]=self.GetChild("ExpandButton")
 			TaskBar.IS_EXPANDED = True
 
 		if app.ENABLE_GEM_SYSTEM:
@@ -744,6 +746,18 @@
 			self.rampageGauge2 = self.GetChild("RampageGauge2")
 			self.rampageGauge2.OnMouseOverOut = ui.__mem_func__(self.__RampageGauge_OverOut)
 			self.rampageGauge2.OnMouseLeftButtonUp = ui.__mem_func__(self.__RampageGauge_Click)
+			if app.ENABLE_HEART_BEAT_MALL:
+				self.rampageGauge1.SetDelay(10)
+				self.rampageGauge2.SetDelay(10)
+
+				self.rampageGauge3 = self.GetChild("RampageGauge3")
+				self.rampageGauge3.OnMouseOverIn = ui.__mem_func__(self.__RampageGauge_OverIn)
+				self.rampageGauge3.SetDelay(10)
+
+				self.rampageGauge4 = self.GetChild("RampageGauge4")
+				self.rampageGauge4.OnMouseOverOut = ui.__mem_func__(self.__RampageGauge_OverOut)
+				self.rampageGauge4.OnMouseLeftButtonUp = ui.__mem_func__(self.__RampageGauge_Click)
+				self.rampageGauge4.SetDelay(10)
 
 			print "[DEBUG]: constInfo.IN_GAME_SHOP_ENABLE / self.rampageGauge1",constInfo.IN_GAME_SHOP_ENABLE, self.rampageGauge1
 			self.__RampageGauge_OverOut()
@@ -770,17 +784,45 @@
 
 	def __RampageGauge_OverIn(self):
 		print "rampage_over_in"
-		self.rampageGauge2.Show()
-		self.rampageGauge1.Hide()
+		if app.ENABLE_HEART_BEAT_MALL:
+			if self.heartBeat:
+				self.rampageGauge4.Show()
+				self.rampageGauge3.Hide()
+
+				self.rampageGauge1.Hide()
+				self.rampageGauge2.Hide()
+			else:
+				self.rampageGauge2.Show()
+				self.rampageGauge1.Hide()
+
+				self.rampageGauge3.Hide()
+				self.rampageGauge4.Hide()
+		else:
+			self.rampageGauge2.Show()
+			self.rampageGauge1.Hide()
 
 	def __RampageGauge_OverOut(self):
 		print "rampage_over_out"
-		self.rampageGauge2.Hide()
-		self.rampageGauge1.Show()
+		if app.ENABLE_HEART_BEAT_MALL:
+			if self.heartBeat:
+				self.rampageGauge4.Hide()
+				self.rampageGauge3.Show()
+
+				self.rampageGauge1.Hide()
+				self.rampageGauge2.Hide()
+			else:
+				self.rampageGauge2.Hide()
+				self.rampageGauge1.Show()
+
+				self.rampageGauge3.Hide()
+				self.rampageGauge4.Hide()
+		else:
+			self.rampageGauge2.Hide()
+			self.rampageGauge1.Show()
 
 	def __RampageGauge_Click(self):
 		print "rampage_up"
-		net.SendCommandPacket("/in_game_mall")
+		net.SendChatPacket("/in_game_mall")
 		# gift icon hide when click mall icon
 		self.wndGiftBox.Hide()
 
@@ -829,14 +871,14 @@
 
 		self.rampageGauge1 = None
 		self.rampageGauge2 = None
+		if app.ENABLE_HEART_BEAT_MALL:
+			self.heartBeat = False
+
+			self.rampageGauge3 = None
+			self.rampageGauge4 = None
 
 		self.tooltipItem = None
 		self.tooltipSkill = None
-
-		if self.tooltipEmotion:
-			del self.tooltipEmotion
-		self.tooltipEmotion = None
-
 		self.quickslot = []
 		self.toggleButtonDict = {}
 
@@ -853,10 +895,10 @@
 		self.mouseImage = None
 
 	def __OnClickQuickPageUpButton(self):
-		player.SetQuickPage(player.GetQuickPage() - 1)
+		player.SetQuickPage(player.GetQuickPage()-1)
 
 	def __OnClickQuickPageDownButton(self):
-		player.SetQuickPage(player.GetQuickPage() + 1)
+		player.SetQuickPage(player.GetQuickPage()+1)
 
 	def SetToggleButtonEvent(self, eButton, kEventFunc):
 		self.toggleButtonDict[eButton].SetEvent(kEventFunc)
@@ -868,15 +910,14 @@
 		self.tooltipSkill = tooltipSkill
 		self.curSkillButton.SetSkillToolTip(self.tooltipSkill)
 
-	if not app.ENABLE_KEYCHANGE_SYSTEM:
-		## Mouse Image
-		def ShowMouseImage(self):
-			self.mouseImage.SetTop()
-			self.mouseImage.Show()
-
-		def HideMouseImage(self):
-			player.SetQuickCameraMode(False)
-			self.mouseImage.Hide()
+	## Mouse Image
+	def ShowMouseImage(self):
+		self.mouseImage.SetTop()
+		self.mouseImage.Show()
+
+	def HideMouseImage(self):
+		player.SetQuickCameraMode(False)
+		self.mouseImage.Hide()
 
 	## Gauge
 	def RefreshStatus(self):
@@ -940,6 +981,55 @@
 				self.hpRecoveryGaugeBar.SetSize(newWidth, self.GAUGE_HEIGHT)
 				self.hpRecoveryGaugeBar.Show()
 
+		if app.ENABLE_HEART_BEAT_MALL:
+			self.heartBeat = True
+			curPointPct = int(100 * float(curPoint) / float(maxPoint))
+			heartBeats = [
+				[ [0, 30], 1 ],
+				[ [30, 40], 2 ],
+				[ [40, 50], 3 ],
+			]
+
+			if curPointPct >= heartBeats[0][0][0] and curPointPct <= heartBeats[0][0][1]:
+				self.rampageGauge1.SetDelay(heartBeats[0][1])
+				self.rampageGauge2.SetDelay(heartBeats[0][1])
+				self.rampageGauge3.SetDelay(heartBeats[0][1])
+				self.rampageGauge4.SetDelay(heartBeats[0][1])
+			elif curPointPct >= heartBeats[1][0][0] and curPointPct <= heartBeats[1][0][1]:
+				self.rampageGauge1.SetDelay(heartBeats[1][1])
+				self.rampageGauge2.SetDelay(heartBeats[1][1])
+				self.rampageGauge3.SetDelay(heartBeats[1][1])
+				self.rampageGauge4.SetDelay(heartBeats[1][1])
+			elif curPointPct >= heartBeats[2][0][0] and curPointPct <= heartBeats[2][0][1]:
+				self.rampageGauge1.SetDelay(heartBeats[2][1])
+				self.rampageGauge2.SetDelay(heartBeats[2][1])
+				self.rampageGauge3.SetDelay(heartBeats[2][1])
+				self.rampageGauge4.SetDelay(heartBeats[2][1])
+			else:
+				if curPointPct <= 0:
+					self.rampageGauge1.SetDelay(99)
+					self.rampageGauge2.SetDelay(99)
+					self.rampageGauge3.SetDelay(99)
+					self.rampageGauge4.SetDelay(99)
+				else:
+					self.heartBeat = False
+
+					self.rampageGauge1.SetDelay(10)
+					self.rampageGauge2.SetDelay(10)
+					self.rampageGauge3.SetDelay(10)
+					self.rampageGauge4.SetDelay(10)
+
+			if self.heartBeat:
+				self.rampageGauge1.Hide()
+				self.rampageGauge2.Hide()
+				self.rampageGauge3.Show()
+				self.rampageGauge4.Show()
+			else:
+				self.rampageGauge1.Show()
+				self.rampageGauge2.Show()
+				self.rampageGauge3.Hide()
+				self.rampageGauge4.Hide()
+
 	def SetSP(self, curPoint, recoveryPoint, maxPoint):
 		curPoint = min(curPoint, maxPoint)
 		if maxPoint > 0:
@@ -1022,7 +1112,7 @@
 		for slot in self.quickslot:
 
 			for i in xrange(4):
-				slotNumber = i + startNumber
+				slotNumber = i+startNumber
 
 				(Type, Position) = player.GetLocalQuickSlot(slotNumber)
 
@@ -1030,18 +1120,16 @@
 					slot.ClearSlot(slotNumber)
 					continue
 
-				if player.SLOT_TYPE_INVENTORY == Type or player.SLOT_TYPE_BELT_INVENTORY == Type:
-					window = player.SlotTypeToInvenType(Type)
-
-					itemIndex = player.GetItemIndex(window, Position)
-					itemCount = player.GetItemCount(window, Position)
+				if player.SLOT_TYPE_INVENTORY == Type:
+					itemIndex = player.GetItemIndex(Position)
+					itemCount = player.GetItemCount(Position)
 					if itemCount <= 1:
 						itemCount = 0
 
 					## 자동물약 (#72723, #72724) 특수처리 - 아이템인데도 슬롯에 활성화/비활성화 표시를 위한 작업임 - [hyo]
 					if constInfo.IS_AUTO_POTION(itemIndex):
 						# metinSocket - [0] : 활성화 여부, [1] : 사용한 양, [2] : 최대 용량
-						metinSocket = [player.GetItemMetinSocket(window, Position, j) for j in xrange(player.METIN_SOCKET_MAX_NUM)]
+						metinSocket = [player.GetItemMetinSocket(Position, j) for j in xrange(player.METIN_SOCKET_MAX_NUM)]
 
 						if 0 != int(metinSocket[0]):
 							slot.ActivateSlot(slotNumber)
@@ -1073,7 +1161,7 @@
 							
 							active_id = player.GetActivePetItemId()
 							if active_id and active_id == player.GetItemMetinSocket(Position, 2):
-								slot.ActivateSlotOld(slotNumber)
+								slot.ActivateSlot(slotNumber)
 
 					slot.SetItemSlot(slotNumber, itemIndex, itemCount)
 
@@ -1107,13 +1195,6 @@
 				elif player.SLOT_TYPE_EMOTION == Type:
 
 					emotionIndex = Position
-					if app.ENABLE_EXPRESSING_EMOTION:
-						if emotionIndex >= app.SPECIAL_ACTION_START_INDEX:
-							actionSlotIndex, actionDuration = player.FindSpecialActionSlot(emotionIndex)
-							if actionSlotIndex == 0:
-								player.RemoveQuickSlotByValue(Type, Position)
-								continue
-
 					slot.SetEmotionSlot(slotNumber, emotionIndex)
 					slot.SetCoverButton(slotNumber)
 					slot.SetSlotCount(slotNumber, 0)
@@ -1121,37 +1202,34 @@
 			slot.RefreshSlot()
 			startNumber += 4
 
-	if app.ENABLE_GROWTH_PET_SYSTEM:
+	if app.ENABLE_GROWTH_PET_SYSTEM:		
 		def __SetCoolTimePetItemSlot(self, slot, Position, slotNumber, itemVnum):
-
+		
 			item.SelectItem(itemVnum)
 			itemSubType = item.GetItemSubType()
-
+		
 			if itemSubType not in [item.PET_UPBRINGING, item.PET_BAG]:
 				return
-
+				
 			if itemSubType == item.PET_BAG:
 				id = player.GetItemMetinSocket(Position, 2)
 				if id == 0:
 					return
-
+			
 			(limitType, limitValue) = item.GetLimit(0)
 
 			if itemSubType == item.PET_UPBRINGING:
 				limitValue = player.GetItemMetinSocket(Position, 1)
-
+					
 			if limitType in [item.LIMIT_REAL_TIME, item.LIMIT_REAL_TIME_START_FIRST_USE]:
 				sock_time   = player.GetItemMetinSocket(Position, 0)
 				remain_time = max( 0, sock_time - app.GetGlobalTimeStamp() )
-
+				
 				slot.SetSlotCoolTimeInverse(slotNumber, limitValue, limitValue - remain_time)
 
 	def canAddQuickSlot(self, Type, slotNumber):
-		if player.SLOT_TYPE_INVENTORY == Type or\
-			player.SLOT_TYPE_BELT_INVENTORY == Type:
-
-			window = player.SlotTypeToInvenType(Type)
-			itemIndex = player.GetItemIndex(window, slotNumber)
+		if player.SLOT_TYPE_INVENTORY == Type:
+			itemIndex = player.GetItemIndex(slotNumber)
 			return item.CanAddToQuickSlotItem(itemIndex)
 
 		return True
@@ -1258,16 +1336,11 @@
 
 		(Type, Position) = player.GetLocalQuickSlot(slotNumber)
 
-		if player.SLOT_TYPE_INVENTORY == Type or player.SLOT_TYPE_BELT_INVENTORY == Type:
-
-			window = player.SlotTypeToInvenType(Type)
-			self.tooltipItem.SetInventoryItem(Position, window)
-
+		if player.SLOT_TYPE_INVENTORY == Type:
+			self.tooltipItem.SetInventoryItem(Position)
 			self.tooltipSkill.HideToolTip()
-			self.tooltipEmotion.HideToolTip()
 
 		elif player.SLOT_TYPE_SKILL == Type:
-
 			skillIndex = player.GetSkillIndex(Position)
 			skillType = skill.GetSkillType(skillIndex)
 
@@ -1280,38 +1353,13 @@
 				skillLevel = player.GetSkillLevel(Position)
 
 			self.tooltipSkill.SetSkillNew(Position, skillIndex, skillGrade, skillLevel)
-
-			self.tooltipItem.HideToolTip()
-			self.tooltipEmotion.HideToolTip()
-
-		elif player.SLOT_TYPE_EMOTION == Type:
-
-			emotionIndex = Position
-
-			self.tooltipEmotion.ClearToolTip()
-			self.tooltipEmotion.SetTitle(emotion.EMOTION_DICT[emotionIndex]["name"])
-
-			if app.ENABLE_EXPRESSING_EMOTION:
-				actionSlotIndex, actionDuration = player.FindSpecialActionSlot(emotionIndex)
-				if actionDuration != 0:
-					leftSec = max(0, actionDuration - app.GetGlobalTimeStamp())
-					if leftSec > 0:
-						self.tooltipEmotion.AppendTextLine("(" + localeInfo.LEFT_TIME + " : " + localeInfo.SecondToDHM(leftSec) + ")")
-
-			self.tooltipEmotion.AlignHorizonalCenter()
-			self.tooltipEmotion.ShowToolTip()
-
-			## Hide other tool tips.
 			self.tooltipItem.HideToolTip()
-			self.tooltipSkill.HideToolTip()
 
 	def OverOutItem(self):
 		if 0 != self.tooltipItem:
 			self.tooltipItem.HideToolTip()
 		if 0 != self.tooltipSkill:
 			self.tooltipSkill.HideToolTip()
-		if 0 != self.tooltipEmotion:
-			self.tooltipEmotion.HideToolTip()
 
 	def OnUpdate(self):
 		if app.GetGlobalTime() - self.lastUpdateQuickSlot > 500:
@@ -1338,15 +1386,6 @@
 		else:
 			self.tooltipEXP.Hide()
 
-	if app.ENABLE_HELP_RENEWAL:
-		def LeftMouseButtonIsShow(self):
-			wndMouseButtonMode = self.mouseModeButtonList[self.MOUSE_BUTTON_LEFT]
-			return wndMouseButtonMode.IsShow()
-
-		def RightMouseButtonIsShow(self):
-			wndMouseButtonMode = self.mouseModeButtonList[self.MOUSE_BUTTON_RIGHT]
-			return wndMouseButtonMode.IsShow()
-
 	## Skill
 	def ToggleLeftMouseButtonModeWindow(self):
 		wndMouseButtonMode = self.mouseModeButtonList[self.MOUSE_BUTTON_LEFT]
@@ -1408,7 +1447,7 @@
 			if appendCount > 0:
 				y -= 32
 
-	def CloseSelectSkill(self, slotIndex = -1):
+	def CloseSelectSkill(self, slotIndex=-1):
 		self.mouseModeButtonList[self.MOUSE_BUTTON_RIGHT].Hide()
 		for button in self.selectSkillButtonList:
 			button.Destroy()
@@ -1478,8 +1517,4 @@
 	def OnChangeCurrentSkill(self, skillSlotNumber):
 		self.curSkillButton.SetSkill(skillSlotNumber)
 		self.curSkillButton.Show()
-		self.curMouseModeButton[self.MOUSE_BUTTON_RIGHT].Hide()
-
-	if app.ENABLE_EXPRESSING_EMOTION:
-		def RemoveQuickSlotIndex(self, iIndex):
-			pass
+		self.curMouseModeButton[self.MOUSE_BUTTON_RIGHT].Hide()
\ No newline at end of file
diff -ruN client_base/client/client/pack/root/uitooltip.py client_final/client/client/pack/root/uitooltip.py
--- client_base/client/client/pack/root/uitooltip.py	2026-02-20 12:28:54.000000000 +0000
+++ client_final/client/client/pack/root/uitooltip.py	2026-02-20 18:13:16.649075146 +0000
@@ -19,49 +19,22 @@
 import constInfo
 import osfInfo
 
-if app.ENABLE_DRAGON_SOUL_SYSTEM and app.ENABLE_DS_SET:
+if app.ENABLE_ACCE_COSTUME_SYSTEM:
+	import acce
+
+if app.ENABLE_DS_SET:
 	import uiDragonSoul
 
 if app.ENABLE_MAILBOX:
 	import mail
 
-if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-	import uiRefine
-
 WARP_SCROLLS = [22011, 22000, 22010]
 BELT_SLOTS = [0, 1, 2, 4, 6, 9, 12, 16]
 
-DESC_DEFAULT_MAX_COLS = 26
+DESC_DEFAULT_MAX_COLS = 26 
 DESC_WESTERN_MAX_COLS = 35
 DESC_WESTERN_MAX_WIDTH = 220
 
-LEADERSHIP_ATTACKER_BASE_VALUE = 10
-LEADERSHIP_ATTACKER_ADJUSTMENT_VALUE = 50
-LEADERSHIP_TANKER_BASE_VALUE = 50
-LEADERSHIP_TANKER_ADJUSTMENT_VALUE = 1120
-LEADERSHIP_BUFFER_BASE_VALUE = 5
-LEADERSHIP_BUFFER_ADJUSTMENT_VALUE = 8
-LEADERSHIP_SKILL_MASTER_BASE_VALUE = 1
-LEADERSHIP_SKILL_MASTER_ADJUSTMENT_VALUE = 2
-LEADERSHIP_BERSERKER_BASE_VALUE = 1
-LEADERSHIP_BERSERKER_ADJUSTMENT_VALUE = 3
-LEADERSHIP_DEFENDER_BASE_VALUE = 1
-LEADERSHIP_DEFENDER_ADJUSTMENT_VALUE = 3
-
-if app.ENABLE_PARTY_INSIGHT:
-	INSIGHT_ATTACKER_BASE_VALUE = 2
-	INSIGHT_ATTACKER_ADJUSTMENT_VALUE = 9
-	INSIGHT_TANKER_BASE_VALUE = 10
-	INSIGHT_TANKER_ADJUSTMENT_VALUE = 520
-	INSIGHT_BUFFER_BASE_VALUE = 1
-	INSIGHT_BUFFER_ADJUSTMENT_VALUE = 4
-	INSIGHT_SKILL_MASTER_BASE_VALUE = 1
-	INSIGHT_SKILL_MASTER_ADJUSTMENT_VALUE = 5
-	INSIGHT_BERSERKER_BASE_VALUE = 1
-	INSIGHT_BERSERKER_ADJUSTMENT_VALUE = 1
-	INSIGHT_DEFENDER_BASE_VALUE = 1
-	INSIGHT_DEFENDER_ADJUSTMENT_VALUE = 2
-
 def chop(n):
 	return round(n - 0.5, 1)
 
@@ -128,6 +101,7 @@
 	POSITIVE_COLOR = grp.GenerateColor(0.5411, 0.7254, 0.5568, 1.0)
 	SPECIAL_POSITIVE_COLOR = grp.GenerateColor(0.6911, 0.8754, 0.7068, 1.0)
 	SPECIAL_POSITIVE_COLOR2 = grp.GenerateColor(0.8824, 0.9804, 0.8824, 1.0)
+	SPECIAL_POSITIVE_COLOR_GOLD = 0xffffc700
 
 	if app.ENABLE_DS_SET:
 		TEXTLINE_2ND_COLOR_DEFAULT = grp.GenerateColor(1.0, 1.0, 0.6078, 1.0)
@@ -141,8 +115,8 @@
 		CHANGELOOK_TITLE_COLOR = 0xff8BBDFF
 		CHANGELOOK_ITEMNAME_COLOR = 0xffBCE55C
 
-	if app.ENABLE_ATTR_6TH_7TH:
-		ATTR_6TH_7TH_COLOR = grp.GenerateColor(1.0, 1.0, 0.6078, 1.0)
+	if app.ENABLE_APPLY_RANDOM:
+		APPLY_RANDOM_TEXT_COLOR = 0xff7AF6D4
 
 	def __init__(self, width = TOOL_TIP_WIDTH, isPickable=False):
 		ui.ThinBoard.__init__(self, "TOP_MOST")
@@ -205,15 +179,7 @@
 	def AlignHorizonalCenter(self):
 		for child in self.childrenList:
 			(x, y) = child.GetLocalPosition()
-			child.SetPosition(self.toolTipWidth / 2, y)
-
-		self.ResizeToolTip()
-
-	def AlignTextLineHorizonalCenter(self):
-		for child in self.childrenList:
-			if type(child).__name__ == "TextLine":
-				(x, y) = child.GetLocalPosition()
-				child.SetPosition(self.toolTipWidth / 2, y)
+			child.SetPosition(self.toolTipWidth/2, y)
 
 		self.ResizeToolTip()
 
@@ -228,14 +194,14 @@
 		textLine.Show()
 
 		if centerAlign:
-			textLine.SetPosition(self.toolTipWidth / 2, self.toolTipHeight)
+			textLine.SetPosition(self.toolTipWidth/2, self.toolTipHeight)
 			textLine.SetHorizontalAlignCenter()
 		else:
 			textLine.SetPosition(10, self.toolTipHeight)
 
 		self.childrenList.append(textLine)
 
-		(textWidth, textHeight) = textLine.GetTextSize()
+		(textWidth, textHeight)=textLine.GetTextSize()
 
 		textWidth += 40
 		textHeight += 5
@@ -247,8 +213,58 @@
 
 		return textLine
 
+	def AutoAppendNewTextLineResize(self, text, color = FONT_COLOR, centerAlign = True):
+		textLine = ui.TextLine()
+		textLine.SetParent(self)
+		textLine.SetFontName(self.defFontName)
+		textLine.SetPackedFontColor(color)
+		textLine.SetText(text)
+		textLine.SetOutline()
+		textLine.SetFeather(False)
+		textLine.Show()
+		
+		(textWidth, textHeight) = textLine.GetTextSize()
+		textWidth += 30
+		textHeight += 10
+		if self.toolTipWidth < textWidth:
+			self.toolTipWidth = textWidth
+		
+		if centerAlign:
+			textLine.SetPosition(self.toolTipWidth/2, self.toolTipHeight)
+			textLine.SetHorizontalAlignCenter()
+		else:
+			textLine.SetPosition(10, self.toolTipHeight)
+		
+		self.childrenList.append(textLine)
+		
+		self.toolTipHeight += self.TEXT_LINE_HEIGHT
+		self.AlignHorizonalCenter()
+		return textLine
+	
+	def AutoAppendNewTextLine(self, text, color = FONT_COLOR, centerAlign = True):
+		textLine = ui.TextLine()
+		textLine.SetParent(self)
+		textLine.SetFontName(self.defFontName)
+		textLine.SetPackedFontColor(color)
+		textLine.SetText(text)
+		textLine.SetOutline()
+		textLine.SetFeather(False)
+		textLine.Show()
+		textLine.SetPosition(15, self.toolTipHeight)
+		
+		self.childrenList.append(textLine)
+		(textWidth, textHeight) = textLine.GetTextSize()
+		textWidth += 30
+		textHeight += 10
+		if self.toolTipWidth < textWidth:
+			self.toolTipWidth = textWidth
+		
+		self.toolTipHeight += textHeight
+		self.ResizeToolTipText(textWidth, self.toolTipHeight)
+		return textLine
+
 	def SetThinBoardSize(self, width, height = 12):
-		self.toolTipWidth = width
+		self.toolTipWidth = width 
 		self.toolTipHeight = height
 
 	def AppendTextLine(self, text, color = FONT_COLOR, centerAlign = True):
@@ -261,15 +277,15 @@
 		textLine.SetFeather(False)
 		if app.WJ_MULTI_TEXTLINE:
 			textLine.SetLineHeight(self.TEXT_LINE_HEIGHT)
+		textLine.Show()
 
 		if centerAlign:
-			textLine.SetPosition(self.toolTipWidth / 2, self.toolTipHeight)
+			textLine.SetPosition(self.toolTipWidth/2, self.toolTipHeight)
 			textLine.SetHorizontalAlignCenter()
+
 		else:
 			textLine.SetPosition(10, self.toolTipHeight)
 
-		textLine.Show()
-
 		self.childrenList.append(textLine)
 
 		if app.WJ_MULTI_TEXTLINE:
@@ -346,7 +362,7 @@
 				self.AppendSpace(5)
 			self.AppendTextLine(grpText.GetSplitingTextLine(description, characterLimitation, i), color)
 
-	def __AppendDescription_WesternLanguage(self, desc, color = FONT_COLOR):
+	def __AppendDescription_WesternLanguage(self, desc, color=FONT_COLOR):
 		lines = SplitDescription(desc, DESC_WESTERN_MAX_COLS)
 		if not lines:
 			return
@@ -358,6 +374,12 @@
 	def ResizeToolTip(self):
 		self.SetSize(self.toolTipWidth, self.TOOL_TIP_HEIGHT + self.toolTipHeight)
 
+	def ResizeToolTipX(self, x):
+		self.SetSize(x, self.TOOL_TIP_HEIGHT + self.toolTipHeight)
+
+	def ResizeToolTipText(self, x, y):
+		self.SetSize(x, y)
+
 	def SetTitle(self, name):
 		self.AppendTextLine(name, self.TITLE_COLOR)
 
@@ -392,6 +414,13 @@
 	def HideToolTip(self):
 		self.Hide()
 
+	if app.ENABLE_EXPRESSING_EMOTION:
+		def AppendLastTime(self, endTime):
+			leftSec = max(0, endTime - app.GetGlobalTimeStamp())
+			if leftSec > 0:
+				self.AppendSpace(5)
+				self.AppendTextLine(localeInfo.LEFT_TIME + " : " + localeInfo.SecondToDHM(leftSec), self.NORMAL_COLOR)
+
 	def OnUpdate(self):
 		if not self.followFlag:
 			return
@@ -429,105 +458,139 @@
 		self.SetPosition(x, y)
 
 class ItemToolTip(ToolTip):
-
-	ATTRIBUTE_NEED_WIDTH = {
-		23 : 230,
-		24 : 230,
-		25 : 230,
-		26 : 220,
-		27 : 210,
-
-		35 : 210,
-		36 : 210,
-		37 : 210,
-		38 : 210,
-		39 : 210,
-		40 : 210,
-		41 : 210,
-
-		42 : 220,
-		43 : 230,
-		45 : 230,
-	}
-
 	if not app.DISABLE_WOLFMAN_CREATION:
-		ANTI_FLAG_DICT = {
-			0 : item.ITEM_ANTIFLAG_WARRIOR,
-			1 : item.ITEM_ANTIFLAG_ASSASSIN,
-			2 : item.ITEM_ANTIFLAG_SURA,
-			3 : item.ITEM_ANTIFLAG_SHAMAN,
-			4 : item.ITEM_ANTIFLAG_WOLFMAN,
-		}
+		CHARACTER_NAMES = (
+			localeInfo.TOOLTIP_WARRIOR,
+			localeInfo.TOOLTIP_ASSASSIN,
+			localeInfo.TOOLTIP_SURA,
+			localeInfo.TOOLTIP_SHAMAN,
+			localeInfo.TOOLTIP_WOLFMAN
+		)
 	else:
-		ANTI_FLAG_DICT = {
-			0 : item.ITEM_ANTIFLAG_WARRIOR,
-			1 : item.ITEM_ANTIFLAG_ASSASSIN,
-			2 : item.ITEM_ANTIFLAG_SURA,
-			3 : item.ITEM_ANTIFLAG_SHAMAN,
-		}
-
-	FONT_COLOR = grp.GenerateColor(0.7607, 0.7607, 0.7607, 1.0)
-
-	if app.ENABLE_APPLY_RANDOM:
-		APPLY_RANDOM_TEXT_COLOR = 0xff7AF6D4
-
-	if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-		REFINE_ELEMENT_BONUS_COLOR = -7751539
-
-		REFINE_ELEMENT_COLOR_DICT = {
-			item.APPLY_ENCHANT_ELECT : 4280530920L,
-			item.APPLY_ENCHANT_FIRE : 4292692027L,
-			item.APPLY_ENCHANT_ICE : 4282215647L,
-			item.APPLY_ENCHANT_WIND : 4281847585L,
-			item.APPLY_ENCHANT_EARTH : 4294232596L,
-			item.APPLY_ENCHANT_DARK : 4290195180L
-		}
+		CHARACTER_NAMES = (
+			localeInfo.TOOLTIP_WARRIOR,
+			localeInfo.TOOLTIP_ASSASSIN,
+			localeInfo.TOOLTIP_SURA,
+			localeInfo.TOOLTIP_SHAMAN,
+		)
 
-		REFINE_ELEMENT_INDEX_APPLY_TYPE = 0
-		REFINE_ELEMENT_INDEX_GRADE = 1
-		REFINE_ELEMENT_INDEX_VALUE = 2
-		REFINE_ELEMENT_INDEX_BONUS = 3
-		REFINE_ELEMENT_INDEX_MAX = item.REFINE_ELEMENT_MAX
+	CHARACTER_COUNT = len(CHARACTER_NAMES)
+	WEAR_NAMES = ( 
+		localeInfo.TOOLTIP_ARMOR, 
+		localeInfo.TOOLTIP_HELMET, 
+		localeInfo.TOOLTIP_SHOES, 
+		localeInfo.TOOLTIP_WRISTLET, 
+		localeInfo.TOOLTIP_WEAPON, 
+		localeInfo.TOOLTIP_NECK,
+		localeInfo.TOOLTIP_EAR,
+		localeInfo.TOOLTIP_UNIQUE,
+		localeInfo.TOOLTIP_SHIELD,
+		localeInfo.TOOLTIP_ARROW,
+	)
+	WEAR_COUNT = len(WEAR_NAMES)
 
-		REFINE_ELEMENT_TITLE_TEXT_GAP = 10
+	if not app.DISABLE_WOLFMAN_CREATION:
+		AFFECT_DICT = {
+			item.APPLY_MAX_HP : localeInfo.TOOLTIP_MAX_HP,
+			item.APPLY_MAX_SP : localeInfo.TOOLTIP_MAX_SP,
+			item.APPLY_CON : localeInfo.TOOLTIP_CON,
+			item.APPLY_INT : localeInfo.TOOLTIP_INT,
+			item.APPLY_STR : localeInfo.TOOLTIP_STR,
+			item.APPLY_DEX : localeInfo.TOOLTIP_DEX,
+			item.APPLY_ATT_SPEED : localeInfo.TOOLTIP_ATT_SPEED,
+			item.APPLY_MOV_SPEED : localeInfo.TOOLTIP_MOV_SPEED,
+			item.APPLY_CAST_SPEED : localeInfo.TOOLTIP_CAST_SPEED,
+			item.APPLY_HP_REGEN : localeInfo.TOOLTIP_HP_REGEN,
+			item.APPLY_SP_REGEN : localeInfo.TOOLTIP_SP_REGEN,
+			item.APPLY_POISON_PCT : localeInfo.TOOLTIP_APPLY_POISON_PCT,
+			item.APPLY_BLEEDING_PCT : localeInfo.TOOLTIP_APPLY_BLEEDING_PCT,
+			item.APPLY_STUN_PCT : localeInfo.TOOLTIP_APPLY_STUN_PCT,
+			item.APPLY_SLOW_PCT : localeInfo.TOOLTIP_APPLY_SLOW_PCT,
+			item.APPLY_CRITICAL_PCT : localeInfo.TOOLTIP_APPLY_CRITICAL_PCT,
+			item.APPLY_PENETRATE_PCT : localeInfo.TOOLTIP_APPLY_PENETRATE_PCT,
 
-	def __init__(self, *args, **kwargs):
-		ToolTip.__init__(self, *args, **kwargs)
+			item.APPLY_ATTBONUS_WARRIOR : localeInfo.TOOLTIP_APPLY_ATTBONUS_WARRIOR,
+			item.APPLY_ATTBONUS_ASSASSIN : localeInfo.TOOLTIP_APPLY_ATTBONUS_ASSASSIN,
+			item.APPLY_ATTBONUS_SURA : localeInfo.TOOLTIP_APPLY_ATTBONUS_SURA,
+			item.APPLY_ATTBONUS_SHAMAN : localeInfo.TOOLTIP_APPLY_ATTBONUS_SHAMAN,
+			item.APPLY_ATTBONUS_MONSTER : localeInfo.TOOLTIP_APPLY_ATTBONUS_MONSTER,
 
-		if not app.DISABLE_WOLFMAN_CREATION:
-			self.CHARACTER_NAMES = (
-				localeInfo.TOOLTIP_WARRIOR,
-				localeInfo.TOOLTIP_ASSASSIN,
-				localeInfo.TOOLTIP_SURA,
-				localeInfo.TOOLTIP_SHAMAN,
-				localeInfo.TOOLTIP_WOLFMAN
-			)
-		else:
-			self.CHARACTER_NAMES = (
-				localeInfo.TOOLTIP_WARRIOR,
-				localeInfo.TOOLTIP_ASSASSIN,
-				localeInfo.TOOLTIP_SURA,
-				localeInfo.TOOLTIP_SHAMAN,
-			)
+			item.APPLY_ATTBONUS_HUMAN : localeInfo.TOOLTIP_APPLY_ATTBONUS_HUMAN,
+			item.APPLY_ATTBONUS_ANIMAL : localeInfo.TOOLTIP_APPLY_ATTBONUS_ANIMAL,
+			item.APPLY_ATTBONUS_ORC : localeInfo.TOOLTIP_APPLY_ATTBONUS_ORC,
+			item.APPLY_ATTBONUS_MILGYO : localeInfo.TOOLTIP_APPLY_ATTBONUS_MILGYO,
+			item.APPLY_ATTBONUS_UNDEAD : localeInfo.TOOLTIP_APPLY_ATTBONUS_UNDEAD,
+			item.APPLY_ATTBONUS_DEVIL : localeInfo.TOOLTIP_APPLY_ATTBONUS_DEVIL,
+			item.APPLY_STEAL_HP : localeInfo.TOOLTIP_APPLY_STEAL_HP,
+			item.APPLY_STEAL_SP : localeInfo.TOOLTIP_APPLY_STEAL_SP,
+			item.APPLY_MANA_BURN_PCT : localeInfo.TOOLTIP_APPLY_MANA_BURN_PCT,
+			item.APPLY_DAMAGE_SP_RECOVER : localeInfo.TOOLTIP_APPLY_DAMAGE_SP_RECOVER,
+			item.APPLY_BLOCK : localeInfo.TOOLTIP_APPLY_BLOCK,
+			item.APPLY_DODGE : localeInfo.TOOLTIP_APPLY_DODGE,
+			item.APPLY_RESIST_SWORD : localeInfo.TOOLTIP_APPLY_RESIST_SWORD,
+			item.APPLY_RESIST_TWOHAND : localeInfo.TOOLTIP_APPLY_RESIST_TWOHAND,
+			item.APPLY_RESIST_DAGGER : localeInfo.TOOLTIP_APPLY_RESIST_DAGGER,
+			item.APPLY_RESIST_BELL : localeInfo.TOOLTIP_APPLY_RESIST_BELL,
+			item.APPLY_RESIST_FAN : localeInfo.TOOLTIP_APPLY_RESIST_FAN,
+			item.APPLY_RESIST_BOW : localeInfo.TOOLTIP_RESIST_BOW,
+			item.APPLY_RESIST_FIRE : localeInfo.TOOLTIP_RESIST_FIRE,
+			item.APPLY_RESIST_ELEC : localeInfo.TOOLTIP_RESIST_ELEC,
+			item.APPLY_RESIST_MAGIC : localeInfo.TOOLTIP_RESIST_MAGIC,
+			item.APPLY_RESIST_WIND : localeInfo.TOOLTIP_APPLY_RESIST_WIND,
+			item.APPLY_REFLECT_MELEE : localeInfo.TOOLTIP_APPLY_REFLECT_MELEE,
+			item.APPLY_REFLECT_CURSE : localeInfo.TOOLTIP_APPLY_REFLECT_CURSE,
+			item.APPLY_POISON_REDUCE : localeInfo.TOOLTIP_APPLY_POISON_REDUCE,
+			item.APPLY_BLEEDING_REDUCE : localeInfo.TOOLTIP_APPLY_BLEEDING_REDUCE,
+			item.APPLY_KILL_SP_RECOVER : localeInfo.TOOLTIP_APPLY_KILL_SP_RECOVER,
+			item.APPLY_EXP_DOUBLE_BONUS : localeInfo.TOOLTIP_APPLY_EXP_DOUBLE_BONUS,
+			item.APPLY_GOLD_DOUBLE_BONUS : localeInfo.TOOLTIP_APPLY_GOLD_DOUBLE_BONUS,
+			item.APPLY_ITEM_DROP_BONUS : localeInfo.TOOLTIP_APPLY_ITEM_DROP_BONUS,
+			item.APPLY_POTION_BONUS : localeInfo.TOOLTIP_APPLY_POTION_BONUS,
+			item.APPLY_KILL_HP_RECOVER : localeInfo.TOOLTIP_APPLY_KILL_HP_RECOVER,
+			item.APPLY_IMMUNE_STUN : localeInfo.TOOLTIP_APPLY_IMMUNE_STUN,
+			item.APPLY_IMMUNE_SLOW : localeInfo.TOOLTIP_APPLY_IMMUNE_SLOW,
+			item.APPLY_IMMUNE_FALL : localeInfo.TOOLTIP_APPLY_IMMUNE_FALL,
+			item.APPLY_BOW_DISTANCE : localeInfo.TOOLTIP_BOW_DISTANCE,
+			item.APPLY_DEF_GRADE_BONUS : localeInfo.TOOLTIP_DEF_GRADE,
+			item.APPLY_ATT_GRADE_BONUS : localeInfo.TOOLTIP_ATT_GRADE,
+			item.APPLY_MAGIC_ATT_GRADE : localeInfo.TOOLTIP_MAGIC_ATT_GRADE,
+			item.APPLY_MAGIC_DEF_GRADE : localeInfo.TOOLTIP_MAGIC_DEF_GRADE,
+			item.APPLY_MAX_STAMINA : localeInfo.TOOLTIP_MAX_STAMINA,
+			item.APPLY_MALL_ATTBONUS : localeInfo.TOOLTIP_MALL_ATTBONUS,
+			item.APPLY_MALL_DEFBONUS : localeInfo.TOOLTIP_MALL_DEFBONUS,
+			item.APPLY_MALL_EXPBONUS : localeInfo.TOOLTIP_MALL_EXPBONUS,
+			item.APPLY_MALL_ITEMBONUS : localeInfo.TOOLTIP_MALL_ITEMBONUS,
+			item.APPLY_MALL_GOLDBONUS : localeInfo.TOOLTIP_MALL_GOLDBONUS,
+			item.APPLY_SKILL_DAMAGE_BONUS : localeInfo.TOOLTIP_SKILL_DAMAGE_BONUS,
+			item.APPLY_NORMAL_HIT_DAMAGE_BONUS : localeInfo.TOOLTIP_NORMAL_HIT_DAMAGE_BONUS,
+			item.APPLY_SKILL_DEFEND_BONUS : localeInfo.TOOLTIP_SKILL_DEFEND_BONUS,
+			item.APPLY_NORMAL_HIT_DEFEND_BONUS : localeInfo.TOOLTIP_NORMAL_HIT_DEFEND_BONUS,
+			item.APPLY_PC_BANG_EXP_BONUS : localeInfo.TOOLTIP_MALL_EXPBONUS_P_STATIC,
+			item.APPLY_PC_BANG_DROP_BONUS : localeInfo.TOOLTIP_MALL_ITEMBONUS_P_STATIC,
+			item.APPLY_RESIST_WARRIOR : localeInfo.TOOLTIP_APPLY_RESIST_WARRIOR,
+			item.APPLY_RESIST_ASSASSIN : localeInfo.TOOLTIP_APPLY_RESIST_ASSASSIN,
+			item.APPLY_RESIST_SURA : localeInfo.TOOLTIP_APPLY_RESIST_SURA,
+			item.APPLY_RESIST_SHAMAN : localeInfo.TOOLTIP_APPLY_RESIST_SHAMAN,
+			item.APPLY_MAX_HP_PCT : localeInfo.TOOLTIP_APPLY_MAX_HP_PCT,
+			item.APPLY_MAX_SP_PCT : localeInfo.TOOLTIP_APPLY_MAX_SP_PCT,
+			item.APPLY_ENERGY : localeInfo.TOOLTIP_ENERGY,
+			item.APPLY_COSTUME_ATTR_BONUS : localeInfo.TOOLTIP_COSTUME_ATTR_BONUS,
 
-		self.CHARACTER_COUNT = len(self.CHARACTER_NAMES)
-		self.WEAR_NAMES = (
-			localeInfo.TOOLTIP_ARMOR,
-			localeInfo.TOOLTIP_HELMET,
-			localeInfo.TOOLTIP_SHOES,
-			localeInfo.TOOLTIP_WRISTLET,
-			localeInfo.TOOLTIP_WEAPON,
-			localeInfo.TOOLTIP_NECK,
-			localeInfo.TOOLTIP_EAR,
-			localeInfo.TOOLTIP_UNIQUE,
-			localeInfo.TOOLTIP_SHIELD,
-			localeInfo.TOOLTIP_ARROW,
-		)
-		if app.ENABLE_GLOVE_SYSTEM:
-			self.WEAR_NAMES += (localeInfo.TOOLTIP_GLOVE,)
-		self.WEAR_COUNT = len(self.WEAR_NAMES)
+			item.APPLY_MAGIC_ATTBONUS_PER : localeInfo.TOOLTIP_MAGIC_ATTBONUS_PER,
+			item.APPLY_MELEE_MAGIC_ATTBONUS_PER : localeInfo.TOOLTIP_MELEE_MAGIC_ATTBONUS_PER,
+			item.APPLY_RESIST_ICE : localeInfo.TOOLTIP_RESIST_ICE,
+			item.APPLY_RESIST_EARTH : localeInfo.TOOLTIP_RESIST_EARTH,
+			item.APPLY_RESIST_DARK : localeInfo.TOOLTIP_RESIST_DARK,
+			item.APPLY_ANTI_CRITICAL_PCT : localeInfo.TOOLTIP_ANTI_CRITICAL_PCT,
+			item.APPLY_ANTI_PENETRATE_PCT : localeInfo.TOOLTIP_ANTI_PENETRATE_PCT,
 
-		self.AFFECT_DICT = {
+			item.APPLY_ATTBONUS_WOLFMAN : localeInfo.TOOLTIP_APPLY_ATTBONUS_WOLFMAN,
+			item.APPLY_RESIST_WOLFMAN : localeInfo.TOOLTIP_APPLY_RESIST_WOLFMAN,
+			item.APPLY_RESIST_CLAW : localeInfo.TOOLTIP_APPLY_RESIST_CLAW,
+			#item.APPLY_ACCEDRAIN_RATE : localeInfo.TOOLTIP_APPLY_ACCEDRAIN_RATE,
+		}
+	else:
+		AFFECT_DICT = {
 			item.APPLY_MAX_HP : localeInfo.TOOLTIP_MAX_HP,
 			item.APPLY_MAX_SP : localeInfo.TOOLTIP_MAX_SP,
 			item.APPLY_CON : localeInfo.TOOLTIP_CON,
@@ -540,7 +603,6 @@
 			item.APPLY_HP_REGEN : localeInfo.TOOLTIP_HP_REGEN,
 			item.APPLY_SP_REGEN : localeInfo.TOOLTIP_SP_REGEN,
 			item.APPLY_POISON_PCT : localeInfo.TOOLTIP_APPLY_POISON_PCT,
-			item.APPLY_BLEEDING_PCT : localeInfo.TOOLTIP_APPLY_BLEEDING_PCT,
 			item.APPLY_STUN_PCT : localeInfo.TOOLTIP_APPLY_STUN_PCT,
 			item.APPLY_SLOW_PCT : localeInfo.TOOLTIP_APPLY_SLOW_PCT,
 			item.APPLY_CRITICAL_PCT : localeInfo.TOOLTIP_APPLY_CRITICAL_PCT,
@@ -577,7 +639,6 @@
 			item.APPLY_REFLECT_MELEE : localeInfo.TOOLTIP_APPLY_REFLECT_MELEE,
 			item.APPLY_REFLECT_CURSE : localeInfo.TOOLTIP_APPLY_REFLECT_CURSE,
 			item.APPLY_POISON_REDUCE : localeInfo.TOOLTIP_APPLY_POISON_REDUCE,
-			item.APPLY_BLEEDING_REDUCE : localeInfo.TOOLTIP_APPLY_BLEEDING_REDUCE,
 			item.APPLY_KILL_SP_RECOVER : localeInfo.TOOLTIP_APPLY_KILL_SP_RECOVER,
 			item.APPLY_EXP_DOUBLE_BONUS : localeInfo.TOOLTIP_APPLY_EXP_DOUBLE_BONUS,
 			item.APPLY_GOLD_DOUBLE_BONUS : localeInfo.TOOLTIP_APPLY_GOLD_DOUBLE_BONUS,
@@ -622,239 +683,83 @@
 			item.APPLY_ANTI_PENETRATE_PCT : localeInfo.TOOLTIP_ANTI_PENETRATE_PCT,
 		}
 
+	if app.ENABLE_MAGIC_REDUCTION:
+		AFFECT_DICT[item.APPLY_RESIST_MAGIC_REDUCTION] = localeInfo.TOOLTIP_RESIST_MAGIC_REDUCTION
+
+	# AFFECT_DICT[item.APPLY_ACCEDRAIN_RATE] = localeInfo.TOOLTIP_APPLY_ACCEDRAIN_RATE
+
+	if app.ENABLE_ELEMENT_ADD:
+		AFFECT_DICT[item.APPLY_ENCHANT_ELEC] = localeInfo.TOOLTIP_APPLY_ENCHANT_ELECT
+		AFFECT_DICT[item.APPLY_ENCHANT_FIRE] = localeInfo.TOOLTIP_APPLY_ENCHANT_FIRE
+		AFFECT_DICT[item.APPLY_ENCHANT_ICE] = localeInfo.TOOLTIP_APPLY_ENCHANT_ICE
+		AFFECT_DICT[item.APPLY_ENCHANT_WIND] = localeInfo.TOOLTIP_APPLY_ENCHANT_WIND
+		AFFECT_DICT[item.APPLY_ENCHANT_EARTH] = localeInfo.TOOLTIP_APPLY_ENCHANT_EARTH
+		AFFECT_DICT[item.APPLY_ENCHANT_DARK] = localeInfo.TOOLTIP_APPLY_ENCHANT_DARK
+		AFFECT_DICT[item.APPLY_ATTBONUS_CZ] = localeInfo.TOOLTIP_APPLY_ATTBONUS_CZ
+		AFFECT_DICT[item.APPLY_ATTBONUS_INSECT] = localeInfo.TOOLTIP_APPLY_ATTBONUS_INSECT
+		AFFECT_DICT[item.APPLY_ATTBONUS_DESERT] = localeInfo.TOOLTIP_APPLY_ATTBONUS_DESERT
+
+		AFFECT_DICT[item.APPLY_RESIST_SWORD_REDUCTION] = localeInfo.TOOLTIP_APPLY_ATTBONUS_SWORD
+		AFFECT_DICT[item.APPLY_RESIST_TWOHAND_REDUCTION]= localeInfo.TOOLTIP_APPLY_ATTBONUS_TWOHAND
+		AFFECT_DICT[item.APPLY_RESIST_DAGGER_REDUCTION] = localeInfo.TOOLTIP_APPLY_ATTBONUS_DAGGER
+		AFFECT_DICT[item.APPLY_RESIST_BELL_REDUCTION] = localeInfo.TOOLTIP_APPLY_ATTBONUS_BELL
+		AFFECT_DICT[item.APPLY_RESIST_FAN_REDUCTION] = localeInfo.TOOLTIP_APPLY_ATTBONUS_FAN
+		AFFECT_DICT[item.APPLY_RESIST_BOW_REDUCTION] = localeInfo.TOOLTIP_APPLY_ATTBONUS_BOW
 		if not app.DISABLE_WOLFMAN_CREATION:
-			self.AFFECT_DICT[item.APPLY_ATTBONUS_WOLFMAN] = localeInfo.TOOLTIP_APPLY_ATTBONUS_WOLFMAN
-			self.AFFECT_DICT[item.APPLY_RESIST_WOLFMAN] = localeInfo.TOOLTIP_APPLY_RESIST_WOLFMAN
-			self.AFFECT_DICT[item.APPLY_RESIST_CLAW] = localeInfo.TOOLTIP_APPLY_RESIST_CLAW
-
-		#if app.ENABLE_ACCE_COSTUME_SYSTEM:
-		self.AFFECT_DICT[item.APPLY_ACCEDRAIN_RATE] = localeInfo.TOOLTIP_APPLY_ACCEDRAIN_RATE
-		#if app.ENABLE_MAGIC_REDUCTION:
-		self.AFFECT_DICT[item.APPLY_RESIST_MAGIC_REDUCTION] = localeInfo.TOOLTIP_RESIST_MAGIC_REDUCTION
-
-		#f app.ENABLE_ELEMENT_ADD:
-		self.AFFECT_DICT[item.APPLY_ENCHANT_ELECT] = localeInfo.TOOLTIP_APPLY_ENCHANT_ELECT
-		self.AFFECT_DICT[item.APPLY_ENCHANT_FIRE] = localeInfo.TOOLTIP_APPLY_ENCHANT_FIRE
-		self.AFFECT_DICT[item.APPLY_ENCHANT_ICE] = localeInfo.TOOLTIP_APPLY_ENCHANT_ICE
-		self.AFFECT_DICT[item.APPLY_ENCHANT_WIND] = localeInfo.TOOLTIP_APPLY_ENCHANT_WIND
-		self.AFFECT_DICT[item.APPLY_ENCHANT_EARTH] = localeInfo.TOOLTIP_APPLY_ENCHANT_EARTH
-		self.AFFECT_DICT[item.APPLY_ENCHANT_DARK] = localeInfo.TOOLTIP_APPLY_ENCHANT_DARK
-
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_CZ] = localeInfo.TOOLTIP_APPLY_ATTBONUS_CZ
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_INSECT] = localeInfo.TOOLTIP_APPLY_ATTBONUS_INSECT
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_DESERT] = localeInfo.TOOLTIP_APPLY_ATTBONUS_DESERT
-
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_SWORD] = localeInfo.TOOLTIP_APPLY_ATTBONUS_SWORD
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_TWOHAND] = localeInfo.TOOLTIP_APPLY_ATTBONUS_TWOHAND
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_DAGGER] = localeInfo.TOOLTIP_APPLY_ATTBONUS_DAGGER
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_BELL] = localeInfo.TOOLTIP_APPLY_ATTBONUS_BELL
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_FAN] = localeInfo.TOOLTIP_APPLY_ATTBONUS_FAN
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_BOW] = localeInfo.TOOLTIP_APPLY_ATTBONUS_BOW
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_CLAW] = localeInfo.TOOLTIP_APPLY_ATTBONUS_CLAW
-
-		self.AFFECT_DICT[item.APPLY_RESIST_HUMAN] = localeInfo.TOOLTIP_APPLY_RESIST_HUMAN
-		self.AFFECT_DICT[item.APPLY_RESIST_MOUNT_FALL] = localeInfo.TOOLTIP_APPLY_RESIST_MOUNT_FALL
-
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_SAMYEON] = localeInfo.TOOLTIP_SKILL_DAMAGE_SAMYEON
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_TANHWAN] = localeInfo.TOOLTIP_SKILL_DAMAGE_TANHWAN
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_PALBANG] = localeInfo.TOOLTIP_SKILL_DAMAGE_PALBANG
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_GIGONGCHAM] = localeInfo.TOOLTIP_SKILL_DAMAGE_GIGONGCHAM
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_GYOKSAN] = localeInfo.TOOLTIP_SKILL_DAMAGE_GYOKSAN
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_GEOMPUNG] = localeInfo.TOOLTIP_SKILL_DAMAGE_GEOMPUNG
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_AMSEOP] = localeInfo.TOOLTIP_SKILL_DAMAGE_AMSEOP
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_GUNGSIN] = localeInfo.TOOLTIP_SKILL_DAMAGE_GUNGSIN
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_CHARYUN] = localeInfo.TOOLTIP_SKILL_DAMAGE_CHARYUN
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_SANGONG] = localeInfo.TOOLTIP_SKILL_DAMAGE_SANGONG
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_YEONSA] = localeInfo.TOOLTIP_SKILL_DAMAGE_YEONSA
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_KWANKYEOK] = localeInfo.TOOLTIP_SKILL_DAMAGE_KWANKYEOK
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_GIGUNG] = localeInfo.TOOLTIP_SKILL_DAMAGE_GIGUNG
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_HWAJO] = localeInfo.TOOLTIP_SKILL_DAMAGE_HWAJO
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_SWAERYUNG] = localeInfo.TOOLTIP_SKILL_DAMAGE_SWAERYUNG
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_YONGKWON] = localeInfo.TOOLTIP_SKILL_DAMAGE_YONGKWON
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_PABEOB] = localeInfo.TOOLTIP_SKILL_DAMAGE_PABEOB
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_MARYUNG] = localeInfo.TOOLTIP_SKILL_DAMAGE_MARYUNG
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_HWAYEOMPOK] = localeInfo.TOOLTIP_SKILL_DAMAGE_HWAYEOMPOK
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_MAHWAN] = localeInfo.TOOLTIP_SKILL_DAMAGE_MAHWAN
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_BIPABU] = localeInfo.TOOLTIP_SKILL_DAMAGE_BIPABU
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_YONGBI] = localeInfo.TOOLTIP_SKILL_DAMAGE_YONGBI
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_PAERYONG] = localeInfo.TOOLTIP_SKILL_DAMAGE_PAERYONG
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_NOEJEON] = localeInfo.TOOLTIP_SKILL_DAMAGE_NOEJEON
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_BYEURAK] = localeInfo.TOOLTIP_SKILL_DAMAGE_BYEURAK
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_CHAIN] = localeInfo.TOOLTIP_SKILL_DAMAGE_CHAIN
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_CHAYEOL] = localeInfo.TOOLTIP_SKILL_DAMAGE_CHAYEOL
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_SALPOONG] = localeInfo.TOOLTIP_SKILL_DAMAGE_SALPOONG
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_GONGDAB] = localeInfo.TOOLTIP_SKILL_DAMAGE_GONGDAB
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_PASWAE] = localeInfo.TOOLTIP_SKILL_DAMAGE_PASWAE
-
-		self.AFFECT_DICT[item.APPLY_NORMAL_HIT_DEFEND_BONUS_BOSS_OR_MORE] = localeInfo.TOOLTIP_NORMAL_HIT_DEFEND_BONUS_BOSS_OR_MORE
-		self.AFFECT_DICT[item.APPLY_SKILL_DEFEND_BONUS_BOSS_OR_MORE] = localeInfo.TOOLTIP_SKILL_DEFEND_BONUS_BOSS_OR_MORE
-		self.AFFECT_DICT[item.APPLY_NORMAL_HIT_DAMAGE_BONUS_BOSS_OR_MORE] = localeInfo.TOOLTIP_NORMAL_HIT_DAMAGE_BONUS_BOSS_OR_MORE
-		self.AFFECT_DICT[item.APPLY_SKILL_DAMAGE_BONUS_BOSS_OR_MORE] = localeInfo.TOOLTIP_SKILL_DAMAGE_BONUS_BOSS_OR_MORE
-
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_ENCHANT_FIRE] = localeInfo.TOOLTIP_HIT_BUFF_ENCHANT_FIRE
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_ENCHANT_ICE] = localeInfo.TOOLTIP_HIT_BUFF_ENCHANT_ICE
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_ENCHANT_ELEC] = localeInfo.TOOLTIP_HIT_BUFF_ENCHANT_ELEC
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_ENCHANT_DARK] = localeInfo.TOOLTIP_HIT_BUFF_ENCHANT_DARK
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_ENCHANT_WIND] = localeInfo.TOOLTIP_HIT_BUFF_ENCHANT_WIND
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_ENCHANT_EARTH] = localeInfo.TOOLTIP_HIT_BUFF_ENCHANT_EARTH
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_RESIST_FIRE] = localeInfo.TOOLTIP_HIT_BUFF_RESIST_FIRE
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_RESIST_ICE] = localeInfo.TOOLTIP_HIT_BUFF_RESIST_ICE
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_RESIST_ELEC] = localeInfo.TOOLTIP_HIT_BUFF_RESIST_ELEC
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_RESIST_WIND] = localeInfo.TOOLTIP_HIT_BUFF_RESIST_WIND
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_RESIST_DARK] = localeInfo.TOOLTIP_HIT_BUFF_RESIST_DARK
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_RESIST_EARTH] = localeInfo.TOOLTIP_HIT_BUFF_RESIST_EARTH
-
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_CHEONGRANG_MOV_SPEED] = localeInfo.TOOLTIP_USE_SKILL_CHEONGRANG_MOV_SPEED
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_CHEONGRANG_CASTING_SPEED] = localeInfo.TOOLTIP_USE_SKILL_CHEONGRANG_CASTING_SPEED
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_CHAYEOL_CRITICAL_PCT] = localeInfo.TOOLTIP_USE_SKILL_CHAYEOL_CRITICAL_PCT
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_SANGONG_ATT_GRADE_BONUS] = localeInfo.TOOLTIP_USE_SKILL_SANGONG_ATT_GRADE_BONUS
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_GIGUNG_ATT_GRADE_BONUS] = localeInfo.TOOLTIP_USE_SKILL_GIGUNG_ATT_GRADE_BONUS
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_JEOKRANG_DEF_BONUS] = localeInfo.TOOLTIP_USE_SKILL_JEOKRANG_DEF_BONUS
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_GWIGEOM_DEF_BONUS] = localeInfo.TOOLTIP_USE_SKILL_GWIGEOM_DEF_BONUS
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_TERROR_ATT_GRADE_BONUS] = localeInfo.TOOLTIP_USE_SKILL_TERROR_ATT_GRADE_BONUS
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_MUYEONG_ATT_GRADE_BONUS] = localeInfo.TOOLTIP_USE_SKILL_MUYEONG_ATT_GRADE_BONUS
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_MANASHILED_CASTING_SPEED] = localeInfo.TOOLTIP_USE_SKILL_MANASHILED_CASTING_SPEED
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_HOSIN_DEF_BONUS] = localeInfo.TOOLTIP_USE_SKILL_HOSIN_DEF_BONUS
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_GICHEON_ATT_GRADE_BONUS] = localeInfo.TOOLTIP_USE_SKILL_GICHEON_ATT_GRADE_BONUS
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_JEONGEOP_ATT_GRADE_BONUS] = localeInfo.TOOLTIP_USE_SKILL_JEONGEOP_ATT_GRADE_BONUS
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_JEUNGRYEOK_DEF_BONUS] = localeInfo.TOOLTIP_USE_SKILL_JEUNGRYEOK_DEF_BONUS
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_GIHYEOL_ATT_GRADE_BONUS] = localeInfo.TOOLTIP_USE_SKILL_GIHYEOL_ATT_GRADE_BONUS
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_CHUNKEON_CASTING_SPEED] = localeInfo.TOOLTIP_USE_SKILL_CHUNKEON_CASTING_SPEED
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_NOEGEOM_ATT_GRADE_BONUS] = localeInfo.TOOLTIP_USE_SKILL_NOEGEOM_ATT_GRADE_BONUS
-
-		self.AFFECT_DICT[item.APPLY_SKILL_DURATION_INCREASE_EUNHYUNG] = localeInfo.TOOLTIP_SKILL_DURATION_INCREASE_EUNHYUNG
-		self.AFFECT_DICT[item.APPLY_SKILL_DURATION_INCREASE_GYEONGGONG] = localeInfo.TOOLTIP_SKILL_DURATION_INCREASE_GYEONGGONG
-		self.AFFECT_DICT[item.APPLY_SKILL_DURATION_INCREASE_GEOMKYUNG] = localeInfo.TOOLTIP_SKILL_DURATION_INCREASE_GEOMKYUNG
-		self.AFFECT_DICT[item.APPLY_SKILL_DURATION_INCREASE_JEOKRANG] = localeInfo.TOOLTIP_SKILL_DURATION_INCREASE_JEOKRANG
-
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_PALBANG_HP_ABSORB] = localeInfo.TOOLTIP_USE_SKILL_PALBANG_HP_ABSORB
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_AMSEOP_HP_ABSORB] = localeInfo.TOOLTIP_USE_SKILL_AMSEOP_HP_ABSORB
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_YEONSA_HP_ABSORB] = localeInfo.TOOLTIP_USE_SKILL_YEONSA_HP_ABSORB
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_YONGBI_HP_ABSORB] = localeInfo.TOOLTIP_USE_SKILL_YONGBI_HP_ABSORB
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_CHAIN_HP_ABSORB] = localeInfo.TOOLTIP_USE_SKILL_CHAIN_HP_ABSORB
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_PASWAE_SP_ABSORB] = localeInfo.TOOLTIP_USE_SKILL_PASWAE_SP_ABSORB
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_GIGONGCHAM_STUN] = localeInfo.TOOLTIP_USE_SKILL_GIGONGCHAM_STUN
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_CHARYUN_STUN] = localeInfo.TOOLTIP_USE_SKILL_CHARYUN_STUN
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_PABEOB_STUN] = localeInfo.TOOLTIP_USE_SKILL_PABEOB_STUN
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_MAHWAN_STUN] = localeInfo.TOOLTIP_USE_SKILL_MAHWAN_STUN
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_GONGDAB_STUN] = localeInfo.TOOLTIP_USE_SKILL_GONGDAB_STUN
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_SAMYEON_STUN] = localeInfo.TOOLTIP_USE_SKILL_SAMYEON_STUN
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_GYOKSAN_KNOCKBACK] = localeInfo.TOOLTIP_USE_SKILL_GYOKSAN_KNOCKBACK
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_SEOMJEON_KNOCKBACK] = localeInfo.TOOLTIP_USE_SKILL_SEOMJEON_KNOCKBACK
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_SWAERYUNG_KNOCKBACK] = localeInfo.TOOLTIP_USE_SKILL_SWAERYUNG_KNOCKBACK
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_HWAYEOMPOK_KNOCKBACK] = localeInfo.TOOLTIP_USE_SKILL_HWAYEOMPOK_KNOCKBACK
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_GONGDAB_KNOCKBACK] = localeInfo.TOOLTIP_USE_SKILL_GONGDAB_KNOCKBACK
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_KWANKYEOK_KNOCKBACK] = localeInfo.TOOLTIP_USE_SKILL_KWANKYEOK_KNOCKBACK
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_SAMYEON_NEXT_COOLTIME_DECREASE_10PER] = localeInfo.TOOLTIP_USE_SKILL_SAMYEON_NEXT_COOLTIME_DECREASE_10PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_GEOMPUNG_NEXT_COOLTIME_DECREASE_10PER] = localeInfo.TOOLTIP_USE_SKILL_GEOMPUNG_NEXT_COOLTIME_DECREASE_10PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_GUNGSIN_NEXT_COOLTIME_DECREASE_10PER] = localeInfo.TOOLTIP_USE_SKILL_GUNGSIN_NEXT_COOLTIME_DECREASE_10PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_KWANKYEOK_NEXT_COOLTIME_DECREASE_10PER] = localeInfo.TOOLTIP_USE_SKILL_KWANKYEOK_NEXT_COOLTIME_DECREASE_10PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_YONGKWON_NEXT_COOLTIME_DECREASE_10PER] = localeInfo.TOOLTIP_USE_SKILL_YONGKWON_NEXT_COOLTIME_DECREASE_10PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_MARYUNG_NEXT_COOLTIME_DECREASE_10PER] = localeInfo.TOOLTIP_USE_SKILL_MARYUNG_NEXT_COOLTIME_DECREASE_10PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_BIPABU_NEXT_COOLTIME_DECREASE_10PER] = localeInfo.TOOLTIP_USE_SKILL_BIPABU_NEXT_COOLTIME_DECREASE_10PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_NOEJEON_NEXT_COOLTIME_DECREASE_10PER] = localeInfo.TOOLTIP_USE_SKILL_NOEJEON_NEXT_COOLTIME_DECREASE_10PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_SALPOONG_NEXT_COOLTIME_DECREASE_10PER] = localeInfo.TOOLTIP_USE_SKILL_SALPOONG_NEXT_COOLTIME_DECREASE_10PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_PASWAE_NEXT_COOLTIME_DECREASE_10PER] = localeInfo.TOOLTIP_USE_SKILL_PASWAE_NEXT_COOLTIME_DECREASE_10PER
-
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_STONE] = localeInfo.TOOLTIP_ATTBONUS_STONE
-
-		self.AFFECT_DICT[item.APPLY_DAMAGE_HP_RECOVERY] = localeInfo.TOOLTIP_DAMAGE_HP_RECOVERY
-		self.AFFECT_DICT[item.APPLY_DAMAGE_SP_RECOVERY] = localeInfo.TOOLTIP_DAMAGE_SP_RECOVERY
-
-		self.AFFECT_DICT[item.APPLY_ALIGNMENT_DAMAGE_BONUS] = localeInfo.TOOLTIP_ALIGNMENT_DAMAGE_BONUS
-		self.AFFECT_DICT[item.APPLY_NORMAL_DAMAGE_GUARD] = localeInfo.TOOLTIP_NORMAL_DAMAGE_GUARD
-		self.AFFECT_DICT[item.APPLY_MORE_THEN_HP90_DAMAGE_REDUCE] = localeInfo.TOOLTIP_MORE_THEN_HP90_DAMAGE_REDUCE
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_TUSOK_HP_ABSORB] = localeInfo.TOOLTIP_USE_SKILL_TUSOK_HP_ABSORB
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_PAERYONG_HP_ABSORB] = localeInfo.TOOLTIP_USE_SKILL_PAERYONG_HP_ABSORB
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_BYEURAK_HP_ABSORB] = localeInfo.TOOLTIP_USE_SKILL_BYEURAK_HP_ABSORB
-		self.AFFECT_DICT[item.APPLY_FIRST_ATTRIBUTE_BONUS] = localeInfo.TOOLTIP_FIRST_ATTRIBUTE_BONUS
-		self.AFFECT_DICT[item.APPLY_SECOND_ATTRIBUTE_BONUS] = localeInfo.TOOLTIP_SECOND_ATTRIBUTE_BONUS
-		self.AFFECT_DICT[item.APPLY_THIRD_ATTRIBUTE_BONUS] = localeInfo.TOOLTIP_THIRD_ATTRIBUTE_BONUS
-		self.AFFECT_DICT[item.APPLY_FOURTH_ATTRIBUTE_BONUS] = localeInfo.TOOLTIP_FOURTH_ATTRIBUTE_BONUS
-		self.AFFECT_DICT[item.APPLY_FIFTH_ATTRIBUTE_BONUS] = localeInfo.TOOLTIP_FIFTH_ATTRIBUTE_BONUS
-
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_SAMYEON_NEXT_COOLTIME_DECREASE_20PER] = localeInfo.TOOLTIP_USE_SKILL_SAMYEON_NEXT_COOLTIME_DECREASE_20PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_GEOMPUNG_NEXT_COOLTIME_DECREASE_20PER] = localeInfo.TOOLTIP_USE_SKILL_GEOMPUNG_NEXT_COOLTIME_DECREASE_20PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_GUNGSIN_NEXT_COOLTIME_DECREASE_20PER] = localeInfo.TOOLTIP_USE_SKILL_GUNGSIN_NEXT_COOLTIME_DECREASE_20PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_KWANKYEOK_NEXT_COOLTIME_DECREASE_20PER] = localeInfo.TOOLTIP_USE_SKILL_KWANKYEOK_NEXT_COOLTIME_DECREASE_20PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_YONGKWON_NEXT_COOLTIME_DECREASE_20PER] = localeInfo.TOOLTIP_USE_SKILL_YONGKWON_NEXT_COOLTIME_DECREASE_20PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_MARYUNG_NEXT_COOLTIME_DECREASE_20PER] = localeInfo.TOOLTIP_USE_SKILL_MARYUNG_NEXT_COOLTIME_DECREASE_20PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_BIPABU_NEXT_COOLTIME_DECREASE_20PER] = localeInfo.TOOLTIP_USE_SKILL_BIPABU_NEXT_COOLTIME_DECREASE_20PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_NOEJEON_NEXT_COOLTIME_DECREASE_20PER] = localeInfo.TOOLTIP_USE_SKILL_NOEJEON_NEXT_COOLTIME_DECREASE_20PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_SALPOONG_NEXT_COOLTIME_DECREASE_20PER] = localeInfo.TOOLTIP_USE_SKILL_SALPOONG_NEXT_COOLTIME_DECREASE_20PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_PASWAE_NEXT_COOLTIME_DECREASE_20PER] = localeInfo.TOOLTIP_USE_SKILL_PASWAE_NEXT_COOLTIME_DECREASE_20PER
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_CHAYEOL_HP_ABSORB] = localeInfo.TOOLTIP_USE_SKILL_CHAYEOL_HP_ABSORB
-
-		self.AFFECT_DICT[item.APPLY_SUNGMA_STR] = localeInfo.TOOLTIP_SUNGMA_STR
-		self.AFFECT_DICT[item.APPLY_SUNGMA_HP] = localeInfo.TOOLTIP_SUNGMA_HP
-		self.AFFECT_DICT[item.APPLY_SUNGMA_MOVE] = localeInfo.TOOLTIP_SUNGMA_MOVE
-		self.AFFECT_DICT[item.APPLY_SUNGMA_IMMUNE] = localeInfo.TOOLTIP_SUNGMA_IMMUNE
-		self.AFFECT_DICT[item.APPLY_HIT_PCT] = localeInfo.TOOLTIP_HIT_PCT
-
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_PER_HUMAN] = localeInfo.TOOLTIP_ATTBONUS_PER_HUMAN
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_PER_ANIMAL] = localeInfo.TOOLTIP_ATTBONUS_PER_ANIMAL
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_PER_ORC] = localeInfo.TOOLTIP_ATTBONUS_PER_ORC
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_PER_MILGYO] = localeInfo.TOOLTIP_ATTBONUS_PER_MILGYO
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_PER_UNDEAD] = localeInfo.TOOLTIP_ATTBONUS_PER_UNDEAD
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_PER_DEVIL] = localeInfo.TOOLTIP_ATTBONUS_PER_DEVIL
-		self.AFFECT_DICT[item.APPLY_ENCHANT_PER_ELECT] = localeInfo.TOOLTIP_ENCHANT_PER_ELECT
-		self.AFFECT_DICT[item.APPLY_ENCHANT_PER_FIRE] = localeInfo.TOOLTIP_ENCHANT_PER_FIRE
-		self.AFFECT_DICT[item.APPLY_ENCHANT_PER_ICE] = localeInfo.TOOLTIP_ENCHANT_PER_ICE
-		self.AFFECT_DICT[item.APPLY_ENCHANT_PER_WIND] = localeInfo.TOOLTIP_ENCHANT_PER_WIND
-		self.AFFECT_DICT[item.APPLY_ENCHANT_PER_EARTH] = localeInfo.TOOLTIP_ENCHANT_PER_EARTH
-		self.AFFECT_DICT[item.APPLY_ENCHANT_PER_DARK] = localeInfo.TOOLTIP_ENCHANT_PER_DARK
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_PER_CZ] = localeInfo.TOOLTIP_ATTBONUS_PER_CZ
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_PER_INSECT] = localeInfo.TOOLTIP_ATTBONUS_PER_INSECT
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_PER_DESERT] = localeInfo.TOOLTIP_ATTBONUS_PER_DESERT
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_PER_STONE] = localeInfo.TOOLTIP_ATTBONUS_PER_STONE
-		self.AFFECT_DICT[item.APPLY_ATTBONUS_PER_MONSTER] = localeInfo.TOOLTIP_ATTBONUS_PER_MONSTER
-		self.AFFECT_DICT[item.APPLY_RESIST_PER_HUMAN] = localeInfo.TOOLTIP_RESIST_PER_HUMAN
-		self.AFFECT_DICT[item.APPLY_RESIST_PER_ICE] = localeInfo.TOOLTIP_RESIST_PER_ICE
-		self.AFFECT_DICT[item.APPLY_RESIST_PER_DARK] = localeInfo.TOOLTIP_RESIST_PER_DARK
-		self.AFFECT_DICT[item.APPLY_RESIST_PER_EARTH] = localeInfo.TOOLTIP_RESIST_PER_EARTH
-		self.AFFECT_DICT[item.APPLY_RESIST_PER_FIRE] = localeInfo.TOOLTIP_RESIST_PER_FIRE
-		self.AFFECT_DICT[item.APPLY_RESIST_PER_ELEC] = localeInfo.TOOLTIP_RESIST_PER_ELEC
-		self.AFFECT_DICT[item.APPLY_RESIST_PER_MAGIC] = localeInfo.TOOLTIP_RESIST_PER_MAGIC
-		self.AFFECT_DICT[item.APPLY_RESIST_PER_WIND] = localeInfo.TOOLTIP_RESIST_PER_WIND
-
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_SUNGMA_STR] = localeInfo.TOOLTIP_HIT_BUFF_SUNGMA_STR
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_SUNGMA_MOVE] = localeInfo.TOOLTIP_HIT_BUFF_SUNGMA_MOVE
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_SUNGMA_HP] = localeInfo.TOOLTIP_HIT_BUFF_SUNGMA_HP
-		self.AFFECT_DICT[item.APPLY_HIT_BUFF_SUNGMA_IMMUNE] = localeInfo.TOOLTIP_HIT_BUFF_SUNGMA_IMMUNE
-
-		self.AFFECT_DICT[item.APPLY_MOUNT_MELEE_MAGIC_ATTBONUS_PER] = localeInfo.TOOLTIP_MOUNT_MELEE_MAGIC_ATTBONUS_PER
-		self.AFFECT_DICT[item.APPLY_DISMOUNT_MOVE_SPEED_BONUS_PER] = localeInfo.TOOLTIP_DISMOUNT_MOVE_SPEED_BONUS_PER
-
-		self.AFFECT_DICT[item.APPLY_HIT_AUTO_HP_RECOVERY] = localeInfo.TOOLTIP_HIT_AUTO_HP_RECOVERY
-		self.AFFECT_DICT[item.APPLY_HIT_AUTO_SP_RECOVERY] = localeInfo.TOOLTIP_HIT_AUTO_SP_RECOVERY
-
-		self.AFFECT_DICT[item.APPLY_USE_SKILL_COOLTIME_DECREASE_ALL] = localeInfo.TOOLTIP_USE_SKILL_COOLTIME_DECREASE_ALL
-
-		self.AFFECT_DICT[item.APPLY_HIT_STONE_ATTBONUS_STONE] = localeInfo.TOOLTIP_HIT_STONE_ATTBONUS_STONE
-		self.AFFECT_DICT[item.APPLY_HIT_STONE_DEF_GRADE_BONUS] = localeInfo.TOOLTIP_HIT_STONE_DEF_GRADE_BONUS
-
-		self.AFFECT_DICT[item.APPLY_KILL_BOSS_ITEM_BONUS] = localeInfo.TOOLTIP_KILL_BOSS_ITEM_BONUS
-		self.AFFECT_DICT[item.APPLY_MOB_HIT_MOB_AGGRESSIVE] = localeInfo.TOOLTIP_MOB_HIT_MOB_AGGRESSIVE
-		self.AFFECT_DICT[item.APPLY_NO_DEATH_AND_HP_RECOVERY30] = localeInfo.TOOLTIP_NO_DEATH_AND_HP_RECOVERY30
-		self.AFFECT_DICT[item.APPLY_AUTO_PICKUP] = localeInfo.TOOLTIP_AUTO_PICKUP
-		self.AFFECT_DICT[item.APPLY_MOUNT_NO_KNOCKBACK] = localeInfo.TOOLTIP_MOUNT_NO_KNOCKBACK
-
-		self.AFFECT_DICT[item.APPLY_SUNGMA_PER_STR] = localeInfo.TOOLTIP_SUNGMA_PER_STR
-		self.AFFECT_DICT[item.APPLY_SUNGMA_PER_HP] = localeInfo.TOOLTIP_SUNGMA_PER_HP
-		self.AFFECT_DICT[item.APPLY_SUNGMA_PER_MOVE] = localeInfo.TOOLTIP_SUNGMA_PER_MOVE
-		self.AFFECT_DICT[item.APPLY_SUNGMA_PER_IMMUNE] = localeInfo.TOOLTIP_SUNGMA_PER_IMMUNE
-
-		self.AFFECT_DICT[item.APPLY_IMMUNE_POISON100] = localeInfo.TOOLTIP_APPLY_IMMUNE_POISON100
-		self.AFFECT_DICT[item.APPLY_IMMUNE_BLEEDING100] = localeInfo.TOOLTIP_APPLY_IMMUNE_BLEEDING100
-		self.AFFECT_DICT[item.APPLY_MONSTER_DEFEND_BONUS] = localeInfo.TOOLTIP_APPLY_MONSTER_DEFEND_BONUS
+			AFFECT_DICT[item.APPLY_RESIST_CLAW_REDUCTION] = localeInfo.TOOLTIP_APPLY_ATTBONUS_CLAW
+		AFFECT_DICT[item.APPLY_RESIST_HUMAN] = localeInfo.TOOLTIP_APPLY_RESIST_HUMAN
+
+	AFFECT_DICT[item.APPLY_ATTBONUS_STONE] = localeInfo.TOOLTIP_ATTBONUS_STONE
+	if app.ENABLE_CONQUEROR_LEVEL:
+		AFFECT_DICT[item.APPLY_SUNGMA_STR] = localeInfo.TOOLTIP_SUNGMA_STR
+		AFFECT_DICT[item.APPLY_SUNGMA_HP] = localeInfo.TOOLTIP_SUNGMA_HP
+		AFFECT_DICT[item.APPLY_SUNGMA_MOVE] = localeInfo.TOOLTIP_SUNGMA_MOVE
+		AFFECT_DICT[item.APPLY_SUNGMA_IMMUNE] = localeInfo.TOOLTIP_SUNGMA_IMMUNE
+
+	ATTRIBUTE_NEED_WIDTH = {
+		23 : 230,
+		24 : 230,
+		25 : 230,
+		26 : 220,
+		27 : 210,
+
+		35 : 210,
+		36 : 210,
+		37 : 210,
+		38 : 210,
+		39 : 210,
+		40 : 210,
+		41 : 210,
+
+		42 : 220,
+		43 : 230,
+		45 : 230,
+	}
+
+	if not app.DISABLE_WOLFMAN_CREATION:
+		ANTI_FLAG_DICT = {
+			0 : item.ITEM_ANTIFLAG_WARRIOR,
+			1 : item.ITEM_ANTIFLAG_ASSASSIN,
+			2 : item.ITEM_ANTIFLAG_SURA,
+			3 : item.ITEM_ANTIFLAG_SHAMAN,
+			4 : item.ITEM_ANTIFLAG_WOLFMAN,
+		}
+	else:
+		ANTI_FLAG_DICT = {
+			0 : item.ITEM_ANTIFLAG_WARRIOR,
+			1 : item.ITEM_ANTIFLAG_ASSASSIN,
+			2 : item.ITEM_ANTIFLAG_SURA,
+			3 : item.ITEM_ANTIFLAG_SHAMAN,
+		}
+	FONT_COLOR = grp.GenerateColor(0.7607, 0.7607, 0.7607, 1.0)
 
+	def __init__(self, *args, **kwargs):
+		ToolTip.__init__(self, *args, **kwargs)
 		self.itemVnum = 0
-		self.metinSlot = []
-		self.attrSlot = []
 		self.isShopItem = False
 
-		if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-			self.isRefineElementItem = False
+		if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+			self.isPrivateSearchItem = False
 
 		if app.ENABLE_DS_SET:
 			self.interface = None
@@ -864,8 +769,6 @@
 
 	def __del__(self):
 		ToolTip.__del__(self)
-		self.metinSlot = None
-		self.attrSlot = None
 
 	if app.ENABLE_DS_SET:
 		def BindInterface(self, interface):
@@ -899,50 +802,41 @@
 			return False
 
 		for i in xrange(item.LIMIT_MAX_NUM):
-			try:
-				limit = item.GetLimit(i)
-				if not isinstance(limit, tuple) or len(limit) != 2:
-					continue
-
-				limitType, limitValue = limit
-
-				if limitType == item.LIMIT_LEVEL:
-					if isinstance(limitValue, int) and player.GetStatus(player.LEVEL) < limitValue:
-						return False
-
-				"""
-				elif limitType == item.LIMIT_STR:
-					if isinstance(limitValue, int) and player.GetStatus(player.ST) < limitValue:
-						return False
-				elif limitType == item.LIMIT_DEX:
-					if isinstance(limitValue, int) and player.GetStatus(player.DX) < limitValue:
-						return False
-				elif limitType == item.LIMIT_INT:
-					if isinstance(limitValue, int) and player.GetStatus(player.IQ) < limitValue:
-						return False
-				elif limitType == item.LIMIT_CON:
-					if isinstance(limitValue, int) and player.GetStatus(player.HT) < limitValue:
-						return False
-				"""
+			(limitType, limitValue) = item.GetLimit(i)
 
-			except Exception:
-				continue
+			if item.LIMIT_LEVEL == limitType:
+				if player.GetStatus(player.LEVEL) < limitValue:
+					return False
+			"""
+			elif item.LIMIT_STR == limitType:
+				if player.GetStatus(player.ST) < limitValue:
+					return False
+			elif item.LIMIT_DEX == limitType:
+				if player.GetStatus(player.DX) < limitValue:
+					return False
+			elif item.LIMIT_INT == limitType:
+				if player.GetStatus(player.IQ) < limitValue:
+					return False
+			elif item.LIMIT_CON == limitType:
+				if player.GetStatus(player.HT) < limitValue:
+					return False
+			"""
 
 		return True
 
-	def AppendTextLineDontCheckColor(self, text, color = FONT_COLOR, centerAlign = True):
+	def AppendTextLineAcce(self, text, color = FONT_COLOR, centerAlign = True):
 		return ToolTip.AppendTextLine(self, text, color, centerAlign)
 
-	def AppendTextLine(self, text, color=FONT_COLOR, centerAlign=True):
+	def AppendTextLine(self, text, color = FONT_COLOR, centerAlign = True):
 		if not self.CanEquip() and self.bCannotUseItemForceSetDisableColor:
 			color = self.DISABLE_COLOR
 
-		return ToolTip.AppendTextLine(self, text, color, centerAlign) 
+		return ToolTip.AppendTextLine(self, text, color, centerAlign)
 
 	def ClearToolTip(self):
 		self.isShopItem = False
-		if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-			self.isRefineElementItem = False
+		if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+			self.isPrivateSearchItem = False
 		self.toolTipWidth = self.TOOL_TIP_WIDTH
 		ToolTip.ClearToolTip(self)
 
@@ -951,6 +845,7 @@
 			self.window_type = window_type
 
 		itemVnum = player.GetItemIndex(window_type, slotIndex)
+
 		if 0 == itemVnum:
 			return
 
@@ -966,48 +861,64 @@
 
 		metinSlot = [player.GetItemMetinSocket(window_type, slotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
 		attrSlot = [player.GetItemAttribute(window_type, slotIndex, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
+		apply_random_list = []
+		if app.ENABLE_APPLY_RANDOM:
+			apply_random_list = [player.GetItemApplyRandom(window_type, slotIndex, i) for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM)]
+
+		self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, window_type, slotIndex, None, apply_random_list, 0)
 
 		if app.ENABLE_GROWTH_PET_SYSTEM:
 			if window_type == player.PET_FEED:
 				metinSlot = [player.GetItemMetinSocket(player.INVENTORY, slotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
 
-		refine_element = player.GetItemRefineElement(window_type, slotIndex) if app.ENABLE_REFINE_ELEMENT_SYSTEM else None
-		apply_random_list = [player.GetItemApplyRandom(window_type, slotIndex, i) for i in range(player.APPLY_RANDOM_SLOT_MAX_NUM)] if app.ENABLE_APPLY_RANDOM else []
-		set_value = player.GetItemSetValue(window_type, slotIndex) if app.ENABLE_SET_ITEM else 0
-
-		self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, window_type, slotIndex, refine_element, apply_random_list, set_value)
-
-	if app.ENABLE_MOVE_COSTUME_ATTR:
-		def SetResultItemAttrMove(self, baseSlotIndex, materialSlotIndex, window_type = player.INVENTORY):
-			baseItemVnum = player.GetItemIndex(window_type, baseSlotIndex)
-			if 0 == baseItemVnum:
-				return
+		self.AddItemData(itemVnum, metinSlot, attrSlot, 0, 0, window_type, slotIndex)
+
+	def SetResulItemAttrMove(self, baseSlotIndex, materialSlotIndex, window_type = player.INVENTORY):
+		baseItemVnum = player.GetItemIndex(window_type, baseSlotIndex)
+
+		if 0 == baseItemVnum:
+			return
+
+		materialItemVnum = player.GetItemIndex(window_type, materialSlotIndex)
+
+		if 0 == materialItemVnum:
+			return
+
+		self.ClearToolTip()
 
-			materialItemVnum = player.GetItemIndex(window_type, materialSlotIndex)
-			if 0 == materialItemVnum:
+		metinSlot = [player.GetItemMetinSocket(window_type, baseSlotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
+		attrSlot = [player.GetItemAttribute(window_type, materialSlotIndex, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
+
+		self.AddItemData(baseItemVnum, metinSlot, attrSlot)
+
+	if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+		def SetPrivateSearchItem(self, slotIndex):
+			itemVnum = shop.GetPrivateShopSelectItemVnum(slotIndex)
+
+			if 0 == itemVnum:
 				return
 
 			self.ClearToolTip()
+			self.isPrivateSearchItem = True
 
-			if app.ENABLE_ACCE_COSTUME_SYSTEM:
-				item.SelectItem(materialItemVnum)
-				if item.GetItemType() == item.ITEM_TYPE_COSTUME and item.GetItemSubType() == item.COSTUME_TYPE_ACCE:
-					metinSlot = [player.GetItemMetinSocket(window_type, materialSlotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-				else:
-					metinSlot = [player.GetItemMetinSocket(window_type, baseSlotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-			else:
-				metinSlot = [player.GetItemMetinSocket(window_type, baseSlotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
+			metinSlot = []
+			for i in xrange(player.METIN_SOCKET_MAX_NUM):
+				metinSlot.append(shop.GetPrivateShopSelectItemMetinSocket(slotIndex, i))
+			attrSlot = []
+			for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
+				attrSlot.append(shop.GetPrivateShopSelectItemAttribute(slotIndex, i))
+			apply_random_list = []
+			if app.ENABLE_APPLY_RANDOM:
+				for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM):
+					apply_random_list.append(shop.GetPrivateShopItemApplyRandom(slotIndex, i))
 
-			attrSlot = [player.GetItemAttribute(window_type, materialSlotIndex, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
-			refine_element = player.GetItemRefineElement(window_type, materialSlotIndex) if app.ENABLE_REFINE_ELEMENT_SYSTEM else None
-			apply_random_list = [ player.GetItemApplyRandom(window_type, materialSlotIndex, i) for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM)] if app.ENABLE_APPLY_RANDOM else []
-			set_value = player.GetItemSetValue(window_type, materialSlotIndex) if app.ENABLE_SET_ITEM else 0
+			self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, player.INVENTORY, slotIndex, None, apply_random_list, 0)
 
-			self.AddItemData(baseItemVnum, metinSlot, attrSlot, None, 0, 0, window_type, -1, refine_element, apply_random_list, set_value)
+			if app.ENABLE_CHANGE_LOOK_SYSTEM:
+				self.AppendChangeLookInfoPrivateShopWIndow(slotIndex)
 
 	if app.ENABLE_CHANGE_LOOK_SYSTEM:
-		def AppendChangeLookInfoShopWindow(self, slotIndex):
-			changelookvnum = shop.GetItemChangeLookVnum(slotIndex)
+		def AppendChangeLookInfoItemVnum(self, changelookvnum):
 			if not changelookvnum == 0:
 				self.AppendSpace(5)
 				self.AppendTextLine("[ " + localeInfo.CHANGE_LOOK_TITLE + " ]", self.CHANGELOOK_TITLE_COLOR)
@@ -1026,8 +937,29 @@
 				textLine = self.AppendTextLine(itemName, self.CHANGELOOK_ITEMNAME_COLOR, True)
 				textLine.SetFeather()
 
-	if app.ENABLE_CHANGE_LOOK_SYSTEM:
-		def AppendChangeLookInfoItemVnum(self, changelookvnum):
+		if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+			def AppendChangeLookInfoPrivateShopWIndow(self, slotIndex):
+				changelookvnum = shop.GetPrivateShopItemChangeLookVnum(slotIndex)
+				if not changelookvnum == 0:
+					self.AppendSpace(5)
+					self.AppendTextLine("[ " + localeInfo.CHANGE_LOOK_TITLE + " ]", self.CHANGELOOK_TITLE_COLOR)
+					itemName = item.GetItemNameByVnum(changelookvnum)
+
+					if item.GetItemType() == item.ITEM_TYPE_COSTUME:
+						if item.GetItemSubType() == item.COSTUME_TYPE_BODY:
+							malefemale = ""
+							if item.IsAntiFlag(item.ITEM_ANTIFLAG_MALE):
+								malefemale = localeInfo.FOR_FEMALE
+
+							if item.IsAntiFlag(item.ITEM_ANTIFLAG_FEMALE):
+								malefemale = localeInfo.FOR_MALE
+							itemName += " ( " + malefemale + " )"
+
+					textLine = self.AppendTextLine(itemName, self.CHANGELOOK_ITEMNAME_COLOR, True)
+					textLine.SetFeather()
+
+		def AppendChangeLookInfoShopWindow(self, slotIndex):
+			changelookvnum = shop.GetItemTransmutation(slotIndex)
 			if not changelookvnum == 0:
 				self.AppendSpace(5)
 				self.AppendTextLine("[ " + localeInfo.CHANGE_LOOK_TITLE + " ]", self.CHANGELOOK_TITLE_COLOR)
@@ -1055,19 +987,24 @@
 		self.ClearToolTip()
 		self.isShopItem = True
 
-		metinSlot = [shop.GetItemMetinSocket(slotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-		attrSlot = [shop.GetItemAttribute(slotIndex, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
-		refine_element = shop.GetItemRefineElement(slotIndex) if app.ENABLE_REFINE_ELEMENT_SYSTEM else None
-		apply_random_list = [shop.GetItemApplyRandom(slotIndex, i) for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM)] if app.ENABLE_APPLY_RANDOM else []
-		set_value = shop.GetItemSetValue(slotIndex) if app.ENABLE_SET_ITEM else 0
+		metinSlot = []
+		for i in xrange(player.METIN_SOCKET_MAX_NUM):
+			metinSlot.append(shop.GetItemMetinSocket(slotIndex, i))
+		attrSlot = []
+		for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
+			attrSlot.append(shop.GetItemAttribute(slotIndex, i))
+		apply_random_list = []
+		if app.ENABLE_APPLY_RANDOM:
+			for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM):
+				apply_random_list.append(shop.GetItemApplyRandom(slotIndex, i))
 
-		self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, player.INVENTORY, slotIndex, refine_element, apply_random_list, set_value)
+		self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, player.INVENTORY, slotIndex, None, apply_random_list, 0)
 
 		if app.ENABLE_CHANGE_LOOK_SYSTEM:
 			self.AppendChangeLookInfoShopWindow(slotIndex)
 
 		if app.ENABLE_CHEQUE_SYSTEM:
-			cheque = shop.GetItemCheque(slotIndex)
+			cheque = shop.GetItemPriceCheque(slotIndex)
 			self.AppendPrice(price, cheque)
 		else:
 			self.AppendPrice(price)
@@ -1092,38 +1029,49 @@
 		self.AppendPriceBySecondaryCoin(price)
 
 	if app.ENABLE_SHOPEX_RENEWAL:
-		def SetShopItemByShopItem(self, slot_index):
-			item_vnum = shop.GetItemID(slot_index)
-			price = shop.GetItemPrice(slot_index)
-			price_vnum = shop.GetItemPriceVnum(slot_index)
+		def SetShopItemByShopEx(self, slotIndex, type):
+			itemVnum = shop.GetItemID(slotIndex)
+			PriceVnum = shop.GetItemPriceVnum(slotIndex)
+
+			if 0 == itemVnum:
+				return
 
-			if item_vnum == 0 or price_vnum == 0:
+			if PriceVnum == 0 and type == 3:
 				return
 
+			price = shop.GetItemPrice(slotIndex)
 			self.ClearToolTip()
 			self.isShopItem = True
 
-			socket_list = [shop.GetItemMetinSocket(slot_index, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-			attr_list = [(0, 0) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
-
-			item.SelectItem(price_vnum)
-			price_vnum_name = item.GetItemName()
-			price_vnum_icon_img = item.GetIconImageFileName()
+			metinSlot = []
+			for i in xrange(player.METIN_SOCKET_MAX_NUM):
+				metinSlot.append(shop.GetItemMetinSocket(slotIndex, i))
+			attrSlot = []
+			for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
+				attrSlot.append(shop.GetItemAttribute(slotIndex, i))
 
-			self.AddItemData(item_vnum, socket_list, attr_list)
+			self.AddItemData(itemVnum, metinSlot, attrSlot)
 			self.AppendSpace(5)
 
-			self.AppendTextLine(localeInfo.CHEQUE_SYSTEM_SELL_PRICE)
-			self.AutoAppendTextLine("%s %s" % (localeInfo.NumberToMoneyString(price), price_vnum_name), self.SPECIAL_TITLE_COLOR)
+			if type == 3:
+				self.AddShopEXItem(PriceVnum, price)
+			else:
+				self.AppendTextLine(localeInfo.TOOLTIP_BUYPRICE % (localeInfo.NumberToShopEXP(price)), self.GetPriceColor(price))
+
+		def AddShopEXItem(self, itemVnum, price):
+			self.AppendTextLine(localeInfo.MONEY_INPUT_DIALOG_SELLPRICE)
+			item.SelectItem(itemVnum)
+			name = "%d. %s" % (price, item.GetItemName())
+			self.AutoAppendTextLine(name, self.SPECIAL_TITLE_COLOR)
 
-			item_image = ui.ImageBox()
-			item_image.SetParent(self)
-			item_image.Show()
-			item_image.LoadImage(price_vnum_icon_img)
-			item_image.SetPosition(self.toolTipWidth / 2 - 16, self.toolTipHeight + 2.5)
+			itemImage = ui.ImageBox()
+			itemImage.SetParent(self)
+			itemImage.Show()
+			itemImage.LoadImage(item.GetIconImageFileName())
+			itemImage.SetPosition(self.toolTipWidth / 2 - 16, self.toolTipHeight + 2.5)
 
-			self.toolTipHeight += item_image.GetHeight() + 2.5
-			self.childrenList.append(item_image)
+			self.toolTipHeight += itemImage.GetHeight() + 2.5
+			self.childrenList.append(itemImage)
 			self.ResizeToolTip()
 
 	def SetExchangeOwnerItem(self, slotIndex):
@@ -1134,13 +1082,18 @@
 
 		self.ClearToolTip()
 
-		metinSlot = [exchange.GetItemMetinSocketFromSelf(slotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-		attrSlot = [exchange.GetItemAttributeFromSelf(slotIndex, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
-		refine_element = exchange.GetItemRefineElementFromSelf(slotIndex) if app.ENABLE_REFINE_ELEMENT_SYSTEM else None
-		apply_random_list = [exchange.GetItemApplyRandomFromSelf(slotIndex, i) for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM)] if app.ENABLE_APPLY_RANDOM else []
-		set_value = exchange.GetItemSetValueFromSelf(slotIndex) if app.ENABLE_SET_ITEM else 0
+		metinSlot = []
+		for i in xrange(player.METIN_SOCKET_MAX_NUM):
+			metinSlot.append(exchange.GetItemMetinSocketFromSelf(slotIndex, i))
+		attrSlot = []
+		for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
+			attrSlot.append(exchange.GetItemAttributeFromSelf(slotIndex, i))
+		apply_random_list = []
+		if app.ENABLE_APPLY_RANDOM:
+			for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM):
+				apply_random_list.append(exchange.GetItemApplyRandomFromSelf(slotIndex, i))
 
-		self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, player.INVENTORY, -1, refine_element, apply_random_list, set_value)
+		self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, player.INVENTORY, slotIndex, None, apply_random_list, 0)
 
 		if app.ENABLE_CHANGE_LOOK_SYSTEM:
 			self.AppendChangeLookInfoExchangeWIndow(0, slotIndex)
@@ -1163,13 +1116,18 @@
 
 		self.ClearToolTip()
 
-		metinSlot = [exchange.GetItemMetinSocketFromTarget(slotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-		attrSlot = [exchange.GetItemAttributeFromTarget(slotIndex, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
-		refine_element = exchange.GetItemRefineElementFromTarget(slotIndex) if app.ENABLE_REFINE_ELEMENT_SYSTEM else None
-		apply_random_list = [exchange.GetItemApplyRandomFromTarget(slotIndex, i) for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM)] if app.ENABLE_APPLY_RANDOM else []
-		set_value = exchange.GetItemSetValueFromTarget(slotIndex) if app.ENABLE_SET_ITEM else 0
+		metinSlot = []
+		for i in xrange(player.METIN_SOCKET_MAX_NUM):
+			metinSlot.append(exchange.GetItemMetinSocketFromTarget(slotIndex, i))
+		attrSlot = []
+		for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
+			attrSlot.append(exchange.GetItemAttributeFromTarget(slotIndex, i))
+		apply_random_list = []
+		if app.ENABLE_APPLY_RANDOM:
+			for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM):
+				apply_random_list.append(exchange.GetItemApplyRandomFromTarget(slotIndex, i))
 
-		self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, player.INVENTORY, -1, refine_element, apply_random_list, set_value)
+		self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, player.INVENTORY, slotIndex, None, apply_random_list, 0)
 
 		if app.ENABLE_CHANGE_LOOK_SYSTEM:
 			self.AppendChangeLookInfoExchangeWIndow(1, slotIndex)
@@ -1177,9 +1135,10 @@
 	if app.ENABLE_CHANGE_LOOK_SYSTEM:
 		def AppendChangeLookInfoExchangeWIndow(self, type, slotIndex):
 			if type == 0:
-				changelookvnum = exchange.GetChangeLookVnumFromSelf(slotIndex)
+				changelookvnum = exchange.GetItemTransmutation(slotIndex, True)
 			elif type == 1:
-				changelookvnum = exchange.GetChangeLookVnumFromTarget(slotIndex)
+				changelookvnum = exchange.GetItemTransmutation(slotIndex, False)
+
 			if not changelookvnum == 0:
 				self.AppendSpace(5)
 				self.AppendTextLine("[ " + localeInfo.CHANGE_LOOK_TITLE + " ]", self.CHANGELOOK_TITLE_COLOR)
@@ -1207,71 +1166,22 @@
 		self.ClearToolTip()
 
 		if app.ENABLE_CHEQUE_SYSTEM:
-			self.AppendSellingPrice(shop.GetPrivateShopItemPrice(invenType, invenPos), shop.GetPrivateShopItemCheque(invenType, invenPos), True)
+			self.AppendSellingPrice(shop.GetPrivateShopItemPrice(invenType, invenPos), shop.GetPrivateShopItemPriceCheque(invenType, invenPos), True)
 		else:
 			self.AppendSellingPrice(shop.GetPrivateShopItemPrice(invenType, invenPos))
 
-		metinSlot = [player.GetItemMetinSocket(invenPos, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-		attrSlot = [player.GetItemAttribute(invenPos, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
-		refine_element = player.GetItemRefineElement(invenPos) if app.ENABLE_REFINE_ELEMENT_SYSTEM else None
-		apply_random_list = [player.GetItemApplyRandom(invenPos, i) for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM)] if app.ENABLE_APPLY_RANDOM else []
-		set_value = player.GetItemSetValue(invenPos) if app.ENABLE_SET_ITEM else 0
-
-		self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, invenType, invenPos, refine_element, apply_random_list, set_value)
-
-	if app.ENABLE_CHANGE_LOOK_SYSTEM:
-		def SetChangeLookWindowItem(self, slotIndex):
-			inventoryslotindex = player.GetChangeLookItemInvenSlot(slotIndex)
-			if inventoryslotindex == player.ITEM_SLOT_COUNT:
-				return
-
-			itemVnum = player.GetItemIndex(player.INVENTORY, inventoryslotindex)
-			if 0 == itemVnum:
-				return
-
-			self.ClearToolTip()
-
-			metinSlot = [player.GetItemMetinSocket(player.INVENTORY, inventoryslotindex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-			attrSlot = [player.GetItemAttribute(player.INVENTORY, inventoryslotindex, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
-			refine_element = player.GetItemRefineElement(player.INVENTORY, inventoryslotindex) if app.ENABLE_REFINE_ELEMENT_SYSTEM else None
-			apply_random_list = [player.GetItemApplyRandom(player.INVENTORY, inventoryslotindex, i) for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM)] if app.ENABLE_APPLY_RANDOM else []
-			set_value = player.GetItemSetValue(player.INVENTORY, inventoryslotindex) if app.ENABLE_SET_ITEM else 0
-
-			self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, player.INVENTORY, inventoryslotindex, refine_element, apply_random_list, set_value)
-
-	if app.ENABLE_ACCE_COSTUME_SYSTEM:
-		def SetAcceWindowItem(self, slotIndex):
-			ItemVnum = player.GetAcceItemID(slotIndex)
-			if 0 == ItemVnum:
-				return
-
-			self.ClearToolTip()
-
-			metinSlot = [player.GetAcceItemMetinSocket(slotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-			attrSlot = [player.GetAcceItemAttribute(slotIndex, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
-			refine_element = player.GetAcceItemRefineElement(slotIndex) if app.ENABLE_REFINE_ELEMENT_SYSTEM else None
-			apply_random_list = [player.GetAcceItemApplyRandom(slotIndex, i) for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM)] if app.ENABLE_APPLY_RANDOM else []
-			set_value = player.GetAcceItemSetValue(slotIndex) if app.ENABLE_SET_ITEM else 0
-
-			self.AddItemData(ItemVnum, metinSlot, attrSlot, None, player.GetAcceItemFlags(slotIndex), 0, player.ACCEREFINE, slotIndex, refine_element, apply_random_list, set_value)
-
-	if app.ENABLE_AURA_COSTUME_SYSTEM:
-		def SetAuraWindowItem(self, slotIndex):
-			ItemVnum = player.GetAuraItemID(slotIndex)
-			if 0 == ItemVnum:
-				return
-
-			self.ClearToolTip()
-			if shop.IsOpen() and not shop.IsPrivateShop():
-				self.AppendSellingPrice(item.GetISellItemPrice(item.SelectItem(ItemVnum)))
-
-			metinSlot = [player.GetAuraSlotItemMetinSocket(slotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-			attrSlot = [player.GetAuraSlotItemAttribute(slotIndex, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
-			refine_element = None
-			apply_random_list = [player.GetAuraSlotItemApplyRandom(slotIndex, i) for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM)] if app.ENABLE_APPLY_RANDOM else []
-			set_value = player.GetAuraSlotItemSetValue(slotIndex) if app.ENABLE_SET_ITEM else 0
+		metinSlot = []
+		for i in xrange(player.METIN_SOCKET_MAX_NUM):
+			metinSlot.append(player.GetItemMetinSocket(invenPos, i))
+		attrSlot = []
+		for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
+			attrSlot.append(player.GetItemAttribute(invenPos, i))
+		apply_random_list = []
+		if app.ENABLE_APPLY_RANDOM:
+			for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM):
+				apply_random_list.append(player.GetItemApplyRandom(invenPos, i))
 
-			self.AddItemData(ItemVnum, metinSlot, attrSlot, None, player.GetAuraSlotItemFlags(slotIndex), 0, player.AURA_REFINE, slotIndex, None, apply_random_list, set_value)
+		self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, invenType, invenPos, None, apply_random_list, 0)
 
 	def SetSafeBoxItem(self, slotIndex):
 		itemVnum = safebox.GetItemID(slotIndex)
@@ -1279,14 +1189,18 @@
 			return
 
 		self.ClearToolTip()
+		metinSlot = []
+		for i in xrange(player.METIN_SOCKET_MAX_NUM):
+			metinSlot.append(safebox.GetItemMetinSocket(slotIndex, i))
+		attrSlot = []
+		for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
+			attrSlot.append(safebox.GetItemAttribute(slotIndex, i))
+		apply_random_list = []
+		if app.ENABLE_APPLY_RANDOM:
+			for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM):
+				apply_random_list.append(safebox.GetItemApplyRandom(slotIndex, i))
 
-		metinSlot = [safebox.GetItemMetinSocket(slotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-		attrSlot = [safebox.GetItemAttribute(slotIndex, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
-		refine_element = safebox.GetItemRefineElement(slotIndex) if app.ENABLE_REFINE_ELEMENT_SYSTEM else None
-		apply_random_list = [safebox.GetItemApplyRandom(slotIndex, i) for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM)] if app.ENABLE_APPLY_RANDOM else []
-		set_value = safebox.GetItemSetValue(slotIndex) if app.ENABLE_SET_ITEM else 0
-
-		self.AddItemData(itemVnum, metinSlot, attrSlot, None, safebox.GetItemFlags(slotIndex), 0, player.SAFEBOX, slotIndex, refine_element, apply_random_list, set_value)
+		self.AddItemData(itemVnum, metinSlot, attrSlot, None, safebox.GetItemFlags(slotIndex), 0, player.SAFEBOX, slotIndex, None, apply_random_list, 0)
 
 	def SetMallItem(self, slotIndex):
 		itemVnum = safebox.GetMallItemID(slotIndex)
@@ -1294,14 +1208,18 @@
 			return
 
 		self.ClearToolTip()
+		metinSlot = []
+		for i in xrange(player.METIN_SOCKET_MAX_NUM):
+			metinSlot.append(safebox.GetMallItemMetinSocket(slotIndex, i))
+		attrSlot = []
+		for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
+			attrSlot.append(safebox.GetMallItemAttribute(slotIndex, i))
+		apply_random_list = []
+		if app.ENABLE_APPLY_RANDOM:
+			for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM):
+				apply_random_list.append(safebox.GetMallItemApplyRandom(slotIndex, i))
 
-		metinSlot = [safebox.GetMallItemMetinSocket(slotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-		attrSlot = [safebox.GetMallItemAttribute(slotIndex, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
-		refine_element = safebox.GetMallItemRefineElement(slotIndex) if app.ENABLE_REFINE_ELEMENT_SYSTEM else None
-		apply_random_list = [safebox.GetMallItemApplyRandom(slotIndex, i) for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM)] if app.ENABLE_APPLY_RANDOM else []
-		set_value = safebox.GetMallItemSetValue(slotIndex) if app.ENABLE_SET_ITEM else 0
-
-		self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, player.MALL, slotIndex, refine_element, apply_random_list, set_value)
+		self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, player.INVENTORY, slotIndex, None, apply_random_list, 0)
 
 	def SetItemToolTip(self, itemVnum):
 		self.ClearToolTip()
@@ -1323,30 +1241,23 @@
 			(vnum, count) = item_data
 
 			self.ClearToolTip()
+			metinSlot = []
+			for i in xrange(player.METIN_SOCKET_MAX_NUM):
+				metinSlot.append(mail.GetMailItemMetinSocket(index, i))
+			attrSlot = []
+			for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
+				attrSlot.append(mail.GetMailItemAttribute(index, i))
+			apply_random_list = []
+			if app.ENABLE_APPLY_RANDOM:
+				for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM):
+					apply_random_list.append(mail.GetItemApplyRandom(index, i))
 
-			metinSlot = [mail.GetMailItemMetinSocket(index, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
-			attrSlot = [mail.GetMailItemAttribute(index, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
-			refine_element = mail.GetItemRefineElement(index) if app.ENABLE_REFINE_ELEMENT_SYSTEM else None
-			apply_random_list = [mail.GetItemApplyRandom(index, i) for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM)] if app.ENABLE_APPLY_RANDOM else []
-			set_value = mail.GetItemSetValue(index) if app.ENABLE_SET_ITEM else 0
-
-			self.AddItemData(vnum, metinSlot, attrSlot, None, 0, 0, player.INVENTORY, index, refine_element, apply_random_list, set_value)
+			self.AddItemData(vnum, metinSlot, attrSlot, None, 0, 0, player.INVENTORY, index, None, apply_random_list, 0)
 
 			if app.ENABLE_CHANGE_LOOK_SYSTEM:
 				changelookvnum = mail.GetItemChangeLookVnum(index)
 				self.AppendChangeLookInfoItemVnum(changelookvnum)
 
-	if app.ENABLE_SUMMER_EVENT_ROULETTE:
-		def SetRouletteItem(self, item_vnum):
-			item.SelectItem(item_vnum)
-
-			self.ClearToolTip()
-
-			self.SetTitle(item.GetItemName())
-			self.AppendDescription(item.GetItemDescription(), 26)
-			self.AppendDescription(item.GetItemSummary(), 26, self.CONDITION_COLOR)
-			self.ShowToolTip()
-
 	def __AppendAttackSpeedInfo(self, item):
 		atkSpd = item.GetValue(0)
 
@@ -1367,65 +1278,61 @@
 		atkGrade = item.GetValue(1)
 		self.AppendTextLine(localeInfo.TOOLTIP_ITEM_ATT_GRADE % atkGrade, self.GetChangeTextLineColor(atkGrade))
 
-	if app.ENABLE_APPLY_RANDOM:
-		def __AppendAttackPowerInfo(self, sockets, refine_element):
+	if app.ENABLE_ACCE_COSTUME_SYSTEM:
+		def CalcAcceValue(self, value, abs):
+			if not value:
+				return 0
+
+			valueCalc = int((round(value * abs) / 100) - .5) + int(int((round(value * abs) / 100) - .5) > 0)
+			if valueCalc <= 0 and value > 0:
+				value = 1
+			else:
+				value = valueCalc
+
+			return value
+
+	if app.ENABLE_ACCE_COSTUME_SYSTEM:
+		def __AppendAttackPowerInfo(self, itemAbsChance = 0):
 			minPower = item.GetValue(3)
 			maxPower = item.GetValue(4)
+			addPower = item.GetValue(5)
 
-			minMax = sockets[item.ITEM_SOCKET_ATK_MINMAX_RANDOM]
-			if minMax != 0:
-				minPower = minMax / item.ITEM_VALUE_MINMAX_RANDOM_DIVISION_VALUE
-				maxPower = minMax % (item.ITEM_VALUE_MINMAX_RANDOM_DIVISION_VALUE / 100)
+			if itemAbsChance:
+				minPower = self.CalcAcceValue(minPower, itemAbsChance)
+				maxPower = self.CalcAcceValue(maxPower, itemAbsChance)
+				addPower = self.CalcAcceValue(addPower, itemAbsChance)
 
+			if maxPower > minPower:
+				self.AppendTextLine(localeInfo.TOOLTIP_ITEM_ATT_POWER % (minPower+addPower, maxPower+addPower), self.POSITIVE_COLOR)
+			else:
+				self.AppendTextLine(localeInfo.TOOLTIP_ITEM_ATT_POWER_ONE_ARG % (minPower+addPower), self.POSITIVE_COLOR)
+	else:
+		def __AppendAttackPowerInfo(self):
+			minPower = item.GetValue(3)
+			maxPower = item.GetValue(4)
 			addPower = item.GetValue(5)
 			if maxPower > minPower:
-				if app.ENABLE_REFINE_ELEMENT_SYSTEM and self.GetRefineElement(refine_element):
-					grade = refine_element[self.REFINE_ELEMENT_INDEX_GRADE]
-					bonus_value = 0
-					for i in range(min(self.REFINE_ELEMENT_INDEX_MAX, grade)):
-						bonus_value += refine_element[self.REFINE_ELEMENT_INDEX_BONUS][i]
-
-					if self.isRefineElementItem:
-						min_value = uiRefine.RefineElementDialog.REFINE_ELEMENT_RANDOM_BONUS_VALUE_MIN
-						max_value = uiRefine.RefineElementDialog.REFINE_ELEMENT_RANDOM_BONUS_VALUE_MAX
-
-						affect_string = localeInfo.TOOLTIP_ITEM_ATT_POWER % (minPower + addPower, maxPower + addPower)
-						affect_string += self.__GetRefineElementValueText(0, min_value, max_value, bonus_value)
-						if affect_string:
-							self.AppendTextLine(affect_string, self.POSITIVE_COLOR)
-					else:
-						self.AppendTextLine(localeInfo.TOOLTIP_ITEM_ATT_POWER_REFINE % (minPower + addPower, maxPower + addPower, bonus_value), self.POSITIVE_COLOR)
-				else:
-					self.AppendTextLine(localeInfo.TOOLTIP_ITEM_ATT_POWER % (minPower + addPower, maxPower + addPower), self.POSITIVE_COLOR)
+				self.AppendTextLine(localeInfo.TOOLTIP_ITEM_ATT_POWER % (minPower+addPower, maxPower+addPower), self.POSITIVE_COLOR)
 			else:
-				self.AppendTextLine(localeInfo.TOOLTIP_ITEM_ATT_POWER_ONE_ARG % (minPower + addPower), self.POSITIVE_COLOR)
+				self.AppendTextLine(localeInfo.TOOLTIP_ITEM_ATT_POWER_ONE_ARG % (minPower+addPower), self.POSITIVE_COLOR)
 
-		def __AppendMagicAttackInfo(self, sockets):
+	if app.ENABLE_ACCE_COSTUME_SYSTEM:
+		def __AppendMagicAttackInfo(self, itemAbsChance = 0):
 			minMagicAttackPower = item.GetValue(1)
 			maxMagicAttackPower = item.GetValue(2)
-
-			minMax = sockets[item.ITEM_SOCKET_MTK_MINMAX_RANDOM]
-			if minMax != 0:
-				minMagicAttackPower = minMax / item.ITEM_VALUE_MINMAX_RANDOM_DIVISION_VALUE
-				maxMagicAttackPower = minMax % (item.ITEM_VALUE_MINMAX_RANDOM_DIVISION_VALUE / 100)
-
 			addPower = item.GetValue(5)
 
+			if itemAbsChance:
+				minMagicAttackPower = self.CalcAcceValue(minMagicAttackPower, itemAbsChance)
+				maxMagicAttackPower = self.CalcAcceValue(maxMagicAttackPower, itemAbsChance)
+				addPower = self.CalcAcceValue(addPower, itemAbsChance)
+
 			if minMagicAttackPower > 0 or maxMagicAttackPower > 0:
 				if maxMagicAttackPower > minMagicAttackPower:
 					self.AppendTextLine(localeInfo.TOOLTIP_ITEM_MAGIC_ATT_POWER % (minMagicAttackPower + addPower, maxMagicAttackPower + addPower), self.POSITIVE_COLOR)
 				else:
-					self.AppendTextLine(localeInfo.TOOLTIP_ITEM_MAGIC_ATT_POWER_ONE_ARG % (minMagicAttackPower+addPower), self.POSITIVE_COLOR)
+					self.AppendTextLine(localeInfo.TOOLTIP_ITEM_MAGIC_ATT_POWER_ONE_ARG % (minMagicAttackPower + addPower), self.POSITIVE_COLOR)
 	else:
-		def __AppendAttackPowerInfo(self):
-			minPower = item.GetValue(3)
-			maxPower = item.GetValue(4)
-			addPower = item.GetValue(5)
-			if maxPower > minPower:
-				self.AppendTextLine(localeInfo.TOOLTIP_ITEM_ATT_POWER % (minPower+addPower, maxPower+addPower), self.POSITIVE_COLOR)
-			else:
-				self.AppendTextLine(localeInfo.TOOLTIP_ITEM_ATT_POWER_ONE_ARG % (minPower+addPower), self.POSITIVE_COLOR)
-
 		def __AppendMagicAttackInfo(self):
 			minMagicAttackPower = item.GetValue(1)
 			maxMagicAttackPower = item.GetValue(2)
@@ -1437,96 +1344,68 @@
 				else:
 					self.AppendTextLine(localeInfo.TOOLTIP_ITEM_MAGIC_ATT_POWER_ONE_ARG % (minMagicAttackPower+addPower), self.POSITIVE_COLOR)
 
-	def __AppendMagicDefenceInfo(self):
-		magicDefencePower = item.GetValue(0)
-
-		if magicDefencePower > 0:
-			self.AppendTextLine(localeInfo.TOOLTIP_ITEM_MAGIC_DEF_POWER % magicDefencePower, self.GetChangeTextLineColor(magicDefencePower))
-
 	if app.ENABLE_ACCE_COSTUME_SYSTEM:
-		def __AppendAttributeInformationAcce(self, itemVnum, attrSlot, slotIndex, window_type, metinSlot):
-			if 0 != attrSlot:
-				(affectTypeAcce, affectValueAcce) = item.GetAffect(0)
+		def __AppendMagicDefenceInfo(self, itemAbsChance = 0):
+			magicDefencePower = item.GetValue(0)
 
-				if item.GetRefinedVnum() == 0:
-					## 전설등급 흡수율 알아오기.
-					if window_type == player.INVENTORY or window_type == player.EQUIPMENT:
-						socketInDrainValue = player.GetItemMetinSocket(window_type, slotIndex, 1)
-						if not metinSlot[1] == 0 and socketInDrainValue == 0:
-							socketInDrainValue = metinSlot[1]
-
-					elif window_type == player.ACCEREFINE:
-						socketInDrainValue = player.GetAcceItemMetinSocket(slotIndex, 1)
-					elif window_type == player.SAFEBOX:
-						socketInDrainValue = safebox.GetItemMetinSocket(slotIndex, 1)
+			if itemAbsChance:
+				magicDefencePower = self.CalcAcceValue(magicDefencePower, itemAbsChance)
 
-					drainlate = socketInDrainValue / 100.0
-				else:
-					drainlate = affectValueAcce / 100.0
+			if magicDefencePower > 0:
+				self.AppendTextLine(localeInfo.TOOLTIP_ITEM_MAGIC_DEF_POWER % magicDefencePower, self.GetChangeTextLineColor(magicDefencePower))
+	else:
+		def __AppendMagicDefenceInfo(self):
+			magicDefencePower = item.GetValue(0)
+
+			if magicDefencePower > 0:
+				self.AppendTextLine(localeInfo.TOOLTIP_ITEM_MAGIC_DEF_POWER % magicDefencePower, self.GetChangeTextLineColor(magicDefencePower))
 
+	if app.ENABLE_ACCE_COSTUME_SYSTEM:
+		def __AppendAttributeInformation(self, attrSlot, itemAbsChance = 0):
+			if 0 != attrSlot:
 				for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
 					type = attrSlot[i][0]
 					value = attrSlot[i][1]
 
-					if value <= 0:
+					if 0 == value:
 						continue
 
-					value = max(((value) * drainlate) , 1)
 					affectString = self.__GetAffectString(type, value)
 
+					if item.GetItemType() == item.ITEM_TYPE_COSTUME and item.GetItemSubType() == item.COSTUME_TYPE_ACCE and itemAbsChance:
+						value = self.CalcAcceValue(value, itemAbsChance)
+						affectString = self.__GetAffectString(type, value)
+
 					if affectString:
 						affectColor = self.__GetAttributeColor(i, value)
 						self.AppendTextLine(affectString, affectColor)
-
-	if app.ENABLE_AURA_COSTUME_SYSTEM:
-		def __AppendAttributeInformationAura(self, itemVnum, attrSlot, slotIndex, window_type, metinSlot):
+	else:
+		def __AppendAttributeInformation(self, attrSlot):
 			if 0 != attrSlot:
-				socketLevelValue = 0
-
-				if window_type == player.INVENTORY or window_type == player.EQUIPMENT:
-					socketLevelValue = player.GetItemMetinSocket(window_type, slotIndex, item.ITEM_SOCKET_AURA_LEVEL_VALUE)
-
-					if metinSlot[item.ITEM_SOCKET_AURA_LEVEL_VALUE] != 0 and socketLevelValue == 0:
-						socketLevelValue = metinSlot[item.ITEM_SOCKET_AURA_LEVEL_VALUE]
-
-				elif window_type == player.AURA_REFINE:
-					socketLevelValue = player.GetAuraSlotItemMetinSocket(slotIndex, item.ITEM_SOCKET_AURA_LEVEL_VALUE)
-
-				elif window_type == player.SAFEBOX:
-					socketLevelValue = safebox.GetItemMetinSocket(slotIndex, item.ITEM_SOCKET_AURA_LEVEL_VALUE)
-
-				if socketLevelValue == 0:
-					return
-
-				curLevel = (socketLevelValue / 100000) - 1000
-				drainlate = curLevel / 10. / 100.0
-
 				for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
 					type = attrSlot[i][0]
 					value = attrSlot[i][1]
-					if 0 >= value:
+
+					if 0 == value:
 						continue
 
-					value = max(((value) * drainlate) , 1)
 					affectString = self.__GetAffectString(type, value)
-
 					if affectString:
 						affectColor = self.__GetAttributeColor(i, value)
 						self.AppendTextLine(affectString, affectColor)
 
-	def __AppendAttributeInformation(self, attrSlot):
-		if 0 != attrSlot:
-			for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
-				type = attrSlot[i][0]
-				value = attrSlot[i][1]
+	if app.ENABLE_67TH_BONUS:
+		def __AppendRareAttributeInformation(self, attrSlot):
+			if 0 != attrSlot:
+				attrCount = 0
+				for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
+					if 0 == attrSlot[i][1]:
+						continue
 
-				if 0 == value:
-					continue
+					attrCount += 1
 
-				affectString = self.__GetAffectString(type, value)
-				if affectString:
-					affectColor = self.__GetAttributeColor(i, value)
-					self.AppendTextLine(affectString, affectColor)
+				if attrCount < player.ATTRIBUTE_SLOT_MAX_NUM and attrCount >= (player.ATTRIBUTE_SLOT_MAX_NUM - 2):
+					self.AppendTextLine(localeInfo.ATTR_6TH_7TH_POSSIBILITY, self.TEXTLINE_2ND_COLOR_DEFAULT)
 
 	if app.ENABLE_APPLY_RANDOM:
 		def __AppendDefaultItemApplyInformation(self, apply_random_list):
@@ -1587,104 +1466,9 @@
 							affectColor = self.__GetAttributeColor(i, value)
 							self.AppendTextLine(affectString, affectColor)
 
-	if app.ENABLE_ATTR_6TH_7TH:
-		def __AppendAttribute6th7thPossibility(self, attrSlot):
-			if 0 != attrSlot:
-				attrCount = 0
-				for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
-					if 0 == attrSlot[i][1]:
-						continue
-					attrCount += 1
-
-				if attrCount >= player.ATTRIBUTE_SLOT_MAX_NUM - 2 and attrCount < player.ATTRIBUTE_SLOT_MAX_NUM:
-					self.AppendTextLine(localeInfo.ATTR_6TH_7TH_POSSIBILITY, self.ATTR_6TH_7TH_COLOR)
-
-	if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-		def __AppendRefineElementInformation(self, refine_element):
-			if not self.GetRefineElement(refine_element):
-				return
-
-			apply_type = refine_element[self.REFINE_ELEMENT_INDEX_APPLY_TYPE]
-			grade = refine_element[self.REFINE_ELEMENT_INDEX_GRADE]
-			value = 0
-			for i in range(min(self.REFINE_ELEMENT_INDEX_MAX, grade)):
-				value += refine_element[self.REFINE_ELEMENT_INDEX_VALUE][i]
-
-			if self.isRefineElementItem:
-				min_value = uiRefine.RefineElementDialog.REFINE_ELEMENT_RANDOM_VALUE_MIN
-				max_value = uiRefine.RefineElementDialog.REFINE_ELEMENT_RANDOM_VALUE_MAX
-
-				affect_string = self.__GetRefineElementValueText(apply_type, min_value, max_value, value)
-				if affect_string:
-					self.AppendTextLine(affect_string, self.REFINE_ELEMENT_COLOR_DICT[apply_type])
-			else:
-				affect_string = self.__GetAffectString(apply_type, value)
-				if affect_string:
-					self.AppendTextLine(affect_string, self.REFINE_ELEMENT_COLOR_DICT[apply_type])
-
-		def __AppendRefineElementText(self, refine_element):
-			if not self.GetRefineElement(refine_element):
-				return
-
-			apply_type = refine_element[self.REFINE_ELEMENT_INDEX_APPLY_TYPE]
-			grade = refine_element[self.REFINE_ELEMENT_INDEX_GRADE]
-
-			affect_string = self.__GetRefineElementText(apply_type, grade)
-			if affect_string:
-				self.AppendSpace(self.REFINE_ELEMENT_TITLE_TEXT_GAP)
-				self.AppendTextLine(affect_string, self.REFINE_ELEMENT_COLOR_DICT[apply_type])
-
-		def __GetRefineElementText(self, apply_type, grade):
-			if apply_type == item.APPLY_ENCHANT_ELECT:
-				return localeInfo.REFINE_ELEMENT_TEXT_ELECT % grade
-			elif apply_type == item.APPLY_ENCHANT_FIRE:
-				return localeInfo.REFINE_ELEMENT_TEXT_FIRE % grade
-			elif apply_type == item.APPLY_ENCHANT_ICE:
-				return localeInfo.REFINE_ELEMENT_TEXT_ICE % grade
-			elif apply_type == item.APPLY_ENCHANT_WIND:
-				return localeInfo.REFINE_ELEMENT_TEXT_WIND % grade
-			elif apply_type == item.APPLY_ENCHANT_EARTH:
-				return localeInfo.REFINE_ELEMENT_TEXT_EARTH % grade
-			elif apply_type == item.APPLY_ENCHANT_DARK:
-				return localeInfo.REFINE_ELEMENT_TEXT_DARK % grade
-			else:
-				return None
-
-		def __GetRefineElementValueText(self, apply_type, min_value, max_value, value):
-			min_value += value
-			max_value += value
-
-			if apply_type == item.APPLY_ENCHANT_ELECT:
-				return localeInfo.TOOLTIP_APPLY_ENCHANT_ELECT2 % (min_value, max_value)
-			elif apply_type == item.APPLY_ENCHANT_FIRE:
-				return localeInfo.TOOLTIP_APPLY_ENCHANT_FIRE2 % (min_value, max_value)
-			elif apply_type == item.APPLY_ENCHANT_ICE:
-				return localeInfo.TOOLTIP_APPLY_ENCHANT_ICE2 % (min_value, max_value)
-			elif apply_type == item.APPLY_ENCHANT_WIND:
-				return localeInfo.TOOLTIP_APPLY_ENCHANT_WIND2 % (min_value, max_value)
-			elif apply_type == item.APPLY_ENCHANT_EARTH:
-				return localeInfo.TOOLTIP_APPLY_ENCHANT_EARTH2 % (min_value, max_value)
-			elif apply_type == item.APPLY_ENCHANT_DARK:
-				return localeInfo.TOOLTIP_APPLY_ENCHANT_DARK2 % (min_value, max_value)
-			else:
-				return " (+%d~+%d)" % (min_value, max_value)
-
-		def GetRefineElement(self, real_refine_element):
-			if not real_refine_element:
-				return None
-
-			return real_refine_element[self.REFINE_ELEMENT_INDEX_GRADE] > 0
-
-		def GetRefineElementCell(self, window_type, slot_index):
-			if window_type == player.INVENTORY or window_type == player.EQUIPMENT:
-				return player.GetItemRefineElement(window_type, slot_index)
-
 	def __GetAttributeColor(self, index, value):
 		if value > 0:
 			if index >= 5:
-				if app.ENABLE_ATTR_6TH_7TH and item.GetItemType() in [item.ITEM_TYPE_ARMOR, item.ITEM_TYPE_WEAPON, item.ITEM_TYPE_COSTUME]:
-					return self.ATTR_6TH_7TH_COLOR
-
 				return self.SPECIAL_POSITIVE_COLOR2
 			else:
 				return self.SPECIAL_POSITIVE_COLOR
@@ -1701,59 +1485,35 @@
 
 	def __SetPolymorphItemTitle(self, monsterVnum):
 		if localeInfo.IsVIETNAM():
-			itemName = item.GetItemName()
-			itemName += " "
-			itemName += nonplayer.GetMonsterName(monsterVnum)
+			itemName =item.GetItemName()
+			itemName+=" "
+			itemName+=nonplayer.GetMonsterName(monsterVnum)
 		else:
-			itemName = nonplayer.GetMonsterName(monsterVnum)
-			itemName += " "
-			itemName += item.GetItemName()
+			itemName =nonplayer.GetMonsterName(monsterVnum)
+			itemName+=" "
+			itemName+=item.GetItemName()
 		self.SetTitle(itemName)
 
-	if app.ENABLE_SET_ITEM:
-		def __SetNormalItemTitle(self, set_value = 0):
-			self.SetTitle(item.GetItemNameBySetValue(set_value))
-	else:
-		def __SetNormalItemTitle(self):
-			self.SetTitle(item.GetItemName())
-
-	if app.ENABLE_SET_ITEM:
-		def __SetSpecialItemTitle(self, set_value = 0):
-			self.AppendTextLine(item.GetItemNameBySetValue(set_value), self.SPECIAL_TITLE_COLOR)
-	else:
-		def __SetSpecialItemTitle(self):
-			self.AppendTextLine(item.GetItemName(), self.SPECIAL_TITLE_COLOR)
+	def __SetNormalItemTitle(self):
+		self.SetTitle(item.GetItemName())
 
-	if app.ENABLE_SET_ITEM:
-		def __SetItemTitle(self, itemVnum, metinSlot, attrSlot, set_value):
-			if localeInfo.IsCANADA():
-				if 72726 == itemVnum or 72730 == itemVnum:
-					self.AppendTextLine(item.GetItemName(), grp.GenerateColor(1.0, 0.7843, 0.0, 1.0))
-					return
+	def __SetSpecialItemTitle(self):
+		self.AppendTextLine(item.GetItemName(), self.SPECIAL_TITLE_COLOR)
 
-			if self.__IsPolymorphItem(itemVnum):
-				self.__SetPolymorphItemTitle(metinSlot[0])
-			else:
-				if self.__IsAttr(attrSlot):
-					self.__SetSpecialItemTitle(set_value)
-					return
-
-				self.__SetNormalItemTitle(set_value)
-	else:
-		def __SetItemTitle(self, itemVnum, metinSlot, attrSlot):
-			if localeInfo.IsCANADA():
-				if 72726 == itemVnum or 72730 == itemVnum:
-					self.AppendTextLine(item.GetItemName(), grp.GenerateColor(1.0, 0.7843, 0.0, 1.0))
-					return
+	def __SetItemTitle(self, itemVnum, metinSlot, attrSlot):
+		if localeInfo.IsCANADA():
+			if 72726 == itemVnum or 72730 == itemVnum:
+				self.AppendTextLine(item.GetItemName(), grp.GenerateColor(1.0, 0.7843, 0.0, 1.0))
+				return
 
-			if self.__IsPolymorphItem(itemVnum):
-				self.__SetPolymorphItemTitle(metinSlot[0])
-			else:
-				if self.__IsAttr(attrSlot):
-					self.__SetSpecialItemTitle()
-					return
+		if self.__IsPolymorphItem(itemVnum):
+			self.__SetPolymorphItemTitle(metinSlot[0])
+		else:
+			if self.__IsAttr(attrSlot):
+				self.__SetSpecialItemTitle()
+				return
 
-				self.__SetNormalItemTitle()
+			self.__SetNormalItemTitle()
 
 	def __IsAttr(self, attrSlot):
 		if not attrSlot:
@@ -1772,7 +1532,7 @@
 			if self.GetMetinItemIndex(metinSlotData) == constInfo.ERROR_METIN_STONE:
 				sockets[i] = player.METIN_SOCKET_TYPE_SILVER
 
-		self.AddItemData(item_vnum, sockets, attributes, rare_attr_slot, flags, 0, player.INVENTORY, -1, refine_element, apply_random_list, set_value)
+		self.AddItemData(item_vnum, sockets, attributes, rare_attr_slot, 0, 0, player.INVENTORY, -1, refine_element, apply_random_list, set_value)
 
 	def AddItemData_Offline(self, itemVnum, itemDesc, itemSummary, metinSlot, attrSlot):
 		self.__AdjustMaxWidth(attrSlot, itemDesc)
@@ -1840,9 +1600,9 @@
 
 			## 효과 적용/미적용
 			if metinSlot[1] and keep_time >= 60 and remain_count > 0:
-				self.AppendTextLine(localeInfo.SOUL_ITEM_TOOLTIP_APPLY, 0xff86e57f) # RGB(134,229,127)
+				self.AppendTextLine(localeInfo.SOUL_ITEM_TOOLTIP_APPLY, 0xff86e57f ) # RGB(134,229,127)
 			else:
-				self.AppendTextLine(localeInfo.SOUL_ITEM_TOOLTIP_UNAPPLIED, 0xfff15f5f) # RGB(241,95,95)
+				self.AppendTextLine(localeInfo.SOUL_ITEM_TOOLTIP_UNAPPLIED, 0xfff15f5f ) # RGB(241,95,95)
 			self.AppendSpace(5)
 
 			## 남은 횟수 
@@ -1869,16 +1629,10 @@
 
 	def AddItemData(self, itemVnum, metinSlot, attrSlot = 0, rare_attr_slot = None, flags = 0, unbindTime = 0, window_type = player.INVENTORY, slotIndex = -1, refine_element = None, apply_random_list = None, set_value = 0):
 		self.itemVnum = itemVnum
-		self.metinSlot = metinSlot
-		self.attrSlot = attrSlot
-
 		item.SelectItem(itemVnum)
 		itemType = item.GetItemType()
 		itemSubType = item.GetItemSubType()
 
-		if not item.GetItemDescription():
-			self.__CalculateToolTipWidth()
-
 		if 50026 == itemVnum:
 			if 0 != metinSlot:
 				name = item.GetItemName()
@@ -1886,7 +1640,7 @@
 					name += " "
 					name += localeInfo.NumberToMoneyString(metinSlot[0])
 				self.SetTitle(name)
-				if app.ENABLE_SOULBIND_SYSTEM:
+				if app.ENABLE_SOUL_BIND_SYSTEM:
 					self.__AppendSealInformation(window_type, slotIndex) ## cyh itemseal 2013 11 11
 				self.ShowToolTip()
 			return
@@ -1901,7 +1655,7 @@
 		if 50300 == itemVnum:
 			if 0 != metinSlot:
 				self.__SetSkillBookToolTip(metinSlot[0], localeInfo.TOOLTIP_SKILLBOOK_NAME, 1)
-				if app.ENABLE_SOULBIND_SYSTEM:
+				if app.ENABLE_SOUL_BIND_SYSTEM:
 					self.__AppendSealInformation(window_type, slotIndex) ## cyh itemseal 2013 11 11
 				self.ShowToolTip()
 			return
@@ -1910,7 +1664,7 @@
 				self.__SetSkillBookToolTip(metinSlot[0], localeInfo.TOOLTIP_SKILL_FORGET_BOOK_NAME, 0)
 				self.AppendDescription(item.GetItemDescription(), 26)
 				self.AppendDescription(item.GetItemSummary(), 26, self.CONDITION_COLOR)
-				if app.ENABLE_SOULBIND_SYSTEM:
+				if app.ENABLE_SOUL_BIND_SYSTEM:
 					self.__AppendSealInformation(window_type, slotIndex) ## cyh itemseal 2013 11 11
 				self.ShowToolTip()
 			return
@@ -1919,7 +1673,7 @@
 				self.__SetSkillBookToolTip(metinSlot[0], localeInfo.TOOLTIP_SKILL_FORGET_BOOK_NAME, 0)
 				self.AppendDescription(item.GetItemDescription(), 26)
 				self.AppendDescription(item.GetItemSummary(), 26, self.CONDITION_COLOR)
-				if app.ENABLE_SOULBIND_SYSTEM:
+				if app.ENABLE_SOUL_BIND_SYSTEM:
 					self.__AppendSealInformation(window_type, slotIndex) ## cyh itemseal 2013 11 11
 				self.ShowToolTip()
 			return
@@ -1943,7 +1697,6 @@
 		isCostumeMount = 0
 		isCostumeAcce = 0
 		isCostumeWeapon = 0
-		isCostumeAura = 0
 
 		if item.ITEM_TYPE_COSTUME == itemType:
 			isCostumeItem = 1
@@ -1955,14 +1708,9 @@
 				isCostumeAcce = item.COSTUME_TYPE_ACCE == itemSubType
 			if app.ENABLE_WEAPON_COSTUME_SYSTEM:
 				isCostumeWeapon = item.COSTUME_TYPE_WEAPON == itemSubType
-			if app.ENABLE_AURA_COSTUME_SYSTEM:
-				isCostumeAura = item.COSTUME_TYPE_AURA == itemSubType
 
 		self.__AdjustMaxWidth(attrSlot, itemDesc)
-		if app.ENABLE_SET_ITEM:
-			self.__SetItemTitle(itemVnum, metinSlot, attrSlot, set_value)
-		else:
-			self.__SetItemTitle(itemVnum, metinSlot, attrSlot)
+		self.__SetItemTitle(itemVnum, metinSlot, attrSlot)
 
 		if app.ENABLE_GROWTH_PET_SYSTEM and item.ITEM_TYPE_PET == itemType:
 			if item.PET_UPBRINGING == itemSubType:
@@ -1978,11 +1726,10 @@
 		if self.__IsHair(itemVnum):
 			self.__AppendHairIcon(itemVnum)
 
-		elif osfInfo.ENABLE_HYPERLINK_ITEM_ICON and isinstance(self, HyperlinkItemToolTip):
-			self.__AppendItemIcon(itemVnum)
-
-		if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-			self.__AppendRefineElementText(refine_element)
+		if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+			if self.isPrivateSearchItem:
+				if not self.__IsHair(itemVnum):
+					self.__AppendPrivateSearchItemIcon(itemVnum)
 
 		### Description ###
 		self.AppendDescription(itemDesc, 26)
@@ -1990,35 +1737,24 @@
 
 		### Weapon ###
 		if item.ITEM_TYPE_WEAPON == itemType:
-
 			self.__AppendLimitInformation()
 
 			self.AppendSpace(5)
 
 			## 부채일 경우 마공을 먼저 표시한다.
 			if item.WEAPON_FAN == itemSubType:
-				if app.ENABLE_APPLY_RANDOM:
-					self.__AppendMagicAttackInfo(metinSlot)
-					self.__AppendAttackPowerInfo(metinSlot, refine_element)
-				else:
-					self.__AppendMagicAttackInfo()
-					self.__AppendAttackPowerInfo()
+				self.__AppendMagicAttackInfo()
+				self.__AppendAttackPowerInfo()
 			else:
-				if app.ENABLE_APPLY_RANDOM:
-					self.__AppendAttackPowerInfo(metinSlot, refine_element)
-					self.__AppendMagicAttackInfo(metinSlot)
-				else:
-					self.__AppendAttackPowerInfo()
-					self.__AppendMagicAttackInfo()
+				self.__AppendAttackPowerInfo()
+				self.__AppendMagicAttackInfo()
 
 			self.__AppendAffectInformation()
 			if app.ENABLE_APPLY_RANDOM:
 				self.__AppendDefaultItemApplyInformation(apply_random_list)
-			if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-				self.__AppendRefineElementInformation(refine_element)
 			self.__AppendAttributeInformation(attrSlot)
-			if app.ENABLE_ATTR_6TH_7TH:
-				self.__AppendAttribute6th7thPossibility(attrSlot)
+			if app.ENABLE_67TH_BONUS:
+				self.__AppendRareAttributeInformation(attrSlot)
 
 			if app.ENABLE_CHANGE_LOOK_SYSTEM:
 				self.AppendChangeLookInformation(window_type, slotIndex)
@@ -2058,7 +1794,7 @@
 				if 1 != bHasRealtimeFlag:
 					self.__AppendMetinSlotInfo(metinSlot)
 
-			if app.ENABLE_NEW_USER_CARE:
+			if app.WJ_NEW_USER_CARE:
 				if item.WEAPON_QUIVER != itemSubType:
 					self.__AppendRealTimeToolTip(itemVnum, metinSlot[0])
 
@@ -2068,23 +1804,18 @@
 
 			## 방어력
 			defGrade = item.GetValue(1)
-			if app.ENABLE_APPLY_RANDOM:
-				minMax = metinSlot[item.ITEM_SOCKET_DEF_MINMAX_RANDOM]
-				if minMax != 0:
-					defGrade = minMax / item.ITEM_VALUE_MINMAX_RANDOM_DIVISION_VALUE
-
-			defBonus = item.GetValue(5) * 2 ## 방어력 표시 잘못 되는 문제를 수정
+			defBonus = item.GetValue(5)*2 ## 방어력 표시 잘못 되는 문제를 수정
 			if defGrade > 0:
 				self.AppendSpace(5)
-				self.AppendTextLine(localeInfo.TOOLTIP_ITEM_DEF_GRADE % (defGrade + defBonus), self.GetChangeTextLineColor(defGrade))
+				self.AppendTextLine(localeInfo.TOOLTIP_ITEM_DEF_GRADE % (defGrade+defBonus), self.GetChangeTextLineColor(defGrade))
 
 			self.__AppendMagicDefenceInfo()
 			self.__AppendAffectInformation()
 			if app.ENABLE_APPLY_RANDOM:
 				self.__AppendDefaultItemApplyInformation(apply_random_list)
 			self.__AppendAttributeInformation(attrSlot)
-			if app.ENABLE_ATTR_6TH_7TH:
-				self.__AppendAttribute6th7thPossibility(attrSlot)
+			if app.ENABLE_67TH_BONUS:
+				self.__AppendRareAttributeInformation(attrSlot)
 
 			if app.ENABLE_CHANGE_LOOK_SYSTEM:
 				self.AppendChangeLookInformation(window_type, slotIndex)
@@ -2092,12 +1823,9 @@
 			self.AppendWearableInformation()
 
 			if itemSubType in (item.ARMOR_WRIST, item.ARMOR_NECK, item.ARMOR_EAR):
-				self.__AppendAccessoryMetinSlotInfo(metinSlot, constInfo.GET_ACCESSORY_MATERIAL_VNUM(itemVnum, itemSubType), apply_random_list)
+				self.__AppendAccessoryMetinSlotInfo(metinSlot, constInfo.GET_ACCESSORY_MATERIAL_VNUM(itemVnum, itemSubType))
 			else:
-				if app.ENABLE_GLOVE_SYSTEM and itemSubType == item.ARMOR_GLOVE:
-					self.__AppendGloveMetinSlotInfo(metinSlot)
-				else:
-					self.__AppendMetinSlotInfo(metinSlot)
+				self.__AppendMetinSlotInfo(metinSlot)
 
 		### Ring Slot Item (Not UNIQUE) ###
 		elif item.ITEM_TYPE_RING == itemType:
@@ -2113,59 +1841,131 @@
 		### Belt Item ###
 		elif item.ITEM_TYPE_BELT == itemType:
 			self.__AppendLimitInformation()
-
-			if app.ENABLE_APPLY_RANDOM:
-				minMax = metinSlot[item.ITEM_SOCKET_BELT_DEF_MINMAX_RANDOM]
-				if minMax != 0:
-					defGrade = minMax / item.ITEM_VALUE_MINMAX_RANDOM_DIVISION_VALUE
-					defBonus = item.GetValue(5) * 2
-
-					self.AppendSpace(5)
-					self.AppendTextLine(localeInfo.TOOLTIP_ITEM_DEF_GRADE % (defGrade + defBonus), self.GetChangeTextLineColor(defGrade))
-
 			self.__AppendAffectInformation()
 			if app.ENABLE_APPLY_RANDOM:
 				self.__AppendDefaultItemApplyInformation(apply_random_list)
 			self.__AppendAttributeInformation(attrSlot)
+			if app.ENABLE_67TH_BONUS:
+				self.__AppendRareAttributeInformation(attrSlot)
 
-			if app.ENABLE_APPLY_RANDOM:
-				self.__AppendAccessoryMetinSlotInfo(metinSlot, constInfo.GET_BELT_MATERIAL_VNUM(itemVnum), apply_random_list)
-			else:
-				self.__AppendAccessoryMetinSlotInfo(metinSlot, constInfo.GET_BELT_MATERIAL_VNUM(itemVnum))
+			if osfInfo.SHOW_BELT_SLOTS_TOOLTIP == True:
+				self.AppendTextLine("%s: %s " % (localeInfo.TOOLTIP_ITEM_SLOTS, BELT_SLOTS[item.GetValue(0)]), self.SPECIAL_POSITIVE_COLOR)
+
+			self.__AppendAccessoryMetinSlotInfo(metinSlot, constInfo.GET_BELT_MATERIAL_VNUM(itemVnum))
 
 		## 코스츔 아이템 ##
 		elif 0 != isCostumeItem:
 			self.__AppendLimitInformation()
 
-			if app.ENABLE_ACCE_COSTUME_SYSTEM and item.GetItemSubType() == item.COSTUME_TYPE_ACCE:
-				self.__AppendAffectInformationAcce(slotIndex, window_type, metinSlot)
-				self.__AppendAcceItemAffectInformation(itemVnum, window_type, slotIndex, metinSlot, refine_element, apply_random_list)
-				if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-					self.__AppendRefineElementInformationAcce(window_type, slotIndex, metinSlot, refine_element)
-				self.__AppendAttributeInformationAcce(itemVnum, attrSlot, slotIndex, window_type, metinSlot)
-
-			elif app.ENABLE_AURA_COSTUME_SYSTEM and item.GetItemSubType() == item.COSTUME_TYPE_AURA:
-				self.__AppendAffectInformationAura(slotIndex, window_type, metinSlot)
-				self.__AppendAuraItemAffectInformation(itemVnum, window_type, slotIndex, metinSlot, apply_random_list)
-				self.__AppendAttributeInformationAura(itemVnum, attrSlot, slotIndex, window_type, metinSlot)
-
+			if app.ENABLE_ACCE_COSTUME_SYSTEM:
+				if item.GetItemSubType() == item.COSTUME_TYPE_ACCE:
+					## ABSORPTION RATE
+					absChance = int(metinSlot[acce.ABSORPTION_SOCKET])
+					self.AppendTextLine(localeInfo.TOOLTIP_APPLY_ACCEDRAIN_RATE(absChance), self.CONDITION_COLOR)
+					## END ABSOPRTION RATE
+
+					itemAbsorbedVnum = int(metinSlot[acce.ABSORBED_SOCKET])
+					if itemAbsorbedVnum:
+						## ATTACK / DEFENCE
+						item.SelectItem(itemAbsorbedVnum)
+						if item.GetItemType() == item.ITEM_TYPE_WEAPON:
+							if item.GetItemSubType() == item.WEAPON_FAN:
+								self.__AppendMagicAttackInfo(metinSlot[acce.ABSORPTION_SOCKET])
+								item.SelectItem(itemAbsorbedVnum)
+								self.__AppendAttackPowerInfo(metinSlot[acce.ABSORPTION_SOCKET])
+							else:
+								self.__AppendAttackPowerInfo(metinSlot[acce.ABSORPTION_SOCKET])
+								item.SelectItem(itemAbsorbedVnum)
+								self.__AppendMagicAttackInfo(metinSlot[acce.ABSORPTION_SOCKET])
+						elif item.GetItemType() == item.ITEM_TYPE_ARMOR:
+							defGrade = item.GetValue(1)
+							defBonus = item.GetValue(5) * 2
+							defGrade = self.CalcAcceValue(defGrade, metinSlot[acce.ABSORPTION_SOCKET])
+							defBonus = self.CalcAcceValue(defBonus, metinSlot[acce.ABSORPTION_SOCKET])
+
+							if defGrade > 0:
+								self.AppendSpace(5)
+								self.AppendTextLine(localeInfo.TOOLTIP_ITEM_DEF_GRADE % (defGrade + defBonus), self.GetChangeTextLineColor(defGrade))
+
+							item.SelectItem(itemAbsorbedVnum)
+							self.__AppendMagicDefenceInfo(metinSlot[acce.ABSORPTION_SOCKET])
+						## END ATTACK / DEFENCE
+
+						## EFFECT
+						item.SelectItem(itemAbsorbedVnum)
+						for i in xrange(item.ITEM_APPLY_MAX_NUM):
+							(affectType, affectValue) = item.GetAffect(i)
+							affectValue = self.CalcAcceValue(affectValue, metinSlot[acce.ABSORPTION_SOCKET])
+							affectString = self.__GetAffectString(affectType, affectValue)
+							if affectString and affectValue > 0:
+								self.AppendTextLine(affectString, self.GetChangeTextLineColor(affectValue))
+
+							item.SelectItem(itemAbsorbedVnum)
+						# END EFFECT
+
+						item.SelectItem(itemVnum)
+						## ATTR
+						self.__AppendAttributeInformation(attrSlot, metinSlot[acce.ABSORPTION_SOCKET])
+						# END ATTR
+					else:
+						# ATTR
+						self.__AppendAttributeInformation(attrSlot)
+						# END ATTR
+				else:
+					self.__AppendAffectInformation()
+					self.__AppendAttributeInformation(attrSlot)
 			else:
 				self.__AppendAffectInformation()
 				self.__AppendAttributeInformation(attrSlot)
 
 			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				if item.GetItemSubType() == item.COSTUME_TYPE_WEAPON or item.GetItemSubType() == item.COSTUME_TYPE_BODY:
-					self.AppendChangeLookInformation(window_type, slotIndex)
-
-				if item.GetItemSubType() == item.COSTUME_TYPE_MOUNT:
-					self.AppendChangeLookInformation(window_type, slotIndex)
+				self.AppendChangeLookInformation(window_type, slotIndex)
 
 			self.AppendWearableInformation()
 
 			bHasRealtimeFlag = 0
 			bHasRealtimeFirstFlag = 0
 
-			if item.GetItemSubType() != item.COSTUME_TYPE_ACCE:
+			if app.ENABLE_ACCE_COSTUME_SYSTEM:
+				if item.GetItemSubType() != item.COSTUME_TYPE_ACCE:
+					## 사용가능 시간 제한이 있는지 찾아보고
+					for i in xrange(item.LIMIT_MAX_NUM):
+						(limitType, limitValue) = item.GetLimit(i)
+
+						if item.LIMIT_REAL_TIME == limitType:
+							bHasRealtimeFlag = 1
+
+						if item.LIMIT_REAL_TIME_START_FIRST_USE == limitType:
+							bHasRealtimeFirstFlag = 1
+
+					if app.ENABLE_MOUNT_COSTUME_SYSTEM:
+						if item.GetItemSubType() == item.COSTUME_TYPE_MOUNT:
+							if not bHasRealtimeFirstFlag:
+								if 1 == bHasRealtimeFlag:
+									if app.ENABLE_COSTUME_EXTENDED_RECHARGE:
+										self.AppendMallItemLastTimeEx(metinSlot[0])
+									else:
+										self.AppendMallItemLastTime(metinSlot[0])
+								else:
+									time = metinSlot[player.METIN_SOCKET_MAX_NUM-1]
+
+									if 1 == item.GetValue(2): ## 실시간 이용 Flag / 장착 안해도 준다
+										self.AppendMallItemLastTime(time)
+									else:
+										self.AppendUniqueItemLastTime(time)
+						else:
+							if 1 == bHasRealtimeFlag:
+								if app.ENABLE_COSTUME_EXTENDED_RECHARGE:
+									self.AppendMallItemLastTimeEx(metinSlot[0])
+								else:
+									self.AppendMallItemLastTime(metinSlot[0])
+					else:
+						if 1 == bHasRealtimeFlag:
+							if app.ENABLE_COSTUME_EXTENDED_RECHARGE:
+								self.AppendMallItemLastTimeEx(metinSlot[0])
+							else:
+								self.AppendMallItemLastTime(metinSlot[0])
+			else:
 				## 사용가능 시간 제한이 있는지 찾아보고
 				for i in xrange(item.LIMIT_MAX_NUM):
 					(limitType, limitValue) = item.GetLimit(i)
@@ -2176,20 +1976,33 @@
 					if item.LIMIT_REAL_TIME_START_FIRST_USE == limitType:
 						bHasRealtimeFirstFlag = 1
 
-				if item.GetItemSubType() == item.COSTUME_TYPE_MOUNT:
-					if not bHasRealtimeFirstFlag:
-						if 1 == bHasRealtimeFlag:
-							self.AppendMallItemLastTime(metinSlot[0])
-						else:
-							time = metinSlot[player.ITEM_METIN_SOCKET_MAX - 1] # METIN_SOCKET_MAX_NUM
+				if app.ENABLE_MOUNT_COSTUME_SYSTEM:
+					if item.GetItemSubType() == item.COSTUME_TYPE_MOUNT:
+						if not bHasRealtimeFirstFlag:
+							if 1 == bHasRealtimeFlag:
+								if app.ENABLE_COSTUME_EXTENDED_RECHARGE:
+									self.AppendMallItemLastTimeEx(metinSlot[0])
+								else:
+									self.AppendMallItemLastTime(metinSlot[0])
+							else:
+								time = metinSlot[player.METIN_SOCKET_MAX_NUM-1]
 
-							if 1 == item.GetValue(2): ## 실시간 이용 Flag / 장착 안해도 준다
-								self.AppendMallItemLastTime(time)
+								if 1 == item.GetValue(2): ## 실시간 이용 Flag / 장착 안해도 준다
+									self.AppendMallItemLastTime(time)
+								else:
+									self.AppendUniqueItemLastTime(time)
+					else:
+						if 1 == bHasRealtimeFlag:
+							if app.ENABLE_COSTUME_EXTENDED_RECHARGE:
+								self.AppendMallItemLastTimeEx(metinSlot[0])
 							else:
-								self.AppendUniqueItemLastTime(time)
+								self.AppendMallItemLastTime(metinSlot[0])
 				else:
 					if 1 == bHasRealtimeFlag:
-						self.AppendMallItemLastTime(metinSlot[0])
+						if app.ENABLE_COSTUME_EXTENDED_RECHARGE:
+							self.AppendMallItemLastTimeEx(metinSlot[0])
+						else:
+							self.AppendMallItemLastTime(metinSlot[0])
 
 			if app.ENABLE_MOUNT_COSTUME_SYSTEM:
 				if item.GetItemSubType() == item.COSTUME_TYPE_MOUNT:
@@ -2200,38 +2013,11 @@
 		## Rod ##
 		elif item.ITEM_TYPE_ROD == itemType:
 			if 0 != metinSlot:
-				if app.ENABLE_FISHING_GAME and 27591 == itemVnum:
-					self.__AppendLimitInformation()
-
-					curLevel = item.GetValue(0) / 10
-
-					self.AppendSpace(5)
-					self.AppendTextLine(localeInfo.TOOLTIP_FISHINGROD_LEVEL % (curLevel), self.NORMAL_COLOR)
-
-					bHasRealtimeFlag = 0
-
-					for i in xrange(item.LIMIT_MAX_NUM):
-						(limitType, limitValue) = item.GetLimit(i)
-
-						if item.LIMIT_REAL_TIME == limitType:
-							bHasRealtimeFlag = 1
-
-					if 1 == bHasRealtimeFlag:
-						self.AppendMallItemLastTime(metinSlot[0])
-					else:
-						time = metinSlot[player.ITEM_METIN_SOCKET_MAX - 1] # METIN_SOCKET_MAX_NUM
-
-						if 1 == item.GetValue(2):
-							self.AppendMallItemLastTime(time)
-						else:
-							self.AppendUniqueItemLastTime(time)
-				else:
-					curLevel = item.GetValue(0) / 10
-					curEXP = metinSlot[0]
-					maxEXP = item.GetValue(2)
-
-					self.__AppendLimitInformation()
-					self.__AppendRodInformation(curLevel, curEXP, maxEXP)
+				curLevel = item.GetValue(0) / 10
+				curEXP = metinSlot[0]
+				maxEXP = item.GetValue(2)
+				self.__AppendLimitInformation()
+				self.__AppendRodInformation(curLevel, curEXP, maxEXP)
 
 		## Pick ##
 		elif item.ITEM_TYPE_PICK == itemType:
@@ -2275,20 +2061,40 @@
 
 				self.AppendTextLine(affectText, self.NORMAL_COLOR)
 
-				if time > 0:
-					minute = (time / 60)
-					second = (time % 60)
-					timeString = localeInfo.TOOLTIP_POTION_TIME
-
-					if minute > 0:
-						timeString += str(minute) + localeInfo.TOOLTIP_POTION_MIN
-					if second > 0:
-						timeString += " " + str(second) + localeInfo.TOOLTIP_POTION_SEC
+				if app.ENABLE_EXTENDED_BLEND_AFFECT:
+					status = metinSlot[3]
 
-					self.AppendTextLine(timeString)
-				# [MT-489] 제조창에 알수 없는 툴팁
-				#else:
-				#	self.AppendTextLine(localeInfo.BLEND_POTION_NO_TIME)
+					self.AppendSpace(10)
+					if status != 0:
+						self.AppendTextLine(localeInfo.BLEND_ITEM_TOOLTIP_APPLY, 0xff86e57f) # RGB(134, 229, 127)
+					else:
+						self.AppendTextLine(localeInfo.BLEND_ITEM_TOOLTIP_UNAPPLIED, 0xfff15f5f) # RGB(241, 95, 95)
+
+					self.AppendSpace(5)
+					if time > item.MIN_INFINITE_DURATION:
+						self.AppendTextLine(localeInfo.INFINITE_USE, self.CONDITION_COLOR)
+					else:
+						if time > 0:
+							endTime = app.GetGlobalTimeStamp() + time
+							leftSec = max(0, endTime - app.GetGlobalTimeStamp())
+							self.AppendTextLine(localeInfo.LEFT_TIME + " : " + localeInfo.SecondToDHMS(leftSec), self.NORMAL_COLOR)
+						else:
+							self.AppendTextLine(localeInfo.BLEND_ITEM_TOOLTIP_NO_TIME)
+				else:
+					if time > 0:
+						minute = (time / 60)
+						second = (time % 60)
+						timeString = localeInfo.TOOLTIP_POTION_TIME
+
+						if minute > 0:
+							timeString += str(minute) + localeInfo.TOOLTIP_POTION_MIN
+						if second > 0:
+							timeString += " " + str(second) + localeInfo.TOOLTIP_POTION_SEC
+
+						self.AppendTextLine(timeString)
+					# [MT-489] 제조창에 알수 없는 툴팁
+					#else:
+					#	self.AppendTextLine(localeInfo.BLEND_POTION_NO_TIME)
 			else:
 				self.AppendTextLine("BLEND_POTION_NO_INFO")
 
@@ -2305,7 +2111,7 @@
 				if 1 == bHasRealtimeFlag:
 					self.AppendMallItemLastTime(metinSlot[0])
 				else:
-					time = metinSlot[player.ITEM_METIN_SOCKET_MAX - 1] # METIN_SOCKET_MAX_NUM
+					time = metinSlot[player.METIN_SOCKET_MAX_NUM-1]
 
 					if 1 == item.GetValue(2): ## 실시간 이용 Flag / 장착 안해도 준다
 						self.AppendMallItemLastTime(time)
@@ -2323,7 +2129,7 @@
 				self.__AppendAbilityPotionInformation()
 
 			## 영석 감지기
-			if 27989 == itemVnum or 76006 == itemVnum or 79602 == itemVnum:
+			if 27989 == itemVnum or 76006 == itemVnum:
 				if 0 != metinSlot:
 					useCount = int(metinSlot[0])
 
@@ -2392,7 +2198,7 @@
 					# ... 이거... 서버에는 이런 시간 체크 안되어 있는데...
 					# 왜 이런게 있는지 알지는 못하나 그냥 두자...
 					if 0 != metinSlot:
-						time = metinSlot[player.ITEM_METIN_SOCKET_MAX - 1] # METIN_SOCKET_MAX_NUM
+						time = metinSlot[player.METIN_SOCKET_MAX_NUM-1]
 
 						## 실시간 이용 Flag
 						if 1 == item.GetValue(2):
@@ -2432,27 +2238,23 @@
 				if 1 == bHasRealtimeFlag:
 					self.AppendMallItemLastTime(metinSlot[0])
 
-			elif item.USE_AFFECT == itemSubType:
-				duration = item.GetValue(3)
-				if duration != 0 and duration < 0x1FFFFFFF:
-					self.AppendTextLine(localeInfo.TOOLTIP_DURATION + " : " + localeInfo.SecondToDHM(duration), self.CONDITION_COLOR)
-				else:
-					for i in xrange(item.LIMIT_MAX_NUM):
-						(limitType, limitValue) = item.GetLimit(i)
-
-						if item.LIMIT_DURATION == limitType:
-							self.AppendTextLine(localeInfo.TOOLTIP_DURATION + " : " + localeInfo.SecondToDHM(limitValue), self.CONDITION_COLOR)
-
+		#elif item.ITEM_TYPE_QUEST == itemType:
 		elif item.ITEM_TYPE_QUEST == itemType:
+			#if itemVnum >= 53001 and itemVnum <= 53306:
+			self.AppendSpace(5)
+			for g in xrange(item.ITEM_APPLY_MAX_NUM):
+				(affectType, affectValue) = item.GetAffect(g)
+				affectString = self.__GetAffectString(affectType, affectValue)
+				if affectString:
+					affectColor = self.GetChangeTextLineColor(affectValue)
+					self.AppendTextLine(affectString, affectColor)
+
 			for i in xrange(item.LIMIT_MAX_NUM):
 				(limitType, limitValue) = item.GetLimit(i)
 
 				if item.LIMIT_REAL_TIME == limitType:
 					self.AppendMallItemLastTime(metinSlot[0])
 
-				elif item.LIMIT_DURATION == limitType:
-					self.AppendTextLine(localeInfo.TOOLTIP_DURATION + " : " + localeInfo.SecondToDHM(limitValue), self.CONDITION_COLOR)
-
 		# app.ENABLE_PET_SYSTEM
 		elif item.ITEM_TYPE_PET == itemType and item.PET_PAY == itemSubType:
 			if osfInfo.PET_ITEM_ATTR_TOOLTIP == True:
@@ -2498,7 +2300,6 @@
 				
 			elif item.PET_BAG == itemSubType:
 				self.__AppendPetBagItemInfomation(metinSlot)
-
 		else:
 			self.__AppendLimitInformation()
 
@@ -2523,15 +2324,12 @@
 		else:
 			for i in xrange(item.LIMIT_MAX_NUM):
 				(limitType, limitValue) = item.GetLimit(i)
-				#dbg.TraceError("LimitType : %d, limitValue : %d" % (limitType, limitValue))
 
 				if item.LIMIT_REAL_TIME_START_FIRST_USE == limitType:
 					self.AppendRealTimeStartFirstUseLastTime(item, metinSlot, i)
-					#dbg.TraceError("2) REAL_TIME_START_FIRST_USE flag On")
 
 				elif item.LIMIT_TIMER_BASED_ON_WEAR == limitType:
 					self.AppendTimerBasedOnWearLastTime(metinSlot)
-					#dbg.TraceError("1) REAL_TIME flag On")
 
 		## 2015 크리스마스 이벤트 아이템으로 2개의 아이템은 REAL_TIME 이 아님에도 기간제 아이템이다
 		if self.itemVnum in [79505, 79506]:
@@ -2548,329 +2346,32 @@
 			if 0 != metinSlot[0]:
 				self.AppendMallItemLastTime(metinSlot[0])
 
-		if app.ENABLE_MINI_GAME_YUTNORI:
-			if self.itemVnum in [79507, 79508]:
-				if 0 != metinSlot[0]:
-					self.AppendMallItemLastTime(metinSlot[0])
+		# if app.ENABLE_MINI_GAME_YUTNORI:
+		if self.itemVnum in [79507, 79508]:
+			if 0 != metinSlot[0]:
+				self.AppendMallItemLastTime(metinSlot[0])
 
-		if app.ENABLE_GACHA:
-			if 0 != metinSlot and item.ITEM_TYPE_GACHA == itemType and itemSubType == item.USE_GACHA:
+		if app.ENABLE_BOSS_BOX:
+			if 0 != metinSlot and item.ITEM_TYPE_GACHA == itemType:
 				useCount = int(metinSlot[0])
 
 				self.AppendSpace(5)
 				self.AppendTextLine(localeInfo.TOOLTIP_REST_USABLE_COUNT % useCount, grp.GenerateColor(0.6705, 0.9490, 0.0, 1.0))
 
-		if app.ENABLE_SOULBIND_SYSTEM:
+		if app.ENABLE_SOUL_BIND_SYSTEM:
 			self.__AppendSealInformation(window_type, slotIndex) ## cyh itemseal 2013 11 11
 
-		#if osfInfo.SHOW_SELL_IMAGE_TEXT_LINE == True:
-		#	if slotIndex < player.EQUIPMENT_SLOT_START:
-		#		if not player.IsAntiFlagBySlot(slotIndex, item.ANTIFLAG_SELL):
-		#			self.AppendSpace(5)
-		#			self.AppendTextLine("|Ikey/ctrl|i + |Ikey/x|i + |Ikey/mouse_left|i - Remover")
+		if osfInfo.SHOW_SELL_IMAGE_TEXT_LINE == True:
+			if slotIndex < player.EQUIPMENT_SLOT_START:
+				if not player.IsAntiFlagBySlot(slotIndex, item.ANTIFLAG_SELL):
+					self.AppendSpace(5)
+					self.AppendTextLine("|Ikey/ctrl|i + |Ikey/x|i + |Ikey/mouse_left|i - Remover")
 
 		if osfInfo.SHOW_ITEM_VNUM_TOOTIP == True:
-			if chr.IsGameMaster(player.GetMainCharacterIndex()):
-				self.AppendSpace(5)
-				self.AppendTextLine("VNUM %d" % itemVnum, grp.GenerateColor(0.6705, 0.9490, 0.0, 1.0))
-
-		self.ShowToolTip()
-
-	if app.ENABLE_GROWTH_PET_SYSTEM:
-		def AddHyperLinkPetItemData(self, itemVnum, metinSlot, attrSlot, pet_info):
-			
-			pet_level			= int(pet_info[0], 16)
-			pet_birthday		= int(pet_info[1], 16)
-			pet_evol_level		= int(pet_info[2], 16)
-			pet_hp				= int(pet_info[3], 16) / 10.0
-			pet_def				= int(pet_info[4], 16) / 10.0
-			pet_sp				= int(pet_info[5], 16) / 10.0
-			pet_life_time		= int(pet_info[6], 16)
-			pet_life_time_max	= int(pet_info[7], 16)
-			pet_skill_count		= int(pet_info[8], 16)
-			pet_item_vnum		= int(pet_info[9], 16)
-			pet_nick_name		= pet_info[10]
-						
-			pet_skill_vnum		= [0] * player.PET_SKILL_COUNT_MAX
-			pet_skill_level		= [0] * player.PET_SKILL_COUNT_MAX
-			
-			skill_index = 11
-			for index in range(player.PET_SKILL_COUNT_MAX):
-				pet_skill_vnum[index]	= int(pet_info[skill_index], 16)
-				skill_index = skill_index + 1
-				pet_skill_level[index]	= int(pet_info[skill_index], 16)
-				skill_index = skill_index + 1
-				
-			self.itemVnum = itemVnum
-			item.SelectItem(itemVnum)
-			itemType = item.GetItemType()
-			itemSubType = item.GetItemSubType()
-			itemDesc = item.GetItemDescription()
-			itemSummary = item.GetItemSummary()
-
-			if item.ITEM_TYPE_PET != itemType:
-				return
-			
-			if itemSubType not in [item.PET_UPBRINGING, item.PET_BAG]:
-				return
-			
-			if item.PET_BAG == itemSubType:
-				self.itemVnum = pet_item_vnum
-				item.SelectItem(pet_item_vnum)
-				pet_bag_desc = localeInfo.PET_BAG_DESC % item.GetItemName()
-				self.__AdjustMaxWidth(0, pet_bag_desc)
-				self.itemVnum = itemVnum
-				item.SelectItem(itemVnum)
-
-			if item.PET_BAG == itemSubType:
-				self.AppendTextLine( pet_nick_name + "(" + localeInfo.PET_TOOLTIP_TRADABLE + ")", self.TITLE_COLOR )
-			elif item.PET_UPBRINGING == itemSubType:
-				self.AppendTextLine( pet_nick_name, self.TITLE_COLOR)
-				
-			## Pet Type
-			PET_TYPES = [
-				0,
-				localeInfo.PET_ATTR_DETERMINE_TYPE1_TOOLTIP,
-				localeInfo.PET_ATTR_DETERMINE_TYPE2_TOOLTIP,
-				localeInfo.PET_ATTR_DETERMINE_TYPE3_TOOLTIP,
-				localeInfo.PET_ATTR_DETERMINE_TYPE4_TOOLTIP,
-				localeInfo.PET_ATTR_DETERMINE_TYPE5_TOOLTIP,
-				localeInfo.PET_ATTR_DETERMINE_TYPE6_TOOLTIP,
-				localeInfo.PET_ATTR_DETERMINE_TYPE7_TOOLTIP,
-				localeInfo.PET_ATTR_DETERMINE_TYPE8_TOOLTIP,
-			]
-			
-			pet_type = metinSlot[3]
-			self.AppendSpace(5)
-			self.AppendTextLine(PET_TYPES[pet_type], self.SPECIAL_POSITIVE_COLOR2)
-			
-			## ??
-			if item.PET_UPBRINGING == itemSubType:
-				self.AppendDescription(itemDesc, 26)
-				self.AppendDescription(itemSummary, 26, self.CONDITION_COLOR)
-			elif item.PET_BAG == itemSubType:
-				self.AppendDescription(pet_bag_desc, 26)
-				self.itemVnum = itemVnum
-				item.SelectItem(itemVnum)
-
-			self.AppendSpace(5)
-			if item.PET_UPBRINGING == itemSubType:
-				cur_time = app.GetGlobalTimeStamp()
-				
-				# Pet's age stops at their death
-				if metinSlot[0] < cur_time:
-					pet_birthday = max(0, metinSlot[0] - pet_birthday)
-				else:
-					pet_birthday = max(0, cur_time - pet_birthday)
-					
-			elif item.PET_BAG == itemSubType:
-				cur_time	 = app.GetGlobalTimeStamp()
-				pet_birthday = max(0, cur_time - pet_birthday + (cur_time - metinSlot[1]))
-				
-			self.AppendTextLine(localeInfo.PET_TOOLTIP_LEVEL + " " + str(pet_level) + " (" + localeInfo.SecondToDay(pet_birthday) + ")")
-
-			self.AppendSpace(5)
-			if pet_skill_count:
-				self.AppendTextLine( self.GetEvolName(pet_evol_level) + "(" + str(pet_skill_count) + ")")
-			else:
-				self.AppendTextLine( self.GetEvolName(pet_evol_level) )
-
 			self.AppendSpace(5)
-			self.AppendTextLine(localeInfo.PET_TOOLTIP_HP + " +" + str("%0.1f" % pet_hp) + "%", self.SPECIAL_POSITIVE_COLOR)
-			self.AppendTextLine(localeInfo.PET_TOOLTIP_SP + " +" + str("%0.1f" % pet_sp) + "%", self.SPECIAL_POSITIVE_COLOR)
-			self.AppendTextLine(localeInfo.PET_TOOLTIP_DEF + " +" + str("%0.1f" % pet_def) + "%", self.SPECIAL_POSITIVE_COLOR)
-
-			for index in range(player.PET_SKILL_COUNT_MAX):
-				if pet_skill_vnum[index]:
-					self.AppendSpace(5)
-					( pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time ) = skill.GetPetSkillInfo(pet_skill_vnum[index])
-					self.AppendTextLine( localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level[index]) , self.SPECIAL_POSITIVE_COLOR)
-						
-			for i in xrange(item.LIMIT_MAX_NUM):
-				(limitType, limitValue) = item.GetLimit(i)
-				if item.LIMIT_REAL_TIME == limitType:
-					self.AppendPetItemLastTime(metinSlot[0])
-				if item.LIMIT_REAL_TIME_START_FIRST_USE == limitType:
-					self.AppendPetItemLastTime(metinSlot[0])
-
-			
-			self.ShowToolTip()
-			
-		def GetEvolName(self, evol_level):
-		
-			if 1 == evol_level:
-				return localeInfo.PET_INFORMATION_STAGE1
-			elif 2 == evol_level:
-				return localeInfo.PET_INFORMATION_STAGE2
-			elif 3 == evol_level:
-				return localeInfo.PET_INFORMATION_STAGE3
-			elif 4 == evol_level:
-				return localeInfo.PET_INFORMATION_STAGE4
-				
-			return localeInfo.PET_INFORMATION_STAGE1
-		
-		def __AppendPetBagItemInfomation(self, metinSlot):
-			pet_id = metinSlot[2]
-			if pet_id:
-				self.ClearToolTip()
-				growhPetVNum = player.GetPetItemVNumInBag(pet_id)
-				if 0 == growhPetVNum:
-					return
-
-				item.SelectItem(growhPetVNum)
-				pet_bag_desc = localeInfo.PET_BAG_DESC % item.GetItemName()
-				self.__AdjustMaxWidth(0, pet_bag_desc)
-
-				(pet_level, evol_level, birthday, pet_nick, pet_hp, pet_def, pet_sp) = player.GetPetItem(pet_id)
-				self.AppendTextLine( pet_nick + "(" + localeInfo.PET_TOOLTIP_TRADABLE + ")", self.TITLE_COLOR )
-				
-				## Pet Type
-				PET_TYPES = [
-					0,
-					localeInfo.PET_ATTR_DETERMINE_TYPE1_TOOLTIP,
-					localeInfo.PET_ATTR_DETERMINE_TYPE2_TOOLTIP,
-					localeInfo.PET_ATTR_DETERMINE_TYPE3_TOOLTIP,
-					localeInfo.PET_ATTR_DETERMINE_TYPE4_TOOLTIP,
-					localeInfo.PET_ATTR_DETERMINE_TYPE5_TOOLTIP,
-					localeInfo.PET_ATTR_DETERMINE_TYPE6_TOOLTIP,
-					localeInfo.PET_ATTR_DETERMINE_TYPE7_TOOLTIP,
-					localeInfo.PET_ATTR_DETERMINE_TYPE8_TOOLTIP,
-				]
-				
-				pet_type = metinSlot[3]
-				self.AppendSpace(5)
-				self.AppendTextLine(PET_TYPES[pet_type], self.SPECIAL_POSITIVE_COLOR2)
-
-				## DESC
-				self.AppendDescription(pet_bag_desc, 26)
-				
-				item.SelectItem(self.itemVnum)
-
-				(skill_count, pet_skill1, pet_skill_level1, pet_skill_cool1, pet_skill2, pet_skill_level2, pet_skill_cool2, pet_skill3, pet_skill_level3, pet_skill_cool3) = player.GetPetSkill(pet_id)
-
-				self.AppendSpace(5)
-
-				cur_time = app.GetGlobalTimeStamp()
-				birthSec = max(0, cur_time - birthday - (cur_time - metinSlot[1]))
-				
-				self.AppendTextLine(localeInfo.PET_TOOLTIP_LEVEL + " " + str(pet_level) + " (" + localeInfo.SecondToDay(birthSec) + ")")
-
-				## Pet Evolution/Skill Count
-				self.AppendSpace(5)
-				if skill_count:
-					self.AppendTextLine( self.GetEvolName(evol_level) + "(" + str(skill_count) + ")")
-				else:
-					self.AppendTextLine( self.GetEvolName(evol_level) )
-					
-				## Pet Stats
-				self.AppendSpace(5)
-				self.AppendTextLine(localeInfo.PET_TOOLTIP_HP + " +" + str("%0.1f" % pet_hp) + "%", self.SPECIAL_POSITIVE_COLOR)
-				self.AppendTextLine(localeInfo.PET_TOOLTIP_SP + " +" + str("%0.1f" % pet_sp) + "%", self.SPECIAL_POSITIVE_COLOR)
-				self.AppendTextLine(localeInfo.PET_TOOLTIP_DEF + " +" + str("%0.1f" % pet_def) + "%", self.SPECIAL_POSITIVE_COLOR)
+			self.AppendTextLine("VNUM %d" % itemVnum, grp.GenerateColor(0.6705, 0.9490, 0.0, 1.0))
 
-				## Pet Skills
-				if pet_skill1:
-					self.AppendSpace(5)
-					( pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time ) = skill.GetPetSkillInfo(pet_skill1)
-					self.AppendTextLine( localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level1) , self.SPECIAL_POSITIVE_COLOR)
-				if pet_skill2:
-					( pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time ) = skill.GetPetSkillInfo(pet_skill2)
-					self.AppendTextLine( localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level2) , self.SPECIAL_POSITIVE_COLOR)
-				if pet_skill3:
-					( pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time) = skill.GetPetSkillInfo(pet_skill3)
-					self.AppendTextLine( localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level3) , self.SPECIAL_POSITIVE_COLOR)
-
-				## Bag Duration
-				for i in xrange(item.LIMIT_MAX_NUM):
-					(limitType, limitValue) = item.GetLimit(i)
-					if item.LIMIT_REAL_TIME_START_FIRST_USE == limitType:
-						self.AppendPetItemLastTime(metinSlot[0])
-
-		def __AppendPetEggItemInformation(self, metinSlot, isFeedWindow = False):
-			for i in xrange(item.LIMIT_MAX_NUM):
-				(limitType, limitValue) = item.GetLimit(i)
-				if item.LIMIT_REAL_TIME == limitType:
-					if metinSlot[0] == 0:
-						self.AppendMallItemLastTime(limitValue, True)
-					else:
-						self.AppendMallItemLastTime(metinSlot[0])
-
-		def __AppendUpBringingPetItemInfomation(self, metinSlot):
-			pet_id = metinSlot[2]
-			if pet_id:
-				## Pet Type
-				PET_TYPES = [
-					0,
-					localeInfo.PET_ATTR_DETERMINE_TYPE1_TOOLTIP,
-					localeInfo.PET_ATTR_DETERMINE_TYPE2_TOOLTIP,
-					localeInfo.PET_ATTR_DETERMINE_TYPE3_TOOLTIP,
-					localeInfo.PET_ATTR_DETERMINE_TYPE4_TOOLTIP,
-					localeInfo.PET_ATTR_DETERMINE_TYPE5_TOOLTIP,
-					localeInfo.PET_ATTR_DETERMINE_TYPE6_TOOLTIP,
-					localeInfo.PET_ATTR_DETERMINE_TYPE7_TOOLTIP,
-					localeInfo.PET_ATTR_DETERMINE_TYPE8_TOOLTIP,
-				]
-				
-				pet_type = metinSlot[3]
-				self.AppendSpace(5)
-				self.AppendTextLine(PET_TYPES[pet_type], self.SPECIAL_POSITIVE_COLOR2)
-			
-				## Skills
-				(skill_count, pet_skill1, pet_skill_level1, pet_skill_cool1, pet_skill2, pet_skill_level2, pet_skill_cool2, pet_skill3, pet_skill_level3, pet_skill_cool3) = player.GetPetSkill(pet_id)
-				
-				## Pet Level/Age
-				(pet_level, evol_level, birthday, pet_nick, pet_hp, pet_def, pet_sp) = player.GetPetItem(pet_id)
-				self.AppendSpace(5)
-				
-				curTime = app.GetGlobalTimeStamp()
-				birthSec = 0
-				
-				# Pet's age stops at their death
-				if metinSlot[0] < curTime:
-					birthSec = max(0, metinSlot[0] - birthday)
-				else:
-					birthSec = max(0, curTime - birthday)
-				self.AppendTextLine(localeInfo.PET_TOOLTIP_LEVEL + " " + str(pet_level) + " (" + localeInfo.SecondToDay(birthSec) + ")")
-			
-				## Pet Evolution/Skill Count
-				self.AppendSpace(5)
-				if skill_count:
-					self.AppendTextLine( self.GetEvolName(evol_level) + "(" + str(skill_count) + ")")
-				else:
-					self.AppendTextLine( self.GetEvolName(evol_level) )
-					
-				## Pet Stats
-				self.AppendSpace(5)
-				self.AppendTextLine(localeInfo.PET_TOOLTIP_HP + " +" + str("%0.1f" % pet_hp) + "%", self.SPECIAL_POSITIVE_COLOR)
-				self.AppendTextLine(localeInfo.PET_TOOLTIP_SP + " +" + str("%0.1f" % pet_sp) + "%", self.SPECIAL_POSITIVE_COLOR)
-				self.AppendTextLine(localeInfo.PET_TOOLTIP_DEF + " +" + str("%0.1f" % pet_def) + "%", self.SPECIAL_POSITIVE_COLOR)
-				
-				## Pet Skills
-				if pet_skill1:
-					self.AppendSpace(5)
-					( pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time ) = skill.GetPetSkillInfo(pet_skill1)
-					self.AppendTextLine( localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level1) , self.SPECIAL_POSITIVE_COLOR)
-				if pet_skill2:
-					( pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time ) = skill.GetPetSkillInfo(pet_skill2)
-					self.AppendTextLine( localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level2) , self.SPECIAL_POSITIVE_COLOR)
-				if pet_skill3:
-					( pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time) = skill.GetPetSkillInfo(pet_skill3)
-					self.AppendTextLine( localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level3) , self.SPECIAL_POSITIVE_COLOR)
-					
-				## Pet Duration
-				for i in xrange(item.LIMIT_MAX_NUM):
-					(limitType, limitValue) = item.GetLimit(i)
-					if item.LIMIT_REAL_TIME == limitType:
-						self.AppendPetItemLastTime(metinSlot[0])
-			
-		def AppendPetItemLastTime(self, endTime):
-			self.AppendSpace(5)
-			
-			leftSec = endTime - app.GetGlobalTimeStamp()
-			if leftSec >= 0:
-				self.AppendTextLine(localeInfo.LEFT_TIME + " : " + localeInfo.SecondToDHM(leftSec), self.NORMAL_COLOR)
-			else:
-				self.AppendTextLine(localeInfo.LEFT_TIME + " : " + localeInfo.PET_TOOLTIP_LIFETIME_OVER, self.DISABLE_COLOR)
+		self.ShowToolTip()
 
 	def __DragonSoulInfoString (self, dwVnum):
 		step = (dwVnum / 100) % 10
@@ -2922,6 +2423,18 @@
 	def __IsCostumeHair(self, itemVnum):
 		return self.__IsNewHair3(itemVnum - 100000)
 
+	if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+		def __AppendPrivateSearchItemIcon(self, itemVnum):
+			itemImage = ui.ImageBox()
+			itemImage.SetParent(self)
+			itemImage.Show()
+			item.SelectItem(itemVnum)
+			itemImage.LoadImage(item.GetIconImageFileName())
+			itemImage.SetPosition((self.toolTipWidth / 2) - 16, self.toolTipHeight)
+			self.toolTipHeight += itemImage.GetHeight()
+			self.childrenList.append(itemImage)
+			self.ResizeToolTip()
+
 	def __AppendHairIcon(self, itemVnum):
 		itemImage = ui.ImageBox()
 		itemImage.SetParent(self)
@@ -2941,68 +2454,21 @@
 		elif self.__IsCostumeHair(itemVnum):
 			itemImage.LoadImage("icon/hair/%d.sub" % (itemVnum - 100000))
 
-		itemImage.SetPosition(itemImage.GetWidth() / 2, self.toolTipHeight)
+		if app.ENABLE_PRIVATESHOP_SEARCH_SYSTEM:
+			if self.isPrivateSearchItem:
+				itemImage.SetPosition((self.toolTipWidth / 2) - 48, self.toolTipHeight)
+			else:
+				itemImage.SetPosition((self.toolTipWidth / 2) - 48, self.toolTipHeight)
+		else:
+			itemImage.SetPosition(itemImage.GetWidth() / 2, self.toolTipHeight)
 
+		itemImage.SetPosition(0, self.toolTipHeight)
 		self.toolTipHeight += itemImage.GetHeight()
-		#self.toolTipWidth += itemImage.GetWidth() / 2
+		#self.toolTipWidth += itemImage.GetWidth()/2
+		itemImage.SetWindowHorizontalAlignCenter()
 		self.childrenList.append(itemImage)
 		self.ResizeToolTip()
 
-	if osfInfo.ENABLE_HYPERLINK_ITEM_ICON:
-		def __AppendItemIcon(self, itemVnum):
-			itemImage = ui.ImageBox()
-			itemImage.SetParent(self)
-			item.SelectItem(itemVnum)
-			itemImage.LoadImage(item.GetIconImageFileName())
-			itemImage.SetPosition(self.toolTipWidth / 2 - itemImage.GetWidth() / 2, self.toolTipHeight)
-			itemImage.Show()
-
-			self.toolTipHeight += itemImage.GetHeight()
-			self.childrenList.append(itemImage)
-			self.ResizeToolTip()
-
-	def ResizeToolTipWidth(self, width):
-		self.toolTipWidth = width
-
-	def __CalculateToolTipWidth(self):
-		affectTextLineList = []
-
-		metinSocket = self.metinSlot
-		if metinSocket:
-			for socketIndex in metinSocket:
-				if socketIndex:
-					item.SelectItem(socketIndex)
-
-					affectType, affectValue = item.GetAffect(0)
-					affectString = self.__GetAffectString(affectType, affectValue)
-					if affectString:
-						affectTextLineList.append(affectString)
-
-			if self.itemVnum:
-				item.SelectItem(self.itemVnum)
-			self.metinSlot = None
-
-		attrSlot = self.attrSlot
-		if attrSlot:
-			for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
-				type = attrSlot[i][0]
-				value = attrSlot[i][1]
-
-				if 0 == value:
-					continue
-
-				affectString = self.__GetAffectString(type, value)
-				if affectString:
-					affectTextLineList.append(affectString)
-
-			self.attrSlot = None
-
-		if self.toolTipWidth == self.TOOL_TIP_WIDTH:
-			if affectTextLineList:
-				self.toolTipWidth += (app.GetTextWidth(max(affectTextLineList, key = len)) / 2)
-
-		self.AlignTextLineHorizonalCenter()
-
 	## 사이즈가 큰 Description 일 경우 툴팁 사이즈를 조정한다
 	def __AdjustMaxWidth(self, attrSlot, desc):
 		newToolTipWidth = self.toolTipWidth
@@ -3063,8 +2529,8 @@
 
 	def __AppendRodInformation(self, curLevel, curEXP, maxEXP):
 		self.AppendSpace(5)
-
 		self.AppendTextLine(localeInfo.TOOLTIP_FISHINGROD_LEVEL % (curLevel), self.NORMAL_COLOR)
+
 		self.AppendTextLine(localeInfo.TOOLTIP_FISHINGROD_EXP % (curEXP, maxEXP), self.NORMAL_COLOR)
 
 		if curEXP == maxEXP:
@@ -3104,37 +2570,17 @@
 				self.AppendTextLine(localeInfo.TOOLTIP_ITEM_LIMIT_CON % (limitValue), color)
 			"""
 
-	if app.ENABLE_SOULBIND_SYSTEM:
+	if app.ENABLE_SOUL_BIND_SYSTEM:
 		## cyh itemseal 2013 11 11
 		def __AppendSealInformation(self, window_type, slotIndex):
-			if not self.isShopItem:
-				itemSealDate = player.GetItemSealDate(window_type, slotIndex)
-				if itemSealDate == item.GetUnlimitedSealDate():
-					self.AppendSpace(5)
-					self.AppendTextLine(localeInfo.TOOLTIP_SEALED, self.NEGATIVE_COLOR)
-				elif itemSealDate > 0:
-					self.AppendSpace(5)
-					hours, minutes = player.GetItemUnSealLeftTime(window_type, slotIndex)
-					self.AppendTextLine(localeInfo.TOOLTIP_UNSEAL_LEFT_TIME % (hours, minutes), self.NEGATIVE_COLOR)
-
-	if app.ENABLE_CHANGED_ATTR:
-		def GetAffectString(self, affectType, affectValue):
-			if 0 == affectType:
-				return None
-
-			if 0 == affectValue:
-				return None
-
-			try:
-				#if app.ENABLE_COSTUME_ATTR_RENEWAL_SECOND:
-				#	if affectValue < 0 and affectType in self.AFFECT_MINUS_DICT:
-				#		return self.AFFECT_MINUS_DICT[affectType](affectValue)
-
-				return self.AFFECT_DICT[affectType](affectValue)
-			except TypeError:
-				return "UNKNOWN_VALUE[%s] %s" % (affectType, affectValue)
-			except KeyError:
-				return "UNKNOWN_TYPE[%s] %s" % (affectType, affectValue)
+			itemSealDate = player.GetItemSealDate(window_type, slotIndex)
+			if itemSealDate == item.GetUnlimitedSealDate():
+				self.AppendSpace(5)
+				self.AppendTextLine(localeInfo.TOOLTIP_SEALED, self.NEGATIVE_COLOR)
+			elif itemSealDate > 0:
+				self.AppendSpace(5)
+				hours, minutes = player.GetItemUnSealLeftTime(window_type, slotIndex)
+				self.AppendTextLine(localeInfo.TOOLTIP_UNSEAL_LEFT_TIME % (hours, minutes), self.NEGATIVE_COLOR )
 
 	def __GetAffectString(self, affectType, affectValue):
 		if 0 == affectType:
@@ -3154,417 +2600,17 @@
 		except KeyError:
 			return "UNKNOWN_TYPE[%s] %s" % (affectType, affectValue)
 
-	if app.ENABLE_ACCE_COSTUME_SYSTEM:
-		def __AppendAffectInformationAcce(self, slotIndex, window_type, metinSlot):
-			for i in xrange(item.ITEM_APPLY_MAX_NUM):
-				(affectType, affectValue) = item.GetAffect(i)
-
-				if item.GetRefinedVnum() == 0:
-					## 전설등급 흡수율 알아오기.
-					socketInDrainValue = 0
-					if window_type == player.INVENTORY or window_type == player.EQUIPMENT:
-						socketInDrainValue = player.GetItemMetinSocket(window_type, slotIndex, 1)
-						if not metinSlot[1] == 0 and socketInDrainValue == 0:
-							socketInDrainValue = metinSlot[1]
-					elif window_type == player.ACCEREFINE:
-						socketInDrainValue = player.GetAcceItemMetinSocket(slotIndex, 1)
-					elif window_type == player.SAFEBOX:
-						socketInDrainValue = safebox.GetItemMetinSocket(slotIndex, 1)
-
-					affectString = self.__GetAffectString(affectType, socketInDrainValue)
-				else:
-					affectString = self.__GetAffectString(affectType, affectValue)
-
-				if affectString:
-					if affectType == item.APPLY_ACCEDRAIN_RATE:
-						self.AppendTextLine(affectString, self.CONDITION_COLOR)
-				else:
-					if app.ENABLE_ACCE_SECOND_COSTUME_SYSTEM:
-						if affectType == item.APPLY_ACCEDRAIN_RATE:
-							if item.GetRefinedVnum() == 0 and slotIndex == 2 and socketInDrainValue == 0 and window_type == player.ACCEREFINE:
-								socketInDrainValue = player.GetAcceItemMetinSocket(0, 1)
-								## 메인에 등록된 아이템이 전설일때만.
-								if socketInDrainValue == 0:
-									return
-								plusdrainlate = 5
-								if socketInDrainValue >= 21:
-									plusdrainlate = plusdrainlate - (socketInDrainValue - 20)
-								affectString = localeInfo.TOOLTIP_APPLY_ACCEDRAIN_RATE(socketInDrainValue) + " ~ %d%%" % (socketInDrainValue + plusdrainlate)
-								self.AppendTextLine(affectString, self.CONDITION_COLOR)
-					else:
-						pass
-
-		if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-			def __AppendRefineElementInformationAcce(self, window_type, slotIndex, metinSlot, refine_element):
-				if refine_element == None:
-					return
-
-				(affectTypeAcce, affectValueAcce) = item.GetAffect(0)
-				socketInDrainValue = 0
-
-				if item.GetRefinedVnum() == 0:
-					## 전설등급 흡수율 알아오기.
-					socketInDrainValue = 0
-					if window_type == player.INVENTORY or window_type == player.EQUIPMENT:
-						socketInDrainValue = player.GetItemMetinSocket(window_type, slotIndex, 1)
-						if not metinSlot[1] == 0 and socketInDrainValue == 0:
-							socketInDrainValue = metinSlot[1]
-					elif window_type == player.ACCEREFINE:
-						socketInDrainValue = player.GetAcceItemMetinSocket(slotIndex, 1)
-					elif window_type == player.SAFEBOX:
-						socketInDrainValue = safebox.GetItemMetinSocket(slotIndex, 1)
-
-					drainlate = socketInDrainValue / 100.0
-				else:
-					drainlate = affectValueAcce / 100.0
-					socketInDrainValue = affectValueAcce
-
-				if socketInDrainValue == 0:
-					return
-
-				apply_type = refine_element[self.REFINE_ELEMENT_INDEX_APPLY_TYPE]
-				grade = refine_element[self.REFINE_ELEMENT_INDEX_GRADE]
-				value = 0
-				for i in range(min(self.REFINE_ELEMENT_INDEX_MAX, grade)):
-					value += refine_element[self.REFINE_ELEMENT_INDEX_VALUE][i]
-
-				value = max((value * drainlate) , 1)
-
-				affect_string = self.__GetAffectString(apply_type, value)
-				if affect_string:
-					self.AppendTextLine(affect_string, self.REFINE_ELEMENT_COLOR_DICT[apply_type])
-
-		def AppendTextLineAcce(self, text, color):
-			self.AppendTextLine(text, color)
-
-		def __AppendAcceItemAffectInformation(self, oriitemVnum, window_type, slotIndex, metinSlot, refine_element, apply_random_list):
-			(affectTypeAcce, affectValueAcce) = item.GetAffect(0)
-			socketInDrainValue = 0
-
-			if item.GetRefinedVnum() == 0:
-				## 전설등급 흡수율 알아오기.
-				socketInDrainValue = 0
-				if window_type == player.INVENTORY or window_type == player.EQUIPMENT:
-					socketInDrainValue = player.GetItemMetinSocket(window_type, slotIndex, 1)
-					if not metinSlot[1] == 0 and socketInDrainValue == 0:
-						socketInDrainValue = metinSlot[1]
-				elif window_type == player.ACCEREFINE:
-					socketInDrainValue = player.GetAcceItemMetinSocket(slotIndex, 1)
-				elif window_type == player.SAFEBOX:
-					socketInDrainValue = safebox.GetItemMetinSocket(slotIndex, 1)
-
-				drainlate = socketInDrainValue / 100.0
-			else:
-				drainlate = affectValueAcce / 100.0
-				socketInDrainValue = affectValueAcce
-
-			if socketInDrainValue == 0:
-				return
-
-			## 정보 뽑아올 아이템 알아오기.
-			socketInDrainItemVnum = 0
-			if window_type == player.INVENTORY or window_type == player.EQUIPMENT:
-				socketInDrainItemVnum = player.GetItemMetinSocket(window_type, slotIndex, 0)
-				if not metinSlot[0] == 0 and socketInDrainItemVnum == 0:
-					socketInDrainItemVnum = metinSlot[0]
-			elif window_type == player.ACCEREFINE:
-				socketInDrainItemVnum = player.GetAcceItemMetinSocket(slotIndex, 0)
-			elif window_type == player.SAFEBOX:
-				socketInDrainItemVnum = safebox.GetItemMetinSocket(slotIndex, 0)
-
-			## 흡수한 악세서리 아이템만 보여주기위해 걸러준다.
-			if socketInDrainItemVnum == 0:
-				return
-
-			item.SelectItem(socketInDrainItemVnum)
-
-			itemtype = item.GetItemType()
-
-			if itemtype == item.ITEM_TYPE_WEAPON:
-				## 추가 데미지
-				addPower = item.GetValue(5)
-
-				## 무기. Attack
-				if item.GetValue(3) >= 1 and item.GetValue(4) >= 1:
-					if app.ENABLE_APPLY_RANDOM:
-						minValue = item.GetValue(3)
-						maxValue = item.GetValue(4)
-
-						minMax = 0
-						if window_type == player.INVENTORY or window_type == player.EQUIPMENT:
-							minMax = player.GetItemMetinSocket(window_type, slotIndex, item.ITEM_SOCKET_ATK_MINMAX_RANDOM)
-							if not metinSlot[item.ITEM_SOCKET_ATK_MINMAX_RANDOM] == 0 and minMax == 0:
-								minMax = metinSlot[item.ITEM_SOCKET_ATK_MINMAX_RANDOM]
-						elif window_type == player.ACCEREFINE:
-							minMax = player.GetAcceItemMetinSocket(slotIndex, item.ITEM_SOCKET_ATK_MINMAX_RANDOM)
-						elif window_type == player.SAFEBOX:
-							minMax = safebox.GetItemMetinSocket(slotIndex, item.ITEM_SOCKET_ATK_MINMAX_RANDOM)
-
-						if minMax != 0:
-							minValue = minMax / item.ITEM_VALUE_MINMAX_RANDOM_DIVISION_VALUE
-							maxValue = minMax % (item.ITEM_VALUE_MINMAX_RANDOM_DIVISION_VALUE / 100)
-
-						minPower = max(((minValue + addPower) * drainlate) , 1)
-						maxPower = max(((maxValue + addPower) * drainlate) , 1)
-					else:
-						minPower = max(((item.GetValue(3) + addPower) * drainlate) , 1)
-						maxPower = max(((item.GetValue(4) + addPower) * drainlate) , 1)
-
-					if maxPower > minPower:
-						if app.ENABLE_REFINE_ELEMENT_SYSTEM and self.GetRefineElement(refine_element):
-							grade = refine_element[self.REFINE_ELEMENT_INDEX_GRADE]
-
-							bonus_value = 0
-							for i in range(min(self.REFINE_ELEMENT_INDEX_MAX, grade)):
-								bonus_value += refine_element[self.REFINE_ELEMENT_INDEX_BONUS][i]
-							bonus_value = max((bonus_value * drainlate) , 1)
-
-							self.AppendTextLineAcce(localeInfo.TOOLTIP_ITEM_ATT_POWER_REFINE % (minPower, maxPower, bonus_value), self.POSITIVE_COLOR)
-						else:
-							self.AppendTextLineAcce(localeInfo.TOOLTIP_ITEM_ATT_POWER % (minPower, maxPower), self.POSITIVE_COLOR)
-					else:
-						self.AppendTextLineAcce(localeInfo.TOOLTIP_ITEM_ATT_POWER_ONE_ARG % (minPower), self.POSITIVE_COLOR)
-
-				## 무기. Magic
-				if item.GetValue(1) >= 1 or item.GetValue(2) >= 1:
-					if app.ENABLE_APPLY_RANDOM:
-						minValue = item.GetValue(1)
-						maxValue = item.GetValue(2)
-
-						minMax = 0
-						if window_type == player.INVENTORY or window_type == player.EQUIPMENT:
-							minMax = player.GetItemMetinSocket(window_type, slotIndex, item.ITEM_SOCKET_MTK_MINMAX_RANDOM)
-							if not metinSlot[item.ITEM_SOCKET_MTK_MINMAX_RANDOM] == 0 and minMax == 0:
-								minMax = metinSlot[item.ITEM_SOCKET_MTK_MINMAX_RANDOM]
-						elif window_type == player.ACCEREFINE:
-							minMax = player.GetAcceItemMetinSocket(player.ACCE_SLOT_RIGHT, item.ITEM_SOCKET_MTK_MINMAX_RANDOM)
-						elif window_type == player.SAFEBOX:
-							minMax = safebox.GetItemMetinSocket(slotIndex, item.ITEM_SOCKET_MTK_MINMAX_RANDOM)
-
-						if minMax != 0:
-							minValue = minMax / item.ITEM_VALUE_MINMAX_RANDOM_DIVISION_VALUE
-							maxValue = minMax % (item.ITEM_VALUE_MINMAX_RANDOM_DIVISION_VALUE / 100)
-
-						minMagicAttackPower = max(((minValue + addPower) * drainlate) , 1)
-						maxMagicAttackPower = max(((maxValue + addPower) * drainlate) , 1)
-					else:
-						minMagicAttackPower = max(((item.GetValue(1) + addPower) * drainlate) , 1)
-						maxMagicAttackPower = max(((item.GetValue(2) + addPower) * drainlate) , 1)
-
-					if maxMagicAttackPower > minMagicAttackPower:
-						self.AppendTextLineAcce(localeInfo.TOOLTIP_ITEM_MAGIC_ATT_POWER % (minMagicAttackPower, maxMagicAttackPower), self.POSITIVE_COLOR)
-					else:
-						self.AppendTextLineAcce(localeInfo.TOOLTIP_ITEM_MAGIC_ATT_POWER_ONE_ARG % (minMagicAttackPower), self.POSITIVE_COLOR)
-
-			elif itemtype == item.ITEM_TYPE_ARMOR:
-
-				## 방어력
-				defBonus = item.GetValue(5) * 2 ## 방어력 표시 잘못 되는 문제를 수정
-				if item.GetValue(1) >= 1:
-					if app.ENABLE_APPLY_RANDOM:
-						defValue = item.GetValue(1)
-
-						minMax = 0
-						if window_type == player.INVENTORY or window_type == player.EQUIPMENT:
-							minMax = player.GetItemMetinSocket(window_type, slotIndex, item.ITEM_SOCKET_DEF_MINMAX_RANDOM)
-							if not metinSlot[item.ITEM_SOCKET_DEF_MINMAX_RANDOM] == 0 and minMax == 0:
-								minMax = metinSlot[item.ITEM_SOCKET_DEF_MINMAX_RANDOM]
-						elif window_type == player.ACCEREFINE:
-							minMax = player.GetAcceItemMetinSocket(player.ACCE_SLOT_RIGHT, item.ITEM_SOCKET_DEF_MINMAX_RANDOM)
-						elif window_type == player.SAFEBOX:
-							minMax = safebox.GetItemMetinSocket(slotIndex, item.ITEM_SOCKET_DEF_MINMAX_RANDOM)
-
-						if minMax != 0:
-							defValue = minMax / item.ITEM_VALUE_MINMAX_RANDOM_DIVISION_VALUE
-
-						defGrade = max(((defValue + defBonus) * drainlate) , 1)
-					else:
-						defGrade = max(((item.GetValue(1) + defBonus) * drainlate) , 1)
-
-					if defGrade > 0:
-						self.AppendSpace(5)
-						self.AppendTextLineAcce(localeInfo.TOOLTIP_ITEM_DEF_GRADE % (defGrade), self.GetChangeTextLineColor(defGrade))
-
-			if app.ENABLE_APPLY_RANDOM:
-				if 0 != apply_random_list:
-					for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM):
-						randomType = apply_random_list[i][0]
-						randomValue = max((apply_random_list[i][1] * drainlate), 1)
-
-						if 0 == randomValue:
-							continue
-
-						affectRandomString = self.__GetAffectString(randomType, randomValue)
-						if affectRandomString:
-							self.AppendTextLineAcce(affectRandomString, self.APPLY_RANDOM_TEXT_COLOR)
-
-			## Itemtable 에 있는 기본 속성 적용.
-			## 악세서리에는 - 갑 ex 이동속도 적용 안함.
-			for i in xrange(item.ITEM_APPLY_MAX_NUM):
-				(affectType, affectValue) = item.GetAffect(i)
-				if affectValue > 0:
-					affectValue = max((affectValue * drainlate), 1)
-					affectString = self.__GetAffectString(affectType, affectValue)
-					if affectString:
-						self.AppendTextLineAcce(affectString, self.GetChangeTextLineColor(affectValue))
-
-			item.SelectItem(oriitemVnum)
-
-	if app.ENABLE_AURA_COSTUME_SYSTEM:
-		def __AppendAffectInformationAura(self, slotIndex, window_type, metinSlot):
-			socketLevelValue = 0
-
-			if window_type == player.INVENTORY or window_type == player.EQUIPMENT:
-				socketLevelValue = player.GetItemMetinSocket(window_type, slotIndex, item.ITEM_SOCKET_AURA_LEVEL_VALUE)
-				if metinSlot[item.ITEM_SOCKET_AURA_LEVEL_VALUE] != 0 and socketLevelValue == 0:
-					socketLevelValue = metinSlot[item.ITEM_SOCKET_AURA_LEVEL_VALUE]
-
-			elif window_type == player.AURA_REFINE:
-				socketLevelValue = player.GetAuraSlotItemMetinSocket(slotIndex, item.ITEM_SOCKET_AURA_LEVEL_VALUE)
-
-			elif window_type == player.SAFEBOX:
-				socketLevelValue = safebox.GetItemMetinSocket(slotIndex, item.ITEM_SOCKET_AURA_LEVEL_VALUE)
-
-			if socketLevelValue == 0:
-				return
-
-			curLevel = (socketLevelValue / 100000) - 1000
-			curStep = player.GetAuraRefineInfo(curLevel, item.AURA_REFINE_INFO_STEP)
-			if curStep < item.AURA_GRADE_RADIANT:
-				curExpPer = 100.0 * (socketLevelValue % 100000) / player.GetAuraRefineInfo(curLevel, item.AURA_REFINE_INFO_NEED_EXP)
-
-			self.AppendTextLine(localeInfo.AURA_LEVEL_STEP % (curLevel, curStep), self.CONDITION_COLOR)
-			if curStep < item.AURA_GRADE_RADIANT:
-				self.AppendTextLine(localeInfo.AURA_TOOLTIP_EXP % (curExpPer), self.CONDITION_COLOR)
-
-			self.AppendTextLine(localeInfo.AURA_DRAIN_PER % (1.0 * curLevel / 10), self.CONDITION_COLOR)
-
-		def __AppendAuraItemAffectInformation(self, ori_item_vnum, window_type, slot_index, sockets, apply_random_list):
-			socketLevelValue = 0
-
-			if window_type == player.INVENTORY or window_type == player.EQUIPMENT:
-				socketLevelValue = player.GetItemMetinSocket(window_type, slot_index, item.ITEM_SOCKET_AURA_LEVEL_VALUE)
-				if sockets[item.ITEM_SOCKET_AURA_LEVEL_VALUE] != 0 and socketLevelValue == 0:
-					socketLevelValue = sockets[item.ITEM_SOCKET_AURA_LEVEL_VALUE]
-			elif window_type == player.AURA_REFINE:
-				socketLevelValue = player.GetAuraSlotItemMetinSocket(slot_index, item.ITEM_SOCKET_AURA_LEVEL_VALUE)
-			elif window_type == player.SAFEBOX:
-				socketLevelValue = safebox.GetItemMetinSocket(slot_index, item.ITEM_SOCKET_AURA_LEVEL_VALUE)
-
-			if socketLevelValue == 0:
-				return
-
-			curLevel = (socketLevelValue / 100000) - 1000
-			drainlate = curLevel / 10. / 100.0
-
-			socketInDrainItemVnum = 0
-			if window_type == player.INVENTORY or window_type == player.EQUIPMENT:
-				socketInDrainItemVnum = player.GetItemMetinSocket(window_type, slot_index, item.ITEM_SOCKET_AURA_DRAIN_ITEM_VNUM)
-				if not sockets[item.ITEM_SOCKET_AURA_DRAIN_ITEM_VNUM] == 0 and socketInDrainItemVnum == 0:
-					socketInDrainItemVnum = sockets[item.ITEM_SOCKET_AURA_DRAIN_ITEM_VNUM]
-			elif window_type == player.AURA_REFINE:
-				socketInDrainItemVnum = player.GetAuraSlotItemMetinSocket(slot_index, item.ITEM_SOCKET_AURA_DRAIN_ITEM_VNUM)
-			elif window_type == player.SAFEBOX:
-				socketInDrainItemVnum = safebox.GetItemMetinSocket(slot_index, item.ITEM_SOCKET_AURA_DRAIN_ITEM_VNUM)
-
-			if socketInDrainItemVnum == 0:
-				return
-
-			item.SelectItem(socketInDrainItemVnum)
-			itemType = item.GetItemType()
-
-			if itemType == item.ITEM_TYPE_ARMOR:
-				## 방어력
-				defBonus = item.GetValue(5) * 2 ## 방어력 표시 잘못 되는 문제를 수정
-				if item.GetValue(1) >= 1:
-					defGrade = max(((item.GetValue(1) + defBonus) * drainlate), 1)
-
-					if app.ENABLE_APPLY_RANDOM:
-						minMax = 0
-						if window_type == player.INVENTORY or window_type == player.EQUIPMENT:
-							minMax = player.GetItemMetinSocket(window_type, slot_index, item.ITEM_SOCKET_DEF_MINMAX_RANDOM)
-							if not sockets[item.ITEM_SOCKET_DEF_MINMAX_RANDOM] == 0 and minMax == 0:
-								minMax = sockets[item.ITEM_SOCKET_DEF_MINMAX_RANDOM]
-						elif window_type == player.AURA_REFINE:
-							minMax = player.GetAuraSlotItemMetinSocket(player.AURA_SLOT_SUB, item.ITEM_SOCKET_DEF_MINMAX_RANDOM)
-						elif window_type == player.SAFEBOX:
-							minMax = safebox.GetItemMetinSocket(slot_index, item.ITEM_SOCKET_DEF_MINMAX_RANDOM)
-
-						if minMax != 0:
-							defValue = minMax / item.ITEM_VALUE_MINMAX_RANDOM_DIVISION_VALUE
-							defGrade = max(((defValue + defBonus) * drainlate), 1)
-
-					if defGrade > 0:
-						self.AppendSpace(5)
-						self.AppendTextLineDontCheckColor(localeInfo.TOOLTIP_ITEM_DEF_GRADE % (defGrade), self.GetChangeTextLineColor(defGrade))
-
-			if app.ENABLE_APPLY_RANDOM:
-				if 0 != apply_random_list:
-					for i in xrange(player.APPLY_RANDOM_SLOT_MAX_NUM):
-						randomType = apply_random_list[i][0]
-						randomValue = max((apply_random_list[i][1] * drainlate), 1)
-
-						if 0 == randomValue:
-							continue
-
-						affectRandomString = self.__GetAffectString(randomType, randomValue)
-						if affectRandomString:
-							self.AppendTextLineDontCheckColor(affectRandomString, self.APPLY_RANDOM_TEXT_COLOR)
-
-			## Itemtable 에 있는 기본 속성 적용.
-			## 악세서리에는 - 갑 ex 이동속도 적용 안함.
-			for i in xrange(item.ITEM_APPLY_MAX_NUM):
-				(affectType, affectValue) = item.GetAffect(i)
-				if affectValue > 0:
-					affectValue = max((affectValue * drainlate), 1)
-					affectString = self.__GetAffectString(affectType, affectValue)
-					if affectString:
-						self.AppendTextLineDontCheckColor(affectString, self.GetChangeTextLineColor(affectValue))
-
-			item.SelectItem(ori_item_vnum)
-
 	def __AppendAffectInformation(self):
 		for i in xrange(item.ITEM_APPLY_MAX_NUM):
 			(affectType, affectValue) = item.GetAffect(i)
 			affectString = self.__GetAffectString(affectType, affectValue)
 
 			if affectString:
-				if app.ENABLE_ACCE_COSTUME_SYSTEM:
-					if affectType == item.APPLY_ACCEDRAIN_RATE:
-						self.AppendTextLine(affectString, self.CONDITION_COLOR)
-					else:
-						self.AppendTextLine(affectString, self.GetChangeTextLineColor(affectValue))
-				else:
-					self.AppendTextLine(affectString, self.GetChangeTextLineColor(affectValue))
-
-	if app.ENABLE_CHANGE_LOOK_SYSTEM:
-		def AppendChangeLookInformation(self, window_type, slotIndex):
-			if window_type == player.SAFEBOX:
-				changelookvnum = safebox.GetItemChangeLookVnum(slotIndex)
-			elif window_type == player.MALL:
-				changelookvnum = safebox.GetMallItemChangeLookVnum(slotIndex)
-			elif app.ENABLE_ACCE_COSTUME_SYSTEM and window_type == player.ACCEREFINE:
-				changelookvnum = player.GetAcceWindowChangeLookVnum(slotIndex)
-			else:
-				changelookvnum = player.GetChangeLookVnum(window_type, slotIndex)
-
-			if not changelookvnum == 0:
-				self.AppendSpace(5)
-				self.AppendTextLine("[ " + localeInfo.CHANGE_LOOK_TITLE + " ]", self.CHANGELOOK_TITLE_COLOR)
-				itemName = item.GetItemNameByVnum(changelookvnum)
-
-				if item.GetItemType() == item.ITEM_TYPE_COSTUME:
-					if item.GetItemSubType() == item.COSTUME_TYPE_BODY:
-						malefemale = ""
-						if item.IsAntiFlag(item.ITEM_ANTIFLAG_MALE):
-							malefemale = localeInfo.FOR_FEMALE
-
-						if item.IsAntiFlag(item.ITEM_ANTIFLAG_FEMALE):
-							malefemale = localeInfo.FOR_MALE
-						itemName += " ( " + malefemale + " )"
-
-				textLine = self.AppendTextLine(itemName, self.CHANGELOOK_ITEMNAME_COLOR, True)
-				textLine.SetFeather()
+				#if affectType == item.APPLY_ACCEDRAIN_RATE:
+				#	self.AppendTextLine(affectString, self.CONDITION_COLOR)
+				#else:
+				#	self.AppendTextLine(affectString, self.GetChangeTextLineColor(affectValue))
+				self.AppendTextLine(affectString, self.GetChangeTextLineColor(affectValue))
 
 	def AppendWearableInformation(self):
 		self.AppendSpace(5)
@@ -3651,9 +2697,9 @@
 			self.AppendTextLine(timeString)
 
 	def GetPriceColor(self, price):
-		if price >= constInfo.HIGH_PRICE:
+		if price>=constInfo.HIGH_PRICE:
 			return self.HIGH_PRICE_COLOR
-		if price >= constInfo.MIDDLE_PRICE:
+		if price>=constInfo.MIDDLE_PRICE:
 			return self.MIDDLE_PRICE_COLOR
 		else:
 			return self.LOW_PRICE_COLOR
@@ -3661,45 +2707,45 @@
 	if app.ENABLE_CHEQUE_SYSTEM:
 		def AppendPrice(self, price, cheque = 0):
 			self.AppendSpace(5)
-			self.AppendTextLineDontCheckColor(localeInfo.CHEQUE_SYSTEM_SELL_PRICE, grp.GenerateColor(1.0, 0.9686, 0.3098, 1.0))
+			self.AppendTextLine(localeInfo.CHEQUE_SYSTEM_SELL_PRICE, grp.GenerateColor(1.0, 0.9686, 0.3098, 1.0))
 
 			if cheque > 0:
-				self.AppendTextLineDontCheckColor(localeInfo.CHEQUE_SYSTEM_WON % (str(cheque)), grp.GenerateColor(0.0, 0.8470, 1.0, 1.0))
+				self.AppendTextLine(localeInfo.CHEQUE_SYSTEM_WON % (str(cheque)), grp.GenerateColor(0.0, 0.8470, 1.0, 1.0))
 
 			if price >= 0:
-				self.AppendTextLineDontCheckColor(localeInfo.CHEQUE_SYSTEM_YANG % (localeInfo.NumberToMoneyString(price)), self.GetPriceColor(price))
+				self.AppendTextLine(localeInfo.CHEQUE_SYSTEM_YANG % (localeInfo.NumberToMoneyString(price)), self.GetPriceColor(price))
 	else:
 		def AppendPrice(self, price):
 			self.AppendSpace(5)
-			self.AppendTextLineDontCheckColor(localeInfo.TOOLTIP_BUYPRICE % (localeInfo.NumberToMoneyString(price)), self.GetPriceColor(price))
+			self.AppendTextLine(localeInfo.TOOLTIP_BUYPRICE % (localeInfo.NumberToMoneyString(price)), self.GetPriceColor(price))
 
 	def AppendPriceBySecondaryCoin(self, price):
 		self.AppendSpace(5)
-		self.AppendTextLineDontCheckColor(localeInfo.TOOLTIP_BUYPRICE % (localeInfo.NumberToSecondaryCoinString(price)), self.GetPriceColor(price))
+		self.AppendTextLine(localeInfo.TOOLTIP_BUYPRICE % (localeInfo.NumberToSecondaryCoinString(price)), self.GetPriceColor(price))
 
 	if app.ENABLE_CHEQUE_SYSTEM:
 		def AppendSellingPrice(self, price, cheque = 0, isPrivateShopBuilder = False):
 			if item.IsAntiFlag(item.ITEM_ANTIFLAG_SELL) and \
 				not isPrivateShopBuilder:
-				self.AppendTextLineDontCheckColor(localeInfo.TOOLTIP_ANTI_SELL, self.DISABLE_COLOR)
+				self.AppendTextLine(localeInfo.TOOLTIP_ANTI_SELL, self.DISABLE_COLOR)
 				self.AppendSpace(5)
 			else:
-				self.AppendTextLineDontCheckColor(localeInfo.CHEQUE_SYSTEM_SELL_PRICE, grp.GenerateColor(1.0, 0.9686, 0.3098, 1.0))
+				self.AppendTextLine(localeInfo.CHEQUE_SYSTEM_SELL_PRICE, grp.GenerateColor(1.0, 0.9686, 0.3098, 1.0))
 
 				if cheque > 0:
-					self.AppendTextLineDontCheckColor(localeInfo.CHEQUE_SYSTEM_WON % (str(cheque)), grp.GenerateColor(0.0, 0.8470, 1.0, 1.0))
+					self.AppendTextLine(localeInfo.CHEQUE_SYSTEM_WON % (str(cheque)), grp.GenerateColor(0.0, 0.8470, 1.0, 1.0))
 
 				if price >= 0:
-					self.AppendTextLineDontCheckColor(localeInfo.CHEQUE_SYSTEM_YANG % (localeInfo.NumberToMoneyString(price)), self.GetPriceColor(price))
+					self.AppendTextLine(localeInfo.CHEQUE_SYSTEM_YANG % (localeInfo.NumberToMoneyString(price)), self.GetPriceColor(price))
 
 				self.AppendSpace(5)
 	else:
 		def AppendSellingPrice(self, price):
 			if item.IsAntiFlag(item.ITEM_ANTIFLAG_SELL):
-				self.AppendTextLineDontCheckColor(localeInfo.TOOLTIP_ANTI_SELL, self.DISABLE_COLOR)
+				self.AppendTextLine(localeInfo.TOOLTIP_ANTI_SELL, self.DISABLE_COLOR)
 				self.AppendSpace(5)
 			else:
-				self.AppendTextLineDontCheckColor(localeInfo.TOOLTIP_SELLPRICE % (localeInfo.NumberToMoneyString(price)), self.GetPriceColor(price))
+				self.AppendTextLine(localeInfo.TOOLTIP_SELLPRICE % (localeInfo.NumberToMoneyString(price)), self.GetPriceColor(price))
 				self.AppendSpace(5)
 
 	def AppendMetinInformation(self):
@@ -3729,8 +2775,6 @@
 			item.IsWearableFlag(item.WEARABLE_SHIELD),
 			item.IsWearableFlag(item.WEARABLE_ARROW)
 		)
-		if app.ENABLE_GLOVE_SYSTEM:
-			flagList += (item.IsWearableFlag(item.WEARABLE_GLOVE),)
 
 		wearNames = ""
 		for i in xrange(self.WEAR_COUNT):
@@ -3738,7 +2782,7 @@
 			flag = flagList[i]
 
 			if flag:
-				wearNames += " "
+				wearNames += "  "
 				wearNames += name
 
 		textLine = ui.TextLine()
@@ -3762,14 +2806,14 @@
 		elif player.METIN_SOCKET_TYPE_GOLD == number:
 			return player.METIN_SOCKET_TYPE_GOLD
 		else:
-			if app.ENABLE_NEW_USER_CARE:
+			if app.WJ_NEW_USER_CARE:
 				if item.SelectItem(number) == False:
 					return player.METIN_SOCKET_TYPE_NONE
 				else:
 					if item.METIN_NORMAL == item.GetItemSubType():
 						return player.METIN_SOCKET_TYPE_SILVER
-					elif item.METIN_SUNGMA == item.GetItemSubType():
-						return player.METIN_SOCKET_TYPE_SILVER
+					elif item.METIN_GOLD == item.GetItemSubType():
+						return player.METIN_SOCKET_TYPE_GOLD
 					elif "USE_PUT_INTO_ACCESSORY_SOCKET" == item.GetUseType(number):
 						return player.METIN_SOCKET_TYPE_SILVER
 					elif "USE_PUT_INTO_RING_SOCKET" == item.GetUseType(number):
@@ -3780,8 +2824,8 @@
 				item.SelectItem(number)
 				if item.METIN_NORMAL == item.GetItemSubType():
 					return player.METIN_SOCKET_TYPE_SILVER
-				elif item.METIN_SUNGMA == item.GetItemSubType():
-					return player.METIN_SOCKET_TYPE_SILVER
+				elif item.METIN_GOLD == item.GetItemSubType():
+					return player.METIN_SOCKET_TYPE_GOLD
 				elif "USE_PUT_INTO_ACCESSORY_SOCKET" == item.GetUseType(number):
 					return player.METIN_SOCKET_TYPE_SILVER
 				elif "USE_PUT_INTO_RING_SOCKET" == item.GetUseType(number):
@@ -3799,174 +2843,76 @@
 
 		return number
 
-	def __AppendAccessoryMetinSlotInfo(self, metin_slot, mtrl_vnum, apply_random_list = None):
+	def __AppendAccessoryMetinSlotInfo(self, metinSlot, mtrlVnum):
 		ACCESSORY_SOCKET_MAX_SIZE = 3
 
-		cur = min(metin_slot[0], ACCESSORY_SOCKET_MAX_SIZE)
-		end = min(metin_slot[1], ACCESSORY_SOCKET_MAX_SIZE)
+		cur = min(metinSlot[0], ACCESSORY_SOCKET_MAX_SIZE)
+		end = min(metinSlot[1], ACCESSORY_SOCKET_MAX_SIZE)
 
-		affect_type1, affect_value1 = item.GetAffect(0)
-		if app.ENABLE_APPLY_RANDOM:
-			if affect_type1 == item.APPLY_RANDOM and apply_random_list != None:
-				affect_type1 = apply_random_list[0][0]
-				affect_value1 = apply_random_list[0][1]
-		affect_list1 = [0, max(1, affect_value1 * 10 / 100), max(2, affect_value1 * 20 / 100), max(3, affect_value1 * 40 / 100)]
+		affectType1, affectValue1 = item.GetAffect(0)
+		affectList1 = [0, max(1, affectValue1 * 10 / 100), max(2, affectValue1 * 20 / 100), max(3, affectValue1 * 40 / 100)]
 
-		affect_type2, affect_value2 = item.GetAffect(1)
-		if app.ENABLE_APPLY_RANDOM:
-			if affect_type2 == item.APPLY_RANDOM and apply_random_list != None:
-				affect_type2 = apply_random_list[1][0]
-				affect_value2 = apply_random_list[1][1]
-		affect_list2 = [0, max(1, affect_value2 * 10 / 100), max(2, affect_value2 * 20 / 100), max(3, affect_value2 * 40 / 100)]
+		affectType2, affectValue2 = item.GetAffect(1)
+		affectList2 = [0, max(1, affectValue2 * 10 / 100), max(2, affectValue2 * 20 / 100), max(3, affectValue2 * 40 / 100)]
 
-		affect_type3, affect_value3 = item.GetAffect(2)
-		if app.ENABLE_APPLY_RANDOM:
-			if affect_type3 == item.APPLY_RANDOM and apply_random_list != None:
-				affect_type3 = apply_random_list[2][0]
-				affect_value3 = apply_random_list[2][1]
-		affect_list3 = [0, max(1, affect_value3 * 10 / 100), max(2, affect_value3 * 20 / 100), max(3, affect_value3 * 40 / 100)]
-
-		mtrl_pos = 0
-		mtrl_list = [mtrl_vnum] * cur + [player.METIN_SOCKET_TYPE_SILVER] * (end - cur)
-		for mtrl in mtrl_list:
-			affect_string1 = self.__GetAffectString(affect_type1, affect_list1[mtrl_pos + 1] - affect_list1[mtrl_pos])
-			affect_string2 = self.__GetAffectString(affect_type2, affect_list2[mtrl_pos + 1] - affect_list2[mtrl_pos])
-			affect_string3 = self.__GetAffectString(affect_type3, affect_list3[mtrl_pos + 1] - affect_list3[mtrl_pos])
-
-			left_time = 0
-			if cur == mtrl_pos + 1:
-				left_time = metin_slot[2]
+		affectType3, affectValue3 = item.GetAffect(2)
+		affectList3 = [0, max(1, affectValue3 * 10 / 100), max(2, affectValue3 * 20 / 100), max(3, affectValue3 * 40 / 100)]
+
+		mtrlPos = 0
+		mtrlList = [mtrlVnum] * cur + [player.METIN_SOCKET_TYPE_SILVER] * (end - cur)
+		for mtrl in mtrlList:
+			affectString1 = self.__GetAffectString(affectType1, affectList1[mtrlPos + 1] - affectList1[mtrlPos])
+			affectString2 = self.__GetAffectString(affectType2, affectList2[mtrlPos + 1] - affectList2[mtrlPos])
+			affectString3 = self.__GetAffectString(affectType3, affectList3[mtrlPos + 1] - affectList3[mtrlPos])
+
+			leftTime = 0
+			if cur == mtrlPos + 1:
+				leftTime = metinSlot[2]
 
-			self.__AppendMetinSlotInfo_AppendMetinSocketData(mtrl_pos, mtrl, affect_string1, affect_string2, affect_string3, left_time)
-			mtrl_pos += 1
+			self.__AppendMetinSlotInfo_AppendMetinSocketData(mtrlPos, mtrl, affectString1, affectString2, affectString3, leftTime)
+			mtrlPos += 1
 
 	def __AppendMetinSlotInfo(self, metinSlot):
 		if self.__AppendMetinSlotInfo_IsEmptySlotList(metinSlot):
 			return
 
-		for i in xrange(player.ITEM_METIN_SOCKET_MAX):
-			self.__AppendMetinSlotInfo_AppendMetinSocketData(i, metinSlot[i])
-
-	if app.ENABLE_GLOVE_SYSTEM:
-		def __AppendGloveMetinSlotInfo(self, metinSlot):
-			if self.__AppendMetinSlotInfo_IsEmptySlotList(metinSlot):
-				return
+		for i in xrange(player.METIN_SOCKET_MAX_NUM):
+			if app.ENABLE_ITEM_SOCKET5:
+				if metinSlot[i] == -1:
+					continue
 
-			for i in xrange(player.ITEM_METIN_SOCKET_MAX):
-				self.__AppendSungmaSocketData(metinSlot[i])
+			self.__AppendMetinSlotInfo_AppendMetinSocketData(i, metinSlot[i])
 
 	def __AppendMetinSlotInfo_IsEmptySlotList(self, metinSlot):
 		if 0 == metinSlot:
 			return 1
 
-		for i in xrange(player.ITEM_METIN_SOCKET_MAX):
+		for i in xrange(player.METIN_SOCKET_MAX_NUM):
 			metinSlotData = metinSlot[i]
+			if app.ENABLE_ITEM_SOCKET5:
+				if metinSlotData == -1:
+					continue
+
 			if 0 != self.GetMetinSocketType(metinSlotData):
 				if 0 != self.GetMetinItemIndex(metinSlotData):
 					return 0
 
 		return 1
 
-	if app.ENABLE_GLOVE_SYSTEM:
-		def __AppendSungmaSocketData(self, metinSlot):
-			data = metinSlot
-			if data < 1000000:
-				data = None
-
-				slotType = self.GetMetinSocketType(metinSlot)
-				itemIndex = self.GetMetinItemIndex(metinSlot)
-
-				if 0 == slotType:
-					return
-			else:
-				affectType = (data / 10000) % 1000
-				affectValue = data % 100
-
-				itemIndex = 28046 # stone base vnum
-				itemIndex += (((data / 1000) % 10) * 100) # stone level
-				itemIndex += ((data / 100) % 10) - 1 # stone type
-
-			self.AppendSpace(5)
-
-			slotImage = ui.ImageBox()
-			slotImage.SetParent(self)
-			slotImage.LoadImage("d:/ymir work/ui/game/windows/metin_slot_silver.sub")
-			slotImage.Show()
-
-			## Name
-			nameTextLine = ui.TextLine()
-			nameTextLine.SetParent(self)
-			nameTextLine.SetFontName(self.defFontName)
-			nameTextLine.SetPackedFontColor(self.NORMAL_COLOR)
-			nameTextLine.SetOutline()
-			nameTextLine.SetFeather()
-			nameTextLine.Show()
-
-			self.childrenList.append(nameTextLine)
-			self.childrenList.append(slotImage)
-
-			if localeInfo.IsARABIC():
-				slotImage.SetPosition(self.toolTipWidth - slotImage.GetWidth() - 9, self.toolTipHeight - 1)
-				nameTextLine.SetPosition(self.toolTipWidth - 50, self.toolTipHeight + 2)
-			else:
-				slotImage.SetPosition(9, self.toolTipHeight - 1)
-				nameTextLine.SetPosition(50, self.toolTipHeight + 2)
-
-			metinImage = ui.ImageBox()
-			metinImage.SetParent(self)
-			metinImage.Show()
-			self.childrenList.append(metinImage)
-
-			if itemIndex:
-				item.SelectItem(itemIndex)
-
-				## Image
-				try:
-					metinImage.LoadImage(item.GetIconImageFileName())
-				except:
-					dbg.TraceError("ItemToolTip.__AppendSungmaSocketData() - Failed to find image file %d:%s" % 
-						(itemIndex, item.GetIconImageFileName())
-					)
-
-				nameTextLine.SetText(item.GetItemName())
-
-				## Affect
-				affectTextLine = ui.TextLine()
-				affectTextLine.SetParent(self)
-				affectTextLine.SetFontName(self.defFontName)
-				affectTextLine.SetPackedFontColor(self.POSITIVE_COLOR)
-				affectTextLine.SetOutline()
-				affectTextLine.SetFeather()
-				affectTextLine.Show()
-
-				if localeInfo.IsARABIC():
-					metinImage.SetPosition(self.toolTipWidth - metinImage.GetWidth() - 10, self.toolTipHeight)
-					affectTextLine.SetPosition(self.toolTipWidth - 50, self.toolTipHeight + 16 + 2)
-				else:
-					metinImage.SetPosition(10, self.toolTipHeight)
-					affectTextLine.SetPosition(50, self.toolTipHeight + 16 + 2)
-
-				if itemIndex == constInfo.ERROR_METIN_STONE:
-					affectTextLine.SetText(localeInfo.TOOLTIP_APPLY_NOAFFECT)
-				else:
-					if data and affectType != 0:
-						affectString = self.__GetAffectString(affectType, affectValue)
-						if affectString:
-							affectTextLine.SetText(affectString)
-					else:
-						affectTextLine.SetText(localeInfo.TOOLTIP_SOCKET_EMPTY)
-
-				self.childrenList.append(affectTextLine)
-			else:
-				nameTextLine.SetText(localeInfo.TOOLTIP_SOCKET_EMPTY)
-
-			self.toolTipHeight += 35
-			self.ResizeToolTip()
-
 	def __AppendMetinSlotInfo_AppendMetinSocketData(self, index, metinSlotData, custumAffectString = "", custumAffectString2 = "", custumAffectString3 = "", leftTime = 0):
 		slotType = self.GetMetinSocketType(metinSlotData)
 		itemIndex = self.GetMetinItemIndex(metinSlotData)
 
+		# 2019.12.17.owsap.Only show socket items
+		# if app.ENABLE_ITEM_SOCKET5:
+			# if itemIndex:
+				# item.SelectItem(itemIndex)
+				# if item.GetItemType() != item.ITEM_TYPE_METIN and\
+					# item.GetUseType(itemIndex) != "USE_PUT_INTO_ACCESSORY_SOCKET" and\
+					# item.GetUseType(itemIndex) != "USE_PUT_INTO_RING_SOCKET" and\
+					# item.GetUseType(itemIndex) != "USE_PUT_INTO_BELT_SOCKET":
+					# return
+
 		if 0 == slotType:
 			return
 
@@ -4110,10 +3056,26 @@
 			self.AppendSpace(5)
 			self.AppendTextLine(localeInfo.LEFT_TIME + " : " + localeInfo.SecondToDHM(leftSec), self.NORMAL_COLOR)
 
+	if app.ENABLE_COSTUME_EXTENDED_RECHARGE:
+		def AppendMallItemLastTimeEx(self, endTime):
+			leftSec = max(0, endTime - app.GetGlobalTimeStamp())
+
+			if leftSec > item.MIN_INFINITE_DURATION:
+				self.AppendSpace(5)
+				self.AppendTextLine(localeInfo.INFINITE_USE, self.CONDITION_COLOR)
+				return
+
+			if leftSec > 0:
+				self.AppendSpace(5)
+				self.AppendTextLine(localeInfo.LEFT_TIME + " : " + localeInfo.SecondToDHM(leftSec), self.NORMAL_COLOR)
+
 	def AppendTimerBasedOnWearLastTime(self, metinSlot):
 		if 0 == metinSlot[0]:
 			self.AppendSpace(5)
 			self.AppendTextLine(localeInfo.CANNOT_USE, self.DISABLE_COLOR)
+		elif app.ENABLE_DSS_EXTENDED_RECHARGE and metinSlot[0] > item.MIN_INFINITE_DURATION:
+			self.AppendSpace(5)
+			self.AppendTextLine(localeInfo.INFINITE_USE, self.CONDITION_COLOR)
 		else:
 			endTime = app.GetGlobalTimeStamp() + metinSlot[0]
 			self.AppendMallItemLastTime(endTime)
@@ -4133,7 +3095,7 @@
 
 		self.AppendMallItemLastTime(endTime)
 
-	if app.ENABLE_NEW_USER_CARE:
+	if app.WJ_NEW_USER_CARE:
 		def __AppendRealTimeToolTip(self, itemVnum, endTime):
 			item.SelectItem(itemVnum)
 
@@ -4149,63 +3111,501 @@
 				else:
 					continue
 
-class HyperlinkItemToolTip(ItemToolTip):
-	def __init__(self):
-		ItemToolTip.__init__(self, isPickable=True)
+	if app.ENABLE_ACCE_COSTUME_SYSTEM:
+		def SetAcceResultItem(self, slotIndex, window_type = player.INVENTORY):
+			(itemVnum, MinAbs, MaxAbs) = acce.GetResultItem()
+			if not itemVnum:
+				return
 
-	def __del__(self):
-		ItemToolTip.__del__(self)
+			self.ClearToolTip()
 
-	def SetHyperlinkItem(self, tokens):
-		import chat
+			metinSlot = [player.GetItemMetinSocket(window_type, slotIndex, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
+			attrSlot = [player.GetItemAttribute(window_type, slotIndex, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
 
-		if app.ENABLE_ITEM_SOCKET6:
-			minTokenCount = chat.HYPER_LINK_ITEM_SOCKET5
-		else:
-			minTokenCount = chat.HYPER_LINK_ITEM_SOCKET2
-		maxTokenCount = chat.HYPER_LINK_ITEM_MAX
+			item.SelectItem(itemVnum)
+			itemType = item.GetItemType()
+			itemSubType = item.GetItemSubType()
+			if itemType != item.ITEM_TYPE_COSTUME and itemSubType != item.COSTUME_TYPE_ACCE:
+				return
+
+			absChance = MaxAbs
+			itemDesc = item.GetItemDescription()
+			self.__AdjustMaxWidth(attrSlot, itemDesc)
+			self.__SetItemTitle(itemVnum, metinSlot, attrSlot)
+			self.AppendDescription(itemDesc, 26)
+			self.AppendDescription(item.GetItemSummary(), 26, self.CONDITION_COLOR)
+			self.__AppendLimitInformation()
+
+			## ABSORPTION RATE
+			if MinAbs == MaxAbs:
+				self.AppendTextLine(localeInfo.TOOLTIP_APPLY_ACCEDRAIN_RATE(MinAbs), self.CONDITION_COLOR)
+			else:
+				self.AppendTextLine(localeInfo.TOOLTIP_APPLY_ACCEDRAIN_RATE(MinAbs) + " ~ %d%%" % (MaxAbs), self.CONDITION_COLOR)
+			## END ABSOPRTION RATE
+
+			itemAbsorbedVnum = int(metinSlot[acce.ABSORBED_SOCKET])
+			if itemAbsorbedVnum:
+				## ATTACK / DEFENCE
+				item.SelectItem(itemAbsorbedVnum)
+				if item.GetItemType() == item.ITEM_TYPE_WEAPON:
+					if item.GetItemSubType() == item.WEAPON_FAN:
+						self.__AppendMagicAttackInfo(absChance)
+						item.SelectItem(itemAbsorbedVnum)
+						self.__AppendAttackPowerInfo(absChance)
+					else:
+						self.__AppendAttackPowerInfo(absChance)
+						item.SelectItem(itemAbsorbedVnum)
+						self.__AppendMagicAttackInfo(absChance)
+				elif item.GetItemType() == item.ITEM_TYPE_ARMOR:
+					defGrade = item.GetValue(1)
+					defBonus = item.GetValue(5) * 2
+					defGrade = self.CalcAcceValue(defGrade, absChance)
+					defBonus = self.CalcAcceValue(defBonus, absChance)
+
+					if defGrade > 0:
+						self.AppendSpace(5)
+						self.AppendTextLine(localeInfo.TOOLTIP_ITEM_DEF_GRADE % (defGrade + defBonus), self.GetChangeTextLineColor(defGrade))
+
+					item.SelectItem(itemAbsorbedVnum)
+					self.__AppendMagicDefenceInfo(absChance)
+				## END ATTACK / DEFENCE
+
+				## EFFECT
+				item.SelectItem(itemAbsorbedVnum)
+				for i in xrange(item.ITEM_APPLY_MAX_NUM):
+					(affectType, affectValue) = item.GetAffect(i)
+					affectValue = self.CalcAcceValue(affectValue, absChance)
+					affectString = self.__GetAffectString(affectType, affectValue)
+					if affectString and affectValue > 0:
+						self.AppendTextLine(affectString, self.GetChangeTextLineColor(affectValue))
+
+					item.SelectItem(itemAbsorbedVnum)
+				# END EFFECT
+
+			item.SelectItem(itemVnum)
+			## ATTR
+			self.__AppendAttributeInformation(attrSlot, MaxAbs)
+			# END ATTR
+
+			self.AppendWearableInformation()
+			self.ShowToolTip()
+
+		def SetAcceResultAbsItem(self, slotIndex1, slotIndex2, window_type = player.INVENTORY):
+			itemVnumAcce = player.GetItemIndex(window_type, slotIndex1)
+			itemVnumTarget = player.GetItemIndex(window_type, slotIndex2)
+			if not itemVnumAcce or not itemVnumTarget:
+				return
+
+			self.ClearToolTip()
+
+			item.SelectItem(itemVnumAcce)
+			itemType = item.GetItemType()
+			itemSubType = item.GetItemSubType()
+			if itemType != item.ITEM_TYPE_COSTUME and itemSubType != item.COSTUME_TYPE_ACCE:
+				return
+
+			metinSlot = [player.GetItemMetinSocket(window_type, slotIndex1, i) for i in xrange(player.METIN_SOCKET_MAX_NUM)]
+			attrSlot = [player.GetItemAttribute(window_type, slotIndex2, i) for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM)]
+
+			itemDesc = item.GetItemDescription()
+			self.__AdjustMaxWidth(attrSlot, itemDesc)
+			self.__SetItemTitle(itemVnumAcce, metinSlot, attrSlot)
+			self.AppendDescription(itemDesc, 26)
+			self.AppendDescription(item.GetItemSummary(), 26, self.CONDITION_COLOR)
+			item.SelectItem(itemVnumAcce)
+			self.__AppendLimitInformation()
+
+			## ABSORPTION RATE
+			self.AppendTextLine(localeInfo.TOOLTIP_APPLY_ACCEDRAIN_RATE(metinSlot[acce.ABSORPTION_SOCKET]), self.CONDITION_COLOR)
+			## END ABSOPRTION RATE
+
+			## ATTACK / DEFENCE
+			itemAbsorbedVnum = itemVnumTarget
+			item.SelectItem(itemAbsorbedVnum)
+			if item.GetItemType() == item.ITEM_TYPE_WEAPON:
+				if item.GetItemSubType() == item.WEAPON_FAN:
+					self.__AppendMagicAttackInfo(metinSlot[acce.ABSORPTION_SOCKET])
+					item.SelectItem(itemAbsorbedVnum)
+					self.__AppendAttackPowerInfo(metinSlot[acce.ABSORPTION_SOCKET])
+				else:
+					self.__AppendAttackPowerInfo(metinSlot[acce.ABSORPTION_SOCKET])
+					item.SelectItem(itemAbsorbedVnum)
+					self.__AppendMagicAttackInfo(metinSlot[acce.ABSORPTION_SOCKET])
+			elif item.GetItemType() == item.ITEM_TYPE_ARMOR:
+				defGrade = item.GetValue(1)
+				defBonus = item.GetValue(5) * 2
+				defGrade = self.CalcAcceValue(defGrade, metinSlot[acce.ABSORPTION_SOCKET])
+				defBonus = self.CalcAcceValue(defBonus, metinSlot[acce.ABSORPTION_SOCKET])
+
+				if defGrade > 0:
+					self.AppendSpace(5)
+					self.AppendTextLine(localeInfo.TOOLTIP_ITEM_DEF_GRADE % (defGrade + defBonus), self.GetChangeTextLineColor(defGrade))
+
+				item.SelectItem(itemAbsorbedVnum)
+				self.__AppendMagicDefenceInfo(metinSlot[acce.ABSORPTION_SOCKET])
+			## END ATTACK / DEFENCE
+
+			## EFFECT
+			item.SelectItem(itemAbsorbedVnum)
+			for i in xrange(item.ITEM_APPLY_MAX_NUM):
+				(affectType, affectValue) = item.GetAffect(i)
+				affectValue = self.CalcAcceValue(affectValue, metinSlot[acce.ABSORPTION_SOCKET])
+				affectString = self.__GetAffectString(affectType, affectValue)
+				if affectString and affectValue > 0:
+					self.AppendTextLine(affectString, self.GetChangeTextLineColor(affectValue))
+
+				item.SelectItem(itemAbsorbedVnum)
+			## END EFFECT
+
+			## ATTR
+			item.SelectItem(itemAbsorbedVnum)
+			for i in xrange(player.ATTRIBUTE_SLOT_MAX_NUM):
+				type = attrSlot[i][0]
+				value = attrSlot[i][1]
+				if not value:
+					continue
 
-		if tokens and len(tokens) >= minTokenCount and len(tokens) <= maxTokenCount:
-			if app.ENABLE_SET_ITEM:
-				head, vnum, pre_set, flag = tokens[:chat.HYPER_LINK_ITEM_FLAGS + 1]
-				set_value = int(pre_set, 16)
+				value = self.CalcAcceValue(value, metinSlot[acce.ABSORPTION_SOCKET])
+				affectString = self.__GetAffectString(type, value)
+				if affectString and value > 0:
+					affectColor = self.__GetAttributeColor(i, value)
+					self.AppendTextLine(affectString, affectColor)
+
+				item.SelectItem(itemAbsorbedVnum)
+			## END ATTR
+
+			## WEARABLE
+			item.SelectItem(itemVnumAcce)
+			self.AppendSpace(5)
+			self.AppendTextLine(localeInfo.TOOLTIP_ITEM_WEARABLE_JOB, self.NORMAL_COLOR)
+
+			item.SelectItem(itemVnumAcce)
+			flagList = (
+				not item.IsAntiFlag(item.ITEM_ANTIFLAG_WARRIOR),
+				not item.IsAntiFlag(item.ITEM_ANTIFLAG_ASSASSIN),
+				not item.IsAntiFlag(item.ITEM_ANTIFLAG_SURA),
+				not item.IsAntiFlag(item.ITEM_ANTIFLAG_SHAMAN)
+			)
+
+			if not app.DISABLE_WOLFMAN_CREATION:
+				flagList += (not item.IsAntiFlag(item.ITEM_ANTIFLAG_WOLFMAN),)
+
+			characterNames = ""
+			for i in xrange(self.CHARACTER_COUNT):
+				name = self.CHARACTER_NAMES[i]
+				flag = flagList[i]
+				if flag:
+					characterNames += " "
+					characterNames += name
+
+			textLine = self.AppendTextLine(characterNames, self.NORMAL_COLOR, True)
+			textLine.SetFeather()
+
+			item.SelectItem(itemVnumAcce)
+			if item.IsAntiFlag(item.ITEM_ANTIFLAG_MALE):
+				textLine = self.AppendTextLine(localeInfo.FOR_FEMALE, self.NORMAL_COLOR, True)
+				textLine.SetFeather()
+
+			if item.IsAntiFlag(item.ITEM_ANTIFLAG_FEMALE):
+				textLine = self.AppendTextLine(localeInfo.FOR_MALE, self.NORMAL_COLOR, True)
+				textLine.SetFeather()
+			## END WEARABLE
+
+			self.ShowToolTip()
+
+	if app.ENABLE_CHANGE_LOOK_SYSTEM:
+		def AppendChangeLookInformation(self, window_type, slotIndex):
+			if window_type == player.SAFEBOX:
+				changelookvnum = safebox.GetItemTransmutation(slotIndex)
+			elif window_type == player.MALL:
+				changelookvnum = safebox.GetMallItemTransmutation(slotIndex)
 			else:
-				head, vnum, flag = tokens[:chat.HYPER_LINK_ITEM_FLAGS + 1]
-				set_value = 0
+				changelookvnum = player.GetItemTransmutation(window_type, slotIndex)
 
-			itemVnum = int(vnum, 16)
-			metinSlot = [int(metin, 16) for metin in tokens[chat.HYPER_LINK_ITEM_SOCKET0:minTokenCount + 1]]
+			if not changelookvnum == 0:
+				self.AppendSpace(5)
+				self.AppendTextLine("[ " + localeInfo.CHANGE_LOOK_TITLE + " ]", self.CHANGELOOK_TITLE_COLOR)
+				itemName = item.GetItemNameByVnum(changelookvnum)
 
-			if app.ENABLE_CHANGE_LOOK_SYSTEM:
-				changelookvnum = int(tokens[chat.HYPER_LINK_ITEM_CHANGE_ITEM_VNUM], 16)
+				if item.GetItemType() == item.ITEM_TYPE_COSTUME:
+					if item.GetItemSubType() == item.COSTUME_TYPE_BODY:
+						malefemale = ""
+						if item.IsAntiFlag(item.ITEM_ANTIFLAG_MALE):
+							malefemale = localeInfo.FOR_FEMALE
+
+						if item.IsAntiFlag(item.ITEM_ANTIFLAG_FEMALE):
+							malefemale = localeInfo.FOR_MALE
+						itemName += " ( " + malefemale + " )"
+
+				textLine = self.AppendTextLine(itemName, self.CHANGELOOK_ITEMNAME_COLOR, True)
+				textLine.SetFeather()
+
+	if app.ENABLE_GROWTH_PET_SYSTEM:
+		def AddHyperLinkPetItemData(self, itemVnum, metinSlot, attrSlot, pet_info):
+			
+			pet_level			= int(pet_info[0], 16)
+			pet_birthday		= int(pet_info[1], 16)
+			pet_evol_level		= int(pet_info[2], 16)
+			pet_hp				= int(pet_info[3], 16) / 10.0
+			pet_def				= int(pet_info[4], 16) / 10.0
+			pet_sp				= int(pet_info[5], 16) / 10.0
+			pet_life_time		= int(pet_info[6], 16)
+			pet_life_time_max	= int(pet_info[7], 16)
+			pet_skill_count		= int(pet_info[8], 16)
+			pet_item_vnum		= int(pet_info[9], 16)
+			pet_nick_name		= pet_info[10]
+						
+			pet_skill_vnum		= [0] * player.PET_SKILL_COUNT_MAX
+			pet_skill_level		= [0] * player.PET_SKILL_COUNT_MAX
+			
+			skill_index = 11
+			for index in range(player.PET_SKILL_COUNT_MAX):
+				pet_skill_vnum[index]	= int(pet_info[skill_index], 16)
+				skill_index = skill_index + 1
+				pet_skill_level[index]	= int(pet_info[skill_index], 16)
+				skill_index = skill_index + 1
+				
+			self.itemVnum = itemVnum
+			item.SelectItem(itemVnum)
+			itemType = item.GetItemType()
+			itemSubType = item.GetItemSubType()
+			itemDesc = item.GetItemDescription()
+			itemSummary = item.GetItemSummary()
+
+			if item.ITEM_TYPE_PET != itemType:
+				return
+			
+			if itemSubType not in [item.PET_UPBRINGING, item.PET_BAG]:
+				return
+			
+			if item.PET_BAG == itemSubType:
+				self.itemVnum = pet_item_vnum
+				item.SelectItem(pet_item_vnum)
+				pet_bag_desc = localeInfo.PET_BAG_DESC % item.GetItemName()
+				self.__AdjustMaxWidth(0, pet_bag_desc)
+				self.itemVnum = itemVnum
+				item.SelectItem(itemVnum)
+
+			if item.PET_BAG == itemSubType:
+				self.AppendTextLine( pet_nick_name + "(" + localeInfo.PET_TOOLTIP_TRADABLE + ")", self.TITLE_COLOR )
+			elif item.PET_UPBRINGING == itemSubType:
+				self.AppendTextLine( pet_nick_name, self.TITLE_COLOR)
+				
+			
+			## ??
+			if item.PET_UPBRINGING == itemSubType:
+				self.AppendDescription(itemDesc, 26)
+				self.AppendDescription(itemSummary, 26, self.CONDITION_COLOR)
+			elif item.PET_BAG == itemSubType:
+				self.AppendDescription(pet_bag_desc, 26)
+				self.itemVnum = itemVnum
+				item.SelectItem(itemVnum)
+
+			self.AppendSpace(5)
+			if item.PET_UPBRINGING == itemSubType:
+				cur_time = app.GetGlobalTimeStamp()
+				
+				# Pet's age stops at their death
+				if metinSlot[0] < cur_time:
+					pet_birthday = max(0, metinSlot[0] - pet_birthday)
+				else:
+					pet_birthday = max(0, cur_time - pet_birthday)
+					
+			elif item.PET_BAG == itemSubType:
+				cur_time	 = app.GetGlobalTimeStamp()
+				pet_birthday = max(0, cur_time - pet_birthday + (cur_time - metinSlot[1]))
+				
+			self.AppendTextLine(localeInfo.PET_TOOLTIP_LEVEL + " " + str(pet_level) + " (" + localeInfo.SecondToDay(pet_birthday) + ")")				
 
-			if app.ENABLE_REFINE_ELEMENT_SYSTEM:
-				refine_element = [
-					int(tokens[chat.HYPER_LINK_ITEM_REFINE_ELEMENT_APPLY_TYPE], 16),
-					int(tokens[chat.HYPER_LINK_ITEM_REFINE_ELEMENT_GRADE], 16),
-					[int(tokens[chat.HYPER_LINK_ITEM_REFINE_ELEMENT_VALUE0 + i], 16) for i in range(self.REFINE_ELEMENT_INDEX_MAX)],
-					[int(tokens[chat.HYPER_LINK_ITEM_REFINE_ELEMENT_BONUS_VALUE0 + i], 16) for i in range(self.REFINE_ELEMENT_INDEX_MAX)]
-				]
+			self.AppendSpace(5)
+			if pet_skill_count:
+				self.AppendTextLine( self.GetEvolName(pet_evol_level) + "(" + str(pet_skill_count) + ")")
 			else:
-				refine_element = None
+				self.AppendTextLine( self.GetEvolName(pet_evol_level) )
 
-			if app.ENABLE_APPLY_RANDOM:
-				apply_random = tokens[chat.HYPER_LINK_ITEM_APPLY_RANDOM_TYPE0:chat.HYPER_LINK_ITEM_APPLY_RANDOM_VALUE2 + 1]
-				if apply_random:
-					apply_random_list = []
-
-					apply_random.reverse()
-					while apply_random:
-						key = int(apply_random.pop(), 16)
-						if apply_random:
-							val = int(apply_random.pop())
-							apply_random_list.append((key, val))
+			self.AppendSpace(5)
+			self.AppendTextLine(localeInfo.PET_TOOLTIP_HP + " +" + str("%0.1f" % pet_hp) + "%", self.SPECIAL_POSITIVE_COLOR)
+			self.AppendTextLine(localeInfo.PET_TOOLTIP_DEF + " +" + str("%0.1f" % pet_def) + "%", self.SPECIAL_POSITIVE_COLOR)
+			self.AppendTextLine(localeInfo.PET_TOOLTIP_SP + " +" + str("%0.1f" % pet_sp) + "%", self.SPECIAL_POSITIVE_COLOR)				
+
+			for index in range(player.PET_SKILL_COUNT_MAX):
+				if pet_skill_vnum[index]:
+					self.AppendSpace(5)
+					( pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time ) = skill.GetPetSkillInfo(pet_skill_vnum[index])
+					self.AppendTextLine( localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level[index]) , self.SPECIAL_POSITIVE_COLOR)
+						
+			for i in xrange(item.LIMIT_MAX_NUM):
+				(limitType, limitValue) = item.GetLimit(i)
+				if item.LIMIT_REAL_TIME == limitType:
+					self.AppendPetItemLastTime(metinSlot[0])
+				if item.LIMIT_REAL_TIME_START_FIRST_USE == limitType:
+					self.AppendPetItemLastTime(metinSlot[0])
+
+			
+			self.ShowToolTip()
+			
+		def GetEvolName(self, evol_level):
+		
+			if 1 == evol_level:
+				return localeInfo.PET_INFORMATION_STAGE1
+			elif 2 == evol_level:
+				return localeInfo.PET_INFORMATION_STAGE2
+			elif 3 == evol_level:
+				return localeInfo.PET_INFORMATION_STAGE3
+			elif 4 == evol_level:
+				return localeInfo.PET_INFORMATION_STAGE4
+				
+			return localeInfo.PET_INFORMATION_STAGE1
+		
+		def __AppendPetBagItemInfomation(self, metinSlot):
+			pet_id = metinSlot[2]
+			if pet_id:
+				self.ClearToolTip()
+				growhPetVNum = player.GetPetItemVNumInBag(pet_id)
+				if 0 == growhPetVNum:
+					return
+
+				item.SelectItem(growhPetVNum)
+				pet_bag_desc = localeInfo.PET_BAG_DESC % item.GetItemName()
+				self.__AdjustMaxWidth(0, pet_bag_desc)
+
+				(pet_level, evol_level, birthday, pet_nick, pet_hp, pet_def, pet_sp) = player.GetPetItem(pet_id)
+				self.AppendTextLine( pet_nick + "(" + localeInfo.PET_TOOLTIP_TRADABLE + ")", self.TITLE_COLOR )
+
+				## DESC
+				self.AppendDescription(pet_bag_desc, 26)
+				
+				item.SelectItem(self.itemVnum)
+
+				(skill_count, pet_skill1, pet_skill_level1, pet_skill_cool1, pet_skill2, pet_skill_level2, pet_skill_cool2, pet_skill3, pet_skill_level3, pet_skill_cool3) = player.GetPetSkill(pet_id)
+
+				self.AppendSpace(5)
+
+				cur_time = app.GetGlobalTimeStamp()
+				birthSec = max(0, cur_time - birthday - (cur_time - metinSlot[1]))
+				
+				self.AppendTextLine(localeInfo.PET_TOOLTIP_LEVEL + " " + str(pet_level) + " (" + localeInfo.SecondToDay(birthSec) + ")")
+
+				## Pet Evolution/Skill Count
+				self.AppendSpace(5)
+				if skill_count:
+					self.AppendTextLine( self.GetEvolName(evol_level) + "(" + str(skill_count) + ")")
+				else:
+					self.AppendTextLine( self.GetEvolName(evol_level) )
+					
+				## Pet Stats
+				self.AppendSpace(5)
+				self.AppendTextLine(localeInfo.PET_TOOLTIP_HP + " +" + str("%0.1f" % pet_hp) + "%", self.SPECIAL_POSITIVE_COLOR)
+				self.AppendTextLine(localeInfo.PET_TOOLTIP_DEF + " +" + str("%0.1f" % pet_def) + "%", self.SPECIAL_POSITIVE_COLOR)
+				self.AppendTextLine(localeInfo.PET_TOOLTIP_SP + " +" + str("%0.1f" % pet_sp) + "%", self.SPECIAL_POSITIVE_COLOR)				
+				
+				## Pet Skills
+				if pet_skill1:
+					self.AppendSpace(5)
+					( pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time ) = skill.GetPetSkillInfo(pet_skill1)
+					self.AppendTextLine( localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level1) , self.SPECIAL_POSITIVE_COLOR)
+				if pet_skill2:
+					( pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time ) = skill.GetPetSkillInfo(pet_skill2)
+					self.AppendTextLine( localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level2) , self.SPECIAL_POSITIVE_COLOR)
+				if pet_skill3:
+					( pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time) = skill.GetPetSkillInfo(pet_skill3)
+					self.AppendTextLine( localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level3) , self.SPECIAL_POSITIVE_COLOR)
+
+				## Bag Duration
+				for i in xrange(item.LIMIT_MAX_NUM):
+					(limitType, limitValue) = item.GetLimit(i)
+					if item.LIMIT_REAL_TIME_START_FIRST_USE == limitType:
+						self.AppendPetItemLastTime(metinSlot[0])
+
+		def __AppendPetEggItemInformation(self, metinSlot, isFeedWindow = False):
+			for i in xrange(item.LIMIT_MAX_NUM):
+				(limitType, limitValue) = item.GetLimit(i)
+				if item.LIMIT_REAL_TIME == limitType:
+					self.AppendMallItemLastTime(metinSlot[0])
 
-					apply_random_list += [(0, 0)] * (player.APPLY_RANDOM_SLOT_MAX_NUM - len(apply_random_list))
+		def __AppendUpBringingPetItemInfomation(self, metinSlot):
+			pet_id = metinSlot[2]
+			if pet_id:
+				## Skills
+				(skill_count, pet_skill1, pet_skill_level1, pet_skill_cool1, pet_skill2, pet_skill_level2, pet_skill_cool2, pet_skill3, pet_skill_level3, pet_skill_cool3) = player.GetPetSkill(pet_id)
+				
+				## Pet Level/Age
+				(pet_level, evol_level, birthday, pet_nick, pet_hp, pet_def, pet_sp) = player.GetPetItem(pet_id)
+				self.AppendSpace(5)
+				
+				curTime = app.GetGlobalTimeStamp()
+				birthSec = 0
+				
+				# Pet's age stops at their death
+				if metinSlot[0] < curTime:
+					birthSec = max(0, metinSlot[0] - birthday)
+				else:
+					birthSec = max(0, curTime - birthday)
+				self.AppendTextLine(localeInfo.PET_TOOLTIP_LEVEL + " " + str(pet_level) + " (" + localeInfo.SecondToDay(birthSec) + ")")
+			
+				## Pet Evolution/Skill Count
+				self.AppendSpace(5)
+				if skill_count:
+					self.AppendTextLine( self.GetEvolName(evol_level) + "(" + str(skill_count) + ")")
 				else:
-					apply_random_list = [(0, 0)] * player.APPLY_RANDOM_SLOT_MAX_NUM
+					self.AppendTextLine( self.GetEvolName(evol_level) )
+					
+				## Pet Stats
+				self.AppendSpace(5)
+				self.AppendTextLine(localeInfo.PET_TOOLTIP_HP + " +" + str("%0.1f" % pet_hp) + "%", self.SPECIAL_POSITIVE_COLOR)
+				self.AppendTextLine(localeInfo.PET_TOOLTIP_DEF + " +" + str("%0.1f" % pet_def) + "%", self.SPECIAL_POSITIVE_COLOR)
+				self.AppendTextLine(localeInfo.PET_TOOLTIP_SP + " +" + str("%0.1f" % pet_sp) + "%", self.SPECIAL_POSITIVE_COLOR)						
+				
+				## Pet Skills
+				if pet_skill1:
+					self.AppendSpace(5)
+					( pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time ) = skill.GetPetSkillInfo(pet_skill1)
+					self.AppendTextLine( localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level1) , self.SPECIAL_POSITIVE_COLOR)
+				if pet_skill2:
+					( pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time ) = skill.GetPetSkillInfo(pet_skill2)
+					self.AppendTextLine( localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level2) , self.SPECIAL_POSITIVE_COLOR)
+				if pet_skill3:
+					( pet_skill_name, pet_skill_desc, pet_skill_use_type , pet_skill_cool_time) = skill.GetPetSkillInfo(pet_skill3)
+					self.AppendTextLine( localeInfo.PET_TOOLTUP_SKILL % (pet_skill_name, pet_skill_level3) , self.SPECIAL_POSITIVE_COLOR)
+					
+				## Pet Duration
+				for i in xrange(item.LIMIT_MAX_NUM):
+					(limitType, limitValue) = item.GetLimit(i)
+					if item.LIMIT_REAL_TIME == limitType:
+						self.AppendPetItemLastTime(metinSlot[0])
+			
+		def AppendPetItemLastTime(self, endTime):
+			self.AppendSpace(5)
+			
+			leftSec = endTime - app.GetGlobalTimeStamp()
+			if leftSec >= 0:
+				self.AppendTextLine(localeInfo.LEFT_TIME + " : " + localeInfo.SecondToDHM(leftSec), self.NORMAL_COLOR)
+			else:
+				self.AppendTextLine(localeInfo.LEFT_TIME + " : " + localeInfo.PET_TOOLTIP_LIFETIME_OVER, self.DISABLE_COLOR)
+
+class HyperlinkItemToolTip(ItemToolTip):
+	def __init__(self):
+		ItemToolTip.__init__(self, isPickable=True)
+
+	def __del__(self):
+		ItemToolTip.__del__(self)
+
+	def SetHyperlinkItem(self, tokens):
+		minTokenCount = 3 + player.METIN_SOCKET_MAX_NUM + 1 if app.ENABLE_ITEM_SOCKET5 else 0
+		if app.ENABLE_CHANGE_LOOK_SYSTEM:
+			minTokenCount += 1
+		maxTokenCount = minTokenCount + 2 * player.ATTRIBUTE_SLOT_MAX_NUM
+		if tokens and len(tokens) >= (minTokenCount - player.METIN_SOCKET_MAX_NUM if app.ENABLE_ITEM_SOCKET5 else minTokenCount) - (minTokenCount - 1 if app.ENABLE_CHANGE_LOOK_SYSTEM else 0) and len(tokens) <= maxTokenCount:
+			head, vnum, flag = tokens[:3]
+			itemVnum = int(vnum, 16)
+			metinSlot = [int(metin, 16) for metin in tokens[3:6 + 3 if app.ENABLE_ITEM_SOCKET5 else 0]]
+
+			if app.ENABLE_CHANGE_LOOK_SYSTEM:
+				changelookvnum = int(tokens[6 + 3 if app.ENABLE_ITEM_SOCKET5 else 0], 16)
+				rests = tokens[7 + 3 if app.ENABLE_ITEM_SOCKET5 else 0:]
+			else:
+				rests = tokens[6 + 3 if app.ENABLE_ITEM_SOCKET5 else 0:]
 
-			rests = tokens[chat.HYPER_LINK_ITEM_ATTRIBUTE_TYPE0:]
 			if rests:
 				attrSlot = []
 
@@ -4221,7 +3621,7 @@
 				attrSlot = [(0, 0)] * player.ATTRIBUTE_SLOT_MAX_NUM
 
 			self.ClearToolTip()
-			self.AddItemData(itemVnum, metinSlot, attrSlot, None, 0, 0, player.INVENTORY, -1, refine_element, apply_random_list, set_value)
+			self.AddItemData(itemVnum, metinSlot, attrSlot)
 
 			if app.ENABLE_CHANGE_LOOK_SYSTEM:
 				self.AppendChangeLookInfoItemVnum(changelookvnum)
@@ -4231,23 +3631,23 @@
 	if app.ENABLE_GROWTH_PET_SYSTEM:
 		def SetHyperlinkPetItem(self, tokens):
 		
-			defaultTokenCount = 3 + 4 #player.METIN_SOCKET_MAX_NUM			
+			defaultTokenCount = 3 + 3 #player.METIN_SOCKET_MAX_NUM			
 			petTokenCount = defaultTokenCount + 11 + (player.PET_SKILL_COUNT_MAX * 2)
 			
 			if tokens and len(tokens) == petTokenCount:
 			
 				head, vnum, flag = tokens[:3]
 				itemVnum = int(vnum, 16)
-				metinSlot = [int(metin, 16) for metin in tokens[3:7]]
+				metinSlot = [int(metin, 16) for metin in tokens[3:6]]
 				
 				attrSlot = [(0, 0)] * player.ATTRIBUTE_SLOT_MAX_NUM
 				
 				print(itemVnum)
 				print(metinSlot)
-				print(tokens[7:])
+				print(tokens[6:])
 
 				self.ClearToolTip()
-				self.AddHyperLinkPetItemData(itemVnum, metinSlot, attrSlot, tokens[7:])
+				self.AddHyperLinkPetItemData(itemVnum, metinSlot, attrSlot, tokens[6:])
 				ItemToolTip.OnUpdate(self)
 
 	def OnUpdate(self):
@@ -4257,6 +3657,10 @@
 		self.Hide()
 
 class SkillToolTip(ToolTip):
+	POINT_NAME_DICT = {
+		player.LEVEL : localeInfo.SKILL_TOOLTIP_LEVEL,
+		player.IQ : localeInfo.SKILL_TOOLTIP_INT,
+	}
 
 	SKILL_TOOL_TIP_WIDTH = 200
 	PARTY_SKILL_TOOL_TIP_WIDTH = 340
@@ -4264,18 +3668,18 @@
 	PARTY_SKILL_EXPERIENCE_AFFECT_LIST = (
 		( 2, 2, 10,),
 		( 8, 3, 20,),
-		( 14, 4, 30,),
-		( 22, 5, 45,),
-		( 28, 6, 60,),
-		( 34, 7, 80,),
-		( 38, 8, 100,),
+		(14, 4, 30,),
+		(22, 5, 45,),
+		(28, 6, 60,),
+		(34, 7, 80,),
+		(38, 8, 100,),
 	)
 
 	PARTY_SKILL_PLUS_GRADE_AFFECT_LIST = (
-		( 4, 2, 1, 0, ),
-		( 10, 3, 2, 0, ),
-		( 16, 4, 2, 1, ),
-		( 24, 5, 2, 2, ),
+		( 4, 2, 1, 0,),
+		(10, 3, 2, 0,),
+		(16, 4, 2, 1,),
+		(24, 5, 2, 2,),
 	)
 
 	PARTY_SKILL_ATTACKER_AFFECT_LIST = (
@@ -4284,6 +3688,23 @@
 		( 32, 2, ),
 	)
 
+	SKILL_GRADE_NAME = {
+		player.SKILL_GRADE_MASTER : localeInfo.SKILL_GRADE_NAME_MASTER,
+		player.SKILL_GRADE_GRAND_MASTER : localeInfo.SKILL_GRADE_NAME_GRAND_MASTER,
+		player.SKILL_GRADE_PERFECT_MASTER : localeInfo.SKILL_GRADE_NAME_PERFECT_MASTER,
+	}
+
+	AFFECT_NAME_DICT = {
+		"HP" : localeInfo.TOOLTIP_SKILL_AFFECT_ATT_POWER,
+		"ATT_GRADE" : localeInfo.TOOLTIP_SKILL_AFFECT_ATT_GRADE,
+		"DEF_GRADE" : localeInfo.TOOLTIP_SKILL_AFFECT_DEF_GRADE,
+		"ATT_SPEED" : localeInfo.TOOLTIP_SKILL_AFFECT_ATT_SPEED,
+		"MOV_SPEED" : localeInfo.TOOLTIP_SKILL_AFFECT_MOV_SPEED,
+		"DODGE" : localeInfo.TOOLTIP_SKILL_AFFECT_DODGE,
+		"RESIST_NORMAL" : localeInfo.TOOLTIP_SKILL_AFFECT_RESIST_NORMAL,
+		"REFLECT_MELEE" : localeInfo.TOOLTIP_SKILL_AFFECT_REFLECT_MELEE,
+	}
+
 	AFFECT_APPEND_TEXT_DICT = {
 		"DODGE" : "%",
 		"RESIST_NORMAL" : "%",
@@ -4292,29 +3713,6 @@
 
 	def __init__(self):
 		ToolTip.__init__(self, self.SKILL_TOOL_TIP_WIDTH)
-
-		self.POINT_NAME_DICT = {
-			player.LEVEL : localeInfo.SKILL_TOOLTIP_LEVEL,
-			player.IQ : localeInfo.SKILL_TOOLTIP_INT,
-		}
-
-		self.SKILL_GRADE_NAME = {
-			player.SKILL_GRADE_MASTER : localeInfo.SKILL_GRADE_NAME_MASTER,
-			player.SKILL_GRADE_GRAND_MASTER : localeInfo.SKILL_GRADE_NAME_GRAND_MASTER,
-			player.SKILL_GRADE_PERFECT_MASTER : localeInfo.SKILL_GRADE_NAME_PERFECT_MASTER,
-		}
-
-		self.AFFECT_NAME_DICT = {
-			"HP" : localeInfo.TOOLTIP_SKILL_AFFECT_ATT_POWER,
-			"ATT_GRADE" : localeInfo.TOOLTIP_SKILL_AFFECT_ATT_GRADE,
-			"DEF_GRADE" : localeInfo.TOOLTIP_SKILL_AFFECT_DEF_GRADE,
-			"ATT_SPEED" : localeInfo.TOOLTIP_SKILL_AFFECT_ATT_SPEED,
-			"MOV_SPEED" : localeInfo.TOOLTIP_SKILL_AFFECT_MOV_SPEED,
-			"DODGE" : localeInfo.TOOLTIP_SKILL_AFFECT_DODGE,
-			"RESIST_NORMAL" : localeInfo.TOOLTIP_SKILL_AFFECT_RESIST_NORMAL,
-			"REFLECT_MELEE" : localeInfo.TOOLTIP_SKILL_AFFECT_REFLECT_MELEE,
-		}
-
 	def __del__(self):
 		ToolTip.__del__(self)
 
@@ -4360,6 +3758,13 @@
 			self.AppendDefaultData(skillIndex)
 			self.__AppendLeaderShipSkillData(skillGrade, skillLevel)
 
+		elif player.SKILL_INDEX_INSIGHT == skillIndex:
+			slotIndex = player.GetSkillSlotIndex(skillIndex)
+			skillLevel = player.GetSkillLevel(slotIndex)
+
+			self.AppendDefaultData(skillIndex)
+			self.__AppendInSightSkillData(skillGrade, skillLevel)
+
 		elif player.SKILL_INDEX_RIDING == skillIndex:
 			slotIndex = player.GetSkillSlotIndex(skillIndex)
 			self.AppendSupportSkillDefaultData(skillIndex, skillGrade, skillLevel, 30)
@@ -4397,20 +3802,13 @@
 			self.AppendSkillConditionData(skillIndex)
 			self.AppendGuildSkillData(skillIndex, skillLevel)
 
-		elif app.ENABLE_PARTY_PROFICY and player.SKILL_INDEX_ROLE_PROFICIENCY == skillIndex:
+		elif player.SKILL_INDEX_ROLE_PROFICIENCY == skillIndex:
 			slotIndex = player.GetSkillSlotIndex(skillIndex)
 			skillLevel = player.GetSkillLevel(slotIndex)
 
 			self.AppendDefaultData(skillIndex)
 			self.__AppendRoleProficiencySkillData(skillGrade, skillLevel)
 
-		elif app.ENABLE_PARTY_INSIGHT and player.SKILL_INDEX_INSIGHT == skillIndex:
-			slotIndex = player.GetSkillSlotIndex(skillIndex)
-			skillLevel = player.GetSkillLevel(slotIndex)
-
-			self.AppendDefaultData(skillIndex)
-			self.__AppendInSightSkillData(skillGrade, skillLevel)
-
 		else:
 			if self.SKILL_TOOL_TIP_WIDTH != self.toolTipWidth:
 				self.toolTipWidth = self.SKILL_TOOL_TIP_WIDTH
@@ -4700,7 +4098,7 @@
 		if continuationSP > 0:
 			self.AppendTextLine(localeInfo.TOOLTIP_NEED_SP_PER_SEC % (continuationSP), color)
 
-	def __AppendLeaderShipSkillData(self, skill_grade, skill_level):
+	def __AppendRoleProficiencySkillData(self, skill_grade, skill_level):
 		if 1 == skill_grade:
 			skill_level += 19
 		elif 2 == skill_grade:
@@ -4711,103 +4109,106 @@
 		if skill_level <= 0:
 			return
 
-		skillIndex = player.SKILL_INDEX_TONGSOL
+		skillIndex = player.SKILL_INDEX_ROLE_PROFICIENCY
+		slotIndex = player.GetSkillSlotIndex(skillIndex)
+
+		self.AppendSpace(5)
+		self.AutoAppendTextLine(localeInfo.TOOLTIP_ROLE_PROFICIENCY_SKILL_LEVEL % skill_level, self.NORMAL_COLOR)
+		self.AutoAppendTextLine(localeInfo.TOOLTIP_ROLE_PROFICIENCY_LEADER_EFFECT % int(skill_level))
+
+		self.AlignHorizonalCenter()
+
+	def __AppendInSightSkillData(self, skill_grade, skill_level):
+		if 1 == skill_grade:
+			skill_level += 19
+		elif 2 == skill_grade:
+			skill_level += 29
+		elif 3 == skill_grade:
+			skill_level = 40
+
+		if skill_level <= 0:
+			return
+
+		skillIndex = player.SKILL_INDEX_INSIGHT
 		slotIndex = player.GetSkillSlotIndex(skillIndex)
 		skillPower = player.GetSkillCurrentEfficientPercentage(slotIndex)
 
 		if localeInfo.IsBRAZIL() or localeInfo.IsNEWCIBN():
 			k = skillPower
 		else:
-			k = float(skill.GetSkillPowerByLevel(skill_level)) / 100
+			# k = float(skill.GetSkillPowerByLevel(skill_level) ) /100
+			k = player.GetSkillLevel(skillIndex) / 100.0
 
 		self.AppendSpace(5)
-		self.AutoAppendTextLine(localeInfo.TOOLTIP_PARTY_SKILL_LEVEL % skill_level, self.NORMAL_COLOR)
+		self.AutoAppendTextLine(localeInfo.TOOLTIP_INSIGHT_SKILL_LEVEL % skill_level, self.NORMAL_COLOR)
 
 		if skill_level >= 10:
-			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_ATTACKER % int(LEADERSHIP_ATTACKER_BASE_VALUE + LEADERSHIP_ATTACKER_ADJUSTMENT_VALUE * k))
+			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_ATTACKER % int(10 + 60 * k))
 
 		if skill_level >= 20:
-			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_BERSERKER % int(LEADERSHIP_BERSERKER_BASE_VALUE + LEADERSHIP_BERSERKER_ADJUSTMENT_VALUE * k))
-			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_TANKER % int(LEADERSHIP_TANKER_BASE_VALUE + LEADERSHIP_TANKER_ADJUSTMENT_VALUE * k))
+			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_BERSERKER % int(1 + 5 * k))
+			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_TANKER % int(50 + 1450 * k))
 
 		if skill_level >= 25:
-			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_BUFFER % int(LEADERSHIP_BUFFER_BASE_VALUE + LEADERSHIP_BUFFER_ADJUSTMENT_VALUE * k))
+			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_BUFFER % int(5 + 45 * k))
 
 		if skill_level >= 35:
-			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_SKILL_MASTER % int(LEADERSHIP_SKILL_MASTER_BASE_VALUE + LEADERSHIP_SKILL_MASTER_ADJUSTMENT_VALUE * k))
+			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_SKILL_MASTER % int(25 + 600 * k))
 
 		if skill_level >= 40:
-			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_DEFENDER % int(LEADERSHIP_DEFENDER_BASE_VALUE + LEADERSHIP_DEFENDER_ADJUSTMENT_VALUE * k))
+			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_DEFENDER % int(5 + 30 * k))
 
 		self.AlignHorizonalCenter()
 
-	def __AppendSummonDescription(self, skillLevel, color):
-		if skillLevel > 1:
-			self.AppendTextLine(localeInfo.SKILL_SUMMON_DESCRIPTION % (skillLevel * 10), color)
-		elif 1 == skillLevel:
-			self.AppendTextLine(localeInfo.SKILL_SUMMON_DESCRIPTION % (15), color)
-		elif 0 == skillLevel:
-			self.AppendTextLine(localeInfo.SKILL_SUMMON_DESCRIPTION % (10), color)
-
-	if app.ENABLE_PARTY_PROFICY:
-		def __AppendRoleProficiencySkillData(self, skill_grade, skill_level):
-			if 1 == skill_grade:
-				skill_level += 19
-			elif 2 == skill_grade:
-				skill_level += 29
-			elif 3 == skill_grade:
-				skill_level = 40
-
-			if skill_level <= 0:
-				return
-
-			self.AppendSpace(5)
-			self.AutoAppendTextLine(localeInfo.TOOLTIP_ROLE_PROFICIENCY_SKILL_LEVEL % skill_level, self.NORMAL_COLOR)
-			self.AutoAppendTextLine(localeInfo.TOOLTIP_ROLE_PROFICIENCY_LEADER_EFFECT % skill.GetRoleProficiencyLeaderBonusByLevel(skill_level))
-
-			self.AlignHorizonalCenter()
+	def __AppendLeaderShipSkillData(self, skill_grade, skill_level):
+		if 1 == skill_grade:
+			skill_level += 19
+		elif 2 == skill_grade:
+			skill_level += 29
+		elif 3 == skill_grade:
+			skill_level = 40
 
-	if app.ENABLE_PARTY_INSIGHT:
-		def __AppendInSightSkillData(self, skill_grade, skill_level):
-			if 1 == skill_grade:
-				skill_level += 19
-			elif 2 == skill_grade:
-				skill_level += 29
-			elif 3 == skill_grade:
-				skill_level = 40
+		if skill_level <= 0:
+			return
 
-			if skill_level <= 0:
-				return
+		skillIndex = player.SKILL_INDEX_TONGSOL
+		slotIndex = player.GetSkillSlotIndex(skillIndex)
+		skillPower = player.GetSkillCurrentEfficientPercentage(slotIndex)
 
-			skillIndex = player.SKILL_INDEX_INSIGHT
-			slotIndex = player.GetSkillSlotIndex(skillIndex)
-			skillPower = player.GetSkillCurrentEfficientPercentage(slotIndex)
+		if localeInfo.IsBRAZIL() or localeInfo.IsNEWCIBN():
+			k = skillPower
+		else:
+			# k = float(skill.GetSkillPowerByLevel(skill_level) ) /100
+			k = player.GetSkillLevel(skillIndex) / 100.0
 
-			if localeInfo.IsBRAZIL() or localeInfo.IsNEWCIBN():
-				k = skillPower
-			else:
-				k = float(skill.GetSkillPowerByLevel(skill_level)) / 100
+		self.AppendSpace(5)
+		self.AutoAppendTextLine(localeInfo.TOOLTIP_PARTY_SKILL_LEVEL % skill_level, self.NORMAL_COLOR)
 
-			self.AppendSpace(5)
-			self.AutoAppendTextLine(localeInfo.TOOLTIP_INSIGHT_SKILL_LEVEL % skill_level, self.NORMAL_COLOR)
+		if skill_level >= 10:
+			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_ATTACKER % int(10 + 60 * k))
 
-			if skill_level >= 10:
-				self.AutoAppendTextLine(localeInfo.PARTY_SKILL_ATTACKER % int(INSIGHT_ATTACKER_BASE_VALUE + INSIGHT_ATTACKER_ADJUSTMENT_VALUE * k))
+		if skill_level >= 20:
+			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_BERSERKER % int(1 + 5 * k))
+			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_TANKER % int(50 + 1450 * k))
 
-			if skill_level >= 20:
-				self.AutoAppendTextLine(localeInfo.PARTY_SKILL_BERSERKER % int(INSIGHT_BERSERKER_BASE_VALUE + INSIGHT_BERSERKER_ADJUSTMENT_VALUE * k))
-				self.AutoAppendTextLine(localeInfo.PARTY_SKILL_TANKER % int(INSIGHT_TANKER_BASE_VALUE + INSIGHT_TANKER_ADJUSTMENT_VALUE * k))
+		if skill_level >= 25:
+			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_BUFFER % int(5 + 45 * k))
 
-			if skill_level >= 25:
-				self.AutoAppendTextLine(localeInfo.PARTY_SKILL_BUFFER % int(INSIGHT_BUFFER_BASE_VALUE + INSIGHT_BUFFER_ADJUSTMENT_VALUE * k))
+		if skill_level >= 35:
+			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_SKILL_MASTER % int(25 + 600 * k))
 
-			if skill_level >= 35:
-				self.AutoAppendTextLine(localeInfo.PARTY_SKILL_SKILL_MASTER % int(INSIGHT_SKILL_MASTER_BASE_VALUE + INSIGHT_SKILL_MASTER_ADJUSTMENT_VALUE * k))
+		if skill_level >= 40:
+			self.AutoAppendTextLine(localeInfo.PARTY_SKILL_DEFENDER % int(5 + 30 * k))
 
-			if skill_level >= 40:
-				self.AutoAppendTextLine(localeInfo.PARTY_SKILL_DEFENDER % int(INSIGHT_DEFENDER_BASE_VALUE + INSIGHT_DEFENDER_ADJUSTMENT_VALUE * k))
+		self.AlignHorizonalCenter()
 
-			self.AlignHorizonalCenter()
+	def __AppendSummonDescription(self, skillLevel, color):
+		if skillLevel > 1:
+			self.AppendTextLine(localeInfo.SKILL_SUMMON_DESCRIPTION % (skillLevel * 10), color)
+		elif 1 == skillLevel:
+			self.AppendTextLine(localeInfo.SKILL_SUMMON_DESCRIPTION % (15), color)
+		elif 0 == skillLevel:
+			self.AppendTextLine(localeInfo.SKILL_SUMMON_DESCRIPTION % (10), color)
 
 if app.ENABLE_GROWTH_PET_SYSTEM:
 	class PetSkillToolTip(ToolTip):
Binary files client_base/client/client/pack/ymir work/ui/skill_pet.dds and client_final/client/client/pack/ymir work/ui/skill_pet.dds differ
