diff --git a/server/server/home/metin2/Source/Server/game/src/char_item.cpp b/server/server/home/metin2/Source/Server/game/src/char_item.cpp
--- a/server/server/home/metin2/Source/Server/game/src/char_item.cpp+++ b/server/server/home/metin2/Source/Server/game/src/char_item.cpp@@ -2652,7 +2652,7 @@ 	snprintf(szLine, sizeof(szLine), "MyShopPriceList %u %u", dwItemVnum, dwItemPrice);
 #endif
 	ChatPacket(CHAT_TYPE_COMMAND, szLine);
-	sys_log(0, szLine);
+	sys_log(0, "%s", szLine);
 }
 
 //

diff --git a/server/server/home/metin2/Source/Server/game/src/char_manager.cpp b/server/server/home/metin2/Source/Server/game/src/char_manager.cpp
--- a/server/server/home/metin2/Source/Server/game/src/char_manager.cpp+++ b/server/server/home/metin2/Source/Server/game/src/char_manager.cpp@@ -362,7 +362,7 @@ 	if (test_server)
 		SendNotice(buf);
 
-	sys_log(0, buf);
+	sys_log(0, "%s", buf);
 	return (ch);
 }
 

diff --git a/server/server/home/metin2/Source/Server/game/src/cmd_gm.cpp b/server/server/home/metin2/Source/Server/game/src/cmd_gm.cpp
--- a/server/server/home/metin2/Source/Server/game/src/cmd_gm.cpp+++ b/server/server/home/metin2/Source/Server/game/src/cmd_gm.cpp@@ -62,7 +62,7 @@ 	char arg1[256];
 	one_argument(argument, arg1, sizeof(arg1));
 
-	sys_log(0, arg1);
+	sys_log(0, "%s", arg1);
 
 	if (!*arg1)
 	{
@@ -5895,7 +5895,7 @@ 
 	char buf[255 + 1];
 	snprintf(buf, sizeof(buf), "LOG LEVEL : %d", level);
-	sys_log(0, buf);
+	sys_log(0, "%s", buf);
 
 	log_set_level(level);
 }

diff --git a/server/server/home/metin2/Source/Server/game/src/minigame_roulette.cpp b/server/server/home/metin2/Source/Server/game/src/minigame_roulette.cpp
--- a/server/server/home/metin2/Source/Server/game/src/minigame_roulette.cpp+++ b/server/server/home/metin2/Source/Server/game/src/minigame_roulette.cpp@@ -699,7 +699,7 @@ 	vsnprintf(buf, sizeof(buf), format, args);
 	va_end(args);
 
-	sys_err(buf);
+	sys_err("%s", buf);
 
 	Close(true);
 }

diff --git a/server/server/home/metin2/Source/Server/libsql/AsyncSQL.cpp b/server/server/home/metin2/Source/Server/libsql/AsyncSQL.cpp
--- a/server/server/home/metin2/Source/Server/libsql/AsyncSQL.cpp+++ b/server/server/home/metin2/Source/Server/libsql/AsyncSQL.cpp@@ -272,7 +272,7 @@ 			"AsyncSQL::DirectQuery : mysql_query error: %s\nquery: %s",
 			mysql_error(&m_hDB), p->stQuery.c_str());
 
-		sys_err(buf);
+		sys_err("%s", buf);
 		p->uiSQLErrno = mysql_errno(&m_hDB);
 	}
 

diff --git a/server/server/home/metin2/Source/Server/game/src/char.h b/server/server/home/metin2/Source/Server/game/src/char.h
--- a/server/server/home/metin2/Source/Server/game/src/char.h+++ b/server/server/home/metin2/Source/Server/game/src/char.h@@ -1,5 +1,6 @@ #ifndef __INC_CHAR_H__
 #define __INC_CHAR_H__
+#include <cstdio>
 
 #include "../../common/stl.h"
 #include "entity.h"
@@ -2741,7 +2742,7 @@ 	char* GetItemAward_cmd() { return itemAward_cmd; }
 	//bool GetItemAward_flag() { return itemAward_flag; }
 	void SetItemAward_vnum(unsigned int vnum) { itemAward_vnum = vnum; }
-	void SetItemAward_cmd(char* cmd) { strcpy(itemAward_cmd, cmd); }
+	void SetItemAward_cmd(const char* cmd) { snprintf(itemAward_cmd, sizeof(itemAward_cmd), "%s", cmd ? cmd : ""); }
 	//void SetItemAward_flag(bool flag) { itemAward_flag = flag; }
 
 #if defined(__MOVE_COSTUME_ATTR__)

diff --git a/server/server/home/metin2/Source/Server/game/src/battlepass_manager.cpp b/server/server/home/metin2/Source/Server/game/src/battlepass_manager.cpp
--- a/server/server/home/metin2/Source/Server/game/src/battlepass_manager.cpp+++ b/server/server/home/metin2/Source/Server/game/src/battlepass_manager.cpp@@ -1298,7 +1298,7 @@ 				TPacketGCExtBattlePassGeneralInfo packet;
 				packet.bHeader = HEADER_GC_EXT_BATTLE_PASS_GENERAL_INFO;
 				packet.bBattlePassType = 1;
-				strcpy(packet.szSeasonName, season_name);
+				snprintf(packet.szSeasonName, sizeof(packet.szSeasonName), "%s", season_name ? season_name : "");
 				packet.dwBattlePassID = timeInfo[0].bBattlePassId;
 				packet.dwBattlePassStartTime = timeInfo[0].dwStartTime;
 				packet.dwBattlePassEndTime = timeInfo[0].dwEndTime;
@@ -1325,7 +1325,7 @@ 				TPacketGCExtBattlePassGeneralInfo packet;
 				packet.bHeader = HEADER_GC_EXT_BATTLE_PASS_GENERAL_INFO;
 				packet.bBattlePassType = 2;
-				strcpy(packet.szSeasonName, season_name);
+				snprintf(packet.szSeasonName, sizeof(packet.szSeasonName), "%s", season_name ? season_name : "");
 				packet.dwBattlePassID = timeInfo[0].bBattlePassId;
 				packet.dwBattlePassStartTime = timeInfo[0].dwStartTime;
 				packet.dwBattlePassEndTime = timeInfo[0].dwEndTime;
@@ -1352,7 +1352,7 @@ 				TPacketGCExtBattlePassGeneralInfo packet;
 				packet.bHeader = HEADER_GC_EXT_BATTLE_PASS_GENERAL_INFO;
 				packet.bBattlePassType = 3;
-				strcpy(packet.szSeasonName, season_name);
+				snprintf(packet.szSeasonName, sizeof(packet.szSeasonName), "%s", season_name ? season_name : "");
 				packet.dwBattlePassID = timeInfo[0].bBattlePassId;
 				packet.dwBattlePassStartTime = timeInfo[0].dwStartTime;
 				packet.dwBattlePassEndTime = timeInfo[0].dwEndTime;

diff --git a/server/server/home/metin2/Source/Server/db/src/ClientManagerPlayer.cpp b/server/server/home/metin2/Source/Server/db/src/ClientManagerPlayer.cpp
--- a/server/server/home/metin2/Source/Server/db/src/ClientManagerPlayer.cpp+++ b/server/server/home/metin2/Source/Server/db/src/ClientManagerPlayer.cpp@@ -690,14 +690,14 @@ 		TItemAward* pItemAward = *(it++);
 		char* whyStr = pItemAward->szWhy; // why ݷ б
 		char cmdStr[100] = ""; // whyݷ뿡   ӽ ڿ ص
-		strcpy(cmdStr, whyStr); // ɾ   ū  ūȭ Ǳ 
+		snprintf(cmdStr, sizeof(cmdStr), "%s", whyStr ? whyStr : ""); // bounded copy
 		char command[20] = "";
 		GetCommand(cmdStr, command); // command 
 		if (!(strcmp(cmdStr, "GIFT"))) // command  GIFT ̸
 		{
 			TPacketItemAwardInfromer giftData;
-			strcpy(giftData.login, pItemAward->szLogin); //α ̵ 
-			strcpy(giftData.command, command); // ɾ 
+			snprintf(giftData.login, sizeof(giftData.login), "%s", pItemAward->szLogin ? pItemAward->szLogin : "");
+			snprintf(giftData.command, sizeof(giftData.command), "%s", command ? command : "");
 			giftData.vnum = pItemAward->dwVnum; //  vnum  
 			ForwardPacket(HEADER_DG_ITEMAWARD_INFORMER, &giftData, sizeof(TPacketItemAwardInfromer));
 		}

diff --git a/server/server/home/metin2/Source/Server/db/src/ItemAwardManager.cpp b/server/server/home/metin2/Source/Server/db/src/ItemAwardManager.cpp
--- a/server/server/home/metin2/Source/Server/db/src/ItemAwardManager.cpp+++ b/server/server/home/metin2/Source/Server/db/src/ItemAwardManager.cpp@@ -122,15 +122,15 @@ 			//  ߿ whyݷ뿡  
 			char* whyStr = kData->szWhy; // why ݷ б
 			char cmdStr[100] = ""; // whyݷ뿡   ӽ ڿ ص
-			strcpy(cmdStr, whyStr); // ɾ   ū  ūȭ Ǳ 
+		snprintf(cmdStr, sizeof(cmdStr), "%s", whyStr ? whyStr : ""); // bounded copy
 			char command[20] = "";
 			CClientManager::instance().GetCommand(cmdStr, command); // command 
 			//sys_err("%d, %s", pItemAward->dwID, command);
 			if (!(strcmp(cmdStr, "GIFT"))) // command  GIFT̸
 			{
 				TPacketItemAwardInfromer giftData;
-				strcpy(giftData.login, kData->szLogin); // α ̵ 
-				strcpy(giftData.command, command); // ɾ 
+			snprintf(giftData.login, sizeof(giftData.login), "%s", kData->szLogin ? kData->szLogin : "");
+			snprintf(giftData.command, sizeof(giftData.command), "%s", command ? command : "");
 				giftData.vnum = kData->dwVnum; //  vnum 
 				CClientManager::instance().ForwardPacket(HEADER_DG_ITEMAWARD_INFORMER, &giftData, sizeof(TPacketItemAwardInfromer));
 			}

diff --git a/server/server/home/metin2/Source/Server/db/src/ClientManager.cpp b/server/server/home/metin2/Source/Server/db/src/ClientManager.cpp
--- a/server/server/home/metin2/Source/Server/db/src/ClientManager.cpp+++ b/server/server/home/metin2/Source/Server/db/src/ClientManager.cpp@@ -4836,7 +4836,7 @@ 			if ((it != m_map_lEventFlag.end() && it->second == val) == false)
 			{
 				TPacketSetEventFlag p;
-				std::strcpy(p.szFlagName, flag);
+					snprintf(p.szFlagName, sizeof(p.szFlagName), "%s", flag ? flag : "");
 				p.lValue = val;
 				SetEventFlag(&p);
 			}

diff --git a/server/server/home/metin2/Source/Server/libthecore/src/log.c b/server/server/home/metin2/Source/Server/libthecore/src/log.c
--- a/server/server/home/metin2/Source/Server/libthecore/src/log.c+++ b/server/server/home/metin2/Source/Server/libthecore/src/log.c@@ -473,6 +473,6 @@ 
 void log_file_set_dir(const char* dir)
 {
-	strcpy(log_dir, dir);
+	snprintf(log_dir, sizeof(log_dir), "%s", dir ? dir : "");
 	log_file_delete_old(log_dir);
 }

diff --git a/server/server/home/metin2/Source/Server/liblua/src/lib/liolib.c b/server/server/home/metin2/Source/Server/liblua/src/lib/liolib.c
--- a/server/server/home/metin2/Source/Server/liblua/src/lib/liolib.c+++ b/server/server/home/metin2/Source/Server/liblua/src/lib/liolib.c@@ -10,6 +10,11 @@ #include <stdlib.h>
 #include <string.h>
 #include <time.h>
+
+#ifndef ENABLE_LUA_POPEN
+#define ENABLE_LUA_POPEN 0
+#endif
+
 
 #include "lua.h"
 
@@ -199,6 +204,9 @@ 
 static int io_popen(lua_State* L)
 {
+#if !ENABLE_LUA_POPEN
+	return luaL_error(L, "io.popen is disabled");
+#endif
 #if !USE_POPEN
 	luaL_error(L, "`popen' not supported");
 	return 0;

